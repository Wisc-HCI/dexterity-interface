(function(bt,Pt){typeof exports=="object"&&typeof module<"u"?Pt(exports):typeof define=="function"&&define.amd?define(["exports"],Pt):(bt=typeof globalThis<"u"?globalThis:bt||self,Pt(bt.OVWebStreamingLibrary={}))})(this,function(bt){"use strict";var MA=Object.defineProperty;var LA=(bt,Pt,ft)=>Pt in bt?MA(bt,Pt,{enumerable:!0,configurable:!0,writable:!0,value:ft}):bt[Pt]=ft;var ke=(bt,Pt,ft)=>LA(bt,typeof Pt!="symbol"?Pt+"":Pt,ft);var Pt=(f=>(f.DEBUG="DEBUG",f.INFO="INFO",f.WARN="WARN",f.ERROR="ERROR",f))(Pt||{});const ft={CHROME_OS:"ChromeOS",WINDOWS:"Windows",MAC:"macOS",LINUX:"Linux",IOS:"iOS",IPADOS:"iPadOS",WEBOS:"WebOS",TIZEN:"Tizen",ANDROID:"Android",XBOX:"Xbox"},Bf={JWT_GFN:1},At={DESKTOP:"DESKTOP",LAPTOP:"LAPTOP",TV:"TV",PHONE:"PHONE",TABLET:"TABLET",CONSOLE:"CONSOLE"},Kt={UNKNOWN:"Unknown",CHROME:"Chrome",SAFARI:"Safari",YANDEX:"Yandex",EDGE:"Edge",EDGE_LEGACY:"Edge_Legacy",FIREFOX:"Firefox",SAMSUNG:"Samsung",CHROMIUM:"Chromium",OPERA:"Opera",BRAVE:"Brave",SILK:"Silk",REACT:"ReactNative"};function Vf(f){let a="undefined";return f===At.CONSOLE?a="Console":f===At.TABLET?a="Tablet":f===At.PHONE?a="Phone":f===At.TV?a="TV":f===At.LAPTOP?a="Laptop":f===At.DESKTOP&&(a="Desktop"),a}function Hf(f){switch(f){case Kt.CHROME:return"Chrome";case Kt.SAFARI:return"Safari";case Kt.YANDEX:return"Yandex";case Kt.EDGE:return"Edge";case Kt.EDGE_LEGACY:return"Edge_legacy";case Kt.FIREFOX:return"Firefox";case Kt.SAMSUNG:return"Samsung";case Kt.CHROMIUM:return"Chromium";case Kt.OPERA:return"Opera";case Kt.BRAVE:return"Brave";case Kt.SILK:return"Silk";case Kt.UNKNOWN:return"undefined";case Kt.REACT:return"undefined";default:return"undefined"}}function Wf(f){switch(f.toLowerCase()){case"windows":return"Windows";case"macosx":case"macos":return"MacOS";case"chromeos":case"chrome os":return"ChromeOS";case"linux":return"Linux";case"ios":return"iOS";case"ipados":return"iPadOS";case"tizen":return"Tizen";case"webos":return"WebOS";case"xbox":return"Xbox";default:return"undefined"}}class zf{setDataForLoginType(a){console.log("initializing dummy auth")}getLoginUrl(){return"error"}getUserName(){return"Local"}getUserId(){return"Local"}getExternalUserId(){return"Local"}getDeviceId(){return"Local"}getIdpId(){return"Local"}checkTokenValidity(){return Promise.resolve()}respondToRedirect(a){return Promise.resolve()}getTokenCallback(){return()=>Promise.resolve("dummy")}getAuthInfo(){return Promise.resolve({type:Bf.JWT_GFN,token:"dummy"})}logout(){console.log("logging out of dummy auth")}startOffDeviceLogin(){return Promise.resolve({verification_uri:"",user_code:"",device_code:"",expires_in:0,interval:0})}pollOffDeviceLogin(a){return Promise.resolve()}}function Kf(f){return typeof f=="object"&&f!==null&&typeof f.logLevel=="string"&&typeof f.logModule=="string"&&typeof f.logtag=="string"&&typeof f.logstr=="string"}var Ir=(f=>(f.JSON="json",f.TEXT="text",f))(Ir||{});function Wn(f,a){return a===Ir.JSON?JSON.stringify(f):`${f.timestamp} (${f.sessionId}): ${f.detail}`}var kc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $f(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}function qf(f){if(f.__esModule)return f;var a=f.default;if(typeof a=="function"){var g=function I(){return this instanceof I?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};g.prototype=a.prototype}else g={};return Object.defineProperty(g,"__esModule",{value:!0}),Object.keys(f).forEach(function(I){var M=Object.getOwnPropertyDescriptor(f,I);Object.defineProperty(g,I,M.get?M:{enumerable:!0,get:function(){return f[I]}})}),g}var Pc={exports:{}},vo={exports:{}},Oc;function Jf(){return Oc||(Oc=1,(()=>{var f={673:(M,C,w)=>{w.r(C),w.d(C,{DiagConsoleLogger:()=>He,DiagLogLevel:()=>B,INVALID_SPANID:()=>Yt,INVALID_SPAN_CONTEXT:()=>Ci,INVALID_TRACEID:()=>Xt,ProxyTracer:()=>En,ProxyTracerProvider:()=>on,ROOT_CONTEXT:()=>_e,SamplingDecision:()=>Bi,SpanKind:()=>bn,SpanStatusCode:()=>sn,TraceFlags:()=>Qt,ValueType:()=>pe,baggageEntryMetadataFromString:()=>Ee,context:()=>wn,createContextKey:()=>Ce,createNoopMeter:()=>Jt,createTraceState:()=>Yn,default:()=>or,defaultTextMapGetter:()=>Ut,defaultTextMapSetter:()=>Li,diag:()=>Xn,isSpanContextValid:()=>Fi,isValidSpanId:()=>rn,isValidTraceId:()=>nn,metrics:()=>er,propagation:()=>Tn,trace:()=>Rn});var S=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof w.g=="object"?w.g:{},m="1.4.1",A=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,H=function(b){var P=new Set([b]),k=new Set,q=b.match(A);if(!q)return function(){return!1};var re=+q[1],he=+q[2],Te=+q[3];if(q[4]!=null)return function($e){return $e===b};function Le($e){return k.add($e),!1}function De($e){return P.add($e),!0}return function($e){if(P.has($e))return!0;if(k.has($e))return!1;var Bt=$e.match(A);if(!Bt)return Le($e);var Wi=+Bt[1],ai=+Bt[2],ti=+Bt[3];return Bt[4]!=null||re!==Wi?Le($e):re===0?he===ai&&Te<=ti?De($e):Le($e):he<=ai?De($e):Le($e)}}(m),_=m.split(".")[0],V=Symbol.for("opentelemetry.js.api."+_),ie=S;function x(b,P,k,q){var re;q===void 0&&(q=!1);var he=ie[V]=(re=ie[V])!==null&&re!==void 0?re:{version:m};if(!q&&he[b]){var Te=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+b);return k.error(Te.stack||Te.message),!1}return he.version!==m?(Te=new Error("@opentelemetry/api: Registration of version v"+he.version+" for "+b+" does not match previously registered API v"+m),k.error(Te.stack||Te.message),!1):(he[b]=P,k.debug("@opentelemetry/api: Registered a global for "+b+" v"+m+"."),!0)}function F(b){var P,k,q=(P=ie[V])===null||P===void 0?void 0:P.version;if(q&&H(q))return(k=ie[V])===null||k===void 0?void 0:k[b]}function R(b,P){P.debug("@opentelemetry/api: Unregistering a global for "+b+" v"+m+".");var k=ie[V];k&&delete k[b]}var B,Y=function(b,P){var k=typeof Symbol=="function"&&b[Symbol.iterator];if(!k)return b;var q,re,he=k.call(b),Te=[];try{for(;(P===void 0||P-- >0)&&!(q=he.next()).done;)Te.push(q.value)}catch(Le){re={error:Le}}finally{try{q&&!q.done&&(k=he.return)&&k.call(he)}finally{if(re)throw re.error}}return Te},se=function(b,P,k){if(arguments.length===2)for(var q,re=0,he=P.length;re<he;re++)!q&&re in P||(q||(q=Array.prototype.slice.call(P,0,re)),q[re]=P[re]);return b.concat(q||Array.prototype.slice.call(P))},ve=function(){function b(P){this._namespace=P.namespace||"DiagComponentLogger"}return b.prototype.debug=function(){for(var P=[],k=0;k<arguments.length;k++)P[k]=arguments[k];return J("debug",this._namespace,P)},b.prototype.error=function(){for(var P=[],k=0;k<arguments.length;k++)P[k]=arguments[k];return J("error",this._namespace,P)},b.prototype.info=function(){for(var P=[],k=0;k<arguments.length;k++)P[k]=arguments[k];return J("info",this._namespace,P)},b.prototype.warn=function(){for(var P=[],k=0;k<arguments.length;k++)P[k]=arguments[k];return J("warn",this._namespace,P)},b.prototype.verbose=function(){for(var P=[],k=0;k<arguments.length;k++)P[k]=arguments[k];return J("verbose",this._namespace,P)},b}();function J(b,P,k){var q=F("diag");if(q)return k.unshift(P),q[b].apply(q,se([],Y(k),!1))}(function(b){b[b.NONE=0]="NONE",b[b.ERROR=30]="ERROR",b[b.WARN=50]="WARN",b[b.INFO=60]="INFO",b[b.DEBUG=70]="DEBUG",b[b.VERBOSE=80]="VERBOSE",b[b.ALL=9999]="ALL"})(B||(B={}));var fe=function(b,P){var k=typeof Symbol=="function"&&b[Symbol.iterator];if(!k)return b;var q,re,he=k.call(b),Te=[];try{for(;(P===void 0||P-- >0)&&!(q=he.next()).done;)Te.push(q.value)}catch(Le){re={error:Le}}finally{try{q&&!q.done&&(k=he.return)&&k.call(he)}finally{if(re)throw re.error}}return Te},le=function(b,P,k){if(arguments.length===2)for(var q,re=0,he=P.length;re<he;re++)!q&&re in P||(q||(q=Array.prototype.slice.call(P,0,re)),q[re]=P[re]);return b.concat(q||Array.prototype.slice.call(P))},T=function(){function b(){function P(q){return function(){for(var re=[],he=0;he<arguments.length;he++)re[he]=arguments[he];var Te=F("diag");if(Te)return Te[q].apply(Te,le([],fe(re),!1))}}var k=this;k.setLogger=function(q,re){var he,Te,Le;if(re===void 0&&(re={logLevel:B.INFO}),q===k){var De=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return k.error((he=De.stack)!==null&&he!==void 0?he:De.message),!1}typeof re=="number"&&(re={logLevel:re});var $e=F("diag"),Bt=function(ai,ti){function Ii(zi,xr){var gi=ti[zi];return typeof gi=="function"&&ai>=xr?gi.bind(ti):function(){}}return ai<B.NONE?ai=B.NONE:ai>B.ALL&&(ai=B.ALL),ti=ti||{},{error:Ii("error",B.ERROR),warn:Ii("warn",B.WARN),info:Ii("info",B.INFO),debug:Ii("debug",B.DEBUG),verbose:Ii("verbose",B.VERBOSE)}}((Te=re.logLevel)!==null&&Te!==void 0?Te:B.INFO,q);if($e&&!re.suppressOverrideMessage){var Wi=(Le=new Error().stack)!==null&&Le!==void 0?Le:"<failed to generate stacktrace>";$e.warn("Current logger will be overwritten from "+Wi),Bt.warn("Current logger will overwrite one already registered from "+Wi)}return x("diag",Bt,k,!0)},k.disable=function(){R("diag",k)},k.createComponentLogger=function(q){return new ve(q)},k.verbose=P("verbose"),k.debug=P("debug"),k.info=P("info"),k.warn=P("warn"),k.error=P("error")}return b.instance=function(){return this._instance||(this._instance=new b),this._instance},b}(),L=function(b,P){var k=typeof Symbol=="function"&&b[Symbol.iterator];if(!k)return b;var q,re,he=k.call(b),Te=[];try{for(;(P===void 0||P-- >0)&&!(q=he.next()).done;)Te.push(q.value)}catch(Le){re={error:Le}}finally{try{q&&!q.done&&(k=he.return)&&k.call(he)}finally{if(re)throw re.error}}return Te},K=function(b){var P=typeof Symbol=="function"&&Symbol.iterator,k=P&&b[P],q=0;if(k)return k.call(b);if(b&&typeof b.length=="number")return{next:function(){return b&&q>=b.length&&(b=void 0),{value:b&&b[q++],done:!b}}};throw new TypeError(P?"Object is not iterable.":"Symbol.iterator is not defined.")},$=function(){function b(P){this._entries=P?new Map(P):new Map}return b.prototype.getEntry=function(P){var k=this._entries.get(P);if(k)return Object.assign({},k)},b.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(P){var k=L(P,2);return[k[0],k[1]]})},b.prototype.setEntry=function(P,k){var q=new b(this._entries);return q._entries.set(P,k),q},b.prototype.removeEntry=function(P){var k=new b(this._entries);return k._entries.delete(P),k},b.prototype.removeEntries=function(){for(var P,k,q=[],re=0;re<arguments.length;re++)q[re]=arguments[re];var he=new b(this._entries);try{for(var Te=K(q),Le=Te.next();!Le.done;Le=Te.next()){var De=Le.value;he._entries.delete(De)}}catch($e){P={error:$e}}finally{try{Le&&!Le.done&&(k=Te.return)&&k.call(Te)}finally{if(P)throw P.error}}return he},b.prototype.clear=function(){return new b},b}(),ae=Symbol("BaggageEntryMetadata"),Se=T.instance();function ue(b){return b===void 0&&(b={}),new $(new Map(Object.entries(b)))}function Ee(b){return typeof b!="string"&&(Se.error("Cannot create baggage metadata from unknown type: "+typeof b),b=""),{__TYPE__:ae,toString:function(){return b}}}function Ce(b){return Symbol.for(b)}var ge,pe,Ue=function b(P){var k=this;k._currentContext=P?new Map(P):new Map,k.getValue=function(q){return k._currentContext.get(q)},k.setValue=function(q,re){var he=new b(k._currentContext);return he._currentContext.set(q,re),he},k.deleteValue=function(q){var re=new b(k._currentContext);return re._currentContext.delete(q),re}},_e=new Ue,Fe=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],He=function(){function b(k){return function(){for(var q=[],re=0;re<arguments.length;re++)q[re]=arguments[re];if(console){var he=console[k];if(typeof he!="function"&&(he=console.log),typeof he=="function")return he.apply(console,q)}}}for(var P=0;P<Fe.length;P++)this[Fe[P].n]=b(Fe[P].c)},Ne=(ge=function(b,P){return ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,q){k.__proto__=q}||function(k,q){for(var re in q)Object.prototype.hasOwnProperty.call(q,re)&&(k[re]=q[re])},ge(b,P)},function(b,P){if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");function k(){this.constructor=b}ge(b,P),b.prototype=P===null?Object.create(P):(k.prototype=P.prototype,new k)}),je=function(){function b(){}return b.prototype.createHistogram=function(P,k){return ze},b.prototype.createCounter=function(P,k){return Ye},b.prototype.createUpDownCounter=function(P,k){return qt},b.prototype.createObservableGauge=function(P,k){return ri},b.prototype.createObservableCounter=function(P,k){return Ft},b.prototype.createObservableUpDownCounter=function(P,k){return Mi},b.prototype.addBatchObservableCallback=function(P,k){},b.prototype.removeBatchObservableCallback=function(P){},b}(),rt=function(){},Pe=function(b){function P(){return b!==null&&b.apply(this,arguments)||this}return Ne(P,b),P.prototype.add=function(k,q){},P}(rt),ht=function(b){function P(){return b!==null&&b.apply(this,arguments)||this}return Ne(P,b),P.prototype.add=function(k,q){},P}(rt),ct=function(b){function P(){return b!==null&&b.apply(this,arguments)||this}return Ne(P,b),P.prototype.record=function(k,q){},P}(rt),Ve=function(){function b(){}return b.prototype.addCallback=function(P){},b.prototype.removeCallback=function(P){},b}(),Xe=function(b){function P(){return b!==null&&b.apply(this,arguments)||this}return Ne(P,b),P}(Ve),St=function(b){function P(){return b!==null&&b.apply(this,arguments)||this}return Ne(P,b),P}(Ve),lt=function(b){function P(){return b!==null&&b.apply(this,arguments)||this}return Ne(P,b),P}(Ve),We=new je,Ye=new Pe,ze=new ct,qt=new ht,Ft=new Xe,ri=new St,Mi=new lt;function Jt(){return We}(function(b){b[b.INT=0]="INT",b[b.DOUBLE=1]="DOUBLE"})(pe||(pe={}));var Qt,Ut={get:function(b,P){if(b!=null)return b[P]},keys:function(b){return b==null?[]:Object.keys(b)}},Li={set:function(b,P,k){b!=null&&(b[P]=k)}},en=function(b,P){var k=typeof Symbol=="function"&&b[Symbol.iterator];if(!k)return b;var q,re,he=k.call(b),Te=[];try{for(;(P===void 0||P-- >0)&&!(q=he.next()).done;)Te.push(q.value)}catch(Le){re={error:Le}}finally{try{q&&!q.done&&(k=he.return)&&k.call(he)}finally{if(re)throw re.error}}return Te},ut=function(b,P,k){if(arguments.length===2)for(var q,re=0,he=P.length;re<he;re++)!q&&re in P||(q||(q=Array.prototype.slice.call(P,0,re)),q[re]=P[re]);return b.concat(q||Array.prototype.slice.call(P))},Ni=function(){function b(){}return b.prototype.active=function(){return _e},b.prototype.with=function(P,k,q){for(var re=[],he=3;he<arguments.length;he++)re[he-3]=arguments[he];return k.call.apply(k,ut([q],en(re),!1))},b.prototype.bind=function(P,k){return k},b.prototype.enable=function(){return this},b.prototype.disable=function(){return this},b}(),Sn=function(b,P){var k=typeof Symbol=="function"&&b[Symbol.iterator];if(!k)return b;var q,re,he=k.call(b),Te=[];try{for(;(P===void 0||P-- >0)&&!(q=he.next()).done;)Te.push(q.value)}catch(Le){re={error:Le}}finally{try{q&&!q.done&&(k=he.return)&&k.call(he)}finally{if(re)throw re.error}}return Te},tn=function(b,P,k){if(arguments.length===2)for(var q,re=0,he=P.length;re<he;re++)!q&&re in P||(q||(q=Array.prototype.slice.call(P,0,re)),q[re]=P[re]);return b.concat(q||Array.prototype.slice.call(P))},wi="context",xi=new Ni,jt=function(){function b(){}return b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.setGlobalContextManager=function(P){return x(wi,P,T.instance())},b.prototype.active=function(){return this._getContextManager().active()},b.prototype.with=function(P,k,q){for(var re,he=[],Te=3;Te<arguments.length;Te++)he[Te-3]=arguments[Te];return(re=this._getContextManager()).with.apply(re,tn([P,k,q],Sn(he),!1))},b.prototype.bind=function(P,k){return this._getContextManager().bind(P,k)},b.prototype._getContextManager=function(){return F(wi)||xi},b.prototype.disable=function(){this._getContextManager().disable(),R(wi,T.instance())},b}();(function(b){b[b.NONE=0]="NONE",b[b.SAMPLED=1]="SAMPLED"})(Qt||(Qt={}));var Yt="0000000000000000",Xt="00000000000000000000000000000000",Ci={traceId:Xt,spanId:Yt,traceFlags:Qt.NONE},Zt=function(){function b(P){P===void 0&&(P=Ci),this._spanContext=P}return b.prototype.spanContext=function(){return this._spanContext},b.prototype.setAttribute=function(P,k){return this},b.prototype.setAttributes=function(P){return this},b.prototype.addEvent=function(P,k){return this},b.prototype.setStatus=function(P){return this},b.prototype.updateName=function(P){return this},b.prototype.end=function(P){},b.prototype.isRecording=function(){return!1},b.prototype.recordException=function(P,k){},b}(),fi=Ce("OpenTelemetry Context Key SPAN");function pi(b){return b.getValue(fi)||void 0}function Lr(){return pi(jt.getInstance().active())}function yn(b,P){return b.setValue(fi,P)}function $n(b){return b.deleteValue(fi)}function si(b,P){return yn(b,new Zt(P))}function ei(b){var P;return(P=pi(b))===null||P===void 0?void 0:P.spanContext()}var _i=/^([0-9a-f]{32})$/i,vi=/^[0-9a-f]{16}$/i;function nn(b){return _i.test(b)&&b!==Xt}function rn(b){return vi.test(b)&&b!==Yt}function Fi(b){return nn(b.traceId)&&rn(b.spanId)}function Ui(b){return new Zt(b)}var ji=jt.getInstance(),Gi=function(){function b(){}return b.prototype.startSpan=function(P,k,q){if(q===void 0&&(q=ji.active()),!!(k!=null&&k.root))return new Zt;var re,he=q&&ei(q);return typeof(re=he)=="object"&&typeof re.spanId=="string"&&typeof re.traceId=="string"&&typeof re.traceFlags=="number"&&Fi(he)?new Zt(he):new Zt},b.prototype.startActiveSpan=function(P,k,q,re){var he,Te,Le;if(!(arguments.length<2)){arguments.length===2?Le=k:arguments.length===3?(he=k,Le=q):(he=k,Te=q,Le=re);var De=Te??ji.active(),$e=this.startSpan(P,he,De),Bt=yn(De,$e);return ji.with(Bt,Le,void 0,$e)}},b}(),Bi,bn,sn,qn=new Gi,En=function(){function b(P,k,q,re){this._provider=P,this.name=k,this.version=q,this.options=re}return b.prototype.startSpan=function(P,k,q){return this._getTracer().startSpan(P,k,q)},b.prototype.startActiveSpan=function(P,k,q,re){var he=this._getTracer();return Reflect.apply(he.startActiveSpan,he,arguments)},b.prototype._getTracer=function(){if(this._delegate)return this._delegate;var P=this._provider.getDelegateTracer(this.name,this.version,this.options);return P?(this._delegate=P,this._delegate):qn},b}(),Jn=new(function(){function b(){}return b.prototype.getTracer=function(P,k,q){return new Gi},b}()),on=function(){function b(){}return b.prototype.getTracer=function(P,k,q){var re;return(re=this.getDelegateTracer(P,k,q))!==null&&re!==void 0?re:new En(this,P,k,q)},b.prototype.getDelegate=function(){var P;return(P=this._delegate)!==null&&P!==void 0?P:Jn},b.prototype.setDelegate=function(P){this._delegate=P},b.prototype.getDelegateTracer=function(P,k,q){var re;return(re=this._delegate)===null||re===void 0?void 0:re.getTracer(P,k,q)},b}();(function(b){b[b.NOT_RECORD=0]="NOT_RECORD",b[b.RECORD=1]="RECORD",b[b.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Bi||(Bi={})),function(b){b[b.INTERNAL=0]="INTERNAL",b[b.SERVER=1]="SERVER",b[b.CLIENT=2]="CLIENT",b[b.PRODUCER=3]="PRODUCER",b[b.CONSUMER=4]="CONSUMER"}(bn||(bn={})),function(b){b[b.UNSET=0]="UNSET",b[b.OK=1]="OK",b[b.ERROR=2]="ERROR"}(sn||(sn={}));var an="[_0-9a-z-*/]",Qn=new RegExp("^(?:"+("[a-z]"+an+"{0,255}")+"|"+("[a-z0-9]"+an+"{0,240}@[a-z]"+an+"{0,13}")+")$"),dn=/^[ -~]{0,255}[!-~]$/,Nr=/,|=/,Gt=function(){function b(P){this._internalState=new Map,P&&this._parse(P)}return b.prototype.set=function(P,k){var q=this._clone();return q._internalState.has(P)&&q._internalState.delete(P),q._internalState.set(P,k),q},b.prototype.unset=function(P){var k=this._clone();return k._internalState.delete(P),k},b.prototype.get=function(P){return this._internalState.get(P)},b.prototype.serialize=function(){var P=this;return this._keys().reduce(function(k,q){return k.push(q+"="+P.get(q)),k},[]).join(",")},b.prototype._parse=function(P){P.length>512||(this._internalState=P.split(",").reverse().reduce(function(k,q){var re=q.trim(),he=re.indexOf("=");if(he!==-1){var Te=re.slice(0,he),Le=re.slice(he+1,q.length);(function(De){return Qn.test(De)})(Te)&&function(De){return dn.test(De)&&!Nr.test(De)}(Le)&&k.set(Te,Le)}return k},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},b.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},b.prototype._clone=function(){var P=new b;return P._internalState=new Map(this._internalState),P},b}();function Yn(b){return new Gt(b)}var wn=jt.getInstance(),Xn=T.instance(),Zn=new(function(){function b(){}return b.prototype.getMeter=function(P,k,q){return We},b}()),Cn="metrics",er=function(){function b(){}return b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.setGlobalMeterProvider=function(P){return x(Cn,P,T.instance())},b.prototype.getMeterProvider=function(){return F(Cn)||Zn},b.prototype.getMeter=function(P,k,q){return this.getMeterProvider().getMeter(P,k,q)},b.prototype.disable=function(){R(Cn,T.instance())},b}().getInstance(),oi=function(){function b(){}return b.prototype.inject=function(P,k){},b.prototype.extract=function(P,k){return P},b.prototype.fields=function(){return[]},b}(),Vi=Ce("OpenTelemetry Baggage Key");function tr(b){return b.getValue(Vi)||void 0}function ir(){return tr(jt.getInstance().active())}function In(b,P){return b.setValue(Vi,P)}function nr(b){return b.deleteValue(Vi)}var cn="propagation",rr=new oi,sr=function(){function b(){this.createBaggage=ue,this.getBaggage=tr,this.getActiveBaggage=ir,this.setBaggage=In,this.deleteBaggage=nr}return b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.setGlobalPropagator=function(P){return x(cn,P,T.instance())},b.prototype.inject=function(P,k,q){return q===void 0&&(q=Li),this._getGlobalPropagator().inject(P,k,q)},b.prototype.extract=function(P,k,q){return q===void 0&&(q=Ut),this._getGlobalPropagator().extract(P,k,q)},b.prototype.fields=function(){return this._getGlobalPropagator().fields()},b.prototype.disable=function(){R(cn,T.instance())},b.prototype._getGlobalPropagator=function(){return F(cn)||rr},b}(),Tn=sr.getInstance(),Hi="trace",Rn=function(){function b(){this._proxyTracerProvider=new on,this.wrapSpanContext=Ui,this.isSpanContextValid=Fi,this.deleteSpan=$n,this.getSpan=pi,this.getActiveSpan=Lr,this.getSpanContext=ei,this.setSpan=yn,this.setSpanContext=si}return b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.setGlobalTracerProvider=function(P){var k=x(Hi,this._proxyTracerProvider,T.instance());return k&&this._proxyTracerProvider.setDelegate(P),k},b.prototype.getTracerProvider=function(){return F(Hi)||this._proxyTracerProvider},b.prototype.getTracer=function(P,k){return this.getTracerProvider().getTracer(P,k)},b.prototype.disable=function(){R(Hi,T.instance()),this._proxyTracerProvider=new on},b}().getInstance();const or={context:wn,diag:Xn,metrics:er,propagation:Tn,trace:Rn}},379:(M,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.CancellableWait=void 0,C.CancellableWait=class{constructor(w,S){var m;this.timerId=0,this.timedOut=!1,this.aborted=!1,this.promise=new Promise((A,H)=>{this.promiseResolve=A,this.promiseReject=H}),S!=null&&S.aborted?(this.aborted=!0,this.promiseReject()):(this.abortSignal=S,this.onAbortFunc=this.onAbort.bind(this),(m=this.abortSignal)===null||m===void 0||m.addEventListener("abort",this.onAbortFunc),this.timerId=window.setTimeout(this.onTimeout.bind(this),w))}cancel(){var w;(w=this.abortSignal)===null||w===void 0||w.removeEventListener("abort",this.onAbortFunc),this.timerId&&(window.clearTimeout(this.timerId),this.timerId=0),this.abortSignal=void 0}getPromise(){return this.promise}isTimedOut(){return this.timedOut}isAborted(){return this.aborted}onAbort(){this.aborted=!0,this.promiseReject(),this.cancel()}onTimeout(){this.timedOut=!0,this.promiseResolve(),this.timerId=0,this.cancel()}}},921:(M,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.CLIENT_ID=void 0,C.CLIENT_ID="62677554106929725"},121:(M,C,w)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.performHttpRequest=C.DefaultHttpRequestOptions=void 0;const S=w(673),m=w(614),A=w(367),H=w(379),_="httprequest";C.DefaultHttpRequestOptions={method:"GET",headers:{},body:"",retryCount:0,timeout:0,keepalive:!1},C.performHttpRequest=function(V,ie=C.DefaultHttpRequestOptions,x,F){var R;const B=(R=ie.method)!==null&&R!==void 0?R:"GET";return A.TracingManager.getInstance().createSpan(B,()=>(function(Y,se,ve){const J=S.trace.getActiveSpan();if(!J)return;let fe=new Map([["component",A.TracingComponent.name],["component.version",A.TracingComponent.version],["http.method",Y],["http.url",se],["type",""],["http.hostname",""],["http.path",""]]);try{const le=new URL(se);fe.set("type",le.protocol),fe.set("http.hostname",le.hostname),fe.set("http.path",le.pathname)}catch{m.Log.e(_,"Failed to extract http request attributes")}for(const[le,T]of fe)J.setAttribute(le,T);J.setAttributes(ve)}(B,V,ie.headers),function(Y,se=C.DefaultHttpRequestOptions,ve,J){var fe,le;let T=se.retryCount===void 0?1:se.retryCount+1;const L=T,K=(fe=se.backOffDelay)!==null&&fe!==void 0?fe:500;let $=K;const ae=(le=se.method)!==null&&le!==void 0?le:"GET";let Se=new Headers;const ue=J??new AbortController;return(ge=>{if(ge)switch(ge.type){case 1:ge.token&&Se.set("authorization","GFNJWT "+ge.token);break;case 2:ge.token&&Se.set("authorization","GFNPartnerJWT auth="+ge.token)}se.headers!==void 0&&Object.keys(se.headers).forEach(Ue=>{Se.set(Ue,se.headers[Ue])});const pe={};S.propagation.inject(S.context.active(),pe);for(const[Ue,_e]of Object.entries(pe))Se.set(Ue,_e)})(ve),new Promise((ge,pe)=>{const Ue=He=>{(function(Ne){const je=S.trace.getActiveSpan();je&&(je.setAttribute("error","false"),je.setAttribute("http.status_code",Ne.toString()))})(He.status),ge(He)},_e=He=>{(function(){const Ne=S.trace.getActiveSpan();Ne&&Ne.setAttribute("error","true")})(),pe(He)},Fe=()=>{const He=Ne=>{if(T>1){T--,m.Log.d(_,`Failing with ${Ne}, retries left ${T}`);const je=new H.CancellableWait($,ue.signal);return je.getPromise().then(Fe).catch(rt=>{je.isAborted()?_e({code:15867905,retries:L-T}):(m.Log.w(_,`Unhandled exception caught: ${JSON.stringify(rt)}`),_e({code:3237089284,retries:L-T}))}),$+=K,!0}return!1};if(navigator.onLine){let Ne,je={method:ae,headers:Se,mode:"cors",keepalive:se.keepalive,signal:ue.signal,cache:"no-store"};ae!=="GET"&&ae!=="HEAD"&&(je.body=se.body);const rt=0,Pe=[rt,DOMException.NETWORK_ERR,DOMException.TIMEOUT_ERR,503],ht=se.timeout?new H.CancellableWait(se.timeout):void 0,ct=[];ct.push(fetch(Y,je)),ht&&ct.push(ht.getPromise()),Promise.race(ct).then(Ve=>{if(ht!=null&&ht.isTimedOut())throw m.Log.w(_,`Timeout while performing HTTP request for Url: ${Y}`),{code:DOMException.TIMEOUT_ERR,message:"Timeout while performing HTTP request"};if(Ve instanceof globalThis.Response)return Ne=Ve.status,Ve.text()}).then(Ve=>{if(!Ve&&Pe.includes(Ne)){if(T>1)throw{code:Ne,message:"Internal server error."};m.Log.w(_,`Failing with ${Ne} even after ${L} retries`)}Ue({status:Ne,data:Ve??"",retries:L-T})}).catch(Ve=>{const Xe=We=>{let Ye=rt;return We!=null&&We.code?Ye=We==null?void 0:We.code:We!=null&&We.name&&(We.name==="AbortError"?Ye=DOMException.ABORT_ERR:We.name==="NetworkError"?Ye=DOMException.NETWORK_ERR:We.name==="TimeoutError"&&(Ye=DOMException.TIMEOUT_ERR)),Ye},St=We=>[rt,DOMException.NETWORK_ERR,DOMException.TIMEOUT_ERR].includes(We)?(m.Log.d(_,"Fetch failing with NetworkError"),3237089282):We==DOMException.ABORT_ERR?(m.Log.d(_,"Fetch failing since user aborted"),15867905):(m.Log.w(_,`Unhandled Fetch error: ${We}`),3237089284);Ve instanceof Error?m.Log.d(_,`Error in Fetch: ${Ve.message}`):m.Log.d(_,`Error in Fetch: ${JSON.stringify(Ve)}, ${Ve}`);const lt=Xe(Ve);lt==rt&&se.keepalive&&(se.keepalive=!1),Pe.includes(lt)?He(lt)||(m.Log.w(_,`Fetch failing even after ${L} retries. Error: ${lt}`),_e({code:St(lt),retries:L-T})):_e({code:St(lt),retries:L-T})}).finally(()=>{ht==null||ht.cancel()})}else _e({code:3237089281,description:"No network",retries:L-T})};Fe()})}(V,ie,x,F)))}},386:(M,C,w)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.IndexedDb=void 0;const S=w(614),m="indexdb";function A(H,_,V){return{code:H,description:_,error:V!==null?V:void 0}}C.IndexedDb=class{constructor(H,_){this.indexedDb=window.indexedDB,this.version=2,this.isDbClosing=!1,this.didDbCloseUnexpectedly=!1,this.name=H,this.storeDetails=_}open(){return new Promise((H,_)=>{try{if(this.indexedDb){let V=this.indexedDb.open(this.name,this.version);V.onerror=ie=>{_(A(18,`${this.name} db opening failed`,V.error))},V.onsuccess=ie=>{this.createDbInstance(V.result),H()},V.onupgradeneeded=ie=>{S.Log.i(m,`Upgrading from version ${ie.oldVersion} to ${ie.newVersion}`),this.createDbInstance(V.result);const x=F=>{var R;const B=(R=this.dbInstance)===null||R===void 0?void 0:R.createObjectStore(F.storeName,F.storeOptions);F.storeOptions.keyPath&&(B==null||B.createIndex(F.storeIndexName,F.storeOptions.keyPath,{unique:!0}))};switch(ie.oldVersion){case 0:x(this.storeDetails[0]);case 1:x(this.storeDetails[1])}},V.onblocked=ie=>{_(A(19,`${this.name} db blocked during opening`,V.error))}}else _(A(17,"Indexdb object not found"))}catch(V){_(A(20,"Unexpected Exception in open",V))}})}getDbStateError(){if(!this.indexedDb)return A(17,"Indexdb object not found");if(!this.dbInstance)return A(1,"Db not yet open");if(this.isDbClosing){const H=document.visibilityState==="hidden";return A(2,"Db is closing, unexpectedly: "+this.didDbCloseUnexpectedly+", visibility state hidden: "+H)}}get(H,_){const V=this.getDbStateError();return V?Promise.reject(V):new Promise((ie,x)=>{try{const F=this.dbInstance.transaction(H,"readonly"),R=F.objectStore(H);F.oncomplete=Y=>{S.Log.i(m,"transaction complete in get")};const B=R.get(_);B.onsuccess=()=>{ie(B.result)},B.onerror=Y=>{x(A(32,"get method failed",F.error))}}catch(F){x(A(33,"Unexpected Exception happened in get",F))}})}set(H,_){const V=this.getDbStateError();return V?Promise.reject(V):new Promise((ie,x)=>{try{const F=this.dbInstance.transaction(H,"readwrite"),R=F.objectStore(H);F.oncomplete=Y=>{S.Log.i(m,"transaction complete in set")};const B=R.put(_);B.onsuccess=()=>{ie()},B.onerror=Y=>{x(A(48,"put method failed",F.error))}}catch(F){x(A(49,"Unexpected Exception happened in set",F))}})}delete(H,_){const V=this.getDbStateError();return V?Promise.reject(V):new Promise((ie,x)=>{try{const F=this.dbInstance.transaction(H,"readwrite"),R=F.objectStore(H);F.oncomplete=Y=>{S.Log.i(m,"transaction complete in delete")};const B=R.delete(_);B.onsuccess=()=>{ie()},B.onerror=Y=>{x(A(64,"delete method failed",F.error))}}catch(F){x(A(65,"Unexpected Exception in delete",F))}})}clear(H){const _=this.getDbStateError();return _?Promise.reject(_):new Promise((V,ie)=>{try{const x=this.dbInstance.transaction(H,"readwrite"),F=x.objectStore(H);x.oncomplete=B=>{S.Log.i(m,"transaction complete in clear")};const R=F.clear();R.onsuccess=()=>{V()},R.onerror=B=>{ie(A(80,"clear method failed)",x.error))}}catch(x){ie(A(81,"Unexpected Exception happened in clear",x))}})}getAll(H){const _=this.getDbStateError();return _?Promise.reject(_):new Promise((V,ie)=>{try{const x=this.dbInstance.transaction(H,"readonly"),F=x.objectStore(H);x.oncomplete=B=>{S.Log.i(m,"transaction complete in getAll")};const R=F.getAll();R.onsuccess=()=>{V(R.result)},R.onerror=B=>{ie(A(96,"getAll method failed",x.error))}}catch(x){ie(A(97,"Unexpected Exception in getAll",x))}})}close(){var H;this.isDbClosing=!0,(H=this.dbInstance)===null||H===void 0||H.close()}createDbInstance(H){this.isDbClosing=!1,this.didDbCloseUnexpectedly=!1,this.dbInstance=H,this.dbInstance.onversionchange=_=>{S.Log.w(m,"closing db to unblock other tabs"),this.close(),this.dbInstance=void 0},this.dbInstance.onclose=_=>{S.Log.w(m,"Db connection unexpectedly closed"),this.isDbClosing=!0,this.didDbCloseUnexpectedly=!0}}}},596:(M,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.LogBuffer=void 0;class w{constructor(m){this.encoder=new TextEncoder,this.logIndex=0,this.full=!1,this.buffer=new Uint8Array(m+w.FULL_MESSAGE.length),this.maxLength=m}clear(){this.encoder=new TextEncoder,this.logIndex=0,this.full=!1}log(m){if(this.full)return;let A=this.encoder.encode(m+`
`);this.logIndex+A.byteLength>this.maxLength&&(this.full=!0,A=this.encoder.encode(w.FULL_MESSAGE)),this.buffer.set(A,this.logIndex),this.logIndex+=A.byteLength}getData(){return this.buffer.slice(0,this.logIndex)}}C.LogBuffer=w,w.FULL_MESSAGE=`Log is full
`},614:(M,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.LogImpl=C.Logger=C.Log=void 0;const w={NONE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4};class S{constructor(){this.queue=[],this.logMechanism=0,this.logLevel="DEBUG",this._nop=(_,V,...ie)=>{},this._d=(_,V,...ie)=>this.handleLog("DEBUG",_,V,ie),this._i=(_,V,...ie)=>this.handleLog("INFO",_,V,ie),this._w=(_,V,...ie)=>this.handleLog("WARN",_,V,ie),this._e=(_,V,...ie)=>this.handleLog("ERROR",_,V,ie)}setLogMechanism(_){this.logMechanism=_}setLogLevel(_){this.logLevel=_}get d(){return w[this.logLevel]<w.DEBUG?this._nop:this.logMechanism===1?console.debug.bind(console,"%s DEBUG [%s] %s@@",this.renderDate(new Date)):this._d}get w(){return w[this.logLevel]<w.WARN?this._nop:this.logMechanism===1?console.warn.bind(console,"%s WARN  [%s] %s@@",this.renderDate(new Date)):this._w}get i(){return w[this.logLevel]<w.INFO?this._nop:this.logMechanism===1?console.info.bind(console,"%s INFO  [%s] %s@@",this.renderDate(new Date)):this._i}get e(){return w[this.logLevel]<w.ERROR?this._nop:this.logMechanism===1?console.error.bind(console,"%s ERROR [%s] %s@@",this.renderDate(new Date)):this._e}register(_){this.callback=_,this.queue.length&&window.setTimeout(()=>{this.executeLogCallback(!0)})}isCallbackRegistered(){return!!this.callback}stringifyArgs(..._){return _.length?`##${JSON.stringify(_)}`:""}executeLogCallback(_){this.callback&&this.queue.length&&(this.callback(this.queue[0]),this.queue.shift(),_&&this.queue.length&&window.setTimeout(()=>{this.executeLogCallback(!0)}))}unregister(){this.callback=void 0}handleLog(_,V,ie,x){let F=`${ie}${this.stringifyArgs(...x)}`,R={timestamp:this.renderDate(new Date),level:_,tag:V,message:F};this.queue.push(R),this.callback?window.setTimeout(()=>{this.executeLogCallback(!1)}):this.queue.length>S.MAX_QUEUE_SIZE&&this.queue.shift()}renderDate(_){const V=(x,F,R)=>{const B=F-x.length;if(B>0){let Y="";for(let se=0;se<B;se++)Y+=R;return Y+=x,Y}return x};let ie="";return ie=V(_.getFullYear().toString(),4,"0")+"-"+(x=>V((x.getMonth()+1).toString(),2,"0"))(_)+"-"+(x=>V(x.getDate().toString(),2,"0"))(_)+" "+(x=>V(x.getHours().toString(),2,"0"))(_)+":"+(x=>V(x.getMinutes().toString(),2,"0"))(_)+":"+(x=>V(x.getSeconds().toString(),2,"0"))(_)+"."+(x=>V(x.getMilliseconds().toString(),3,"0"))(_),ie}}S.MAX_QUEUE_SIZE=50;const m=new S;C.Log=m,C.Logger=m;class A{constructor(_,V){this.module=_,this.enabled=!0,this.shouldLogToConsole=!1,this.queue=[],V&&(V.enable!==void 0&&(this.enabled=V.enable),V.enableConsoleLogging!==void 0&&(this.shouldLogToConsole=V.enableConsoleLogging)),this._nop=(ie,x,...F)=>{},this._d=(ie,x,...F)=>this.handleLog("DEBUG",ie,x,F),this._i=(ie,x,...F)=>this.handleLog("INFO",ie,x,F),this._w=(ie,x,...F)=>this.handleLog("WARN",ie,x,F),this._e=(ie,x,...F)=>this.handleLog("ERROR",ie,x,F)}get d(){return this.enabled?this.shouldLogToConsole?console.debug.bind(console,"%s DEBUG [%s] %s@@",this.renderDate(new Date)):this._d:this._nop}get w(){return this.enabled?this.shouldLogToConsole?console.warn.bind(console,"%s WARN  [%s] %s@@",this.renderDate(new Date)):this._w:this._nop}get i(){return this.enabled?this.shouldLogToConsole?console.info.bind(console,"%s INFO  [%s] %s@@",this.renderDate(new Date)):this._i:this._nop}get e(){return this.shouldLogToConsole?console.error.bind(console,"%s ERROR [%s] %s@@",this.renderDate(new Date)):this._e}setLogCallback(_){this.callback=_,this.callback&&this.queue.length&&window.setTimeout(()=>{this.executeLogCallback(!0)})}isCallbackRegistered(){return!!this.callback}stringifyArgs(..._){return _.length?`##${JSON.stringify(_)}`:""}executeLogCallback(_){this.callback&&this.queue.length&&(this.callback(this.queue[0]),this.queue.shift(),_&&this.queue.length&&window.setTimeout(()=>{this.executeLogCallback(!0)}))}handleLog(_,V,ie,x){let F=`${ie}${this.stringifyArgs(...x)}`,R={timestamp:this.renderDate(new Date),level:_,tag:this.module+"/"+V,message:F};this.queue.push(R),this.callback?window.setTimeout(()=>{this.executeLogCallback(!1)}):this.queue.length>A.MAX_QUEUE_SIZE&&this.queue.shift()}renderDate(_){const V=(x,F,R)=>{const B=F-x.length;if(B>0){let Y="";for(let se=0;se<B;se++)Y+=R;return Y+=x,Y}return x};let ie="";return ie=V(_.getFullYear().toString(),4,"0")+"-"+(x=>V((x.getMonth()+1).toString(),2,"0"))(_)+"-"+(x=>V(x.getDate().toString(),2,"0"))(_)+" "+(x=>V(x.getHours().toString(),2,"0"))(_)+":"+(x=>V(x.getMinutes().toString(),2,"0"))(_)+":"+(x=>V(x.getSeconds().toString(),2,"0"))(_)+"."+(x=>V(x.getMilliseconds().toString(),3,"0"))(_),ie}}C.LogImpl=A,A.MAX_QUEUE_SIZE=50},36:(M,C,w)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.LogUploader=void 0;const S=w(596),m=w(614),A=w(492),H="loguploader";C.LogUploader=class{constructor(_,V,ie,x,F,R,B=0){this.buffer=new S.LogBuffer(512e3),this.loggingIntervalId=0,this.isUploadInProgress=!1,this.finishRequested=!1,this.uploadChunk=async(Y=!1)=>{if(this.isUploadInProgress)return;this.isUploadInProgress=!0;const se=this.buffer.getData();this.buffer.clear(),await this.loggingService.sendChunk(se,Y),this.isUploadInProgress=!1,this.finishRequested&&!Y&&(m.Log.i(H,"Initiating final chunk upload because finish request received during pending upload"),this.finishRequested=!1,await this.uploadChunk(!0))},this.loggingService=new A.RemoteLoggingService(_,V,ie,x,F,R,B)}start(_){m.Log.i(H,"Starting log upload"),this.clearInterval(),this.finishRequested=!1,this.loggingService.startUpload(_).then(V=>{V?this.loggingIntervalId=window.setInterval(this.uploadChunk,1e4):m.Log.e(H,"Failed to start log upload")})}clearInterval(){this.loggingIntervalId!==0&&(window.clearInterval(this.loggingIntervalId),this.loggingIntervalId=0)}finish(){m.Log.i(H,"Requesting to finish log upload"),this.clearInterval(),this.isUploadInProgress?(this.finishRequested=!0,m.Log.i(H,"Upload in progress.  Will finish upload after pending upload completes")):(m.Log.i(H,"No upload in progress.  Uploading final chunk"),this.uploadChunk(!0))}log(_){this.buffer.log(_)}}},492:(M,C,w)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.RemoteLoggingService=void 0;const S=w(921),m=w(121),A=w(614),H=w(537),_=w(185),V="https://telemetry.gfe.nvidia.com/gfc/v4.0",ie="remoteloggingservice";C.RemoteLoggingService=class{constructor(x,F,R,B,Y,se,ve){var J,fe,le,T,L,K;this.chunkOffset=0,this.url=V;const $=(0,H.translatePlatformInfoForPayload)(F);switch(F.os===void 0&&F.deviceOS&&($.os=F.deviceOS),F.browser===void 0&&F.browserType&&($.browser=F.browserType),F.platformType===void 0&&F.deviceType&&($.deviceType=F.deviceType),this.headPayload={browserType:$.browser,clientId:S.CLIENT_ID,clientTs:"",clientType:R.clientType,clientVariant:R.clientVariant,clientVer:R.clientVer,deviceGdprBehOptIn:Y.deviceGdprBehOptIn,deviceGdprFuncOptIn:Y.deviceGdprFuncOptIn,deviceGdprTechOptIn:Y.deviceGdprTechOptIn,deviceId:F.deviceId,deviceOS:$.os,deviceOSVersion:(J=F.osVersion)!==null&&J!==void 0?J:F.deviceOSVersion,deviceMake:(le=(fe=F.make)!==null&&fe!==void 0?fe:F.deviceMake)!==null&&le!==void 0?le:"",deviceModel:(L=(T=F.model)!==null&&T!==void 0?T:F.deviceModel)!==null&&L!==void 0?L:"",deviceType:$.deviceType,feedbackId:"",feedbackName:"GS_Log_Event",feedbackProtocol:"4.4",feedbackSchemaVer:"3.2",feedbackSysVer:"v4.3",fileList:[{name:se}],gdprBehOptIn:B.gdprBehOptIn,gdprFuncOptIn:B.gdprFuncOptIn,gdprTechOptIn:B.gdprTechOptIn,parameters:{streamSessionId:"",streamSubSessionIds:[]},sentTs:"",sessionId:"",userId:(K=x.userId)!==null&&K!==void 0?K:""},ve){case 0:this.url=V;break;case 1:this.url="https://telemetry.gfestage.nvidia.com/gfc/v4.0";break;default:this.url=ve}}async startUpload(x){this.chunkOffset=0,this.headPayload.feedbackId=crypto.randomUUID(),this.headPayload.parameters.streamSessionId=x??"",this.headPayload.clientTs=new Date().toISOString(),this.headPayload.sentTs=new Date().toISOString();const F={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(this.headPayload)},R=`${this.url}/head`,B=await(0,m.performHttpRequest)(R,F);if(B.status!==200)return A.Log.e(ie,`Head request failed with ${B.status}`),!1;let Y=`Initiated feedback session ${this.headPayload.feedbackId}`;return x&&(Y+=` for stream session ${x}`),A.Log.i(ie,Y),!0}async sendChunk(x,F=!1){const R=new Blob([x]),B=new FormData;try{B.append("feedbackId",this.headPayload.feedbackId),B.append("offset",this.chunkOffset.toString()),B.append("checksum",await(0,_.computeSha256Checksum)(x)),B.append("data2",R),B.append("size",R.size.toString()),B.append("parameters",JSON.stringify(this.headPayload.parameters))}catch(J){const fe=`Cannot send chunk: ${J}`;return A.Log.e(ie,fe),!1}F&&B.append("eob","true");const Y={method:"POST",headers:{},body:B},se=`${this.url}/attachment`,ve=await(0,m.performHttpRequest)(se,Y);switch(ve.status){case 200:return A.Log.i(ie,`Feedback session ${this.headPayload.feedbackId} closed.`),this.headPayload.feedbackId="",this.chunkOffset=0,!0;case 206:return this.chunkOffset+=R.size,!0;case 462:return A.Log.e(ie,"Cannot send attachment request with invalid feedback id"),!1;case 463:return A.Log.e(ie,"Incorrect data offset provided in attachment request"),!1;default:return A.Log.e(ie,`Attachment request failed with ${ve.status}`),!1}}}},419:(M,C,w)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.TelemetryModule=C.CLIENT_STORE=C.OFFLINE_STORE=C.STORAGE_NAME=void 0;const S=w(386),m=w(185),A=w(614),H=w(121),_=w(537),V="telemetry",ie="https://events.gfe.nvidia.com/v1.1/events/json";C.STORAGE_NAME="telemetry",C.OFFLINE_STORE="offline-events-cache",C.CLIENT_STORE="client-events-cache",C.TelemetryModule=new class{constructor(){this.commonDataSet=!1,this.telemetryEventIds={},this.uploadToServerTimerId=0,this.requestPending=!1,this.eventIdGenerator=0,this.exceptionHandled=new Set,this.clientEvents=new Map,this.pendingEvents=new Map,this.missingConsentEvents=[],this.dbPromises=new Map,this.dbInitialized=!1,this.serverUrl=ie,this.httpConfiguration={method:"POST",headers:{"Content-Type":"application/json"},body:"",retryCount:3,timeout:15e3},this.eventSysVer="2.0",this.eventProtocol="1.5",this.maxEventsInStore=256,this.maxEventsInRequest=128,this.requestDelay=2e3,this.sessionId=(0,m.getNewGuid)(),this.idb=new S.IndexedDb(C.STORAGE_NAME,[{storeName:C.OFFLINE_STORE,storeOptions:{keyPath:["clientId"]},storeIndexName:"offline-events-index"},{storeName:C.CLIENT_STORE,storeOptions:{keyPath:["clientId"]},storeIndexName:"client-events-index"}]),this.idb.open().then(async()=>{this.dbInitialized=!0;const x=await Promise.all([this.idb.getAll(C.OFFLINE_STORE),this.idb.getAll(C.CLIENT_STORE)]);x[0].forEach(F=>{A.Log.d(V,`Process offline events from previous sessions: ${F.payloads.length}`),F.payloads.forEach(R=>this.processEventPayload(R))}),x[1].forEach(F=>{A.Log.d(V,`Process client events from previous sessions: ${F.payloads.length}`),F.payloads.filter(R=>R.sessionId!==this.sessionId).forEach(R=>this.processEventPayload(R)),this.clientEvents.has(F.clientId)||this.clientEvents.set(F.clientId,[])}),this.saveEvents(C.OFFLINE_STORE,this.pendingEvents),this.saveEvents(C.CLIENT_STORE,this.clientEvents)}).catch(x=>{this.handleException("dbOpen",x)})}configure(x,F,R){var B,Y,se,ve,J,fe,le,T,L,K,$;try{switch(typeof R){case"function":this.callback=R;break;case"number":const Se=R===1;this.serverUrl=Se?"https://events.gfestage.nvidia.com/v1.1/events/json":ie;break;case"string":this.serverUrl=new URL(R).toString()}this.appInfo=Object.assign({},x),this.deviceInfo=Object.assign({},F),this.platformPayload=(0,_.translatePlatformInfoForPayload)(F),F.os===void 0&&F.deviceOS&&(this.platformPayload.os=F.deviceOS),F.browser===void 0&&F.browserType&&(this.platformPayload.browser=F.browserType),F.platformType===void 0&&F.deviceType&&(this.platformPayload.deviceType=F.deviceType),(B=(L=this.deviceInfo).osVersion)!==null&&B!==void 0||(L.osVersion=(Y=this.deviceInfo.deviceOSVersion)!==null&&Y!==void 0?Y:"");const ae="undefined";(se=(K=this.deviceInfo).model)!==null&&se!==void 0||(K.model=(J=(ve=this.deviceInfo)===null||ve===void 0?void 0:ve.deviceModel)!==null&&J!==void 0?J:ae),(fe=($=this.deviceInfo).make)!==null&&fe!==void 0||($.make=(T=(le=this.deviceInfo)===null||le===void 0?void 0:le.deviceMake)!==null&&T!==void 0?T:ae),typeof R=="function"?(this.pendingEvents.forEach((Se,ue)=>{Se.forEach(Ee=>{R(Ee)}),this.pendingEvents.set(ue,[])}),this.saveEvents(C.OFFLINE_STORE,this.pendingEvents)):this.cacheAndMaybeUploadTelemetry()}catch(ae){return A.Log.e(V,`configure failed: ${JSON.stringify(ae)}`),!1}return!0}createTelemetryProvider(x){return{processEvent:this.processEvent.bind(this,x),cacheEvent:this.cacheEvent.bind(this,x),processCachedEvent:this.processCachedEvent.bind(this),dropCachedEvent:this.dropCachedEvent.bind(this)}}updateClientCommonData(x,F,R,B){if(this.commonDataSet=!0,this.userInfo&&(this.userInfo.userId!==x.userId||this.userInfo.externalUserId!==x.externalUserId||this.userInfo.idpId!==x.idpId)&&this.sendOldUserRelatedEvents(),this.userInfo=Object.assign({},x),R){this.userConsent=Object.assign({},R);const se=JSON.stringify(R);A.Log.d(V,`User consent has been synced: ${se}`)}this.deviceConsent=Object.assign({},F);const Y=JSON.stringify(F);A.Log.d(V,`Device consent has been synced: ${Y}`),this.integrationId=B,A.Log.d(V,`Common data updated, sending ${this.missingConsentEvents.length} events`),this.sendMissingConsentEvents()}sendOldUserRelatedEvents(){this.clientEvents.forEach((F,R)=>{F.forEach(B=>{this.hasConsented(B)===0&&(this.callback?this.callback(B):B.priority&&this.appInfo?this.sendBeacon(B):this.bufferEvent(this.pendingEvents,B))}),this.clientEvents.set(R,[])});let x=0;if(this.appInfo){let F=Promise.resolve();for(;this.getPendingEventsCount();)this.sendEvents(F).forEach(R=>{x+=R.events.length,this.dropSentEvents(R.events)}),F=F.then(()=>{new Promise(R=>window.setTimeout(R,this.requestDelay))})}else Array.from(this.pendingEvents.keys()).forEach(F=>{this.pendingEvents.set(F,[])});this.missingConsentEvents=[],this.saveEvents(C.OFFLINE_STORE,this.pendingEvents),this.saveEvents(C.CLIENT_STORE,this.clientEvents),A.Log.i(V,`User is switched, send ${x} events in buffer`)}sendMissingConsentEvents(){const x=this.missingConsentEvents;this.missingConsentEvents=[],x.forEach(F=>this.processEventPayload(F))}getTelemetryEventIds(){return Object.assign({},this.telemetryEventIds)}setTelemetryEventIds(x){x.networkSessionId&&(this.telemetryEventIds.networkSessionId=x.networkSessionId),x.streamingProfileGuid&&(this.telemetryEventIds.streamingProfileGuid=x.streamingProfileGuid),x.systemInfoGuid&&(this.telemetryEventIds.systemInfoGuid=x.systemInfoGuid)}processEvent(x,F){var R,B,Y,se;if(this.callback)this.callback(F);else try{const ve={name:F.name,eventId:++this.eventIdGenerator,parameters:JSON.parse(JSON.stringify(F.parameters)),gdprLevel:F.gdprLevel,ts:F.ts,sessionId:this.sessionId,userId:(se=(B=(R=this.userInfo)===null||R===void 0?void 0:R.userId)!==null&&B!==void 0?B:(Y=this.userInfo)===null||Y===void 0?void 0:Y.externalUserId)!==null&&se!==void 0?se:"",priority:F.priority,config:Object.assign({},x)};this.processEventPayload(ve)}catch(ve){const J=`JSON error occurred on processing event: ${F.name}`;this.handleClientException(x,ve,J)}}hasConsented(x){if(!this.commonDataSet)return 2;const F=Y=>{var se,ve;return!((se=this.userInfo)===null||se===void 0)&&se.userId||!((ve=this.userInfo)===null||ve===void 0)&&ve.externalUserId?Y==="Full"?0:1:Y==="Temp"?0:1};let R=1;switch(x.gdprLevel){case"functional":this.userConsent?R=F(this.userConsent.gdprFuncOptIn):this.deviceConsent&&(R=(B=this.deviceConsent.deviceGdprFuncOptIn)==="Full"||B==="Temp"?0:1);break;case"technical":this.userConsent&&(R=F(this.userConsent.gdprTechOptIn));break;case"behavioral":this.userConsent&&(R=F(this.userConsent.gdprBehOptIn))}var B;return R}getDebugEventName(x){return`${x.name} ${this.sessionId===x.sessionId?"":"from previous session"}`}processEventPayload(x){switch(this.hasConsented(x)){case 0:this.appInfo?x.priority?this.sendBeacon(x):(this.bufferEvent(this.pendingEvents,x),this.cacheAndMaybeUploadTelemetry()):(A.Log.d(V,`No config, buffer event: ${this.getDebugEventName(x)}`),this.bufferEvent(this.pendingEvents,x));break;case 2:this.dropOldestEventIfNeeded(),A.Log.d(V,`Missing consent event: ${this.getDebugEventName(x)}`),this.missingConsentEvents.push(x);break;case 1:A.Log.d(V,`Drop event: ${this.getDebugEventName(x)}`)}}sendBeacon(x){const F=this.createTelemetryRequestData([x]),R=new Blob([F],{type:"text/plain"}),B=navigator.sendBeacon(this.serverUrl,R);A.Log.i(V,`telemetry upload sendBeacon result : ${B} event: ${this.getDebugEventName(x)}`)}cacheAndMaybeUploadTelemetry(){this.appInfo&&!this.uploadToServerTimerId&&(this.uploadToServerTimerId=window.setInterval(async()=>{if(this.getPendingEventsCount()===0)return window.clearInterval(this.uploadToServerTimerId),void(this.uploadToServerTimerId=0);if(this.saveEvents(C.OFFLINE_STORE,this.pendingEvents),!this.requestPending){this.requestPending=!0;const x=this.sendEvents();(await Promise.all(x.map(F=>F.retry))).forEach((F,R)=>{F||this.dropSentEvents(x[R].events)}),this.saveEvents(C.OFFLINE_STORE,this.pendingEvents),this.requestPending=!1}},this.requestDelay))}makeRequestBatches(){const x=[];return this.pendingEvents.forEach(F=>{if(F.length>0){const R=F[0],B=F.filter(Y=>Y.sessionId===R.sessionId&&Y.config.eventSchemaVer===R.config.eventSchemaVer);x.push(B)}}),x}dropSentEvents(x){let F=this.pendingEvents.get(x[0].config.clientId);const R=new Set(x.map(B=>`${B.sessionId}|${B.eventId}`));F&&(F=F.filter(B=>!R.has(`${B.sessionId}|${B.eventId}`)),this.pendingEvents.set(x[0].config.clientId,F))}sendEvents(x){const F=x??Promise.resolve(),R=[];return this.makeRequestBatches().forEach(B=>{const Y=B.splice(0,this.maxEventsInRequest);R.push({events:Y,retry:F.then(()=>this.sendHttp(Y))})}),R}async sendHttp(x){if(x.length===0)return!1;let F=!1;const R=this.createTelemetryRequestData(x),B=x[0].config.clientId;try{const Y=await(0,H.performHttpRequest)(this.serverUrl,{...this.httpConfiguration,body:R}),se=[408,500,503],ve=`Telemetry http request status: ${B} ${Y.status} ${Y.data}`;se.includes(Y.status)?(A.Log.e(V,`${ve} Retry ${x.length} events.`),F=!0):Y.status>=200&&Y.status<300?A.Log.i(V,`${ve} Uploaded ${x.length} events.`):A.Log.e(V,`${ve} Drop ${x.length} events.`)}catch(Y){A.Log.e(V,`Client ${B} telemetry http request failed. Error: ${Y}`)}return F}cacheEvent(x,F,R){var B,Y,se;try{if(R){const ve=this.clientEvents.get(x.clientId);if(ve){const J=ve.findIndex(fe=>fe.eventId===R);if(J!==-1){const fe=ve.splice(J,1),le={eventId:fe[0].eventId,sessionId:fe[0].sessionId,userId:fe[0].userId,config:Object.assign({},x),name:F.name,gdprLevel:F.gdprLevel,priority:F.priority,ts:F.ts,parameters:JSON.parse(JSON.stringify(F.parameters))};ve.push(le)}}}else{R=++this.eventIdGenerator;const ve={name:F.name,eventId:R,parameters:JSON.parse(JSON.stringify(F.parameters)),gdprLevel:F.gdprLevel,ts:F.ts,sessionId:this.sessionId,userId:(Y=(B=this.userInfo)===null||B===void 0?void 0:B.userId)!==null&&Y!==void 0?Y:"",priority:(se=F.priority)!==null&&se!==void 0&&se,config:Object.assign({},x)};this.bufferEvent(this.clientEvents,ve)}this.saveEvents(C.CLIENT_STORE,this.clientEvents)}catch(ve){const J=`JSON error occurred on caching event: ${F.name}`;this.handleClientException(x,ve,J)}return R??0}processCachedEvent(x){this.removeEventHelper(x,!0)}dropCachedEvent(x){this.removeEventHelper(x,!1)}removeEventHelper(x,F){for(let R of this.clientEvents){const B=R[1].findIndex(Y=>Y.eventId===x);if(B!==-1){const Y=R[1].splice(B,1);this.saveEvents(C.CLIENT_STORE,this.clientEvents),F&&(this.callback?this.callback({name:Y[0].name,gdprLevel:Y[0].gdprLevel,priority:Y[0].priority,ts:Y[0].ts,parameters:Y[0].parameters}):this.processEventPayload(Y[0]));break}}}createTelemetryRequestData(x){var F,R,B,Y,se,ve,J,fe,le,T,L,K,$,ae,Se,ue,Ee,Ce,ge,pe,Ue,_e,Fe,He,Ne,je,rt,Pe,ht,ct,Ve,Xe,St,lt,We,Ye;const ze="undefined",qt={clientId:((F=x[0])===null||F===void 0?void 0:F.config.clientId)||ze,clientVer:((R=this.appInfo)===null||R===void 0?void 0:R.clientVer)||ze,eventSchemaVer:((B=x[0])===null||B===void 0?void 0:B.config.eventSchemaVer)||ze,eventSysVer:this.eventSysVer,eventProtocol:this.eventProtocol,deviceId:((Y=this.deviceInfo)===null||Y===void 0?void 0:Y.deviceId)||ze,userId:((se=this.userInfo)===null||se===void 0?void 0:se.userId)||ze,externalUserId:(ve=this.userInfo)===null||ve===void 0?void 0:ve.externalUserId,idpId:(J=this.userInfo)===null||J===void 0?void 0:J.idpId,sessionId:((fe=x[0])===null||fe===void 0?void 0:fe.sessionId)||ze,events:[],gdprFuncOptIn:(T=(le=this.userConsent)===null||le===void 0?void 0:le.gdprFuncOptIn)!==null&&T!==void 0?T:ze,gdprTechOptIn:(K=(L=this.userConsent)===null||L===void 0?void 0:L.gdprTechOptIn)!==null&&K!==void 0?K:ze,gdprBehOptIn:(ae=($=this.userConsent)===null||$===void 0?void 0:$.gdprBehOptIn)!==null&&ae!==void 0?ae:ze,deviceGdprFuncOptIn:(ue=(Se=this.deviceConsent)===null||Se===void 0?void 0:Se.deviceGdprFuncOptIn)!==null&&ue!==void 0?ue:ze,deviceGdprTechOptIn:(Ce=(Ee=this.deviceConsent)===null||Ee===void 0?void 0:Ee.deviceGdprTechOptIn)!==null&&Ce!==void 0?Ce:ze,deviceGdprBehOptIn:(pe=(ge=this.deviceConsent)===null||ge===void 0?void 0:ge.deviceGdprBehOptIn)!==null&&pe!==void 0?pe:ze,deviceOS:(_e=(Ue=this.platformPayload)===null||Ue===void 0?void 0:Ue.os)!==null&&_e!==void 0?_e:ze,deviceOSVersion:((Fe=this.deviceInfo)===null||Fe===void 0?void 0:Fe.osVersion)||ze,deviceType:(Ne=(He=this.platformPayload)===null||He===void 0?void 0:He.deviceType)!==null&&Ne!==void 0?Ne:ze,deviceModel:((je=this.deviceInfo)===null||je===void 0?void 0:je.model)||ze,deviceMake:((rt=this.deviceInfo)===null||rt===void 0?void 0:rt.make)||ze,clientType:(ht=(Pe=this.appInfo)===null||Pe===void 0?void 0:Pe.clientType)!==null&&ht!==void 0?ht:ze,clientVariant:(Ve=(ct=this.appInfo)===null||ct===void 0?void 0:ct.clientVariant)!==null&&Ve!==void 0?Ve:ze,integrationId:this.integrationId||ze,browserType:(St=(Xe=this.platformPayload)===null||Xe===void 0?void 0:Xe.browser)!==null&&St!==void 0?St:ze,productName:(lt=this.appInfo)===null||lt===void 0?void 0:lt.productName,productVersion:(We=this.appInfo)===null||We===void 0?void 0:We.productVersion,sentTs:""};qt.sentTs=new Date().toISOString();for(const Ft of x){const ri={name:Ft.name,ts:Ft.ts,parameters:Ft.parameters};(Ye=qt.events)===null||Ye===void 0||Ye.push(ri)}return JSON.stringify(qt)}getPendingEventsCount(){let x=0;return this.pendingEvents.forEach(F=>x+=F.length),x}dropOldestEventIfNeeded(){if(this.getPendingEventsCount()+this.missingConsentEvents.length<this.maxEventsInStore)return;let x="";if(this.missingConsentEvents.length)x=this.missingConsentEvents.splice(0,1)[0].name;else{let F,R="";this.pendingEvents.forEach((Y,se)=>{F?Y[0].ts<F.ts&&(R=se,F=Y[0]):(R=se,F=Y[0])});const B=this.pendingEvents.get(R);B&&(x=B.splice(0,1)[0].name)}A.Log.i(V,`Too many events under pending, drop ${x}`)}bufferEvent(x,F){var R;x===this.pendingEvents&&this.dropOldestEventIfNeeded();const B=F.config.clientId;x.has(B)?(R=x.get(B))===null||R===void 0||R.push(F):x.set(B,[F])}saveEvents(x,F){this.dbInitialized&&F.forEach((R,B)=>{var Y;const se={clientId:B,payloads:R},ve=`${x}|${B}`;let J=(Y=this.dbPromises.get(ve))!==null&&Y!==void 0?Y:Promise.resolve();J=J.then(()=>this.idb.set(x,se)).catch(fe=>{this.handleException(`saveEvents(${x})`,fe)}),this.dbPromises.set(ve,J)})}handleException(x,F){var R,B,Y;const se=(Y=(B=(R=F.error)===null||R===void 0?void 0:R.message)!==null&&B!==void 0?B:F.description)!==null&&Y!==void 0?Y:`Exception in ${x}`;A.Log.e(V,`${x} failed: ${(0,m.GetHexString)(F.code)} ${se}`),this.exceptionHandled.has(x)||this.exceptionHandled.add(x)}handleClientException(x,F,R){A.Log.e(V,R),x.exceptionHandler&&x.exceptionHandler({error:F,description:R})}}},367:(M,C,w)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.TracingManager=C.TracingComponent=void 0;const S=w(673);C.TracingComponent={name:"@gamestream/utils",version:"1.0"};class m{constructor(){this.tracer=S.trace.getTracer("gfn-web-gamestream","2.0")}static getInstance(){return m.instance||(m.instance=new m),m.instance}createSpan(H,_){const V=this.tracer.startSpan(H);return S.context.with(S.trace.setSpan(S.context.active(),V),async()=>{try{const ie=_();return ie instanceof Promise?await ie:ie}finally{V.end()}})}}C.TracingManager=m},537:(M,C)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.translatePlatformInfoForClientHeader=C.translatePlatformInfoForPayload=void 0;class w{static getMappedDeviceType(A){switch(A){case"CONSOLE":return"Console";case"TABLET":return"Tablet";case"PHONE":return"Phone";case"TV":return"TV";case"LAPTOP":return"Laptop";case"DESKTOP":return"Desktop";case"HMD":return"HMD";default:return"undefined"}}static getMappedBrowserName(A){switch(A){case"Chrome":return"Chrome";case"Safari":return"Safari";case"Yandex":return"Yandex";case"Edge":return"Edge";case"Edge_Legacy":return"Edge_legacy";case"Firefox":return"Firefox";case"Samsung":return"Samsung";case"Chromium":return"Chromium";case"Opera":return"Opera";case"Brave":return"Brave";case"Silk":return"Silk";default:return"undefined"}}static getMappedDeviceOS(A){switch(A){case"Windows":return"Windows";case"macOS":return"MacOS";case"ChromeOS":return"ChromeOS";case"Linux":return"Linux";case"iOS":return"iOS";case"iPadOS":return"iPadOS";case"Tizen":return"Tizen";case"WebOS":return"WebOS";case"Xbox":return"Xbox";case"Android":return"Android";case"SteamOS":return"SteamOS";case"visionOS":return"visionOS";default:return"undefined"}}constructor(A){this._platformInfo=A,this._gxtDetails=this.translateForPayload(),this._lcarsDetails=this.translateForClientHeaders()}translateForPayload(){var A;const H=this._platformInfo,_=w.getMappedDeviceType(H.platformType),V=w.getMappedBrowserName(H.browser);return{os:w.getMappedDeviceOS((A=H.os)!==null&&A!==void 0?A:"Unknown"),browser:V,deviceType:_}}translateForClientHeaders(){var A;const H=this._platformInfo,_=w.extractDeviceTypeForBrowserClient(w.getMappedDeviceType(H.platformType)),V=w.extractBrowserTypeForBrowserClient(w.getMappedBrowserName(H.browser));return{os:w.mapOSPlatformNameToSupportedDeviceOs(w.getMappedDeviceOS((A=H.os)!==null&&A!==void 0?A:"Unknown")),browser:V,deviceType:_}}get gxtDetails(){return this._gxtDetails}get lcarsDetails(){return this._lcarsDetails}get info(){return this._platformInfo}}let S;w.mapOSPlatformNameToSupportedDeviceOs=m=>{switch(m){case"Windows":return"WINDOWS";case"MacOS":return"MACOS";case"Linux":return"LINUX";case"ChromeOS":return"CHROMEOS";case"iOS":return"IOS";case"iPadOS":return"IPADOS";case"WebOS":return"WEBOS";case"Tizen":return"TIZEN";case"Xbox":return"XBOX";case"Android":return"ANDROID";case"SteamOS":return"STEAMOS";case"Shield":return"SHIELD";case"visionOS":return"VISIONOS";default:return"UNKNOWN"}},w.extractDeviceTypeForBrowserClient=m=>{switch(m){case"Desktop":default:return"DESKTOP";case"Laptop":return"LAPTOP";case"TV":return"TV";case"Phone":return"PHONE";case"Tablet":return"TABLET";case"Console":return"CONSOLE";case"HMD":return"HMD"}},w.extractBrowserTypeForBrowserClient=m=>{switch(m){case"Chrome":return"CHROME";case"Safari":return"SAFARI";case"Yandex":return"YANDEX";case"Edge":return"EDGE";case"Edge_legacy":return"EDGE_LEGACY";case"Firefox":return"FIREFOX";case"Samsung":return"SAMSUNG";case"Chromium":return"CHROMIUM";case"Opera":return"OPERA";case"Brave":return"BRAVE";case"Silk":return"SILK";default:return"UNKNOWN"}},C.translatePlatformInfoForPayload=function(m){return(S==null?void 0:S.info)!=m&&(S=new w(m)),S.gxtDetails},C.translatePlatformInfoForClientHeader=function(m){return(S==null?void 0:S.info)!=m&&(S=new w(m)),S.lcarsDetails}},185:(M,C,w)=>{Object.defineProperty(C,"__esModule",{value:!0}),C.computeSha256Checksum=C.GetHexString=C.convertToUnsignedInt=C.getNewGuid=void 0;const S=w(614),m="utils";function A(H){return H>>>0}C.getNewGuid=function(){let H=new Uint8Array(36);window.crypto.getRandomValues(H);let _="";for(let V=0;V<36;V++){let ie=H[V]%16;V==8||V==13||V==18||V==23?_+="-":V==14?_+="4":(V==19&&(ie=3&ie|8),_+=ie.toString(16))}return S.Log.i(m,"new guid "+_),_},C.convertToUnsignedInt=A,C.GetHexString=function(H){return"0x"+("00000000"+(H=A(H)).toString(16).toUpperCase()).slice(-8)},C.computeSha256Checksum=async function(H){var _;if(!(!((_=crypto.subtle)===null||_===void 0)&&_.digest)){const ie="Crypto.subtle.digest is not available";throw S.Log.e(m,ie),new Error(ie)}const V=await crypto.subtle.digest("SHA-256",H);return Array.from(new Uint8Array(V)).map(ie=>ie.toString(16).padStart(2,"0")).join("")}}},a={};function g(M){var C=a[M];if(C!==void 0)return C.exports;var w=a[M]={exports:{}};return f[M](w,w.exports,g),w.exports}g.d=(M,C)=>{for(var w in C)g.o(C,w)&&!g.o(M,w)&&Object.defineProperty(M,w,{enumerable:!0,get:C[w]})},g.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),g.o=(M,C)=>Object.prototype.hasOwnProperty.call(M,C),g.r=M=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(M,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(M,"__esModule",{value:!0})};var I={};(()=>{var M=I;Object.defineProperty(M,"__esModule",{value:!0}),M.translatePlatformInfoForClientHeader=M.translatePlatformInfoForPayload=M.TracingManager=M.LogUploader=M.LogImpl=M.Logger=M.Log=M.LogBuffer=M.DefaultHttpRequestOptions=M.performHttpRequest=M.CancellableWait=M.TelemetryModule=void 0;var C=g(419);Object.defineProperty(M,"TelemetryModule",{enumerable:!0,get:function(){return C.TelemetryModule}});var w=g(379);Object.defineProperty(M,"CancellableWait",{enumerable:!0,get:function(){return w.CancellableWait}});var S=g(121);Object.defineProperty(M,"performHttpRequest",{enumerable:!0,get:function(){return S.performHttpRequest}}),Object.defineProperty(M,"DefaultHttpRequestOptions",{enumerable:!0,get:function(){return S.DefaultHttpRequestOptions}});var m=g(596);Object.defineProperty(M,"LogBuffer",{enumerable:!0,get:function(){return m.LogBuffer}});var A=g(614);Object.defineProperty(M,"Log",{enumerable:!0,get:function(){return A.Log}}),Object.defineProperty(M,"Logger",{enumerable:!0,get:function(){return A.Logger}}),Object.defineProperty(M,"LogImpl",{enumerable:!0,get:function(){return A.LogImpl}});var H=g(36);Object.defineProperty(M,"LogUploader",{enumerable:!0,get:function(){return H.LogUploader}});var _=g(367);Object.defineProperty(M,"TracingManager",{enumerable:!0,get:function(){return _.TracingManager}});var V=g(537);Object.defineProperty(M,"translatePlatformInfoForPayload",{enumerable:!0,get:function(){return V.translatePlatformInfoForPayload}}),Object.defineProperty(M,"translatePlatformInfoForClientHeader",{enumerable:!0,get:function(){return V.translatePlatformInfoForClientHeader}})})(),vo.exports=I})()),vo.exports}var Qf=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{},gn="1.4.1",Dc=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function Yf(f){var a=new Set([f]),g=new Set,I=f.match(Dc);if(!I)return function(){return!1};var M={major:+I[1],minor:+I[2],patch:+I[3],prerelease:I[4]};if(M.prerelease!=null)return function(m){return m===f};function C(S){return g.add(S),!1}function w(S){return a.add(S),!0}return function(m){if(a.has(m))return!0;if(g.has(m))return!1;var A=m.match(Dc);if(!A)return C(m);var H={major:+A[1],minor:+A[2],patch:+A[3],prerelease:A[4]};return H.prerelease!=null||M.major!==H.major?C(m):M.major===0?M.minor===H.minor&&M.patch<=H.patch?w(m):C(m):M.minor<=H.minor?w(m):C(m)}}var Xf=Yf(gn),Zf=gn.split(".")[0],Tr=Symbol.for("opentelemetry.js.api."+Zf),Rr=Qf;function kr(f,a,g,I){var M;I===void 0&&(I=!1);var C=Rr[Tr]=(M=Rr[Tr])!==null&&M!==void 0?M:{version:gn};if(!I&&C[f]){var w=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+f);return g.error(w.stack||w.message),!1}if(C.version!==gn){var w=new Error("@opentelemetry/api: Registration of version v"+C.version+" for "+f+" does not match previously registered API v"+gn);return g.error(w.stack||w.message),!1}return C[f]=a,g.debug("@opentelemetry/api: Registered a global for "+f+" v"+gn+"."),!0}function mn(f){var a,g,I=(a=Rr[Tr])===null||a===void 0?void 0:a.version;if(!(!I||!Xf(I)))return(g=Rr[Tr])===null||g===void 0?void 0:g[f]}function Pr(f,a){a.debug("@opentelemetry/api: Unregistering a global for "+f+" v"+gn+".");var g=Rr[Tr];g&&delete g[f]}var ep=function(f,a){var g=typeof Symbol=="function"&&f[Symbol.iterator];if(!g)return f;var I=g.call(f),M,C=[],w;try{for(;(a===void 0||a-- >0)&&!(M=I.next()).done;)C.push(M.value)}catch(S){w={error:S}}finally{try{M&&!M.done&&(g=I.return)&&g.call(I)}finally{if(w)throw w.error}}return C},tp=function(f,a,g){if(g||arguments.length===2)for(var I=0,M=a.length,C;I<M;I++)(C||!(I in a))&&(C||(C=Array.prototype.slice.call(a,0,I)),C[I]=a[I]);return f.concat(C||Array.prototype.slice.call(a))},ip=function(){function f(a){this._namespace=a.namespace||"DiagComponentLogger"}return f.prototype.debug=function(){for(var a=[],g=0;g<arguments.length;g++)a[g]=arguments[g];return Or("debug",this._namespace,a)},f.prototype.error=function(){for(var a=[],g=0;g<arguments.length;g++)a[g]=arguments[g];return Or("error",this._namespace,a)},f.prototype.info=function(){for(var a=[],g=0;g<arguments.length;g++)a[g]=arguments[g];return Or("info",this._namespace,a)},f.prototype.warn=function(){for(var a=[],g=0;g<arguments.length;g++)a[g]=arguments[g];return Or("warn",this._namespace,a)},f.prototype.verbose=function(){for(var a=[],g=0;g<arguments.length;g++)a[g]=arguments[g];return Or("verbose",this._namespace,a)},f}();function Or(f,a,g){var I=mn("diag");if(I)return g.unshift(a),I[f].apply(I,tp([],ep(g),!1))}var _t;(function(f){f[f.NONE=0]="NONE",f[f.ERROR=30]="ERROR",f[f.WARN=50]="WARN",f[f.INFO=60]="INFO",f[f.DEBUG=70]="DEBUG",f[f.VERBOSE=80]="VERBOSE",f[f.ALL=9999]="ALL"})(_t||(_t={}));function np(f,a){f<_t.NONE?f=_t.NONE:f>_t.ALL&&(f=_t.ALL),a=a||{};function g(I,M){var C=a[I];return typeof C=="function"&&f>=M?C.bind(a):function(){}}return{error:g("error",_t.ERROR),warn:g("warn",_t.WARN),info:g("info",_t.INFO),debug:g("debug",_t.DEBUG),verbose:g("verbose",_t.VERBOSE)}}var rp=function(f,a){var g=typeof Symbol=="function"&&f[Symbol.iterator];if(!g)return f;var I=g.call(f),M,C=[],w;try{for(;(a===void 0||a-- >0)&&!(M=I.next()).done;)C.push(M.value)}catch(S){w={error:S}}finally{try{M&&!M.done&&(g=I.return)&&g.call(I)}finally{if(w)throw w.error}}return C},sp=function(f,a,g){if(g||arguments.length===2)for(var I=0,M=a.length,C;I<M;I++)(C||!(I in a))&&(C||(C=Array.prototype.slice.call(a,0,I)),C[I]=a[I]);return f.concat(C||Array.prototype.slice.call(a))},op="diag",bi=function(){function f(){function a(M){return function(){for(var C=[],w=0;w<arguments.length;w++)C[w]=arguments[w];var S=mn("diag");if(S)return S[M].apply(S,sp([],rp(C),!1))}}var g=this,I=function(M,C){var w,S,m;if(C===void 0&&(C={logLevel:_t.INFO}),M===g){var A=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return g.error((w=A.stack)!==null&&w!==void 0?w:A.message),!1}typeof C=="number"&&(C={logLevel:C});var H=mn("diag"),_=np((S=C.logLevel)!==null&&S!==void 0?S:_t.INFO,M);if(H&&!C.suppressOverrideMessage){var V=(m=new Error().stack)!==null&&m!==void 0?m:"<failed to generate stacktrace>";H.warn("Current logger will be overwritten from "+V),_.warn("Current logger will overwrite one already registered from "+V)}return kr("diag",_,g,!0)};g.setLogger=I,g.disable=function(){Pr(op,g)},g.createComponentLogger=function(M){return new ip(M)},g.verbose=a("verbose"),g.debug=a("debug"),g.info=a("info"),g.warn=a("warn"),g.error=a("error")}return f.instance=function(){return this._instance||(this._instance=new f),this._instance},f}(),ap=function(f,a){var g=typeof Symbol=="function"&&f[Symbol.iterator];if(!g)return f;var I=g.call(f),M,C=[],w;try{for(;(a===void 0||a-- >0)&&!(M=I.next()).done;)C.push(M.value)}catch(S){w={error:S}}finally{try{M&&!M.done&&(g=I.return)&&g.call(I)}finally{if(w)throw w.error}}return C},dp=function(f){var a=typeof Symbol=="function"&&Symbol.iterator,g=a&&f[a],I=0;if(g)return g.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&I>=f.length&&(f=void 0),{value:f&&f[I++],done:!f}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")},cp=function(){function f(a){this._entries=a?new Map(a):new Map}return f.prototype.getEntry=function(a){var g=this._entries.get(a);if(g)return Object.assign({},g)},f.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(a){var g=ap(a,2),I=g[0],M=g[1];return[I,M]})},f.prototype.setEntry=function(a,g){var I=new f(this._entries);return I._entries.set(a,g),I},f.prototype.removeEntry=function(a){var g=new f(this._entries);return g._entries.delete(a),g},f.prototype.removeEntries=function(){for(var a,g,I=[],M=0;M<arguments.length;M++)I[M]=arguments[M];var C=new f(this._entries);try{for(var w=dp(I),S=w.next();!S.done;S=w.next()){var m=S.value;C._entries.delete(m)}}catch(A){a={error:A}}finally{try{S&&!S.done&&(g=w.return)&&g.call(w)}finally{if(a)throw a.error}}return C},f.prototype.clear=function(){return new f},f}(),lp=Symbol("BaggageEntryMetadata"),up=bi.instance();function hp(f){return f===void 0&&(f={}),new cp(new Map(Object.entries(f)))}function fp(f){return typeof f!="string"&&(up.error("Cannot create baggage metadata from unknown type: "+typeof f),f=""),{__TYPE__:lp,toString:function(){return f}}}function go(f){return Symbol.for(f)}var pp=function(){function f(a){var g=this;g._currentContext=a?new Map(a):new Map,g.getValue=function(I){return g._currentContext.get(I)},g.setValue=function(I,M){var C=new f(g._currentContext);return C._currentContext.set(I,M),C},g.deleteValue=function(I){var M=new f(g._currentContext);return M._currentContext.delete(I),M}}return f}(),Mc=new pp,mo=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],vp=function(){function f(){function a(I){return function(){for(var M=[],C=0;C<arguments.length;C++)M[C]=arguments[C];if(console){var w=console[I];if(typeof w!="function"&&(w=console.log),typeof w=="function")return w.apply(console,M)}}}for(var g=0;g<mo.length;g++)this[mo[g].n]=a(mo[g].c)}return f}(),zn=function(){var f=function(a,g){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,M){I.__proto__=M}||function(I,M){for(var C in M)Object.prototype.hasOwnProperty.call(M,C)&&(I[C]=M[C])},f(a,g)};return function(a,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");f(a,g);function I(){this.constructor=a}a.prototype=g===null?Object.create(g):(I.prototype=g.prototype,new I)}}(),gp=function(){function f(){}return f.prototype.createHistogram=function(a,g){return Cp},f.prototype.createCounter=function(a,g){return wp},f.prototype.createUpDownCounter=function(a,g){return Ip},f.prototype.createObservableGauge=function(a,g){return Rp},f.prototype.createObservableCounter=function(a,g){return Tp},f.prototype.createObservableUpDownCounter=function(a,g){return kp},f.prototype.addBatchObservableCallback=function(a,g){},f.prototype.removeBatchObservableCallback=function(a){},f}(),Ao=function(){function f(){}return f}(),mp=function(f){zn(a,f);function a(){return f!==null&&f.apply(this,arguments)||this}return a.prototype.add=function(g,I){},a}(Ao),Ap=function(f){zn(a,f);function a(){return f!==null&&f.apply(this,arguments)||this}return a.prototype.add=function(g,I){},a}(Ao),Sp=function(f){zn(a,f);function a(){return f!==null&&f.apply(this,arguments)||this}return a.prototype.record=function(g,I){},a}(Ao),So=function(){function f(){}return f.prototype.addCallback=function(a){},f.prototype.removeCallback=function(a){},f}(),yp=function(f){zn(a,f);function a(){return f!==null&&f.apply(this,arguments)||this}return a}(So),bp=function(f){zn(a,f);function a(){return f!==null&&f.apply(this,arguments)||this}return a}(So),Ep=function(f){zn(a,f);function a(){return f!==null&&f.apply(this,arguments)||this}return a}(So),Lc=new gp,wp=new mp,Cp=new Sp,Ip=new Ap,Tp=new yp,Rp=new bp,kp=new Ep;function Pp(){return Lc}var yo;(function(f){f[f.INT=0]="INT",f[f.DOUBLE=1]="DOUBLE"})(yo||(yo={}));var Nc={get:function(f,a){if(f!=null)return f[a]},keys:function(f){return f==null?[]:Object.keys(f)}},xc={set:function(f,a,g){f!=null&&(f[a]=g)}},Op=function(f,a){var g=typeof Symbol=="function"&&f[Symbol.iterator];if(!g)return f;var I=g.call(f),M,C=[],w;try{for(;(a===void 0||a-- >0)&&!(M=I.next()).done;)C.push(M.value)}catch(S){w={error:S}}finally{try{M&&!M.done&&(g=I.return)&&g.call(I)}finally{if(w)throw w.error}}return C},Dp=function(f,a,g){if(g||arguments.length===2)for(var I=0,M=a.length,C;I<M;I++)(C||!(I in a))&&(C||(C=Array.prototype.slice.call(a,0,I)),C[I]=a[I]);return f.concat(C||Array.prototype.slice.call(a))},Mp=function(){function f(){}return f.prototype.active=function(){return Mc},f.prototype.with=function(a,g,I){for(var M=[],C=3;C<arguments.length;C++)M[C-3]=arguments[C];return g.call.apply(g,Dp([I],Op(M),!1))},f.prototype.bind=function(a,g){return g},f.prototype.enable=function(){return this},f.prototype.disable=function(){return this},f}(),Lp=function(f,a){var g=typeof Symbol=="function"&&f[Symbol.iterator];if(!g)return f;var I=g.call(f),M,C=[],w;try{for(;(a===void 0||a-- >0)&&!(M=I.next()).done;)C.push(M.value)}catch(S){w={error:S}}finally{try{M&&!M.done&&(g=I.return)&&g.call(I)}finally{if(w)throw w.error}}return C},Np=function(f,a,g){if(g||arguments.length===2)for(var I=0,M=a.length,C;I<M;I++)(C||!(I in a))&&(C||(C=Array.prototype.slice.call(a,0,I)),C[I]=a[I]);return f.concat(C||Array.prototype.slice.call(a))},bo="context",xp=new Mp,us=function(){function f(){}return f.getInstance=function(){return this._instance||(this._instance=new f),this._instance},f.prototype.setGlobalContextManager=function(a){return kr(bo,a,bi.instance())},f.prototype.active=function(){return this._getContextManager().active()},f.prototype.with=function(a,g,I){for(var M,C=[],w=3;w<arguments.length;w++)C[w-3]=arguments[w];return(M=this._getContextManager()).with.apply(M,Np([a,g,I],Lp(C),!1))},f.prototype.bind=function(a,g){return this._getContextManager().bind(a,g)},f.prototype._getContextManager=function(){return mn(bo)||xp},f.prototype.disable=function(){this._getContextManager().disable(),Pr(bo,bi.instance())},f}(),hs;(function(f){f[f.NONE=0]="NONE",f[f.SAMPLED=1]="SAMPLED"})(hs||(hs={}));var Eo="0000000000000000",wo="00000000000000000000000000000000",_c={traceId:wo,spanId:Eo,traceFlags:hs.NONE},Dr=function(){function f(a){a===void 0&&(a=_c),this._spanContext=a}return f.prototype.spanContext=function(){return this._spanContext},f.prototype.setAttribute=function(a,g){return this},f.prototype.setAttributes=function(a){return this},f.prototype.addEvent=function(a,g){return this},f.prototype.setStatus=function(a){return this},f.prototype.updateName=function(a){return this},f.prototype.end=function(a){},f.prototype.isRecording=function(){return!1},f.prototype.recordException=function(a,g){},f}(),Co=go("OpenTelemetry Context Key SPAN");function Io(f){return f.getValue(Co)||void 0}function _p(){return Io(us.getInstance().active())}function To(f,a){return f.setValue(Co,a)}function Fp(f){return f.deleteValue(Co)}function Up(f,a){return To(f,new Dr(a))}function Fc(f){var a;return(a=Io(f))===null||a===void 0?void 0:a.spanContext()}var jp=/^([0-9a-f]{32})$/i,Gp=/^[0-9a-f]{16}$/i;function Uc(f){return jp.test(f)&&f!==wo}function jc(f){return Gp.test(f)&&f!==Eo}function Ro(f){return Uc(f.traceId)&&jc(f.spanId)}function Bp(f){return new Dr(f)}var ko=us.getInstance(),Gc=function(){function f(){}return f.prototype.startSpan=function(a,g,I){I===void 0&&(I=ko.active());var M=!!(g!=null&&g.root);if(M)return new Dr;var C=I&&Fc(I);return Vp(C)&&Ro(C)?new Dr(C):new Dr},f.prototype.startActiveSpan=function(a,g,I,M){var C,w,S;if(!(arguments.length<2)){arguments.length===2?S=g:arguments.length===3?(C=g,S=I):(C=g,w=I,S=M);var m=w??ko.active(),A=this.startSpan(a,C,m),H=To(m,A);return ko.with(H,S,void 0,A)}},f}();function Vp(f){return typeof f=="object"&&typeof f.spanId=="string"&&typeof f.traceId=="string"&&typeof f.traceFlags=="number"}var Hp=new Gc,Bc=function(){function f(a,g,I,M){this._provider=a,this.name=g,this.version=I,this.options=M}return f.prototype.startSpan=function(a,g,I){return this._getTracer().startSpan(a,g,I)},f.prototype.startActiveSpan=function(a,g,I,M){var C=this._getTracer();return Reflect.apply(C.startActiveSpan,C,arguments)},f.prototype._getTracer=function(){if(this._delegate)return this._delegate;var a=this._provider.getDelegateTracer(this.name,this.version,this.options);return a?(this._delegate=a,this._delegate):Hp},f}(),Wp=function(){function f(){}return f.prototype.getTracer=function(a,g,I){return new Gc},f}(),zp=new Wp,Po=function(){function f(){}return f.prototype.getTracer=function(a,g,I){var M;return(M=this.getDelegateTracer(a,g,I))!==null&&M!==void 0?M:new Bc(this,a,g,I)},f.prototype.getDelegate=function(){var a;return(a=this._delegate)!==null&&a!==void 0?a:zp},f.prototype.setDelegate=function(a){this._delegate=a},f.prototype.getDelegateTracer=function(a,g,I){var M;return(M=this._delegate)===null||M===void 0?void 0:M.getTracer(a,g,I)},f}(),Oo;(function(f){f[f.NOT_RECORD=0]="NOT_RECORD",f[f.RECORD=1]="RECORD",f[f.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Oo||(Oo={}));var Do;(function(f){f[f.INTERNAL=0]="INTERNAL",f[f.SERVER=1]="SERVER",f[f.CLIENT=2]="CLIENT",f[f.PRODUCER=3]="PRODUCER",f[f.CONSUMER=4]="CONSUMER"})(Do||(Do={}));var Mo;(function(f){f[f.UNSET=0]="UNSET",f[f.OK=1]="OK",f[f.ERROR=2]="ERROR"})(Mo||(Mo={}));var Lo="[_0-9a-z-*/]",Kp="[a-z]"+Lo+"{0,255}",$p="[a-z0-9]"+Lo+"{0,240}@[a-z]"+Lo+"{0,13}",qp=new RegExp("^(?:"+Kp+"|"+$p+")$"),Jp=/^[ -~]{0,255}[!-~]$/,Qp=/,|=/;function Yp(f){return qp.test(f)}function Xp(f){return Jp.test(f)&&!Qp.test(f)}var Vc=32,Zp=512,Hc=",",Wc="=",ev=function(){function f(a){this._internalState=new Map,a&&this._parse(a)}return f.prototype.set=function(a,g){var I=this._clone();return I._internalState.has(a)&&I._internalState.delete(a),I._internalState.set(a,g),I},f.prototype.unset=function(a){var g=this._clone();return g._internalState.delete(a),g},f.prototype.get=function(a){return this._internalState.get(a)},f.prototype.serialize=function(){var a=this;return this._keys().reduce(function(g,I){return g.push(I+Wc+a.get(I)),g},[]).join(Hc)},f.prototype._parse=function(a){a.length>Zp||(this._internalState=a.split(Hc).reverse().reduce(function(g,I){var M=I.trim(),C=M.indexOf(Wc);if(C!==-1){var w=M.slice(0,C),S=M.slice(C+1,I.length);Yp(w)&&Xp(S)&&g.set(w,S)}return g},new Map),this._internalState.size>Vc&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,Vc))))},f.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},f.prototype._clone=function(){var a=new f;return a._internalState=new Map(this._internalState),a},f}();function tv(f){return new ev(f)}var zc=us.getInstance(),Kc=bi.instance(),iv=function(){function f(){}return f.prototype.getMeter=function(a,g,I){return Lc},f}(),nv=new iv,No="metrics",rv=function(){function f(){}return f.getInstance=function(){return this._instance||(this._instance=new f),this._instance},f.prototype.setGlobalMeterProvider=function(a){return kr(No,a,bi.instance())},f.prototype.getMeterProvider=function(){return mn(No)||nv},f.prototype.getMeter=function(a,g,I){return this.getMeterProvider().getMeter(a,g,I)},f.prototype.disable=function(){Pr(No,bi.instance())},f}(),$c=rv.getInstance(),sv=function(){function f(){}return f.prototype.inject=function(a,g){},f.prototype.extract=function(a,g){return a},f.prototype.fields=function(){return[]},f}(),xo=go("OpenTelemetry Baggage Key");function qc(f){return f.getValue(xo)||void 0}function ov(){return qc(us.getInstance().active())}function av(f,a){return f.setValue(xo,a)}function dv(f){return f.deleteValue(xo)}var _o="propagation",cv=new sv,lv=function(){function f(){this.createBaggage=hp,this.getBaggage=qc,this.getActiveBaggage=ov,this.setBaggage=av,this.deleteBaggage=dv}return f.getInstance=function(){return this._instance||(this._instance=new f),this._instance},f.prototype.setGlobalPropagator=function(a){return kr(_o,a,bi.instance())},f.prototype.inject=function(a,g,I){return I===void 0&&(I=xc),this._getGlobalPropagator().inject(a,g,I)},f.prototype.extract=function(a,g,I){return I===void 0&&(I=Nc),this._getGlobalPropagator().extract(a,g,I)},f.prototype.fields=function(){return this._getGlobalPropagator().fields()},f.prototype.disable=function(){Pr(_o,bi.instance())},f.prototype._getGlobalPropagator=function(){return mn(_o)||cv},f}(),Jc=lv.getInstance(),Fo="trace",uv=function(){function f(){this._proxyTracerProvider=new Po,this.wrapSpanContext=Bp,this.isSpanContextValid=Ro,this.deleteSpan=Fp,this.getSpan=Io,this.getActiveSpan=_p,this.getSpanContext=Fc,this.setSpan=To,this.setSpanContext=Up}return f.getInstance=function(){return this._instance||(this._instance=new f),this._instance},f.prototype.setGlobalTracerProvider=function(a){var g=kr(Fo,this._proxyTracerProvider,bi.instance());return g&&this._proxyTracerProvider.setDelegate(a),g},f.prototype.getTracerProvider=function(){return mn(Fo)||this._proxyTracerProvider},f.prototype.getTracer=function(a,g){return this.getTracerProvider().getTracer(a,g)},f.prototype.disable=function(){Pr(Fo,bi.instance()),this._proxyTracerProvider=new Po},f}(),Qc=uv.getInstance();const hv=qf(Object.freeze(Object.defineProperty({__proto__:null,DiagConsoleLogger:vp,get DiagLogLevel(){return _t},INVALID_SPANID:Eo,INVALID_SPAN_CONTEXT:_c,INVALID_TRACEID:wo,ProxyTracer:Bc,ProxyTracerProvider:Po,ROOT_CONTEXT:Mc,get SamplingDecision(){return Oo},get SpanKind(){return Do},get SpanStatusCode(){return Mo},get TraceFlags(){return hs},get ValueType(){return yo},baggageEntryMetadataFromString:fp,context:zc,createContextKey:go,createNoopMeter:Pp,createTraceState:tv,default:{context:zc,diag:Kc,metrics:$c,propagation:Jc,trace:Qc},defaultTextMapGetter:Nc,defaultTextMapSetter:xc,diag:Kc,isSpanContextValid:Ro,isValidSpanId:jc,isValidTraceId:Uc,metrics:$c,propagation:Jc,trace:Qc},Symbol.toStringTag,{value:"Module"})));(function(f){(()=>{var a={853:(C,w,S)=>{var m=S(754),A=S(771);function H(e){return e.os==="Xbox"&&e.browser==="Edge"}function _(e){return e.os==="iOS"||e.os==="iPadOS"||V(e)}function V(e){return(e.model||e.deviceModel)==="VISIONPRO"}function ie(e){var t,i;return(i=(t=e.model||e.deviceModel)===null||t===void 0?void 0:t.toUpperCase().startsWith("QUEST"))!==null&&i!==void 0?i:!1}function x(e){return(e.platformType||e.deviceType)==="HMD"}function F(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}function R(e){return"0x"+("00000000"+(e>>>0).toString(16).toUpperCase()).slice(-8)}function B(e){return e.browser==="Safari"}function Y(e){return e?e.os==="iOS":/iPhone|iPod/.test(navigator.userAgent)}function se(e){return e.os==="WebOS"}function ve(e){return e.os==="ChromeOS"}function J(e){return e.os==="Windows"}function fe(e){return e.os==="macOS"}function le(e){return e.os==="Tizen"}function T(){var e,t;return(t=(e=window.matchMedia)===null||e===void 0?void 0:e.call(window,"(pointer:coarse)"))===null||t===void 0?void 0:t.matches}function L(){var e,t;return!!window.TouchEvent&&((t=(e=window.matchMedia)===null||e===void 0?void 0:e.call(window,"(any-pointer:coarse)"))===null||t===void 0?void 0:t.matches)}function K(e){return e.os==="Tizen"||e.os==="WebOS"}function $(e){var t;switch((t=e.platformType)!==null&&t!==void 0?t:e.deviceType){case"PHONE":case"TABLET":return!0;default:return!1}}function ae(){let e=new Uint8Array(36);window.crypto.getRandomValues(e);let t="";for(let i=0;36>i;i++){let n=e[i]%16;i==8||i==13||i==18||i==23?t+="-":i==14?t+="4":(i==19&&(n=n&3|8),t+=n.toString(16))}return A.Log.i("{d988e7f}","{534eaf4}",t),t}function Se(e,t){for(let i=0;i<t.length&&i<e.length;++i){const n=e[i],r=t[i];if(n>r)return!0;if(n<r)return!1}if(e.length<t.length){for(e=e.length;e<t.length;++e)if(0<t[e])return!1}return!0}function ue(e){return e.browser=="Chrome"}function Ee(e,t,i,n,r){if(e.browser!="Chrome")return!1;t=[t,i??0,n??0,r??0];try{const s=e.browserBestVer.split(".").map(o=>Number.parseInt(o));return Se(s,t)}catch{A.Log.w("{d988e7f}","{bcd8f94}")}return!0}function Ce(e,t,i,n){var r;if(!_(e))return!1;try{const s=(r=e.osVersion)!==null&&r!==void 0?r:e.osVer;return ge(s,t,i,n)}catch{A.Log.w("{d988e7f}","{cf4149f}")}return!t}function ge(e,t,i,n){e=e.replace(/[^0-9.]/,"").split(".").map(s=>Number.parseInt(s));const r=[i,n??0];return e.length===1&&e.push(0),t?e.every((s,o)=>s===r[o]):Se(e,r)}function pe(e,t,i){return{code:e,description:t,error:i!==null?i:void 0}}function Ue(e){switch(e){case"ETHERNET":return"ETHERNET";case"WIFI":case"WIFI_2_4":return"WIFI_2_4";case"WIFI_5_0":return"WIFI_5_0";case"MOBILE":return"MOBILE";case"MOBILE_2G":return"MOBILE_2G";case"MOBILE_3G":return"MOBILE_3G";case"MOBILE_4G":return"MOBILE_4G";case"MOBILE_5G":return"MOBILE_5G";case"OTHER":case"BLUETOOTH":case"WIMAX":return"OTHER";default:return"UNKNOWN"}}function _e(e){return e.replace(/(partnerCustomData" *: *")((\\"|[^"])*)(?=")/g,"$1***")}var Fe=!0,He=!1;function Ne(e){if(e)switch(e){case"enable":case"on":case"1":case"true":return!0;case"disable":case"off":case"0":case"false":return!1}}function je(e){var t,i;if(e.overrideData){const n=new URLSearchParams(e.overrideData.toLowerCase());n.get("mode")==="lean"&&(Fe=!1),e=r=>(r=n.get(r),Ne(r)),He=(Fe=(t=e("log"))!==null&&t!==void 0?t:Fe)&&((i=e("console"))!==null&&i!==void 0?i:He)}}var rt=class{constructor(e){this.D=new Map,this.ta=e}addListener(e,t){var i=this.D.get(e);i!==void 0?i.add(t):(i=new Set,i.add(t),this.D.set(e,i))}removeListener(e,t){e=this.D.get(e),e==null||e.delete(t)}removeAllListenersOfEvent(e){this.D.delete(e)}removeAllListeners(){this.D.clear()}hasListener(e){return e=this.D.get(e),e!==void 0&&0<e.size}emit(e,...t){try{let i=this.D.get(e);if(i)for(const n of i)this.ta?n(...t):window.setTimeout(n,0,...t)}catch(i){console.log("Exception in emit: "+i)}}};Fe||A.Logger.setLogLevel("ERROR"),He&&A.Logger.setLogMechanism(1);function Pe(e,t){var i=We,n=Ye;let r=[];var s=e;let o=[];do o.push(s),s=Object.getPrototypeOf(s);while(s.name!="");o.reverse();for(let d of o)r.push(d.toString().replace(/(extends )[^ {]*\.([^ ]*[ {])/,"$1$2"));return r.push(`${i.toString()}`),t?(r.push(`${t.toString()}`),r.push(`onconnect = (event) => { ${t.name}(${e.name}, event, ${i.name}); };`)):r.push(`onmessage = (event) => { ${i.name}(${e.name}, event); };`),r.push(`${n.toString()}`),r.push(`onerror = (event) => { ${n.name}(event); };`),URL.createObjectURL(new Blob(r,{type:"text/javascript"}))}function ht(e,t,i){if(!e.prototype.lb)throw Error("Invalid Worker class provided");e=Pe(e);const n=new Worker(e);URL.revokeObjectURL(e),St(n,t,i)}function ct(e,t,i){var n=window;if(typeof n.SharedWorker>"u")throw Error("SharedWorker not supported");if(!e.prototype.lb)throw Error("Invalid Worker class provided");return e=Pe(e,lt),n=new n.SharedWorker(e),URL.revokeObjectURL(e),St(n,t,i),n}const Ve=new Map;function Xe(e){if(!Ve.has(e)){e.postMessage.bind(e)({Tb:2,data:null});var t=window.setTimeout(()=>{const i=Ve.get(e);i&&(clearTimeout(i),Ve.delete(e)),e instanceof Worker?e.terminate():e instanceof MessagePort&&e.close()},150);Ve.set(e,t)}}function St(e,t,i){const n="port"in e?e.port:e,r=n.postMessage.bind(n);let s=!1;const o=d=>{s||(s=!0,A.Log.e("{10ca8e2}","{03baf25}",d,typeof d),Xe(n),i(d))};n.onmessage=d=>{d=d.data;let u=d.data;switch(d.Tb){case 1:r({Tb:3,data:null});break;case 4:t(u),Xe(n);break;case 5:o(u)}},"onmessageerror"in n&&(n.onmessageerror=o),e.onerror=o,r({Tb:0,data:null})}function lt(e,t,i){const n=globalThis;n.port=t.ports[0],n.port.onmessage=i.bind(self,e)}function We(e,t){var i;const n=globalThis;n.Hd=(i=n.Hd)!==null&&i!==void 0?i:{},i=t.data,t=i.Tb,i=i.data;let r="port"in n?n.port:self;switch(t){case 0:var s=new e;n.Hd[e.name]=s,r.postMessage({Tb:1,data:null});break;case 2:(s=self==null?void 0:self.close)===null||s===void 0||s.call(self);break;case 3:Promise.resolve(n.Hd[e.name].lb()).then(o=>{r.postMessage({Tb:4,data:o})});break;default:throw Error(`Unknown message: ${t}:${i}`)}}function Ye(e){const t=globalThis;("port"in t?t.port:self).postMessage({Tb:5,data:e})}function ze(e,t){switch(t){case"STEAMDECK":return"CONSOLE"}switch(e){case"iOS":return"PHONE";case"iPadOS":return"TABLET";case"Xbox":return"CONSOLE";case"WebOS":case"Tizen":return"TV";case"visionOS":return"HMD";default:return"DESKTOP"}}function qt(e){return e.start=performance.now(),new Promise(t=>{e.$f?t(e.u):Ft(e).then(()=>{e.$f=!0,t(e.u)})})}async function Ft(e){var t=Promise,i=t.all,n=Jt(e),r=Qt(e),s=Ut(e),o=Mi(e),d=Li(e),u=en(e),l=ut(e),h=Ni(e),p=Sn(e),y=tn(e);navigator.maxTouchPoints&&0<navigator.maxTouchPoints&&(e.$=!0),await i.call(t,[n,r,s,o,d,u,l,h,p,y,void 0,wi(e),xi(e)]).then(()=>{e.ma&&((e.ba!=e.J||e.da!=e.M)&&(e.v=!0),(e.L||e.Z||e.W||e.fa)&&!e.aa&&(e.v=!0),e.m&&e.browserFullVer&&!$n(e.m,e.browserFullVer)&&(e.pa?e.ja&&!$n(e.ja,e.browserFullVer)&&(e.v=!0):e.v=!0),(e.L&&!e.oa||e.Z&&!e.S)&&(e.v=!0),e.Ka?(e.P&&!e.M||e.G&&!e.J)&&(e.v=!0):e.La?e.L||(e.v=!0):e.Pa?e.v=!0:e.P||!e.G||e.J||(e.v=!0),e.s=e.ma&&!e.v,e.R=e.ma&&e.v);var N,G,E,D,z,Z,Q,ce,be,Me,xe,Je,Be,tt,gt,mt,dt,nt,Ke,Tt,Oe;if(!e.Kc&&e.T)e.g="Unknown",e.h="Unknown",e.U=!0,e.l=3,e.osVersion="0",e.m="0",e.browserFullVer="0",A.Log.d("{3c72abb}","{049d298}");else if(e.La)e.g="ChromeOS",si(e);else if(e.Ka)si(e),e.P?e.g="Windows":e.G?(e.g="macOS",e.j="APPLE"):e.s?e.M?e.g="Windows":e.J?(e.g="macOS",e.j="APPLE"):e.L||e.Z?(e.g="ChromeOS",e.U=!0,e.l=7):e.fa&&(e.g=ei(e)):e.da?e.g="Windows":e.ba?(e.g="macOS",e.j="APPLE"):e.aa?e.g=ei(e):e.ga?e.g="FreeBSD":(e.g="Unknown",e.l=5,A.Log.d("{3c72abb}","{101497c}"));else if(e.Pa)_i(e),e.P?e.g="Windows":e.G?(e.g="macOS",e.j="APPLE"):e.pf?(e.g="Android",vi(e)):e.aa?e.g=ei(e):e.ga?e.g="FreeBSD":(e.g="Unknown",e.l=5,A.Log.d("{3c72abb}","{49fcccb}"));else if(e.mf)e.h="Edge",e.Pb?e.s&&e.V||e.I?(e.g="Xbox",e.j="MICROSOFT",e.va?e.C="XBOXSERIES":e.I&&(e.C="XBOXONE")):e.g="Windows":e.G?(e.g="macOS",e.j="APPLE"):e.Ea?(e.g="Android",vi(e)):e.s?e.V?(e.g="Xbox",e.j="MICROSOFT",e.va?e.C="XBOXSERIES":e.I&&(e.C="XBOXONE")):e.M?e.g="Windows":e.J?(e.g="macOS",e.j="APPLE"):e.L||e.Z?(e.g="ChromeOS",e.U=!0,e.l=7):e.W?(e.g="Android",vi(e)):e.fa&&(e.g=ei(e)):e.da?e.g="Windows":e.ba?(e.g="macOS",e.j="APPLE"):e.N?(e.g="Android",vi(e)):e.aa?e.g=ei(e):e.ga?e.g="FreeBSD":(e.g="Unknown",e.l=5);else if(e.P)e.Pb?nn(e):(nn(e),e.U=!0,e.l=5);else if(e.G)rn(e);else if(e.Ea)Fi(e);else if(e.s&&(e.V||e.M)||e.da||e.I)nn(e);else if(e.s&&e.J||e.cb||e.xa||e.ba)rn(e);else if(e.s&&(e.L||e.Z))e.g="ChromeOS",si(e);else if(e.Df)e.g="ccOS",e.j="HKMC",e.h="Chromium";else if(e.s&&e.W||e.N)Fi(e);else if(e.s&&e.fa)e.g=ei(e),e.bb||e.$?(e.h="Unknown",e.l=3):Ui(e)||(e.h="Unknown",e.l=5,A.Log.d("{3c72abb}","{54c6569}"));else if(e.Ff)e.g="WebOS",e.j="LG",e.h="Chromium",e.browserFullVer=(Ke=e.browserFullVer)!==null&&Ke!==void 0?Ke:e.rg,e.m=(Tt=e.m)!==null&&Tt!==void 0?Tt:e.qg,e.R=!1;else if(e.wa){if(e.g="Tizen",e.h="Samsung",!((Oe=window.webapis)===null||Oe===void 0)&&Oe.productinfo)try{e.osVersion=window.webapis.productinfo.getFirmware(),e.deviceName=window.webapis.productinfo.getRealModel(),e.Ta=window.webapis.productinfo.getLicensedVendor()}catch{A.Log.e("{3c72abb}","{bc7dd9b}")}else A.Log.e("{3c72abb}","{844af47}"),e.osVersion="0",e.deviceName="";e.j=e.Ta!=="Samsung"&&e.Ta?"TIZENLICENSED":"SAMSUNG",Ke=/(([0-9]+\.)*[0-9]+)\/(([0-9]+\.)*[0-9]+)/,(Tt=navigator.userAgent)&&(Ke=Tt.match(Ke),e.browserFullVer=Ke==null?void 0:Ke[0],(Ke=Ke==null?void 0:Ke[1])&&(Ke=Ke.split("."),e.m=Ke==null?void 0:Ke[0]))}else e.aa?e.Fc?(e.g="Android",e.j="AMAZON",_i(e),e.D="TV"):e.sa?(e.g="Android",e.j="SAMSUNG",e.h="Samsung",vi(e)):Ui(e)?e.R?e.g=ei(e):!e.Yf||e.Mf||e.Zf?e.Ba?(e.g="Android",e.h="Pico",vi(e)):e.g="Linux":(e.g=ei(e),e.h="Chromium",e.l=7):(e.g="Unknown",e.h="Unknown",e.l=0,A.Log.d("{3c72abb}","{be86380}")):e.ga?(e.g="FreeBSD",e.T?e.h="Chrome":e.ra?_i(e):(e.h="Unknown",e.l=3,A.Log.d("{3c72abb}","{a2c16e4}"))):e.Xa||e.Za||e.Ya?(e.xa=!0,rn(e),e.l=7):e.sa?(Fi(e),e.l=7):(e.g="Unknown",e.h="Unknown",e.l=0,A.Log.d("{3c72abb}","{f2eecc9}"));switch(e.R&&(e.osVersion="0",e.m="0",e.browserFullVer="0"),e.Gc=performance.now(),e.u.os=(N=e.g)!==null&&N!==void 0?N:"Unknown",e.u.browser=(G=e.h)!==null&&G!==void 0?G:"Unknown",e.u.osRawVer=(E=e.tg)!==null&&E!==void 0?E:"0",e.u.osVersion=(D=e.osVersion)!==null&&D!==void 0?D:"0",e.u.osVer=e.u.osVersion,e.u.browserVer=(z=e.m)!==null&&z!==void 0?z:"0",N=(Z=e.browserFullVer)!==null&&Z!==void 0?Z:void 0,e.u.browserFullVer=N??"0",e.u.browserBestVer=(Q=N??e.u.browserVer)!==null&&Q!==void 0?Q:"0",e.u.confidence=(Je=(xe=(Me=(be=(ce=e.l)!==null&&ce!==void 0?ce:e.g==="Unknown"?0:void 0)!==null&&be!==void 0?be:e.h==="Unknown"?5:void 0)!==null&&Me!==void 0?Me:e.tf?6:void 0)!==null&&xe!==void 0?xe:e.R?8:void 0)!==null&&Je!==void 0?Je:10,e.u.forging=(Be=e.U)!==null&&Be!==void 0?Be:!1,e.u.spoofing=(tt=e.R)!==null&&tt!==void 0?tt:!1,e.u.make=(gt=e.j)!==null&&gt!==void 0?gt:"",e.u.vendor=e.u.make,e.u.vendorFull=(mt=e.Ta)!==null&&mt!==void 0?mt:e.u.make,Z=void 0,e.u.os){case"ChromeOS":Z="CHROMEOS";break;case"Windows":Z="WINDOWS";break;case"macOS":Z="MACOS";break;case"Linux":Z="LINUX";break;case"iOS":Z="IOS";break;case"iPadOS":Z="IPADOS";break;case"Tizen":Z="TIZEN";break;case"WebOS":Z="WEBOS";break;case"Android":Z="ANDROID";break;case"Xbox":Z="XBOX";break;case"SteamOS":Z="STEAMOS";break;case"ccOS":Z="CCOS";break;case"visionOS":Z="VISIONOS"}e.u.deviceOS=Z,e.u.os==="visionOS"?e.u.model="VISIONPRO":e.ab?e.u.model="STEAMDECK":e.qf?e.u.model=(dt=e.C)!==null&&dt!==void 0?dt:"QUEST":e.C&&(e.u.model=e.C),e.u.deviceModel=e.u.model,dt=(nt=e.D)!==null&&nt!==void 0?nt:ze(e.u.os,e.u.model),e.u.platformType=dt,e.u.deviceType=dt,e.u.totalTime=e.Gc-e.start,e.u.gpuDetail=e.gpuDetail})}function ri(e,t){if(!e.bg){for(const i of t)t=i.voiceURI||"",t.startsWith("Chrome OS")?e.La=!0:t.startsWith("Google")?e.Ka=!0:t.includes("moz-tts")?(t.includes("android")&&(e.pf=!0,e.N=!0),e.Pa=!0):t=="English United States"&&(e.Ea=!0),t.includes("Microsoft")?(e.P=!0,t.includes("Online")?e.mf=!0:e.Pb=!0):t.includes("com.apple")?(e.G=!0,t.includes("Ellen")&&(e.df=!0)):t=="Zuzana"&&(e.G=!0);e.rf=e.G||e.P||e.Ka||e.La||e.Pa||e.Ea,e.bg=!0}}function Mi(e){const t=window.speechSynthesis;if(t){const i=t.getVoices;let n=(i==null?void 0:i.call(t))||[];return new Promise(r=>{if(!i||n.length)ri(e,n),r();else{let s=0;const o=()=>{n=i.call(t);const d=performance.now();n.length==0&&(s==0||600>d-s)?(e.O&&clearTimeout(e.O),e.O=window.setTimeout(o,150)):(e.O&&(clearTimeout(e.O),e.O=0),ri(e,n),r())};t.onvoiceschanged!==void 0&&(t.onvoiceschanged=o),window.setTimeout(()=>{n=i.call(t),n.length?o():(e.O=window.setTimeout(o,150),s=performance.now())},0)}})}return new Promise(i=>{i()})}function Jt(e){return new Promise(t=>{let i=!1;const n=u=>{if(e.ea)clearTimeout(e.ea),e.ea=0;else if(i){A.Log.w("{3c72abb}","{c1bb269}"),jt(e,"GL",e.Jc-performance.now());return}if(!e.Bb){var l=u.Lf;if(l.startsWith("ANGLE")){var h=l.split(",");1<(h==null?void 0:h.length)&&(e.gpuDetail=h[1].trim())}else e.gpuDetail=l;h=l.toLowerCase(),l.includes("SraKmd")?(e.I=!0,l.includes("SraKmd_arden")&&(e.va=!0),(l=/D3D11-(\d{2,}\.\d{1,}\.\d{5,}\.\d{4,})/.exec(l))&&1<l.length&&(e.osVersion=l[1])):l.includes("AMD")&&h.includes("vangogh")&&(e.ab=!0),e.Kc=u.Bf,e.Bb=!0}t()};let r=!1,s=!1;const o=u=>{typeof u=="string"?Yt(e,"GL",u):"data"in u?Xt(e,"GL",u):Ci(e,"GL",u),s=!0,A.Log.e("{3c72abb}","{9e45306}",u)};let d=0;try{self.OffscreenCanvas&&(r=!0,ht(sn,n,o),d=150)}catch(u){s=!0,Zt(e,"GL",u),A.Log.w("{3c72abb}","{caf8cd7}",u)}window.setTimeout(()=>{e.Bb||(e.ea=window.setTimeout(()=>{e.ea=0,e.Jc=performance.now(),s?A.Log.w("{3c72abb}","{fbe663c}"):r?(A.Log.w("{3c72abb}","{2577061}"),fi(e,"GL")):(A.Log.i("{3c72abb}","{95c252e}"),pi(e,"GL"));const u=new sn().lb();n(u),i=!0},d))},0)})}function Qt(e){return new Promise(t=>{if(navigator.userAgentData){var i=l=>{var h;if(!e.ag){var p=l.model,y=l.platform,N=l.platformVersion,G=l.uaFullVersion,E=l.bitness;p==""&&y==""&&N==""&&G==""?e.$a&&e.N||e.wa||E==null||e.N&&!e.T||(e.v=!0):E==""&&y!="Android"&&(e.v=!0),p&&(p==="Xbox"?e.V=!0:p.startsWith("AFT")?(e.lf=!0,e.K=!0):p.includes("BRAVIA")?(e.K=!0,e.Ye=!0):p==="Chromecast"?(e.K=!0,e.cf=!0,e.deviceName="CHROMECAST"):p==="SHIELD Android TV"?(e.K=!0,e.sf=!0,e.deviceName="SHIELDTV"):p.startsWith("MiTV")?(e.K=!0,e.nf=!0,e.deviceName="MITV"):p.startsWith("TVision")?(e.K=!0,e.wf=!0,e.deviceName="TVISION"):p.startsWith("Quest")&&(e.Ue=!0,e.qf=!0,e.C=p,e.deviceName="QUEST")),y==="Windows"?e.M=!0:y==="macOS"?e.J=!0:y==="Chrome OS"||y==="ChromeOS"?e.L=!0:y==="Chromium OS"?e.Z=!0:y==="Android"?e.W=!0:y==="Linux"&&(N==""?(e.W=!0,e.xf=!0):e.fa=!0),p=z=>{if(z&&typeof z=="string")return z.replace(/[-._,:;|#@]/g,".")};var D=z=>{if(!z||!e.ja||95>+e.ja)return z;switch(z.split(".").map(Z=>Number.parseInt(Z))[0]){case 0:return"8-";case 1:return"10.0.10240";case 2:return"10.0.10586";case 3:return"10.0.14393";case 4:return"10.0.15063";case 5:return"10.0.16299";case 6:return"10.0.17134";case 7:return"10.0.17763";case 8:return"10.0.18362+";case 9:return"10.0.9";case 10:return"10.0.19041+";case 11:return"10.0.11";case 12:return"10.0.12";case 13:return"11.0.0";case 14:return"11.0.22000.0";case 15:return"11.0.22621.0";default:return"11.0.22621.0+"}};y=z=>e.M&&!e.V?D(z):z,l.brands&&0<l.brands.length&&Lr(e,l),e.browserFullVer=p(G),e.tg=N,e.osVersion=(h=e.osVersion)!==null&&h!==void 0?h:y(p(N)),e.ag=!0}},n=l=>{l&&(e.na&&(clearTimeout(e.na),e.na=0),i(l),t())},r=!1,s=!1,o=l=>{typeof l=="string"?Yt(e,"HE",l):"data"in l?Xt(e,"HE",l):Ci(e,"HE",l),s=!0,A.Log.e("{3c72abb}","{217e106}",l)},d=0;try{if(self.SharedWorker){r=!0;var u=ct(qn,n,o);d=300}}catch(l){s=!0,A.Log.w("{3c72abb}","{a583546}",l),Zt(e,"HE",l)}e.na=window.setTimeout(()=>{u&&Xe("port"in u?u.port:u),s?A.Log.w("{3c72abb}","{dbf4b42}"):r?(A.Log.w("{3c72abb}","{0bf7a38}"),fi(e,"HE"),e.tf=!0):(A.Log.i("{3c72abb}","{7a82b59}"),pi(e,"HE")),new qn().lb().then(l=>{n(l)})},d)}else t()})}async function Ut(e){e.Nb=window.chrome?await yn():!1}function Li(e){return new Promise(t=>{var i=navigator.userAgent;i&&(i=i.match(e.Hc))&&(e.rg=i==null?void 0:i[1],e.qg=i==null?void 0:i[2]),t()})}function en(e){var t,i,n,r,s,o,d,u,l,h;const p=window,y=p.hasOwnProperty,N=p.navigator,G=p.Intl,E=p.CSS,D=E==null?void 0:E.supports,z=p.Promise;y.call(p,"MSMediaKeys")?e.Nc=!0:y.call(p,"_firefoxTV_cachedScrollPosition")?e.Fc=!0:p.__edgeActiveElement!==void 0||p.__edgeTrackingPreventionStatistics?e.Ya=!0:p.safari?e.Oe=!0:p.opr?e.Be=!0:p.oprt?e.Fe=!0:N.brave?e.qa=!0:p.OperaTouch!==void 0||p.ethereum?(e.$a=!0,e.N=!0):p.yandex?e.ta=!0:p.QuickAccess?e.sa=!0:p.chrome?e.T=!0:p.netscape?e.ra=!0:p.__firefox__?e.Za=!0:p.__gCrWeb?e.Xa=!0:p.ReactNativeWebView&&(e.Ie=!0),p.contacts!==void 0||p.ContactsManager!==void 0?e.N=!0:y.call(p,"onwebOSAccessibilityAlertDone")||p.webOSSystem||y.call(p,"onwebosaccessibilityalertdone")?e.Ff=!0:p.tizen||p.TizenTVApiInfo||p.addEdgeEffectONSCROLLTizenUIF||p.tizentvwasm?e.wa=!0:p.HardkeyEvent&&(e.Df=!0),!((t=N.mediaCapabilities)===null||t===void 0)&&t.decodingInfo&&(e.qe=!0),p.BigInt&&(e.ee=!0,p.BigInt64Array&&(e.fe=!0)),p.PerformanceNavigationTiming&&(e.Ae=!0),p.WebAssembly&&p.WebAssembly.Exception&&(e.af=!0),p.BroadcastChannel&&(e.ge=!0),p.GPUBuffer&&(e.ue=!0),p.SharedWorker&&(e.Me=!0),p.MediaRecorder&&(e.ye=!0),p.CSSCounterStyleRule&&(e.ie=!0),t=(i=p.ArrayBuffer)===null||i===void 0?void 0:i.prototype,t!=null&&t.hasOwnProperty("transfer")&&(e.be=!0),y.call(p,"ondevicelight")&&(e.re=!0),!((n=p.AbortSignal)===null||n===void 0)&&n.abort&&(e.dg=!0),y.call(p,"onbeforeinput")&&(e.de=!0),G&&(G.DisplayNames&&(e.za=!0),e.ve=((r=new G.Collator("zh",{collation:"pinyin"}).resolvedOptions())===null||r===void 0?void 0:r.collation)=="pinyin"),p.Credential&&(e.pe=!0),p.LargestContentfulPaint&&(e.xe=!0),E!=null&&E.registerProperty&&(e.me=!0),i=(s=p.HTMLElement)===null||s===void 0?void 0:s.prototype,i!=null&&i.hasOwnProperty("autofocus")&&(e.te=!0),N.contacts&&(e.oe=!0),p.TrustedHTML&&(e.Pe=!0),p.WakeLock&&(e.Ve=!0),z!=null&&z.any&&(e.ae=!0),p.FileSystemHandle&&(e.se=!0),!((o=p.Atomics)===null||o===void 0)&&o.waitAsync&&(e.ce=!0),D!=null&&D.call(E,"aspect-ratio: auto")&&(e.le=!0),p.ReadableStreamBYOBReader&&(e.Ge=!0),D!=null&&D.call(E,"overflow: clip")&&(e.ze=!0),D!=null&&D.call(E,"content-visibility: auto")&&(e.he=!0),p.CSSStartingStyleRule&&(e.ke=!0),z!=null&&z.withResolvers&&(e.Ce=!0),s=(d=p.CanvasRenderingContext2D)===null||d===void 0?void 0:d.prototype,s!=null&&s.hasOwnProperty("reset")&&(e.ne=!0),((u=p.Set)===null||u===void 0?void 0:u.prototype).hasOwnProperty("difference")&&(e.Je=!0),D!=null&&D.call(E,"selector(:user-valid)")&&(e.je=!0),d=(l=p.InputEvent)===null||l===void 0?void 0:l.prototype,d!=null&&d.hasOwnProperty("isComposing")&&(e.we=!0),p.VRDisplay&&(e.Ba=!0),l=(h=p.HTMLVideoElement)===null||h===void 0?void 0:h.prototype,e.Ob=l==null?void 0:l.hasOwnProperty("webkitSupportsPresentationMode")}function ut(e){var t,i,n,r;const s=window.RequestCrowNativeApi;if(s){let o=0;const d=new Promise((y,N)=>{o=window.setTimeout(()=>{N("timeout")},100)}),u=window.zoneless,l=(i=(t=u==null?void 0:u.windowAddEventListener)===null||t===void 0?void 0:t.bind(window))!==null&&i!==void 0?i:window.addEventListener.bind(window),h=(r=(n=u==null?void 0:u.windowRemoveEventListener)===null||n===void 0?void 0:n.bind(window))!==null&&r!==void 0?r:window.removeEventListener.bind(window);let p;return t=new Promise(y=>{p=N=>{y(N.detail)},l("CrowNativeApiEvent",p),s(JSON.stringify({Lg:"RequestBrowserVersion"}))}).then(y=>{var N;(y=(N=y.browserVersion)===null||N===void 0?void 0:N.match(e.Hc))&&(e.browserFullVer=y==null?void 0:y[1],e.m=y==null?void 0:y[2])}),Promise.race([t,d]).catch(()=>{A.Log.d("{3c72abb}","{841bf6f}")}).finally(()=>{window.clearTimeout(o),h("CrowNativeApiEvent",p)})}return Promise.resolve()}function Ni(e){return new Promise(t=>{let i=!1;const n=u=>{if(e.ha)clearTimeout(e.ha),e.ha=0;else if(i){A.Log.w("{3c72abb}","{b02109c}"),jt(e,"Plat",e.cg-performance.now());return}e.Cb||(u=u.platform,u==="MacIntel"?e.ba=!0:u==="iPhone"?e.xa=!0:u==="Win32"?e.da=!0:u==="iPad"?e.cb=!0:u==="FreeBSD amd64"?e.ga=!0:u==="Windows"&&(e.da=!0,e.U=!0),u.startsWith("Linux")&&(e.aa=!0),e.Cb=!0),t()};let r=!1,s=!1;const o=u=>{typeof u=="string"?Yt(e,"Plat",u):"data"in u?Xt(e,"Plat",u):Ci(e,"Plat",u),s=!0,A.Log.e("{3c72abb}","{6350135}",u)};let d=0;try{r=!0,ht(Jn,n,o),d=150}catch(u){s=!0,Zt(e,"Plat",u),A.Log.w("{3c72abb}","{79668e5}",u)}window.setTimeout(()=>{e.Cb||(e.ha=window.setTimeout(()=>{e.ha=0,e.cg=performance.now(),s?A.Log.w("{3c72abb}","{d9e1e01}"):r?(A.Log.w("{3c72abb}","{a8d68cb}"),fi(e,"Plat")):(A.Log.i("{3c72abb}","{53e2225}"),pi(e,"Plat"));const u=new Jn().lb();n(u),i=!0},d))},0)})}function Sn(e){const t=window;t.ApplePaySession&&t.ApplePaySession.canMakePayments&&(e.Db=!0)}function tn(e){var t=navigator.plugins;for(const i of t)t=i.name,t!=="Native Client"&&(t.startsWith("Microsoft Edge PDF")?e.Zf=!0:t.startsWith("Chrome PDF")?e.Mf=!0:t.startsWith("Chromium PDF")?e.Yf=!0:t.startsWith("PPAPI SAMSUNGHEALTH")&&(e.wa=!0))}function wi(e){const t=window;e.kb=t.matchMedia("(hover: hover)").matches,e.Ab=t.matchMedia("(hover: none)").matches,e.ib=t.matchMedia("(pointer: coarse)").matches,e.jb=t.matchMedia("(pointer: fine)").matches}function xi(e){return new Promise(t=>{const i=u=>{e.ya&&(clearTimeout(e.ya),e.ya=0),u.Bd&&(e.Af=u.Bd,e.pg=u.md,e.og=u.Gd),t()};let n=!1,r=!1;const s=u=>{typeof u=="string"?Yt(e,"TV",u):"data"in u?Xt(e,"TV",u):Ci(e,"TV",u),r=!0,A.Log.e("{3c72abb}","{f49e1b4}",u)};let o=0,d;try{self.SharedWorker&&(n=!0,d=ct(En,i,s),o=150)}catch(u){r=!0,A.Log.w("{3c72abb}","{2066dd6}",u),Zt(e,"TV",u)}e.ya=window.setTimeout(()=>{d&&Xe("port"in d?d.port:d),r?A.Log.w("{3c72abb}","{cdb3848}"):n?(A.Log.w("{3c72abb}","{f01188c}"),fi(e,"TV")):(A.Log.i("{3c72abb}","{db9e3f4}"),pi(e,"TV")),new En().lb().then(u=>{i(u)})},o)})}function jt(e,t,i){e.o?vt(e.o,"WorkerOverlongDelay",t,i.toString()):e.F.push({type:"WorkerOverlongDelay",name:t,data:i})}function Yt(e,t,i){e.o?vt(e.o,"WebWorkerProblem",t,i):e.F.push({type:"ErrorString",name:t,data:i})}function Xt(e,t,i){e.o?vt(e.o,"WorkerMessageProblem",JSON.stringify(i)):e.F.push({type:"MessageEvent",name:t,data:i})}function Ci(e,t,i){e.o?vt(e.o,"WorkerProblem",t,`${i.message} in ${i.filename}@${i.lineno}:${i.colno}`,JSON.stringify(i.error)):e.F.push({type:"ErrorEvent",name:t,data:i})}function Zt(e,t,i){var n;e.o?vt(e.o,"WorkerCreateFailure",t,(n=i==null?void 0:i.stack)!==null&&n!==void 0?n:"",JSON.stringify(i)):e.F.push({type:"WorkerCreateFailure",name:t,data:i})}function fi(e,t){e.o?vt(e.o,"WorkerTimeout",t):e.F.push({type:"WorkerTimeout",name:t})}function pi(e,t){e.o?vt(e.o,"WorkerUnused",t):e.F.push({type:"WorkerUnused",name:t})}function Lr(e,t){var i;e.ma=!0,t.mobile&&(e.bb=!0);var n=t.brands||[];t=0;for(const r of n){n=r.brand;const s=r.version;n==="Google Chrome"?(e.oa=!0,e.m=s):n==="Microsoft Edge"?(e.Ua=!0,e.m=s):n==="Opera"?(e.pa=!0,e.m=s):n==="Yandex"?(e.Wa=!0,e.m=s):n==="Chromium"?(e.S=!0,e.m=(i=e.m)!==null&&i!==void 0?i:s,e.ja=s):n==="Android WebView"?(e.Mc=!0,e.m=s):t++}2<t&&(e.Lc=!0)}async function yn(){if(!window.createImageBitmap)return!1;const e=await fetch("data:image/avif;base64,AAAAGGZ0eXBhdmlmAAAAAGF2aWZtaWYxAAADm21ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAAAAAAAAAAAAAAAAAAAAADnBpdG0AAAAAAAEAAAAiaWxvYwAAAABEQAABAAEAAAAAA7sAAQAAAAAAAAAjAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAYXYwMQAAAAMbaXBycAAAAvxpcGNvAAACrGNvbHJwcm9mAAACoGxjbXMEMAAAbW50clJHQiBYWVogB+UACAAJAAsAEAAFYWNzcE1TRlQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1sY21zAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANZGVzYwAAASAAAABAY3BydAAAAWAAAAA2d3RwdAAAAZgAAAAUY2hhZAAAAawAAAAsclhZWgAAAdgAAAAUYlhZWgAAAewAAAAUZ1hZWgAAAgAAAAAUclRSQwAAAhQAAAAgZ1RSQwAAAhQAAAAgYlRSQwAAAhQAAAAgY2hybQAAAjQAAAAkZG1uZAAAAlgAAAAkZG1kZAAAAnwAAAAkbWx1YwAAAAAAAAABAAAADGVuVVMAAAAkAAAAHABHAEkATQBQACAAYgB1AGkAbAB0AC0AaQBuACAAcwBSAEcAQm1sdWMAAAAAAAAAAQAAAAxlblVTAAAAGgAAABwAUAB1AGIAbABpAGMAIABEAG8AbQBhAGkAbgAAWFlaIAAAAAAAAPbWAAEAAAAA0y1zZjMyAAAAAAABDEIAAAXe///zJQAAB5MAAP2Q///7of///aIAAAPcAADAblhZWiAAAAAAAABvoAAAOPUAAAOQWFlaIAAAAAAAACSfAAAPhAAAtsRYWVogAAAAAAAAYpcAALeHAAAY2XBhcmEAAAAAAAMAAAACZmYAAPKnAAANWQAAE9AAAApbY2hybQAAAAAAAwAAAACj1wAAVHwAAEzNAACZmgAAJmcAAA9cbWx1YwAAAAAAAAABAAAADGVuVVMAAAAIAAAAHABHAEkATQBQbWx1YwAAAAAAAAABAAAADGVuVVMAAAAIAAAAHABzAFIARwBCAAAADGF2MUOBDQwAAAAAFGlzcGUAAAAAAAAAEAAAABAAAAAoY2xhcAAAAAEAAAABAAAAAQAAAAH////xAAAAAv////EAAAACAAAAF2lwbWEAAAAAAAAAAQABBIGCA4QAAAArbWRhdBIACgkfzP/IIEBA0oAyFGW+OwPr0bIHHHHBATZPtaQ3RWTA").then(t=>t.blob());return createImageBitmap(e).then(()=>!0,()=>!1)}function $n(e,t){if(e==t)return!1;let i=/^(\d+)[.]?(.*)/;if(e=i.exec(e),t=i.exec(t),e==null){if(t==null)return!0}else if(t!=null&&e[1]==t[1]&&e[2]=="")return!0;return!1}function si(e){e.h="Chrome",!e.m&&e.xe&&(e.m=e.me?e.te?e.oe?e.za?e.Pe?e.Ve?e.ae?e.se?e.ce?e.le?e.Ge?e.ze?"90+":"89":"88":"87":"86":"85":"84":"83":"81":"80":"79":"78":"77")}function ei(e){return e.ab?"SteamOS":"Linux"}function _i(e){e.h="Firefox",e.m=e.ve?e.za?e.de?e.dg?e.re?"88":"89+":"87":"86":"85":"84-"}function vi(e){var t,i,n,r;e.s&&e.K?e.D="TV":e.s&&e.Ue||e.Ba?e.D="HMD":!e.bb&&!e.$&&e.Af?(e.D="TV",e.j=(i=(t=e.j)!==null&&t!==void 0?t:e.pg)!==null&&i!==void 0?i:"",e.deviceName=(r=(n=e.deviceName)!==null&&n!==void 0?n:e.og)!==null&&r!==void 0?r:"UNKNOWN",e.l=7):(!e.kb||e.jb)&&(e.W?e.xf?e.Ab&&e.ib||(e.D="DESKTOP"):e.kb&&e.jb&&(e.D="DESKTOP"):e.Ab&&e.ib||(e.D="DESKTOP")),e.D||(e.D=600<=(screen.width<screen.height?screen.width:screen.height)?"TABLET":"PHONE")}function nn(e){e.g="Windows",Ui(e)||(e.h="Unknown",e.l=5,A.Log.d("{3c72abb}","{44ce1e0}"))}function rn(e){e.j="APPLE",e.s&&e.J?(e.g="macOS",Ui(e)||(e.h="Unknown",e.l=5,A.Log.d("{3c72abb}","{b80b712}"))):e.ba?e.$?(e.g=e.Ob?"iPadOS":"visionOS",Gi(e)):(e.g="macOS",Ui(e)||(e.h="Unknown",e.l=5,A.Log.d("{3c72abb}","{0f3296f}")),e.h=="Safari"&&(e.m=e.he?"18+":e.ke?"17.5+":e.Ce?"17.4":e.ne?"17.2+":e.Je?"17+":e.je?"16.5+":e.we?"16.4":"16.3-")):e.xa?(e.g="iOS",Gi(e)):e.cb?(e.g=e.Ob?"iPadOS":"visionOS",Gi(e)):(e.U=!0,e.l=5,e.$?(e.g="iOS",Gi(e),A.Log.d("{3c72abb}","{cf1c572}")):(e.g="macOS",e.h="Unknown",A.Log.d("{3c72abb}","{1eb1815}")))}function Fi(e){e.g="Android",e.ra?_i(e):e.sa?(e.h="Samsung",e.j="SAMSUNG"):e.qa?e.h="Brave":e.ta?e.h="Yandex":e.$a?e.h="Opera":e.s?e.Ua?e.h="Edge":e.pa?e.h="Opera":e.Wa?e.h="Yandex":e.oa||e.Mc?(si(e),ji(e)):e.S&&(e.h="Chromium",ji(e)):e.T?e.Nb?e.Ba?e.h="Pico":si(e):e.h=e.$?"Edge":"Silk":(si(e),e.l=7),vi(e)}function Ui(e){var t;if(e.ra)_i(e);else if(e.Be)e.h="Opera";else if(e.qa)e.h="Brave";else if(e.ta)e.h="Yandex";else if(e.T)e.I?(e.g="Xbox",e.j="MICROSOFT",e.h="Edge",e.va?e.C="XBOXSERIES":e.I&&(e.C="XBOXONE")):e.s?e.V?(e.g="Xbox",e.j="MICROSOFT",e.h="Edge"):e.Ua?e.h="Edge":e.pa?e.h="Opera":e.Wa?e.h="Yandex":e.oa?si(e):e.S&&!e.Lc&&(e.h="Chromium"):e.Nb?e.s&&e.S?(e.h="Chromium",e.l=9):e.rf?e.h="Chromium":(e.h="Chromium",e.l=7):(e.h="Edge",e.g=(t=e.g)!==null&&t!==void 0?t:"Unknown",e.l=7);else if(e.Oe||e.Db)e.h="Safari";else if(e.Nc)e.I&&(e.g="Xbox",e.j="MICROSOFT"),e.h="Edge_Legacy";else return!1;return!0}function ji(e){e.lf?(e.j="AMAZON",e.S&&(e.h="Silk")):e.Ye?e.j="SONY":e.cf?e.j="GOOGLE":e.sf?e.j="NVIDIA":e.nf?e.j="XIAOMI":e.wf&&(e.j="TVISION")}function Gi(e){e.osVersion=e.ee?e.za?e.fe?e.ie?e.be?"17.4+":"17+":e.Me?"16+":e.ue?e.df?"15.6+":"15.5+":e.ge?"15.4+":e.af?"15.2+":e.Ae?"15.1+":"15+":"14.5+":e.ye?"14.3+":"14+":e.qe?"13+":"12-";var t=e.osVersion;t=!e.pe&&!(t.startsWith("12")||t.startsWith("13")),e.Za?e.h="Firefox":e.Fe?e.h="Opera":e.qa?e.h="Brave":e.ta?e.h="Yandex":e.Ya?e.h="Edge":e.Xa?e.h="Chrome":e.Db&&!t?e.h="Safari":e.Ie?e.h="ReactNative":t?(e.h="Unknown",e.l=7,A.Log.d("{3c72abb}","{5a39f60}")):(e.h="Unknown",e.l=5,A.Log.d("{3c72abb}","{147d6b4}"))}function Bi(e){var t=on,i;(i=t.o)===null||i===void 0||vt(i,"TelemetryHandlerChanged"),t.o=e;for(const n of t.F)switch(e=n.name,i=n.data,n.type){case"ErrorEvent":Ci(t,e,i);break;case"MessageEvent":Xt(t,e,i);break;case"WorkerUnused":pi(t,e);break;case"WorkerTimeout":fi(t,e);break;case"WorkerCreateFailure":Zt(t,e,i);break;case"ErrorString":Yt(t,e,i);break;case"WorkerOverlongDelay":jt(t,e,i)}t.F=[]}class bn{constructor(){this.Gc=this.start=0,this.Pb=this.mf=this.G=this.P=this.Ea=this.pf=this.Pa=this.Ka=this.La=!1,this.df=!0,this.Cb=this.ag=this.Bb=this.bg=this.$f=this.tf=this.R=this.s=this.v=this.ma=this.Kc=this.jb=this.ib=this.Ab=this.kb=this.Ba=this.we=this.je=this.Je=this.ne=this.Ce=this.ke=this.he=this.Ob=this.ze=this.Ge=this.le=this.ce=this.se=this.ae=this.Ve=this.Pe=this.oe=this.te=this.me=this.xe=this.be=this.ie=this.Me=this.pe=this.Db=this.ve=this.za=this.de=this.dg=this.re=this.ye=this.ue=this.ge=this.af=this.Ae=this.qe=this.fe=this.ee=this.Nb=this.Af=this.Ue=this.K=this.xf=this.fa=this.W=this.Z=this.L=this.J=this.M=this.qf=this.wf=this.nf=this.sf=this.cf=this.Ye=this.lf=this.V=this.ab=this.va=this.I=this.$=this.bb=this.Lc=this.Mc=this.S=this.Wa=this.pa=this.Ua=this.oa=this.Zf=this.Yf=this.Mf=this.Df=this.wa=this.Ff=this.N=this.ga=this.aa=this.cb=this.da=this.xa=this.ba=this.Ie=this.sa=this.ta=this.qa=this.$a=this.Fe=this.Be=this.Fc=this.Za=this.ra=this.Xa=this.T=this.Oe=this.Ya=this.Nc=this.rf=!1,this.cg=this.Jc=this.ha=this.ya=this.na=this.ea=this.O=0,this.gpuDetail="",this.u={os:"Unknown",osRawVer:"0",osVer:"0",osVersion:"0",browser:"Unknown",browserVer:"0",browserFullVer:"0",browserBestVer:"0",forging:!0,spoofing:!0,confidence:0,totalTime:0,vendor:"",make:"",gpuDetail:""},this.F=[],this.Hc=/Chrome\/(([0-9]+)\.[0-9]+\.[0-9]+\.[0-9]+)/}}class sn{lb(){const t=(self.OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")).getContext("webgl"),i=t&&t.getExtension("WEBGL_debug_renderer_info");return i?{md:t&&t.getParameter(i.UNMASKED_VENDOR_WEBGL),Lf:t&&t.getParameter(i.UNMASKED_RENDERER_WEBGL),Bf:!0}:{md:"",Lf:"",Bf:!1}}}class qn{lb(){const t=navigator.userAgentData;return t?t.getHighEntropyValues("platform architecture uaFullVersion platformVersion model bitness".split(" ")).then(i=>(i||(i={}),i.brands||(i.brands=t.brands),i.mobile||(i.mobile=t.mobile),i)):Promise.resolve(void 0)}}class En{lb(){let t={Bd:!1,Gd:"",md:""};if(navigator.userAgent){var i=navigator.userAgent.toUpperCase();const n="BRAVIA TIZEN PHILIPSTV GOOGLETV CRKEY CHROMECAST SHIELDTV".split(" "),r="SONY SAMSUNG PHILIPS GOOGLE GOOGLE GOOGLE NVIDIA".split(" ");if(RegExp("BRAVIA|SMARTTV|SMART-TV|PHILIPSTV|GOOGLETV|CRKEY|CHROMECAST|SHIELD Android TV","i").test(i)&&(t.Bd=!0,i=i.match(n.join("|"))))for(let s=0;s<n.length;s++)i[0]==n[s]&&(t.Gd=n[s],t.md=r[s],i[0]=="CRKEY"&&(t.Gd="CHROMECAST"))}return Promise.resolve(t)}}class Jn{lb(){return{platform:navigator.platform}}}const on=new bn;function an(){performance.mark("platformBegin");var e=on;return e.Ic||(e.Ic=qt(e)),e.Ic}var Qn=class extends rt{constructor(e){super(e),this.W=[]}aa(e){e={logModule:"R",timeStamp:e.timestamp,logLevel:e.level,logtag:e.tag,logstr:e.message},this.hasListener("Log")?this.emit("Log",e):this.W.push(e)}addListener(e,t){if(super.addListener(e,t),e=="Log"&&0<this.W.length){for(const i of this.W)this.emit("Log",i);this.W=[]}}};function dn(e){e.splice(0,e.length)}var Nr=class extends Array{constructor(){super(),this.push=this.h}h(...e){return e=Array.prototype.push.apply(this,e),this.g&&this.g(),e}},Gt=class{constructor(e){this.name="",this.gdprLevel="behavioral",this.priority=!1,this.parameters=e,this.ts=new Date().toISOString()}},Yn=class extends Gt{constructor(e){super(e),this.name="GS_DebugInfo",this.gdprLevel="technical"}},wn=class extends Gt{constructor(e){super(e),this.name="GS_ExceptionInfo",this.gdprLevel="technical"}},Xn=class extends Gt{constructor(e){super(e),this.name="GS_ClientMetricEvent",this.gdprLevel="functional"}},Zn=class extends Gt{constructor(e){super(e),this.name="GS_Sleep_Event",this.gdprLevel="technical"}},Cn=class extends Gt{constructor(e){super(e),this.name="GS_WsCallResult",this.gdprLevel="functional"}},er=class extends Gt{constructor(e){super(e),this.name="GS_HttpCallResult",this.gdprLevel="functional"}};function oi(e,t){A.Log.d("{0f7a7d0}","{1d02c0d}"),tr(e),t?e.o=window.setTimeout(()=>{e.g&&(window.clearInterval(e.g),e.g=0)},e.v):e.g&&(window.clearInterval(e.g),e.g=0)}function Vi(e){oi(e,!1),e.C=new Date().getTime(),e.m=0,e.h=0,e.l=0,e.v=2*e.j+500,e.Ja="",e.s=!1,A.Log.d("{0f7a7d0}","{456f7b1}"),e.g=window.setInterval(()=>{const t=new Date().getTime();ir(e,t),In(e,"p"),e.s||(e.s=nr(e)),e.C=t},e.j)}function tr(e){e.o&&(window.clearTimeout(e.o),e.o=0)}function ir(e,t){const i=Math.max(0,t-e.C-e.j);i>e.F&&(e.h=t,e.m=i,In(e,"s"),cn(e))}function In(e,t){e.Ja.endsWith(t)||(4<=e.Ja.length&&(e.Ja=e.Ja.substring(1)),e.Ja+=t)}function nr(e){let t=!1,i=!1,n=!1;for(let r=0;r<e.Ja.length;r++)e.Ja.charAt(r)==="s"?i=!0:e.Ja.charAt(r)==="e"&&(n=!0);return i&&n&&Math.min(Math.abs(e.l-e.h),Math.abs(e.l-e.h+e.m))<e.v&&(t=!0,e.D.Qf({Se:e.l,Rf:e.h,duration:e.m,Ja:e.Ja})),t}function cn(e){let t="n/a";e.h&&(t=new Date(e.h).toISOString()),A.Log.i("{0f7a7d0}","{e4526ad}",e.m,t)}function rr(e){if(e.g){var t=new Date().getTime();e.l=t,ir(e,t),In(e,"e"),e.s=nr(e),cn(e)}}function sr(e,t){e.v=t??2*e.j+500}var Tn=class{constructor(e,t,i){this.g=this.l=this.h=this.m=this.C=0,this.Ja="",this.o=0,this.s=!1,this.D=e,this.j=t??1e4,this.F=i??1e4,this.v=2*this.j+500}};function Hi(e,t,i){return{kc:e==="online",description:i?`${e}(${i.name}: ${i.message})`:t?`${e}(${t})`:e}}async function Rn(e){if(e.g)return Hi("online");const t=performance.now();try{const i=new AbortController;window.setTimeout(()=>i.abort(),e.timeout);const n=await fetch(e.url,{method:"OPTIONS",signal:i.signal}),r=n.status,s=200<=n.status&&300>n.status||n.status==403?"online":"offline_wrong_status";return A.Log.i("{0ce6b17}","{b7012d7}",s,Math.round(performance.now()-t)),Hi(s,r)}catch(i){return Hi(i.name==="AbortError"?"timeout":"offline",void 0,i)}}var or=class{constructor(e,t=1500,i=!1){this.timeout=t,this.g=i,this.url=(window.location.protocol==="http:"?"http://":"https://")+e,A.Log.i("{0ce6b17}","{dda0527}",this.url,this.timeout)}};window.RtcUtils=window.RtcUtils||{};var b=A.CancellableWait,P=A.DefaultHttpRequestOptions,k=A.Log,q=A.Logger,re=A.LogLevel,he=A.performHttpRequest,Te=A.TelemetryModule,Le=A.TracingManager,De={Va:{},Xb:{type:"UNKNOWN",version:""},Fd:!0,Ke:!1,$d:!0,Zd:!1};function $e(e){var t,i,n,r;if(k.i("{11b33a0}","{e65e133}",JSON.stringify(e)),je(e),e.gxtOverrideData){const s=JSON.parse(e.gxtOverrideData);if(s.params)for(const o of s.params)o.name==="pmCommunication"&&(De.Va.pmCommunication=o.value,De.Xb={type:"GXT",version:o.version})}if(e.overrideData){const s=new URLSearchParams(e.overrideData.toLowerCase());e=o=>(o=s.get(o),Ne(o)),De.Fd=(t=e("log"))!==null&&t!==void 0?t:De.Fd,De.Ke=De.Fd&&((i=e("console"))!==null&&i!==void 0?i:De.Ke),De.$d=(n=e("websocketsignaling"))!==null&&n!==void 0?n:De.$d,De.Zd=(r=e("webrtcstreamer"))!==null&&r!==void 0?r:De.Zd}}var Bt=class extends Gt{constructor(e){super(e),this.name="GridServer_GameLaunch_Request",this.gdprLevel="functional"}};const Wi={fg:"GFN_GridServer",clientId:"93289439828086895",eventSchemaVer:"2.1"};function ai(e,t,i,n){return{url:t,verb:i,statusCode:"0",requestStatusCode:"",sessionId:n??"",subSessionId:e.subSessionId,requestId:"",serverId:"",callDuration:0,response:"None"}}function ti(e,t,i,n){var r,s,o;const d=Te.getTelemetryEventIds();return{requestedZoneAddress:t,zoneName:"",networkSessionId:(r=d.networkSessionId)!==null&&r!==void 0?r:"",sessionId:n??"",subSessionId:"",resumeType:i?"MANUAL":"NONE",overrideConfigType:De.Xb.type,overrideConfigVersion:De.Xb.version,result:"",codec:"UNKNOWN",ipVersion:"UNKNOWN",launchDuration:0,networkType:e.networkType,streamingProfileGuid:(s=d.streamingProfileGuid)!==null&&s!==void 0?s:"",systemInfoGuid:(o=d.systemInfoGuid)!==null&&o!==void 0?o:"",cmsId:e.cmsId}}function Ii(e,t){t=new er({callDuration:t.callDuration,verb:t.verb,sessionId:t.sessionId,subSessionId:t.subSessionId,serverId:t.serverId,url:t.url,overrideConfigType:De.Xb.type,overrideConfigVersion:De.Xb.version,requestStatusCode:t.requestStatusCode,requestId:t.requestId,networkType:e.networkType,statusCode:t.statusCode,cmsId:e.cmsId,moduleName:"GRID_SERVER",response:t.response}),e.processEvent(t)}function zi(e,t){var i,n,r;t.launchDuration=Math.round(t.launchDuration),t=new Bt(t),t.parameters.sessionId||(t.parameters.sessionId=e.sessionId),t.parameters.subSessionId||(t.parameters.subSessionId=e.subSessionId);const s=Te.getTelemetryEventIds();t.parameters.networkSessionId=(i=s.networkSessionId)!==null&&i!==void 0?i:"",t.parameters.systemInfoGuid=(n=s.systemInfoGuid)!==null&&n!==void 0?n:"",t.parameters.streamingProfileGuid=(r=s.streamingProfileGuid)!==null&&r!==void 0?r:"",e.processEvent(t)}function xr(e){const t=new Yn({key1:"InvalidSessionStateTransition",key2:"Streaming",key3:"",key4:"",key5:"",moduleName:"GRID_SERVER",networkType:e.networkType,overrideConfigType:De.Xb.type,overrideConfigVersion:De.Xb.version,cmsId:e.cmsId,sessionId:e.sessionId,subSessionId:e.subSessionId});e.processEvent(t)}function gi(e,t,i,n){var r,s;if(50<=e.h)var o=!1;else{var d=(o=e.g.get(i))!==null&&o!==void 0?o:0;10<=d?o=!1:(e.h++,e.g.set(i,d+1),o=!0)}o&&(!r&&t&&(r=t.name+": "+t.message),t=new wn({filename:n,lineno:0,stacktrace:(s=t==null?void 0:t.stack)!==null&&s!==void 0?s:"",colno:0,handled:"TRUE",category:r??"",message:i,moduleName:"GRID_SERVER",sessionId:e.sessionId,subSessionId:e.subSessionId}),e.processEvent(t))}function fs(e,t){e.subSessionId=t,e.g.clear(),e.h=0}var Ko=class{constructor(){this.networkType="UNKNOWN",this.subSessionId=this.sessionId=this.cmsId="",this.g=new Map,this.h=0,this.j=Te.createTelemetryProvider(Wi)}setNetworkType(e){this.networkType=Ue(e)}processEvent(e){this.Ga?this.Ga({name:e.name,parameters:e.parameters,gdprLevel:e.gdprLevel,ts:e.ts,clientConfig:Wi}):this.j.processEvent(e)}};function ar(e){switch(e){case 15867905:case 15867906:case 15867907:return!0;default:return!1}}function ps(e){switch(e){case"ready_for_connection":case"streaming":case"paused":return!0;default:return!1}}function $o(e,t){const i=(0,A.translatePlatformInfoForClientHeader)({os:t.deviceOs,osVersion:t.deviceOsVer,platformType:t.deviceType,model:t.deviceModel,make:t.deviceMake,browser:t.browserType});if(e["content-type"]="application/json",e["nv-client-type"]=t.clientType,e["x-device-id"]=t.deviceId,e["nv-browser-type"]=i.browser,e["nv-client-streamer"]=t.clientStreamer,i.os==="UNKNOWN"?t.deviceOs&&(e["nv-device-os"]=t.deviceOs):e["nv-device-os"]=i.os,i.deviceType!==void 0&&(e["nv-device-type"]=i.deviceType),t.deviceMake!==void 0&&(e["nv-device-make"]=t.deviceMake),t.deviceModel!==void 0&&(e["nv-device-model"]=t.deviceModel),t.clientAppVersion!==void 0&&(e["nv-client-version"]=t.clientAppVersion),t.clientId!==void 0&&(e["nv-client-id"]=t.clientId),t.clientHeaders)for(const[n,r]of t.clientHeaders)t=n,t.toLowerCase()!=="x-nv-client-identity"&&(e[t.toLowerCase()]=r)}function qo(e){switch(e){case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5;case 5:return 6;default:return 0}}function Jo(e,t){switch(t){case 2:return e==1||e==0;case 3:return e==2||e==4;case 4:return e==3;case 5:return e==2||e==4;case 6:return e!=5;default:return!1}}function Qo(e){switch(e){case 1:return"initializing";case 2:return"ready_for_connection";case 3:return"streaming";case 4:case 5:return"paused";case 6:return"resuming";case 7:return"finished";default:return"unknown"}}function ii(e){switch(e){case 3237085186:return"invalid operation";case 15859712:return"success";case 3237093379:case 3237093381:return"Invalid server response";case 3237093384:return"Exception";case 15867907:case 15867905:case 15867906:return"cancelled";case 15868417:return"no network";case 3237089282:return"network error";default:return"server error"}}function mi(e){const t=m.trace.getActiveSpan();if(t)for(const[i,n]of e.C)t.setAttribute(i,n)}function vs(e,t,i,n,r){e.O=!1,Vi(e.s);const s=ae();return new Promise((o,d)=>{const u=!!r;var l=()=>{var p;const y={code:3237085186,subSessionId:s};st(y.code);const N=ti(e.h,(p=t.serverAddress)!==null&&p!==void 0?p:"",u,r);N.result=R(y.code),N.subSessionId=s,zi(e.h,N),o(y)};if(dr(e))if(e.J())k.e("{1daeef1}","{3753849}"),l();else{e.h.cmsId=t.appId,fs(e.h,s),l=Ss(e,t,r);var h=new URL(l).hostname;h=ti(e.h,h,u),e.g={resolve:o,reject:d,sessionId:r,subSessionId:s,Pf:n,Cd:Number.MAX_VALUE,Zc:!1,Qc:i,Dd:h,startTime:performance.now()},d=ys(e,t,u,s),di(e,u?1:0,l,d,i).then(p=>{!u&&p.result===15859712&&p.session&&k.i("{1daeef1}","{7c01bce}",p.session.sessionId),e.N(p)}).catch(p=>{e.M(p)})}else k.e("{1daeef1}","{3781843}"),l()}).catch(o=>(e.m.clear(),dn(e.j),e.g=void 0,cr(e,o,"startOrResumeSession"),st(3237093384),{code:3237093384,subSessionId:s}))}function dr(e){return e.F.type===-1||!!e.F.token}function st(e,t){const i=m.trace.getActiveSpan();i&&(ar(e)?(i.setAttribute("error",!1),i.setAttribute("error.description",ii(e))):e==15859712?i.setAttribute("error",!1):(i.setAttribute("error",!0),i.setAttribute("error.description",t??ii(e))))}function Ti(e,t){let i=e.protocol;return t&&e.D.has(t)?(e=e.D.get(t),e!==void 0&&(i+=e.server,e.port!=0&&(i+=":"+e.port))):i+=e.serverAddress,i+("/v2/session/"+t)}function di(e,t,i,n,r,s){var o;const d=y=>{if(ar(y))return!1;if(y!==15859712)return!0;switch(t){case 3:return!1;default:return!0}};let u={method:(()=>{switch(t){case 0:return"POST";case 2:return"DELETE";case 1:case 4:return"PUT";default:return"GET"}})(),headers:e.v.headers,body:n,retryCount:e.v.retryCount,timeout:e.v.timeout};(t===2||t===4)&&(u.keepalive=!0,e.u&&ue(e.u)&&!Ee(e.u,81)&&(u.keepalive=!1));const l=performance.now();let h=ai(e.h,i,(o=u.method)!==null&&o!==void 0?o:"",s);h.statusCode="0";let p="";return he(i,u,e.F,r).then(y=>{p=y.data;var N=performance.now();if(h.statusCode=y.status.toString(),h.callDuration=Math.round(N-l),!y.data)throw k.e("{1daeef1}","{ea40865}"),new SyntaxError("The response from server does not contain any data");try{var G=JSON.parse(y.data)}catch(be){throw h.response=y.data,be}if(!G.requestStatus)throw k.e("{1daeef1}","{862f264}",_r(y.data)),new SyntaxError("RequestStatus missing in response");y=G.requestStatus.serverId.toUpperCase(),h.requestId=G.requestStatus.requestId,h.serverId=y,h.requestStatusCode=G.requestStatus.statusDescription,N=G.requestStatus;var E=3237093632;if(N.statusCode!==void 0){var D=N.statusCode;D==1?E=15859712:0<D&&255>D&&(E=3237093632+D),E!=3237093636&&E!=3237093672||!N.unifiedErrorCode||(E=N.unifiedErrorCode)}N.unifiedErrorCode&&k.i("{1daeef1}","{d2c9cc8}",R(N.unifiedErrorCode)),y={result:E,ed:G,serverId:y},N=G.requestStatus;var z,Z,Q;if(E=m.trace.getActiveSpan()){D=new Map([["host.dc",(z=N.serverId)!==null&&z!==void 0?z:""],["request.id",(Z=N.requestId)!==null&&Z!==void 0?Z:""],["request.status",(Q=N.statusDescription)!==null&&Q!==void 0?Q:""]]);for(const[be,Me]of D)E.setAttribute(be,Me)}if(t===5)(G=G.sessions)&&(y.activeSessions=ms(e,G));else if(t!==2){if(z=G.session){y.session=gs(e,z);var ce;Z=m.trace.getActiveSpan(),Z==null||Z.setAttribute("session.status",(ce=z.status)!==null&&ce!==void 0?ce:""),h.sessionId=y.session.sessionId}(G=G.otherUserSessions)&&(y.activeSessions=ms(e,G),y.activeSessions.length&&k.d("{1daeef1}","{ba4be1c}",y.activeSessions.length))}return h&&d(y.result)&&(Ii(e.h,h),h=void 0),y}).catch(y=>{let N={result:3237089282};const G=performance.now();if(y.code){y=y.code;var E=3237093384;y===3237089281?E=15868417:y===3237089282?E=3237089282:y===3237093379?E=3237093379:y===3237089283?E=3237089283:y==15867905&&(E=15867907),N.result=E}else E=!1,(y instanceof SyntaxError||y instanceof TypeError&&y.message&&y.message.includes("Cannot read property"))&&(E=!0,k.e("{1daeef1}","{d8979bb}",y.name,y.message)),E?(N.result=3237093379,k.e("{1daeef1}","{04bcd6f}",_r(p))):(N.result=3237093384,k.e("{1daeef1}","{94d55bb}",y,y.stack),gi(e.h,y,"performSessionRequest","sessioncontrolimpl.ts"));return h&&d(N.result)&&(h.callDuration=Math.round(G-l),Ii(e.h,h)),k.e("{1daeef1}","{9c647aa}",u.method,i),k.e("{1daeef1}","{200d7ba}",N.result,ii(N.result)),N})}function cr(e,t,i){k.e("{1daeef1}","{32f1296}",i,t.message),k.e("{1daeef1}","{94d55bb}",t,t.stack),gi(e.h,t,i,"sessioncontrolimpl.ts")}function gs(e,t){var i;let n={sessionId:t.sessionId,subSessionId:"",appId:0,appLaunchMode:0,state:Qo(t.status),zoneAddress:"",zoneName:"",deviceId:"",gpuType:"",monitorSettings:[],connectionInfo:[],finalizedStreamingFeatures:t.finalizedStreamingFeatures};if(n.appId=t.sessionRequestData?t.sessionRequestData.appId:0,t.connectionInfo){var r=t.connectionInfo;if(e.clientPlatformName==="browser"){let o=!1;for(var s of r)if(s.usage===2){o=!0,n.connectionInfo.push(s);const d={ip:"",port:49100,appLevelProtocol:5,protocol:1,usage:14};s=s.ip.split("."),d.ip=s[0]+"-"+s[1]+"-"+s[2]+"-"+s[3],d.ip+=t.sessionControlInfo.ip.substring(t.sessionControlInfo.ip.indexOf(".")),k.d("{1daeef1}","{cf7d7ea}",d.ip),n.connectionInfo.push(d);break}o||(n.connectionInfo=r)}else n.connectionInfo=r}switch(t.monitorSettings&&(n.monitorSettings=t.monitorSettings),t.gpuType&&(n.gpuType=t.gpuType),(i=t.sessionRequestData)===null||i===void 0?void 0:i.appLaunchMode){case 3:n.appLaunchMode=2;break;case 2:n.appLaunchMode=1}return t.sessionControlInfo&&(i=t.sessionControlInfo.ip,t=t.sessionControlInfo.port,i&&t&&(e.D.has(n.sessionId)&&(r=e.D.get(n.sessionId),(r==null?void 0:r.server)===i&&(r==null?void 0:r.port)===t||k.i("{1daeef1}","{f09f5be}",n.sessionId,r==null?void 0:r.server,r==null?void 0:r.port,i,t)),e.D.set(n.sessionId,{server:i,port:t})),i&&(n.zoneAddress=i,n.zoneName=i.split(".")[0].toUpperCase())),n}function ms(e,t){return t.map(i=>gs(e,i))}function As(e,t,i,n,r,s,o){const d=()=>{mi(e);let p=Ti(e,t),y={action:6,adUpdates:Array.from(e.j)};k.d("{1daeef1}","{dbca4b1}",JSON.stringify(y)),dn(e.j),di(e,4,p,JSON.stringify(y),i,t).then(N=>{n(N)}).catch(N=>r(N))};for(var u=e.j.length-1,l=0;1<=u;)e.j[u].adAction===3&&e.j[u-1].adAction===2?(e.j.splice(u-1,2),l++,u-=2):e.j[u-1].adAction===3?u--:u-=2;l&&k.d("{1daeef1}","{98a2816}",l),l=!1,u=1e3*e.o.adsWaitTimeoutS;const h=e.j.length;if(h&&(e.j[h-1].adAction===4&&1<e.m.size||e.j[h-1].adAction===2?u=e.o.adsThrottleIntervalMS:l=!0),l)Le.getInstance().createSpan("AdUpdateRequest",d);else{l=new Promise(y=>{e.j.g=y});const p=new b(u,i.signal);Promise.race([p.getPromise(),l]).then(()=>{e.j.g=void 0,p.cancel(),e.j.length?e.j.length==h?Le.getInstance().createSpan("AdUpdateRequest",d):As(e,t,i,n,r,s,o):(k.w("{1daeef1}","{5e1dfd0}"),o())}).catch(y=>{e.j.g=void 0,p.isAborted()?(k.i("{1daeef1}","{d7114d7}"),s()):r(y)})}}function Ss(e,t,i){var n,r,s;return i?e=Ti(e,i):(i=(n=t.serverAddress)!==null&&n!==void 0?n:e.serverAddress,e=e.protocol+i+"/v2/session"),e+="?keyboardLayout="+((r=t.keyboardLayout)!==null&&r!==void 0?r:"en_US"),e+="&languageCode="+((s=t.clientLocale)!==null&&s!==void 0?s:"en_US")}function ys(e,t,i,n){var r,s,o,d,u,l,h,p;let y;switch(t.appLaunchMode){case 2:k.d("{1daeef1}","{6d5cf87}"),y=3;break;case 1:y=2;break;default:y=1}const N=(s=(r=t.monitorSettings[0])===null||r===void 0?void 0:r.sdrHdrMode)!==null&&s!==void 0?s:0;r={audioMode:2,remoteControllersBitmap:(o=t.remoteControllersBitmap)!==null&&o!==void 0?o:0,sdrHdrMode:N,networkTestSessionId:null,availableSupportedControllers:[],clientVersion:"29.0",deviceHashId:e.deviceId,internalTitle:null,clientPlatformName:e.clientPlatformName,metaData:[{key:"SubSessionId",value:n},{key:"wssignaling",value:De.$d?"1":"0"}],surroundAudioInfo:0,clientTimezoneOffset:(d=t.clientTimeZoneOffset)!==null&&d!==void 0?d:-6e4*new Date().getTimezoneOffset(),clientIdentification:"GFN-PC",parentSessionId:null,appId:t.appId,streamerVersion:1,clientRequestMonitorSettings:t.monitorSettings,appLaunchMode:y,sdkVersion:"1.0",enhancedStreamMode:1,useOps:!0,clientDisplayHdrCapabilities:null,accountLinked:(u=t.accountLinked)!==null&&u!==void 0?u:!1,partnerCustomData:(l=t.partnerCustomData)!==null&&l!==void 0?l:"",enablePersistingInGameSettings:(h=t.enablePersistingInGameSettings)!==null&&h!==void 0?h:!1,secureRTSPSupported:!1,userAge:(p=t.userAge)!==null&&p!==void 0?p:0,requestedStreamingFeatures:t.streamingFeatures},De.Zd||e.clientPlatformName==="browser"?r.metaData.push({key:"GSStreamerType",value:"WebRTC"}):r.secureRTSPSupported=!0;for(const G in t.metaData)r.metaData.push({key:G,value:t.metaData[G]});return e=JSON.stringify(i?{action:2,data:"RESUME",sessionRequestData:r,metaData:[]}:{sessionRequestData:r}),k.i("{1daeef1}","{c6c3ed4}",i?"PUT":"POST",_e(e)),e}function Yo(e,t,i,n){var r,s,o,d,u,l,h="Configuring",p=0;if(t.seatSetupInfo)switch(t.seatSetupInfo.seatSetupStep){case 0:h="Connecting";break;case 1:h="InQueue",p=t.seatSetupInfo.queuePosition<i?t.seatSetupInfo.queuePosition:i;break;case 5:h="PreviousSessionCleanup";break;default:p=0}if(i={sessionId:t.sessionId,subSessionId:n,queuePosition:p,eta:(s=(r=t.seatSetupInfo)===null||r===void 0?void 0:r.seatSetupEta)!==null&&s!==void 0?s:0,progressState:h,isAdsRequired:t.sessionAdsRequired,ads:[]},r=new Map(e.m),e.m.clear(),t.sessionAds)for(s=t.sessionAds.length,h=0;h<s;h++){if(n=t.sessionAds[h],n.adState==5||n.adState==6)continue;p=n.adId,e.m.set(p,{Mg:n.adState,$c:(d=(o=r.get(p))===null||o===void 0?void 0:o.$c)!==null&&d!==void 0?d:0}),p={adId:p,adState:n.adState,adUrl:n.adUrl,adLengthInSeconds:n.adLengthInSeconds,adMediaFiles:[]};const y=(l=(u=n.adMediaFiles)===null||u===void 0?void 0:u.length)!==null&&l!==void 0?l:0;for(let N=0;N<y;N++){const G=n.adMediaFiles[N];p.adMediaFiles.push({mediaFileUrl:G.mediaFileUrl,encodingProfile:G.encodingProfile})}i.ads.push(p)}return i}function Xo(e,t){let i=e.o.ng;return t.seatSetupInfo.seatSetupStep===1&&e.o.Ef!=0&&(i+=Math.floor(t.seatSetupInfo.queuePosition/e.o.Ef)*e.o.step),t.sessionAdsRequired&&(i=Math.max(i,e.o.adsPollingIntervalMinMS)),Math.min(i,e.o.mg)}async function kn(e,t,i,n){var r,s,o;if(e.S=t,e.g)try{if(rr(e.s),e.O){var d=t;switch(t){case 3237093701:case 3237093654:d=15867909}d!==t&&A.Log.i("{fda9cda}","{49e2182}",R(t),R(d)),t=d,oi(e.s,!1)}else oi(e.s,!0);if(t===3237089282&&!(await Rn(new or(e.serverAddress))).kc){switch(d=t,t){case 3237089282:d=15868417}d!==t&&A.Log.i("{fda9cda}","{b84d4c8}",R(t),R(d)),t=d}const u={code:t,subSessionId:(r=e.g.subSessionId)!==null&&r!==void 0?r:"",session:e.g.lg,zoneName:i,activeSessions:n},l=e.g.Dd;l.result=R(t),l.zoneName=i??"",l.sessionId=(s=e.g.sessionId)!==null&&s!==void 0?s:"",l.launchDuration+=performance.now()-e.g.startTime,zi(e.h,e.g.Dd),st(t),k.d("{1daeef1}","{c4902fa}",R(t),(o=e.g.sessionId)!==null&&o!==void 0?o:""),e.g.resolve(u),e.g=void 0,e.m.clear(),dn(e.j)}catch(u){e.g&&(e.g.reject(u),e.g=void 0)}}var bs=class{constructor(){var e,t,i,n,r,s,o,d,u,l,h,p,y,N,G,E,D,z,Z,Q,ce,be;this.D=new Map,this.v={...P},this.F={type:1},this.C=new Map,this.protocol="https://",this.j=new Nr,this.m=new Map,this.serverAddress="",this.O=!1,this.clientPlatformName=this.deviceId="";let Me;Me=0+((t=(e=De.Va.pmCommunication)===null||e===void 0?void 0:e.httpConnectionTimeout)!==null&&t!==void 0?t:0),Me+=(n=(i=De.Va.pmCommunication)===null||i===void 0?void 0:i.httpDataReceiveTimeout)!==null&&n!==void 0?n:0,this.v.timeout=Me?1e3*Me:13e3,this.v.retryCount=(s=(r=De.Va.pmCommunication)===null||r===void 0?void 0:r.httpRetryCount)!==null&&s!==void 0?s:3,this.v.backOffDelay=(d=(o=De.Va.pmCommunication)===null||o===void 0?void 0:o.httpBackOffDelay)!==null&&d!==void 0?d:500,this.o={ng:(l=(u=De.Va.pmCommunication)===null||u===void 0?void 0:u.pollingIntervalMin)!==null&&l!==void 0?l:1e3,mg:(p=(h=De.Va.pmCommunication)===null||h===void 0?void 0:h.pollingIntervalMax)!==null&&p!==void 0?p:1e4,step:(N=(y=De.Va.pmCommunication)===null||y===void 0?void 0:y.pollingIntervalStep)!==null&&N!==void 0?N:1e3,Ef:(E=(G=De.Va.pmCommunication)===null||G===void 0?void 0:G.pollingQueueSizePerStep)!==null&&E!==void 0?E:50,adsPollingIntervalMinMS:(z=(D=De.Va.pmCommunication)===null||D===void 0?void 0:D.adsPollingIntervalMinMS)!==null&&z!==void 0?z:3e3,adsThrottleIntervalMS:(Q=(Z=De.Va.pmCommunication)===null||Z===void 0?void 0:Z.adsThrottleIntervalMS)!==null&&Q!==void 0?Q:2e3,adsWaitTimeoutS:(be=(ce=De.Va.pmCommunication)===null||ce===void 0?void 0:ce.adsWaitTimeoutS)!==null&&be!==void 0?be:600},this.h=new Ko,this.s=new Tn({Qf:xe=>{var Je,Be=this.h,tt=R((Je=this.S)!==null&&Je!==void 0?Je:0);xe=new Zn({eventSequence:xe.Ja,sleepTime:Math.round(xe.duration/1e3),error:tt,timeToSleep:Math.round((xe.Se-xe.Rf)/1e3),moduleName:"GRID_SERVER",cmsId:Be.cmsId,sessionId:Be.sessionId,subSessionId:Be.subSessionId}),Be.processEvent(xe),this.O=!0,oi(this.s,!1)}})}init(e){var t,i;return $o(this.v.headers,e),this.C.set("component","sessioncontrol"),this.C.set("component.version","2.0"),this.C.set("client.name","GFN-PC"),this.C.set("client.version","29.0"),this.C.set("client.os",(t=e.deviceOs)!==null&&t!==void 0?t:""),this.C.set("client.os.version",(i=e.deviceOsVer)!==null&&i!==void 0?i:""),this.setDefaultServerAddress(e.serverAddress),this.clientPlatformName=e.clientPlatformName,this.deviceId=e.deviceId,this.u||this.clientPlatformName!=="browser"||an().then(n=>{this.u=n}),!0}setAuthInfo(e){this.F=e}setNetworkType(e){this.h.setNetworkType(e)}setDefaultServerAddress(e){this.serverAddress!=e&&(this.serverAddress=e,this.serverAddress.startsWith("mockpm://")||this.serverAddress.toLocaleLowerCase()==="mockpm.com")&&(this.serverAddress=this.serverAddress.replace("mockpm://",""),this.protocol="http://")}async startSession(e,t,i){return await Le.getInstance().createSpan("StartSession",()=>(mi(this),vs(this,e,t,i)))}async resumeSession(e,t,i,n){return await Le.getInstance().createSpan("ResumeSession",()=>(mi(this),vs(this,t,i,n,e)))}async deleteSession(e,t){return await Le.getInstance().createSpan("DeleteSession",()=>{if(mi(this),!dr(this))return k.e("{1daeef1}","{4fed44a}"),st(3237085186),Promise.resolve(3237085186);const i=Ti(this,e);return di(this,2,i,"",t,e).then(n=>(n.result==15859712?(this.D.delete(e),k.d("{1daeef1}","{6206c13}",e)):k.e("{1daeef1}","{4de47e3}",e,R(n.result)),st(n.result),n.result)).catch(n=>(cr(this,n,"deleteSession"),st(3237093384),3237093384))})}async getActiveSessions(e){return await Le.getInstance().createSpan("GetSessionList",()=>(mi(this),dr(this)?di(this,5,this.protocol+this.serverAddress+"/v2/session","",e).then(t=>(t={code:t.result,activeSessions:t.activeSessions,zoneName:t.serverId},st(t.code),t.code!==15859712?k.e("{1daeef1}","{9d2bb75}",R(t.code)):k.d("{1daeef1}","{081857f}"),t)).catch(t=>(cr(this,t,"getActiveSessions"),t={code:3237093384},st(t.code),t)):(k.e("{1daeef1}","{dc27839}"),st(3237085186),Promise.resolve({code:3237085186}))))}async getSessionInfo(e,t){return await Le.getInstance().createSpan("GetSession",()=>{if(!dr(this))return k.e("{1daeef1}","{603fbab}"),st(3237085186),Promise.resolve({code:3237085186});const i=Ti(this,e);return di(this,3,i,"",t,e).then(n=>(n={code:n.result,session:n.session,zoneName:n.serverId},n.code!==15859712?k.e("{1daeef1}","{021d0f4}",R(n.code)):k.d("{1daeef1}","{fa53c7c}"),n)).catch(n=>(cr(this,n,"getSessionInfo"),n={code:3237093384},st(n.code),n))})}J(){return!!this.g}updateAdState(e){if(!this.J())return k.e("{1daeef1}","{20d9281}"),3237085186;const t=this.m.get(e.adId);if(!t)return k.e("{1daeef1}","{74daa9c}",e.adId),3237093386;const i=qo(e.adAction);if(!Jo(t.$c,i))return k.e("{1daeef1}","{09d8184}",e.adAction,e.adId,t.$c),3237093386;if(this.j.length){const n=this.j[this.j.length-1].adId;if(n!==e.adId){const r=this.j[this.j.length-1].adAction;if(r!=4&&r!=5)return k.e("{1daeef1}","{c161587}",n),3237093386}}return e.clientTimestamp||(e.clientTimestamp=Math.round(Date.now()/1e3)),this.j.push(e),t.$c=i,this.m.set(e.adId,t),15859712}L(){var e,t;if(this.g){var i=Ti(this,(e=this.g.sessionId)!==null&&e!==void 0?e:"");di(this,3,i,"",this.g.Qc,(t=this.g.sessionId)!==null&&t!==void 0?t:"").then(n=>{this.N(n)}).catch(n=>{this.M(n)})}}M(e){k.e("{1daeef1}","{e3be7ea}",e.message),gi(this.h,e,"processSessionSetupException","sessioncontrolimpl.ts"),kn(this,3237093384)}N(e){var t,i,n;if(this.g){var r=()=>{kn(this,s.Zc?15867906:15867905)},s=this.g;if(e.session&&(e.session.subSessionId=this.g.subSessionId,this.g.lg=e.session,this.g.sessionId=e.session.sessionId,s.Zc=e.ed.session.seatSetupInfo.seatSetupStep==1),e.result===15859712&&e.session){const o=e.session;o.state==="ready_for_connection"||o.state==="streaming"?(o.state=="streaming"&&xr(this.h),k.i("{1daeef1}","{30d6f44}",(t=this.g.sessionId)!==null&&t!==void 0?t:""),kn(this,15859712,e.serverId)):o.state=="initializing"||o.state=="resuming"?(t=Yo(this,e.ed.session,this.g.Cd,this.g.subSessionId),this.g.Pf(t),s.Zc&&(this.g.Cd=t.queuePosition),t.ads.length?(sr(this.s,1e3*t.ads[0].adLengthInSeconds),As(this,(i=s.sessionId)!==null&&i!==void 0?i:"",s.Qc,this.N.bind(this),this.M.bind(this),r,this.L.bind(this))):(sr(this.s),new b(Xo(this,e.ed.session),(n=this.g.Qc)===null||n===void 0?void 0:n.signal).getPromise().then(this.L.bind(this)).catch(r))):(k.e("{1daeef1}","{ce47cd1}",_r(JSON.stringify(e.ed))),kn(this,3237093378,e.serverId))}else e.result===15867907?r():kn(this,e.result,e.serverId,e.activeSessions)}}};function _r(e){return _e(e).replace(/("clientIp" *: *")(\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b)(?=")/g,"$1***")}var Es={Success:15859712,InvalidOperation:3237085186,NetworkError:3237089282,GetActiveSessionServerError:3237089283,AuthTokenNotUpdated:3237093377,SessionFinishedState:3237093378,ResponseParseFailure:3237093379,InvalidServerResponse:3237093381,PutOrPostInProgress:3237093382,GridServerNotInitialized:3237093383,DOMExceptionInSessionControl:3237093384,InvalidAdStateTransition:3237093386,SessionServerErrorBegin:3237093632,RequestForbidden:3237093634,ServerInternalTimeout:3237093635,ServerInternalError:3237093636,ServerInvalidRequest:3237093637,ServerInvalidRequestVersion:3237093638,SessionListLimitExceeded:3237093639,InvalidRequestDataMalformed:3237093640,InvalidRequestDataMissing:3237093641,RequestLimitExceeded:3237093642,SessionLimitExceeded:3237093643,InvalidRequestVersionOutOfDate:3237093644,SessionEntitledTimeExceeded:3237093645,AuthFailure:3237093646,InvalidAuthenticationMalformed:3237093647,InvalidAuthenticationExpired:3237093648,InvalidAuthenticationNotFound:3237093649,EntitlementFailure:3237093650,InvalidAppIdNotAvailable:3237093651,InvalidAppIdNotFound:3237093652,InvalidSessionIdMalformed:3237093653,InvalidSessionIdNotFound:3237093654,EulaUnAccepted:3237093655,MaintenanceStatus:3237093656,ServiceUnAvailable:3237093657,SteamGuardRequired:3237093658,SteamLoginRequired:3237093659,SteamGuardInvalid:3237093660,SteamProfilePrivate:3237093661,InvalidCountryCode:3237093662,InvalidLanguageCode:3237093663,MissingCountryCode:3237093664,MissingLanguageCode:3237093665,SessionNotPaused:3237093666,EmailNotVerified:3237093667,InvalidAuthenticationUnsupportedProtocol:3237093668,InvalidAuthenticationUnknownToken:3237093669,InvalidAuthenticationCredentials:3237093670,SessionNotPlaying:3237093671,InvalidServiceResponse:3237093672,AppPatching:3237093673,GameNotFound:3237093674,NotEnoughCredits:3237093675,InvitationOnlyRegistration:3237093676,RegionNotSupportedForRegistration:3237093677,SessionTerminatedByAnotherClient:3237093678,DeviceIdAlreadyUsed:3237093679,ServiceNotExist:3237093680,SessionExpired:3237093681,SessionLimitPerDeviceReached:3237093682,ForwardingZoneOutOfCapacity:3237093683,RegionNotSupportedIndefinitely:3237093684,RegionBanned:3237093685,RegionOnHoldForFree:3237093686,RegionOnHoldForPaid:3237093687,AppMaintenanceStatus:3237093688,ResourcePoolNotConfigured:3237093689,InsufficientVmCapacity:3237093690,InsufficientRouteCapacity:3237093691,InsufficientScratchSpaceCapacity:3237093692,RequiredSeatInstanceTypeNotSupported:3237093693,ServerSessionQueueLengthExceeded:3237093694,RegionNotSupportedForStreaming:3237093695,SessionForwardRequestAllocationTimeExpired:3237093696,SessionForwardGameBinariesNotAvailable:3237093697,GameBinariesNotAvailableInRegion:3237093698,UekRetrievalFailed:3237093699,EntitlementFailureForResource:3237093700,SessionInQueueAbandoned:3237093701,MemberTerminated:3237093702,SessionRemovedFromQueueMaintenance:3237093703,ZoneMaintenanceStatus:3237093704,GuestModeCampaignDisabled:3237093705,RegionNotSupportedAnonymousAccess:3237093706,InstanceTypeNotSupportedInSingleRegion:3237093707,InvalidZoneForQueuedSession:3237093710,SessionWaitingAdsTimeExpired:3237093711,UserCancelledWatchingAds:3237093712,StreamingNotAllowedInLimitedMode:3237093713,ForwardRequestJPMFailed:3237093714,MaxSessionNumberLimitExceeded:3237093715,GuestModePartnerCapacityDisabled:3237093716,SessionRejectedNoCapacity:3237093717,SessionInsufficientPlayabilityLevel:3237093718,SessionServerErrorEnd:3237093887,SessionSetupCancelled:15867905,SessionSetupCancelledDuringQueuing:15867906,RequestCancelled:15867907,SystemSleepDuringSessionSetup:15867909,NoInternetDuringSessionSetup:15868417};function Zo(e){var t;const i={monitorSettings:[],...e};if(i.monitorSettings.length===0)for(const n of(t=e.streamParams)!==null&&t!==void 0?t:[])i.monitorSettings.push({heightInPixels:n.height,framesPerSecond:n.fps,widthInPixels:n.width});return i}function Fr(e){var t={ip:"",port:0,protocol:""};for(const i of e.connectionInfo)if(i.usage===14){t.ip=i.ip,t.port=i.port,t.protocol=i.appLevelProtocol===5?"https":"http",t.resourcePath=i.resourcePath;break}t={signalConnectionInfo:t,mediaConnectionInfo:e.connectionInfo,streamInfo:[],clientLocale:"",...e};for(const i of e.monitorSettings)t.streamInfo.push({width:i.widthInPixels,height:i.heightInPixels,fps:i.framesPerSecond,sdrHdrMode:i.sdrHdrMode});return t}function ws(e){let t=[];if(e)for(const i of e)t.push({sessionId:i.sessionId,appId:i.appId,state:i.state,appLaunchMode:i.appLaunchMode});return t}async function ea(e){k.d("{6bae601}","{1aef200}"),e.serverAddress?(await di(e,5,e.protocol+e.serverAddress+"/v2/session","").then(t=>{let i={sessionList:ws(t.activeSessions)};if(t.result!=15859712){let n={code:t.result,description:ii(t.result)};i.error=n,k.e("{6bae601}","{9d2bb75}",R(n.code))}else k.d("{6bae601}","{081857f}");st(t.result),e.l.emit("ActiveSessionsResult",i)}).catch(t=>{k.e("{6bae601}","{63f9b57}",t.message),k.e("{6bae601}","{94d55bb}",t,t.stack),gi(e.h,t,"getAllActiveSessions","gridserver.ts"),t={sessionList:[],error:{code:3237093384,description:ii(3237093384)}},st(3237093384),e.l.emit("ActiveSessionsResult",t)}),k.d("{6bae601}","{a9e5439}")):(e.l.emit("ActiveSessionsResult",{sessionList:[],error:{code:3237093383,description:"GridServer not initialized"}}),st(3237093383))}function Ur(e,t,i=""){k.d("{6bae601}","{1e04fe6}",i,t),e.subSessionId=t,e.h.sessionId=i,fs(e.h,t);const n=e.P.get(t);n===void 0||n===""?e.P.set(t,i):k.w("{6bae601}","{7dd264b}",i)}function ta(e,t,i){var n;const r=!!i;if(Ur(e,ae(),i),!e.serverAddress)return lr({code:3237093383,description:"GridServer not initialized"});if(e.G)return lr({code:3237093382,description:"Previous PutOrPost call is still in progress"});e.h.cmsId=t.appId,e.zoneName=void 0,e.zoneAddress=void 0,e.gpuType=void 0;const s=ti(e.h,e.serverAddress,r,i);s.networkSessionId=(n=t.networkSessionId)!==null&&n!==void 0?n:"",t=Zo(t);let o=Ss(e,t,i),d=ys(e,t,r,e.subSessionId),u=performance.now();return new Promise((l,h)=>{const p=new AbortController;e.G=p,di(e,r?1:0,o,d,p,i).then(y=>{var N,G,E,D,z;s.launchDuration=Math.round(performance.now()-u),!((N=y.session)===null||N===void 0)&&N.sessionId&&(s.sessionId=(G=y.session)===null||G===void 0?void 0:G.sessionId,i=(E=y.session)===null||E===void 0?void 0:E.sessionId),e.zoneName=y.serverId||e.zoneName;let Z;y.session&&(Z=Fr(y.session),Z.subSessionId=e.subSessionId,Cs(e,Z)),s.zoneName=(D=e.zoneName)!==null&&D!==void 0?D:"",p.signal.aborted&&!ar(y.result)&&(y.result=15867905,k.d("{6bae601}","{3ec0e11}")),y.result==15859712?(k.d("{6bae601}","{30536f4}",i),Ur(e,e.getSubSessionId(),i),((z=y.session)===null||z===void 0?void 0:z.state)=="ready_for_connection"?(s.result=R(15859712),zi(e.h,s)):e.K.set(s.sessionId,s),st(y.result),l(Z)):(y.result===15867907&&(y.result=15867905),y={code:y.result,sessionId:i,description:ii(y.result),sessionList:ws(y.activeSessions)},k.e("{6bae601}","{17f93f3}",R(y.code)),s.result=R(y.code),zi(e.h,s),st(y.code),h(y))}).catch(y=>{let N={code:3237093384,sessionId:i,description:ii(3237093384)};k.e("{6bae601}","{4318505}",y.message),k.e("{6bae601}","{94d55bb}",y,y.stack),gi(e.h,y,"putOrPostSession","gridserver.ts"),s.result=R(N.code),zi(e.h,s),st(N.code),h(N)})}).finally(()=>{e.G=void 0})}function lr(e){return st(e.code,e.description),Promise.reject(e)}function Cs(e,t){e.zoneAddress=t.zoneAddress||e.zoneAddress,e.zoneName=t.zoneName||e.zoneName,e.gpuType=t.gpuType||e.gpuType}function v(e,t,i){return e.serverAddress?i?new Promise((n,r)=>{var s=Ti(e,t),o=new URL(s).hostname;(s=e.K.get(t))?e.K.delete(t):(k.e("{6bae601}","{bb9b2e3}",t),s=ti(e.h,o,!1,t)),o=new AbortController,e.I=o,e.g={resolve:n,reject:r,sessionId:t,subSessionId:e.subSessionId,Pf:e.T,Cd:Number.MAX_VALUE,Zc:!1,Qc:o,startTime:performance.now(),Dd:s},e.L()}).then(n=>{let r;if(n.session&&(r=Fr(n.session),Cs(e,r)),n.code===15859712&&r)return r;throw{code:n.code,description:ii(n.code)}}).finally(()=>{e.m.clear(),dn(e.j),e.g=void 0}):(i=Ti(e,t),di(e,3,i,"",void 0,t).then(n=>{if(st(n.result),n.result===15859712&&n.session)return Fr(n.session);throw{code:n.result,description:ii(n.result)}})):lr({code:3237093383,description:"GridServer not initialized"})}function j(e,t){if(!e.serverAddress)return lr({code:3237093383,description:"Gridserver not initialized"});let i=Ti(e,t);return new Promise((n,r)=>{k.d("{6bae601}","{bbad3ce}",t),di(e,2,i,"",void 0,t).then(s=>{if(s.result==15859712)k.d("{6bae601}","{6206c13}",t),n();else{let o={code:s.result,description:ii(s.result),sessionId:t};k.e("{6bae601}","{4de47e3}",t,R(s.result)),r(o)}st(s.result)}).catch(s=>{const o={code:3237093384,description:ii(3237093384)};k.e("{6bae601}","{c4f620c}",s.message),k.e("{6bae601}","{94d55bb}",s,s.stack),gi(e.h,s,"sendDeleteRequestImpl","gridserver.ts"),r(o)})})}var X=class extends bs{constructor(e,t){super(),this.subSessionId="",this.P=new Map,this.R=!1,this.K=new Map,this.U=i=>{this.l.emit("TelemetryEvent",i)},this.T=i=>{this.l.emit("SessionUpdate",i),this.l.emit("ProgressUpdate",{sessionId:i.sessionId,subSessionId:i.subSessionId,queuePosition:i.queuePosition,eta:i.eta,state:i.progressState})},this.u=e,this.l=new Qn(t),q.isCallbackRegistered()||(this.R=!0,q.register(this.l.aa.bind(this.l))),this.h.Ga=this.U}initialize(e){var t;k.i("{6bae601}","{6802390}","Local");const i={deviceId:(t=e.deviceHashId)!==null&&t!==void 0?t:"",...e,clientStreamer:e.clientStreamer.toString()};super.init(i),e=this.h,e.sessionId="",e.subSessionId="",e.cmsId="",k.d("{6bae601}","{5af3344}")}uninitialize(){this.cancelSessionSetup(),this.R&&q.unregister(),this.l.removeAllListeners()}addListener(e,t){this.l.addListener(e,t)}removeListener(e,t){this.l.removeListener(e,t)}updateTelemetryEventIds(e){Te.setTelemetryEventIds(e)}getAllActiveSessions(){Le.getInstance().createSpan("GetSessionList",()=>(mi(this),ea(this)))}getSessionId(){var e;return(e=this.P.get(this.subSessionId))!==null&&e!==void 0?e:""}getSubSessionId(){return this.subSessionId}putOrPostSession(e,t,i){return Le.getInstance().createSpan(i?"PutSession":"PostSession",()=>(mi(this),ta(this,e,i)))}getSession(e,t){return Le.getInstance().createSpan("GetSession",()=>(mi(this),v(this,e,t)))}sendDeleteRequest(e){return Le.getInstance().createSpan("DeleteSession",()=>(mi(this),j(this,e)))}cancelSessionSetup(){var e,t;k.i("{6bae601}","{c73e640}"),(e=this.G)===null||e===void 0||e.abort(),(t=this.I)===null||t===void 0||t.abort(),this.I=this.G=void 0}getZoneName(){var e;return(e=this.zoneName)!==null&&e!==void 0?e:""}getZoneAddress(){var e;return(e=this.zoneAddress)!==null&&e!==void 0?e:""}getGpuType(){var e;return(e=this.gpuType)!==null&&e!==void 0?e:""}J(){return!!this.I}},U=class extends X{constructor(){super()}getAllActiveSessions(){window.setTimeout(()=>{k.d("{6bae601}","{b575263}"),this.l.emit("ActiveSessionsResult",{sessionList:[]})},1)}putOrPostSession(e){var t;return k.d("{6bae601}","{71c010f}"),Ur(this,ae(),(t=e.sessionId)!==null&&t!==void 0?t:"PassThruSessionId"),new Promise(i=>{window.setTimeout(()=>{var n;let r={sessionId:this.getSessionId(),subSessionId:this.getSubSessionId(),appId:parseInt(e.appId),state:"ready_for_connection",signalConnectionInfo:{ip:"",port:49100,protocol:"http"},mediaConnectionInfo:[],streamInfo:[],appLaunchMode:e.appLaunchMode?e.appLaunchMode:0,zoneName:this.getZoneName(),zoneAddress:this.getZoneAddress(),gpuType:this.getGpuType(),clientLocale:"",finalizedStreamingFeatures:(n=e.streamingFeatures)!==null&&n!==void 0?n:{}};if(this.serverAddress&&(r.signalConnectionInfo.ip=this.serverAddress),e.connectionInfo){r.mediaConnectionInfo=e.connectionInfo;for(const s of r.mediaConnectionInfo)s.usage===14&&(r.signalConnectionInfo.ip=s.ip,r.signalConnectionInfo.port=s.port,r.signalConnectionInfo.protocol=s.appLevelProtocol===5?"https":"http",r.signalConnectionInfo.resourcePath=s.resourcePath,k.d("{6bae601}","{c6b8e0f}",s.ip,s.port))}if(r.signalConnectionInfo.ip||k.e("{6bae601}","{a43f57e}"),e.monitorSettings)for(const s of e.monitorSettings)r.streamInfo.push({width:s.widthInPixels,height:s.heightInPixels,fps:s.framesPerSecond,sdrHdrMode:s.sdrHdrMode});else for(const s of e.streamParams)r.streamInfo.push({width:s.width,height:s.height,fps:s.fps});k.d("{6bae601}","{07dc276}",r.sessionId),i(r)},1)})}getSession(){return new Promise((e,t)=>{t({code:-1,description:"PassthruPollingNotSupported"})})}sendDeleteRequest(){return new Promise(e=>{e()})}updateAdState(){return-1}},c=A.Log,ee=A.Logger,te=A.performHttpRequest,W=A.TelemetryModule,de={fg:"Ragnarok",clientId:"62677554106929725",eventSchemaVer:"3.2"},ne=class extends Gt{constructor(e){super(e),this.name="Streamer_Start",this.gdprLevel="functional"}},oe=class extends Gt{constructor(e){super(e),this.name="Streamer_Exit",this.gdprLevel="functional",this.priority=!0}},me=class extends Gt{constructor(e){super(e),this.name="Streamer_InputDevice",this.gdprLevel="functional"}},we={VIDEO:"video",AUDIO:"audio"},qe={Unknown:0,ApproachingEntitlementTimeout:1,ApproachingIdleTimeout:2,ApproachingSessionMaxTimeLimit:3,ClearUserIdleTimeOut:4},ot={allowUnconfined:!1,preventNavigation:!1},wt=class{constructor(){this.g=1}};function Yv(e){if(!((e^15868672)>>8))return 256;let t=32769;switch(e){case 15859712:case 15867908:case 15868418:t=0;break;case 3237093894:case 3237093899:t=32776;break;case 3237093898:t=32772;break;case 3237093900:t=32773;break;case 3237093901:t=32770;break;case 15867910:t=1;break;default:c.d("{c00be32}","{233ad08}",R(e))}return t}function Xv(e){if(e.stopData){var t=Zv(e.stopData);if(t||t===0)return c.d("{c00be32}","{921626d}",t),ol(t)}if(e.nvstResult){switch(c.d("{c00be32}","{f30bc33}",e.nvstResult),e=e.nvstResult,t=15868672,e){case 2147680256:t=15868704;break;case 2147680257:t=15868705;break;case 2147680258:t=3237093635;break;case 2147680259:t=3237094152;break;case 2147680260:t=15868706;break;case 2147680262:t=15868707;break;case 2147680263:t=15868708;break;case 2147680264:t=15868736;break;case 2147680265:t=15868737;break;case 2147680266:t=15868738;break;case 2147680267:t=15868739;break;case 2147680268:t=15868741;break;case 2147680269:t=15868740;break;case 2147680270:t=15868742;break;case 2147680271:t=3237094147;break;case 2147680275:t=15868743;break;case 2147680277:t=15868709;break;case 2147680278:t=15868744;break;case 2147680279:t=15868710;break;case 2147680280:t=15868711;break;case 2147680281:t=15868712;break;case 2147680283:t=3237094155;break;case 2147680284:t=3237094156;break;case 2147680285:t=3237094157;break;case 2147680286:t=3237093678;break;case 2147680287:t=15868715;break;case 2147680288:t=15868716;break;case 2147680289:t=15868719;break;case 2147680300:t=15868688;break;case 2147680291:t=15868704;break;case 2147745794:t=3237093892;break;case 2147745796:t=3237094158;break;case 2147745797:t=3237093892;break;case 2147745803:t=3237093892;break;case 2147745804:t=3237094146;break;case 2147745805:t=3237094148;break;case 2147745806:t=3237094149;break;case 2147745807:t=3237094150;break;case 2148438786:t=15868718;break;default:c.d("{c00be32}","{094c45e}",R(e))}return t}return e.code?(c.d("{c00be32}","{6210ab0}",e.code),ol(e.code)):15868672}function ol(e){let t=15868672;switch(e){case 256:t=15868704;break;case 257:t=15868705;break;case 258:t=15868706;break;case 259:t=15868707;break;case 260:t=15868708;break;case 261:t=15868709;break;case 262:t=15868710;break;case 263:t=15868711;break;case 264:t=15868712;break;case 265:t=15868713;break;case 266:t=15868714;break;case 267:t=15868715;break;case 268:t=15868716;break;case 269:t=15868719;break;case 270:t=15868688;break;case 512:t=15868736;break;case 513:t=15868737;break;case 514:t=15868738;break;case 515:t=15868739;break;case 516:t=15868740;break;case 517:t=15868741;break;case 518:t=15868742;break;case 519:t=15868743;break;case 520:t=15868744;break;case 521:t=15868745;break;case 33025:t=3237094145;break;case 33026:t=3237094146;break;case 33027:t=3237094147;break;case 33028:t=3237094148;break;case 33029:t=3237094149;break;case 33030:t=3237094150;break;case 33031:t=3237094151;break;case 33032:t=3237094152;break;case 33034:t=3237094153;break;case 33035:t=3237094154;break;case 33040:t=3237094155;break;case 33041:t=3237094156;break;case 33042:t=3237094157;break;case 37634:t=15868718;break;case 32768:t=3237094158;break;case 768:t=15868717;break;case 0:t=15868752;break;default:c.d("{c00be32}","{1be40ed}",R(e))}return t}function Zv(e){if(2>e.length)return null;const t=atob(e);let i=0;const n=()=>{const r=256*t.charCodeAt(i)+t.charCodeAt(i+1);return i+=2,r};return n()==0?e.length<i+2?null:n():null}function Ai(){return ia||(ia=new eg),ia}function Si(e){e.h==="white"?e.g&&(e.g.clearColor(1,0,0,1),e.g.clear(e.g.COLOR_BUFFER_BIT),e.h="red"):e.g&&(e.g.clearColor(1,1,1,1),e.g.clear(e.g.COLOR_BUFFER_BIT),e.h="white")}var eg=class{constructor(){this.g=null,this.h=""}initialize(e,t){this.u=t,t="streamkit-latency-indicator";var i=document.getElementById(t);if(i&&i instanceof HTMLCanvasElement&&i.parentElement===e.parentElement)e=i;else{if(i)do t="streamkit-latency-indicator"+Math.round(1e4*Math.random()),i=document.getElementById(t);while(i);i=document.createElement("canvas"),i.id=t,i.style.position="fixed",_(this.u)?(i.style.bottom="env(safe-area-inset-bottom, 0)",i.style.right="max(24px, env(safe-area-inset-right, 0))"):(i.style.bottom="0",i.style.right="0"),i.style.width="40px",i.style.height="40px",i.style.zIndex="300",i.style.pointerEvents="none",e.insertAdjacentElement("afterend",i),e=i}this.j=e,this.j.style.display="block",this.g=this.j.getContext("webgl"),Si(this)}},ia,Re={},al="",Vt={type:"UNKNOWN",version:""},na=!1,ra=!0,dl=!1,ur=!0,Is=!0,Ts=!0,Pn=0,ln=0,un=0,Rs=!1,Ht=!0,jr=!1,sa=!0,Ki=!1,oa=!1,aa=!1,Gr=!1,da=!0,ca=!1,Br=!0,Ri=!0,Vr=!0,la=!0,ua=!0,$i=0,ha=!0,fa=!0,pa=!1,va={},Ct,hn,Hr,ga,ma,Aa,Wr,zr,Kr,$r,Sa,ya,qr,ba,Ea,cl,hr,wa,Ca,Ia,Ta,Ra,ka,Pa,Oa,Da,Ma,ll,La,ul,Na,xa,ks,Ps,_a,Fa,Ua,ja,Ga;function hl(e){if(e&&(e=Number.parseInt(e),!Number.isNaN(e)))return e}function fl(e){var t,i,n,r,s,o,d,u,l,h,p,y,N,G,E,D,z,Z,Q,ce,be,Me,xe,Je,Be,tt,gt,mt,dt,nt,Ke,Tt,Oe,ui,yi,ni,Xi,Gn,Bn,Vn,Hn,ls,uc,hc,fc,pc,vc,gc,mc,Ac,Sc,yc,bc,Ec,wc,Cc,Ic,Tc;if(c.i("{a112b01}","{02b2a8b}",JSON.stringify(e)),e.clientConfigOverride&&(al=e.clientConfigOverride),e.gxtOverrideData){var Zi=JSON.parse(e.gxtOverrideData);if(Zi.params)for(var hi of Zi.params)hi.name==="ragnarok"&&(Re=hi.value,Vt={type:"GXT",version:hi.version})}else e.remoteConfigData&&e.remoteConfigData.ragnarok&&(Re=JSON.parse(e.remoteConfigData.ragnarok),Vt={type:"RCONFIG",version:(Zi=e.remoteConfigData.version)!==null&&Zi!==void 0?Zi:""});if(e.isInternalUser&&(Ct=e.isInternalUser),e.overrideData){hi=new URLSearchParams(e.overrideData);let zt=new URLSearchParams;for(const[Ge,Rc]of hi.entries())zt.append(Ge.toLowerCase(),Rc);if(((t=zt.get("mode"))===null||t===void 0?void 0:t.toLowerCase())==="lean"?(na=!0,hn=Ts=Is=ur=ra=!1,Ct=Hr=!0):((i=zt.get("mode"))===null||i===void 0?void 0:i.toLowerCase())==="dev"&&(Ct=Hr=!0),t=Ge=>{Ge=zt.get(Ge);e:{if(Ge)switch(Ge.toLowerCase()){case"enable":case"on":case"1":case"true":Ge=!0;break e;case"disable":case"off":case"0":case"false":Ge=!1;break e}Ge=void 0}return Ge},Zi=Ge=>(Ge=zt.get(Ge),hl(Ge)),i=Ge=>{Ge=zt.get(Ge);e:{if(Ge&&(Ge=Number.parseFloat(Ge),!Number.isNaN(Ge)))break e;Ge=void 0}return Ge},hi=(Ge,Rc)=>{if(Ge=zt.get(Ge),Ge===null)return Rc;if(Ge)return Ge},dl=(ra=(n=t("log"))!==null&&n!==void 0?n:ra)&&((r=t("console"))!==null&&r!==void 0?r:dl),ur=(s=t("gamepad"))!==null&&s!==void 0?s:ur,Is=(o=t("webrtcstats"))!==null&&o!==void 0?o:Is,Ts=(d=t("statsupload"))!==null&&d!==void 0?d:Ts,hn=(u=t("mic"))!==null&&u!==void 0?u:hn,ga=(l=t("mousefilter"))!==null&&l!==void 0?l:ga,ma=(h=t("unadjustedmovement"))!==null&&h!==void 0?h:ma,Pn=(p=Zi("bitrate"))!==null&&p!==void 0?p:Pn,0<Pn&&100>=Pn&&(Pn*=1e3),Gr=(y=t("gamepadtest"))!==null&&y!==void 0?y:Gr,(n=zt.get("resolution"))&&(s=n.toLowerCase().split("x"),s.length==2?(r=parseInt(s[0]),s=parseInt(s[1]),r&&s?(ln=r,un=s):c.e("{a112b01}","{c87835d}",n)):c.e("{a112b01}","{c87835d}",n)),$i=(N=Zi("fps"))!==null&&N!==void 0?N:$i,Rs=(G=t("gamepadraf"))!==null&&G!==void 0?G:Rs,Aa=(E=Zi("gamepadpoll"))!==null&&E!==void 0?E:Aa,Ht=(D=t("advancedgestures"))!==null&&D!==void 0?D:Ht,jr=(z=t("forcetouchdevice"))!==null&&z!==void 0?z:jr,N=t("touch"),N!==void 0&&(Wr=N?2:0,jr=N),Ki=(Z=t("storetouch"))!==null&&Z!==void 0?Z:Ki,oa=(Q=t("storetouchgesture"))!==null&&Q!==void 0?Q:oa,sa=(ce=t("touchwarp"))!==null&&ce!==void 0?ce:sa,aa=(be=t("latency"))!==null&&be!==void 0?be:aa,zr=hi("deviceos",zr),Kr=hi("devicetype",Kr),$r=hi("clientstreamer",$r),Sa=hi("clienttype",Sa),ya=hi("clientplatformname",ya),qr=hi("clientid",qr),Z=zt.get("applaunchmode"),Z!==null&&(Wr=hl(Z)),da=(Me=t("rsdmm"))!==null&&Me!==void 0?Me:da,ca=(xe=t("rsdmmtoggle"))!==null&&xe!==void 0?xe:ca,(Je=t("ioswars"))===null||Je===void 0||Je||(ua=la=Br=Vr=Ri=!1),Ri=(Be=t("audioreset"))!==null&&Be!==void 0?Be:Ri,Br=(tt=t("sourcereset"))!==null&&tt!==void 0?tt:Br,Vr=(gt=t("autoplaychange"))!==null&&gt!==void 0?gt:Vr,ba=(mt=i("bitsperpixel"))!==null&&mt!==void 0?mt:ba,Ea=(dt=i("bitsperpixel1440p"))!==null&&dt!==void 0?dt:Ea,cl=(nt=t("1440p"))!==null&&nt!==void 0?nt:cl,Hr=(Ke=t("stutter"))!==null&&Ke!==void 0?Ke:Hr,zt.has("meta")){hr={};for(const Ge of zt.getAll("meta"))Me=Ge.split("~"),Me.length===2&&(hr[Me[0]]=Me[1])}wa=(Tt=t("haptics"))!==null&&Tt!==void 0?Tt:wa,Ca=(Oe=t("av1"))!==null&&Oe!==void 0?Oe:Ca,Ia=(ui=t("h265"))!==null&&ui!==void 0?ui:Ia,Ta=(yi=(Ge=>(Ge=zt.get(Ge),Ge=Ge?Ge.split(","):void 0,Ge))("codeclist"))!==null&&yi!==void 0?yi:Ta,Ct=(ni=t("internaluser"))!==null&&ni!==void 0?ni:Ct,Ra=(Xi=t("hdr"))!==null&&Xi!==void 0?Xi:Ra,ka=(Gn=zt.get("hdr10gparams"))!==null&&Gn!==void 0?Gn:ka,Pa=(Bn=t("sdr10"))!==null&&Bn!==void 0?Bn:Pa,ha=(Vn=t("hotkeys"))!==null&&Vn!==void 0?Vn:ha,Oa=(Hn=t("forcehotkeys"))!==null&&Hn!==void 0?Hn:Oa,Da=(ls=t("synthesizegamepadhid"))!==null&&ls!==void 0?ls:Da,Ma=(uc=t("synthesizedds4disabled"))!==null&&uc!==void 0?uc:Ma,ll=(hc=t("synthesizedds5disabled"))!==null&&hc!==void 0?hc:ll,La=(fc=t("synthesizedds4fromds5disabled"))!==null&&fc!==void 0?fc:La,ul=(pc=t("synthesizedds5fromds4disabled"))!==null&&pc!==void 0?pc:ul,Na=(vc=t("synthesizedds4fromgenericenabled"))!==null&&vc!==void 0?vc:Na,xa=(gc=t("synthesizedds5fromgenericenabled"))!==null&&gc!==void 0?gc:xa,ks=(mc=t("synthesizedds4allgamesenabled"))!==null&&mc!==void 0?mc:ks,Ps=(Ac=t("synthesizedds5allgamesenabled"))!==null&&Ac!==void 0?Ac:Ps,_a=(Sc=t("forceserverds4"))!==null&&Sc!==void 0?Sc:_a,Fa=(yc=t("forceserverds5"))!==null&&yc!==void 0?yc:Fa,Ua=(bc=zt.get("cursor"))!==null&&bc!==void 0?bc:Ua,ja=(Ec=t("pointerlockescape"))!==null&&Ec!==void 0?Ec:ja,fa=(wc=t("computepressure"))!==null&&wc!==void 0?wc:fa,Ga=(Cc=t("disableworkerws"))!==null&&Cc!==void 0?Cc:Ga,Re.useTelemetryV2=(Ic=t("usetelemetryv2"))!==null&&Ic!==void 0?Ic:Re.useTelemetryV2,pa=(Tc=t("rirecorder"))!==null&&Tc!==void 0?Tc:pa}$e(e)}function pl(){const e=bl();if(e){const t=e.destination.maxChannelCount;return e.close(),c.i("{d988e7f}","{fa78e0a}",t),t}return c.w("{d988e7f}","{d018fac}"),2}function tg(e,t){if(t.length==0)return e;class i{constructor(s,o){this.w=s,this.g=o,this.a=s/o}j(s){return .05>Math.abs(s.a-this.a)?s:s.a>this.a?new i(Math.floor(this.a/s.a*s.w),s.g):new i(s.w,Math.floor(s.a/this.a*s.g))}h(){return[this.w,this.g]}}t=t.map(r=>new i(r[0],r[1]));const n=new i(e[0],e[1]);e=t[0];for(let r=1;r<t.length;r++){let s=t[r];Math.abs(n.a-s.a)<Math.abs(n.a-e.a)&&(e=s)}return t=e.j(n),t.w>e.w?e.h():t.h()}function Os(e){return e[0]<e[1]?[e[1],e[0]]:e}function vl(e,t,i){var n=screen.width,r=screen.height,s=!!(i&1);const o=!!(i&2);var d=!!(i&4);if((d||i&8)&&(n=3840,r=2160),t&&0<t.length){[n,r]=Os([n,r]),o&&1366<=n&&e===0&&(n=1600,r=1200);const u=n/r,l=n*r;return n=t.filter(h=>120>h.frameRate),n.length&&(t=n),t.sort((h,p)=>{var y=h.resolution,N=p.resolution,G=Math.abs(y.width/y.height-u)-Math.abs(N.width/N.height-u);if(.05<Math.abs(G))return G;G=e===0?-1:1;const E=(e===1?1:-1)*(h.frameRate-p.frameRate);y=y.width*y.height,N=N.width*N.height;const D=y-N;return y<=l?N<=l?h.frameRate!==p.frameRate?E:G*D:-1:N<=l?1:D||E}),t[0]}if(t={resolution:{width:1280,height:720},frameRate:60},s){let[u,l]=Os([n,r]);2<u/l&&(t.resolution={width:1376,height:640})}else o?e!=0?t.resolution={width:1024,height:768}:([n]=Os([n,r]),t.resolution=1024>=n?{width:1024,height:768}:1366>n?{width:1112,height:834}:{width:1600,height:1200}):(s=[[1920,1200],[1920,1080],[1280,1024],[1600,1200]],d&&s.unshift([3840,2160]),d=[[1280,800],[1280,720],[1280,1024],[1024,768]],n=[n,r],n=tg(n,e==0?s:d),t.resolution={width:n[0],height:n[1]});return t}function gl(e){var t;let i=0;return Y(e)&&(i|=1),(e?e.os==="iPadOS":/^(?!.*chrome).*safari/i.test(navigator.userAgent)&&!Y()&&T())&&(i|=2),!((t=window.webapis)===null||t===void 0)&&t.productinfo&&window.webapis.productinfo.isUdPanelSupported()&&(i|=4),window.lge_webrtc_hevc_support&&(i|=8),i}function ml(){return getComputedStyle(document.documentElement)?(getComputedStyle(document.documentElement).getPropertyValue("--sat")||(document.documentElement.style.setProperty("--sat","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--sar","env(safe-area-inset-right)"),document.documentElement.style.setProperty("--sab","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--sal","env(safe-area-inset-left)")),{top:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sat")),left:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sal")),bottom:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),right:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sar"))}):{top:0,left:0,bottom:0,right:0}}function Ds(e,t){return 0>e?0:e>t?t:e}function Al(e){var t=ml();t.top=Math.max(t.top,21),t.bottom=Ds(t.bottom,10);let i={x:e.clientX,y:e.clientY},n=.5;return 0<t.top&&e.clientY-e.radiusY<t.top?(t=(t.top-(e.clientY-Math.min(e.radiusY,21)))/e.radiusY,t=Ds(t,1),n-=.5*t*t):0<t.bottom&&e.clientY+e.radiusY>window.innerHeight-t.bottom&&(t=(e.clientY+Math.min(e.radiusY,10)-(window.innerHeight-t.bottom))/e.radiusY,t=Ds(t,1),n+=.5*t*t),i.y=Ds(i.y-e.radiusY+2*n*e.radiusY,window.innerHeight),i}function Ba(e,t){let i=e;if(!t.kc)if(Re.offlineErrorsStreaming&&Re.offlineErrorsStreaming.includes(R(e)))i=15868418;else if(Re.offlineErrorsSessionSetup&&Re.offlineErrorsSessionSetup.includes(R(e)))i=15868417;else switch(e){case 3237093906:case 3237093899:i=15868418;break;case 3237089282:i=15868417}return i!==e&&c.i("{d988e7f}","{b84d4c8}",R(e),R(i)),i}function Va(e,t){let i=e;if(Re.sleepErrorsStreaming&&Re.sleepErrorsStreaming.includes(R(e)))i=15867908;else if(Re.sleepErrorsSessionSetup&&Re.sleepErrorsSessionSetup.includes(R(e)))i=15867909;else switch(e){case 3237093906:(_(t)||B(t))&&(i=15867908);break;case 3237094159:i=15867908;break;case 3237093701:case 3237093654:i=15867909}return i!==e&&c.i("{d988e7f}","{49e2182}",R(e),R(i)),i}function Sl(e,t){let i=!1;switch(e){case 3237093896:case 3237093897:case 3237093898:case 3237093906:case 3237093899:case 3237093901:case 15868418:case 3237094159:i=!0;break;case 15867908:_(t)&&(i=!0)}return i}function Ha(e,t){if(t)return!0;switch(e){case 15868706:case 15868714:case 15868742:case 15868744:case 15867910:return!0;default:return!1}}function Wa(e,t){return e*=t,2764800<=e&&4953600>e}function Ms(e){switch(e){case"H264":return"H264";case"H265":return"HEVC";case"AV1":return"AV1";default:return"UNKNOWN"}}function yl(e){var t;return e=ve(e)||J(e)||fe(e)||e.os==="Linux"||_(e),(t=Re.enableCpm)!==null&&t!==void 0?t:e}function za(e){return e!==void 0?e?"TRUE":"FALSE":"UNDEFINED"}function Ls(e){return e?"MANUAL":"NONE"}function ig(e){var t;return((t=Re.requireDS4TrackpadForAppIds)!==null&&t!==void 0?t:[]).indexOf(e)!==-1}function fr(e){return`${e.width.toFixed()}x${e.height.toFixed()}`}function Jr(e,t,i){try{const n=document.createElement("a");n.style.display="none";const r=URL.createObjectURL(new Blob(e,{type:i}));return n.href=r,n.download=t,document.body.appendChild(n),n.click(),URL.revokeObjectURL(r),document.body.removeChild(n),!0}catch(n){return c.e("{d988e7f}","{8d57ba9}",n),!1}}function bl(e){const t=window.AudioContext||window.webkitAudioContext||void 0;if(t)return e?new t({sampleRate:e}):new t;c.w("{d988e7f}","{b74c037}")}function ng(e,t){const i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(const r of i)if(e[r]!==t[r])return!1;return!0}function El(){var e;return!((e=globalThis.PointerEvent)===null||e===void 0||!e.prototype)}async function wl(e,t,i){var n;const r=new RTCPeerConnection;try{await r.setRemoteDescription({type:"offer",sdp:t}).catch(u=>{throw Error("Audio munging setRemoteDescription failed. "+u)});const s=await r.createAnswer();await r.setLocalDescription({type:"answer",sdp:(n=s.sdp)===null||n===void 0?void 0:n.replace("opus/48000/2","multiopus/48000/"+e).replace("useinbandfec=1",i)}).catch(u=>{throw Error("Audio munging setLocalDescription failed. "+u)});const o=r.getReceivers()[0];if(!o.getParameters)return c.w("{d988e7f}","{4be0bf6}"),2;const{codecs:d}=o.getParameters();if(d.length===1&&d[0].mimeType==="audio/multiopus"&&d[0].channels===e)c.i("{d988e7f}","{8919816}",e,d[0]);else throw Error("Audio munging failed "+d[0]);return e}catch(s){return c.e("{d988e7f}","{4984c00}",e,s),2}finally{r.close()}}async function rg(){let e=2;var t="minptime=10;useinbandfec=1;channel_mapping=0,4,1,2,3,5;num_streams=4;coupled_streams=2";const i=wl(6,`v=0
o=- 0 3 IN IP4 127.0.0.1
s=-
t=0 0
a=fingerprint:sha-256 A7:24:72:CA:6E:02:55:39:BA:66:DF:6E:CC:4C:D8:B0:1A:BF:1A:56:65:7D:F4:03:AD:7E:77:43:2A:29:EC:93
m=audio 9 UDP/TLS/RTP/SAVPF 100 101
c=IN IP4 0.0.0.0
a=rtcp-mux
a=sendonly
a=mid:audio
a=setup:actpass
a=ice-ufrag:ETEn
a=ice-pwd:OtSK0WpNtpUjkY4+86js7Z/l\r
a=rtpmap:100 multiopus/48000/6\r
a=fmtp:100 `+t+`\r
a=rtpmap:101 opus/48000/2
a=fmtp:101 minptime=10;useinbandfec=1
`,t);t="minptime=10;useinbandfec=1;channel_mapping=0,6,1,2,3,4,5,7;num_streams=5;coupled_streams=3",t=wl(8,`v=0
o=- 0 3 IN IP4 127.0.0.1
s=-
t=0 0
a=fingerprint:sha-256 A7:24:72:CA:6E:02:55:39:BA:66:DF:6E:CC:4C:D8:B0:1A:BF:1A:56:65:7D:F4:03:AD:7E:77:43:2A:29:EC:93
m=audio 9 UDP/TLS/RTP/SAVPF 100 101
c=IN IP4 0.0.0.0
a=rtcp-mux
a=sendonly
a=mid:audio
a=setup:actpass
a=ice-ufrag:ETEn
a=ice-pwd:OtSK0WpNtpUjkY4+86js7Z/l\r
a=rtpmap:100 multiopus/48000/8\r
a=fmtp:100 `+t+`\r
a=rtpmap:101 opus/48000/2
a=fmtp:101 minptime=10;useinbandfec=1
`,t),await Promise.all([i,t]).then(n=>{e=Math.max(Number(n[0]),Number(n[1]))}),c.i("{d988e7f}","{dc7ee29}",e)}function sg(e){if(!e)return 8;switch(e==null?void 0:e.bitDepth){case 1:return 10;case 0:return 8;default:return c.w("{d988e7f}","{6f291f9}",e.bitDepth),8}}function og(e){switch(e){case 1e3:return 3237101567;case 1001:return 3237101566;case 1002:return 3237101565;case 1003:return 3237101564;case 1005:return 3237101562;case 1006:return 3237093890;case 1007:return 3237101560;case 1008:return 3237101559;case 1009:return 3237101558;case 1010:return 3237101557;case 1011:return 3237101556;case 1012:return 3237101555;case 1013:return 3237101554;case 1014:return 3237101553;case 1015:return 3237101552;case 3e3:return 3237101551;case 3003:return 3237101550;case 3008:return 3237101549}return 4100<=e&&4999>=e?3237097472+(e-4e3):3237093890}function Ka(e,t){return Rn(new or(e,Re.connectivityCheckTimeout,!(!((3237093888^t)>>8)||t===3237089282)))}function $a(e){return e.getTransceivers().filter(t=>{var i;return((i=t.receiver.track)===null||i===void 0?void 0:i.kind)==="video"&&(t.direction==="recvonly"||t.direction==="sendrecv")})}function qa(e,t=!1){return t=t?Al(e):{x:e.clientX,y:e.clientY},{identifier:e.identifier,clientX:t.x,clientY:t.y,deltaX:0,deltaY:0}}function Cl(e,t,i){let n=!1;const r=t.changedTouches,s=xt(e.o,t.timeStamp);for(let o=0;o<r.length;o++){const d=r[o],u=e.h.findIndex(l=>l.identifier==d.identifier);u!=-1&&(n=!0,Si(Ai()),e.h.splice(u,1),e.h.length===0?(e.l!==0?(window.clearTimeout(e.l),e.l=0,i&&Kg(e.j,e.target,s,qa(d,!0),e.m)):(e.g===2||e.g===4)&&Ht&&pd(e.j,s),e.m=0,e.g=0):e.g===5?e.g=0:e.g===6&&(Ht&&vd(e.j),e.g=0))}br(e.j)&&n&&t.preventDefault()}var ag=class{constructor(e,t,i,n,r){this.target=e,this.videoAddEventListener=t,this.videoRemoveEventListener=i,this.j=n,this.o=r,this.h=[],this.g=this.m=this.l=0,this.D=s=>{let o=!1;const d=s.changedTouches,u=xt(this.o,s.timeStamp);for(let l=0;l<d.length;l++){const h=d[l];h.target===this.target&&(o=!0,Si(Ai()),this.h.length===0?(this.g=1,this.l=window.setTimeout(()=>{this.l=0,this.m===1&&(this.g=2,Ht&&Wg(this.j,this.target,u,qa(h)))},500)):this.g!==1&&(this.g===2||this.g===4?Ht&&pd(this.j,u):this.g===6&&Ht&&vd(this.j),this.g=0),this.h.push(qa(h)),this.h.length>this.m&&(this.m=this.h.length))}br(this.j)&&o&&s.preventDefault()},this.C=s=>{let o=!1;for(var d of this.h)d.deltaX=0,d.deltaY=0;d=s.changedTouches;const u=xt(this.o,s.timeStamp);let l=[];for(let y=0;y<d.length;y++){const N=d[y],G=this.h.findIndex(E=>E.identifier==N.identifier);if(G!=-1){o=!0;var h=this.h[G],p=N.clientX-h.clientX;h=N.clientY-h.clientY;let E=!1;this.l!==0?(10<Math.abs(p)||10<Math.abs(h))&&(window.clearTimeout(this.l),this.l=0,E=!0):E=!0,E&&(p={identifier:N.identifier,clientX:N.clientX,clientY:N.clientY,deltaX:p,deltaY:h},l.push(G),this.h[G]=p)}}0<l.length&&this.l===0&&this.g!==0&&(this.h.length===1?(this.g===1?this.g=3:this.g===2&&(this.g=4),Ht&&zg(this.j,this.target,u,this.h[0])):this.h.length===2?this.g===5?Ht&&this.j.scroll(this.target,u,this.h):this.g===6?Ht&&bu(this.j,this.h):this.g===1&&(0<this.h[0].deltaY*this.h[1].deltaY&&(Math.sign(this.h[0].deltaX)===Math.sign(this.h[1].deltaX)||10>Math.abs(this.h[0].deltaX)&&10>Math.abs(this.h[1].deltaX))?(this.g=5,Ht&&this.j.scroll(this.target,u,this.h)):(this.g=6,Ht&&bu(this.j,this.h))):this.g=0),br(this.j)&&o&&s.preventDefault()},this.s=s=>{Cl(this,s,!1)},this.v=s=>{Cl(this,s,!0)}}start(){const e={passive:!Ht};this.videoAddEventListener("touchstart",this.D,e),this.videoAddEventListener("touchmove",this.C,e),this.videoAddEventListener("touchcancel",this.s,e),this.videoAddEventListener("touchend",this.v,e)}stop(){if(this.videoRemoveEventListener("touchstart",this.D),this.videoRemoveEventListener("touchmove",this.C),this.videoRemoveEventListener("touchcancel",this.s),this.videoRemoveEventListener("touchend",this.v),this.h=[],this.l!==0&&(window.clearTimeout(this.l),this.l=0),this.m=0,Ht)switch(this.g){case 6:vd(this.j);break;case 2:case 4:pd(this.j,performance.now())}this.g=0}};function Il(e,t){e.clientX=t.pageX-e.j.nb,e.clientY=t.pageY-e.j.vertical,e.radiusX=t.radiusX,e.radiusY=t.radiusY}function Tl(e){const t=Al(e);e.h=.01<Math.abs(t.y-e.clientY),e.clientX=t.x,e.clientY=t.y}class dg{constructor(t,i,n){this.radiusY=this.radiusX=this.clientY=this.clientX=0,this.h=!1,this.identifier=t.identifier,this.g=i,this.j=n,Il(this,t),sa&&navigator.standalone?Tl(this):this.h=!1}update(t){Il(this,t),this.h&&Tl(this)}}class Ja{constructor(t,i,n,r,s){this.h=i,this.id=t.identifier,this.s=n,this.j=t.pageX,this.l=t.pageY,this.m=t.radiusX,this.o=t.radiusY,this.g=r,this.captureTs=s}}function Ns(e,t,i,n){var r,s=0;for(let G of t){if(40<s){c.e("{ec05004}","{2faaf33}",t.length-s);return}var o=(r=e.g.get(G.identifier))===null||r===void 0?void 0:r.g;if(o===void 0)c.e("{ec05004}","{960ee4f}",G.identifier);else{var d=e.m*G.clientX,u=e.o*G.clientY,l=e.m*G.radiusX,h=e.o*G.radiusY,p=65535+l,y=-h;if(h=65535+h,d<-l||d>p||u<y||u>h)switch(i){case 2:case 8:break;case 1:continue;case 4:continue;default:continue}d=Math.min(Math.max(d,0),65535),u=Math.min(Math.max(u,0),65535);e:{l=e.N,p=i,y=G.radiusX,h=G.radiusY;var N=n;if(40<=s){o=!1;break e}const E=18+16*s;l.j.setUint8(E,o),l.j.setUint8(E+1,p),l.j.setUint16(E+2,d,!1),l.j.setUint16(E+4,u,!1),l.j.setUint8(E+6,y),l.j.setUint8(E+7,h),et(N,l.j,E+8,!1,1e3),o=!0}if(!o){e.l+=t.length-s;break}s++}}s!=0&&(s>t.length?c.w("{ec05004}","{4e60a66}",s,t.length):(e=e.N,t=s,s=8+16*t,e.j.setUint16(14,s,!1),e.j.setUint16(16,t,!1),t=10,3<=e.h&&(s++,t--),s=new DataView(e.j.buffer,t,s),Lt(e),Lt(e,s)||c.e("{ec05004}","{56a8404}")))}function Rl(e,t,i){var n=performance.now(),r=xt(e.v,t.timeStamp);let s=!1,o=[];const d=t.changedTouches;let u=[];for(let l=0;l<d.length;l++){const h=d[l];if(h.target===e.target){let p=e.g.get(h.identifier);o.push(h.identifier),p&&(s=!0,Si(Ai()),p.update(h),u.push(p),Ki&&e.h.push(new Ja(h,p.g,i,n,t.timeStamp)))}}Ns(e,u,i,r);for(const l of o)i=e,n=l,(r=i.g.get(n))&&(i.g.delete(n),i.s.delete(r.g));Ki&&(e.L=e.g.size==0),br(e.j)&&s&&t.preventDefault()}var cg=class{constructor(e,t,i,n,r,s){this.target=e,this.videoAddEventListener=t,this.videoRemoveEventListener=i,this.N=n,this.j=r,this.v=s,this.o=this.m=0,this.F={nb:1,vertical:1},this.g=new Map,this.s=new Set,this.l=0,this.h=[],this.C=0,this.L=!0,this.K=o=>{const d=performance.now(),u=xt(this.v,o.timeStamp);let l=!1;this.j.lc(!1);const h=o.changedTouches;let p=[];for(let N=0;N<h.length;N++){const G=h[N];if(G.target===this.target){l=!0,Si(Ai());var y=G;let E=0;for(;this.s.has(E);)E++;let D=new dg(y,E,this.F);this.g.set(y.identifier,D),this.s.add(E),y=D,p.push(y),Ki&&this.h.push(new Ja(G,y.g,1,d,o.timeStamp))}}Ns(this,p,1,u),Ki&&oa&&this.g.size==8&&this.L&&(this.D(),this.M()),br(this.j)&&l&&o.preventDefault()},this.J=o=>{const d=performance.now(),u=xt(this.v,o.timeStamp);let l=!1;const h=o.changedTouches;let p=[];for(let y=0;y<h.length;y++){const N=h[y];if(N.target===this.target){let G=this.g.get(N.identifier);G&&(l=!0,G.update(N),p.push(G),Ki&&this.h.push(new Ja(N,G.g,4,d,o.timeStamp)))}}Ns(this,p,4,u),br(this.j)&&l&&o.preventDefault()},this.G=o=>{Rl(this,o,8)},this.I=o=>{Rl(this,o,2)},this.D=this.P.bind(this),this.M=this.O.bind(this)}P(){const e=this.h.length;if(e){var t=this.h[e-1].g-3e4,i=-1;for(let n=0;n<e&&this.h[n].g<t;n++)i=n;this.h.splice(0,i+1)}}O(){for(let e of this.h)c.d("{ec05004}","{3c6a946}",e.captureTs.toFixed(2),e.g.toFixed(2),e.id,e.h,e.s,e.j.toFixed(2),e.l.toFixed(2),e.m.toFixed(0),e.o.toFixed(0));this.h=[]}start(){this.l=0;const e={passive:!1};this.videoAddEventListener("touchstart",this.K,e),this.videoAddEventListener("touchmove",this.J,e),this.videoAddEventListener("touchcancel",this.G,e),this.videoAddEventListener("touchend",this.I,e),Ki&&(c.d("{ec05004}","{72764d2}",performance.now()),this.h=[],this.C=window.setInterval(this.D,6e4)),this.j.lc(!1)}stop(){Ki&&(this.C&&clearTimeout(this.C),this.D(),this.M()),this.g.size&&(Ns(this,Array.from(this.g.values()),8,performance.now()),this.g.clear(),this.s.clear()),this.l&&c.w("{ec05004}","{10858ae}",this.l);const e={passive:!1};this.videoRemoveEventListener("touchstart",this.K,e),this.videoRemoveEventListener("touchmove",this.J,e),this.videoRemoveEventListener("touchcancel",this.G,e),this.videoRemoveEventListener("touchend",this.I,e)}},Qr=new Map([["Escape",27],["Digit0",48],["Digit1",49],["Digit2",50],["Digit3",51],["Digit4",52],["Digit5",53],["Digit6",54],["Digit7",55],["Digit8",56],["Digit9",57],["Minus",189],["Equal",187],["Backspace",8],["Tab",9],["KeyQ",81],["KeyW",87],["KeyE",69],["KeyR",82],["KeyT",84],["KeyY",89],["KeyU",85],["KeyI",73],["KeyO",79],["KeyP",80],["BracketLeft",219],["BracketRight",221],["Enter",13],["ControlLeft",162],["KeyA",65],["KeyS",83],["KeyD",68],["KeyF",70],["KeyG",71],["KeyH",72],["KeyJ",74],["KeyK",75],["KeyL",76],["Semicolon",186],["Quote",222],["Backquote",192],["ShiftLeft",160],["Backslash",220],["KeyZ",90],["KeyX",88],["KeyC",67],["KeyV",86],["KeyB",66],["KeyN",78],["KeyM",77],["Comma",188],["Period",190],["Slash",191],["ShiftRight",161],["NumpadMultiply",106],["AltLeft",164],["Space",32],["CapsLock",20],["F1",112],["F2",113],["F3",114],["F4",115],["F5",116],["F6",117],["F7",118],["F8",119],["F9",120],["F10",121],["Pause",19],["ScrollLock",145],["Numpad7",103],["Numpad8",104],["Numpad9",105],["NumpadSubtract",109],["Numpad4",100],["Numpad5",101],["Numpad6",102],["NumpadAdd",107],["Numpad1",97],["Numpad2",98],["Numpad3",99],["Numpad0",96],["NumpadDecimal",110],["PrintScreen",42],["IntlBackslash",226],["F11",122],["F12",123],["NumpadEqual",187],["F13",124],["F14",125],["F15",126],["F16",127],["F17",128],["F18",129],["F19",130],["F20",131],["F21",132],["F22",133],["F23",134],["F24",135],["KanaMode",233],["Lang2",25],["Lang1",21],["IntlRo",194],["Convert",234],["NonConvert",235],["IntlYen",193],["NumpadComma",188],["NumpadEnter",13],["ControlRight",163],["NumpadDivide",111],["PrintScreen",42],["AltRight",165],["NumLock",144],["Pause",19],["Home",36],["ArrowUp",38],["PageUp",33],["ArrowLeft",37],["ArrowRight",39],["End",35],["ArrowDown",40],["PageDown",34],["Insert",45],["Delete",46],["MetaLeft",91],["OSLeft",91],["MetaRight",92],["OSRight",92],["Lang2",25],["Lang1",21],["NumpadClear",12],["NumpadClearEntry",12]]),lg=new Map([["HanjaMode",25],["HangulMode",21]]),kl=new Map([["1",{vkCode:49,shift:!1}],["2",{vkCode:50,shift:!1}],["3",{vkCode:51,shift:!1}],["4",{vkCode:52,shift:!1}],["5",{vkCode:53,shift:!1}],["6",{vkCode:54,shift:!1}],["7",{vkCode:55,shift:!1}],["8",{vkCode:56,shift:!1}],["9",{vkCode:57,shift:!1}],["0",{vkCode:48,shift:!1}],["!",{vkCode:49,shift:!0}],["@",{vkCode:50,shift:!0}],["#",{vkCode:51,shift:!0}],["$",{vkCode:52,shift:!0}],["%",{vkCode:53,shift:!0}],["^",{vkCode:54,shift:!0}],["&",{vkCode:55,shift:!0}],["*",{vkCode:56,shift:!0}],["(",{vkCode:57,shift:!0}],[")",{vkCode:48,shift:!0}],["-",{vkCode:189,shift:!1}],["_",{vkCode:189,shift:!0}],["=",{vkCode:187,shift:!1}],["+",{vkCode:187,shift:!0}],[",",{vkCode:188,shift:!1}],["<",{vkCode:188,shift:!0}],[".",{vkCode:190,shift:!1}],[">",{vkCode:190,shift:!0}],[";",{vkCode:186,shift:!1}],[":",{vkCode:186,shift:!0}],["/",{vkCode:191,shift:!1}],["?",{vkCode:191,shift:!0}],["`",{vkCode:192,shift:!1}],["~",{vkCode:192,shift:!0}],["[",{vkCode:219,shift:!1}],["{",{vkCode:219,shift:!0}],["\\",{vkCode:220,shift:!1}],["|",{vkCode:220,shift:!0}],["]",{vkCode:221,shift:!1}],["}",{vkCode:221,shift:!0}],["'",{vkCode:222,shift:!1}],['"',{vkCode:222,shift:!0}],[" ",{vkCode:32,shift:!1}],["A",{vkCode:65,shift:!0}],["B",{vkCode:66,shift:!0}],["C",{vkCode:67,shift:!0}],["D",{vkCode:68,shift:!0}],["E",{vkCode:69,shift:!0}],["F",{vkCode:70,shift:!0}],["G",{vkCode:71,shift:!0}],["H",{vkCode:72,shift:!0}],["I",{vkCode:73,shift:!0}],["J",{vkCode:74,shift:!0}],["K",{vkCode:75,shift:!0}],["L",{vkCode:76,shift:!0}],["M",{vkCode:77,shift:!0}],["N",{vkCode:78,shift:!0}],["O",{vkCode:79,shift:!0}],["P",{vkCode:80,shift:!0}],["Q",{vkCode:81,shift:!0}],["R",{vkCode:82,shift:!0}],["S",{vkCode:83,shift:!0}],["T",{vkCode:84,shift:!0}],["U",{vkCode:85,shift:!0}],["V",{vkCode:86,shift:!0}],["W",{vkCode:87,shift:!0}],["X",{vkCode:88,shift:!0}],["Y",{vkCode:89,shift:!0}],["Z",{vkCode:90,shift:!0}],["a",{vkCode:65,shift:!1}],["b",{vkCode:66,shift:!1}],["c",{vkCode:67,shift:!1}],["d",{vkCode:68,shift:!1}],["e",{vkCode:69,shift:!1}],["f",{vkCode:70,shift:!1}],["g",{vkCode:71,shift:!1}],["h",{vkCode:72,shift:!1}],["i",{vkCode:73,shift:!1}],["j",{vkCode:74,shift:!1}],["k",{vkCode:75,shift:!1}],["l",{vkCode:76,shift:!1}],["m",{vkCode:77,shift:!1}],["n",{vkCode:78,shift:!1}],["o",{vkCode:79,shift:!1}],["p",{vkCode:80,shift:!1}],["q",{vkCode:81,shift:!1}],["r",{vkCode:82,shift:!1}],["s",{vkCode:83,shift:!1}],["t",{vkCode:84,shift:!1}],["u",{vkCode:85,shift:!1}],["v",{vkCode:86,shift:!1}],["w",{vkCode:87,shift:!1}],["x",{vkCode:88,shift:!1}],["y",{vkCode:89,shift:!1}],["z",{vkCode:90,shift:!1}]]);function et(e,t,i,n,r=1){const s=Math.floor(e*r)&4294967295;e=Math.floor(e/4294967296*r),n?(t.setUint32(i,s,!0),t.setUint32(i+4,e,!0)):(t.setUint32(i,e,!1),t.setUint32(i+4,s,!1))}function Dt(e){const t=e.h.getUint8(e.g);return e.g++,t}function ug(e,t=!1){return e.h.getUint16(e.g,t??!1)}function at(e,t=!1){return t=ug(e,t),e.g+=2,t}function hg(e,t=!1){return e.h.getUint32(e.g,t??!1)}function xs(e,t=!1){return t=hg(e,t),e.g+=4,t}function fg(e,t=!1){var i=e.h;e=e.g;let n;return t?(t=i.getUint32(e,!0),n=i.getUint32(e+4,!0)):(n=i.getUint32(e,!1),t=i.getUint32(e+4,!1)),4294967296*n+t}function pr(e,t=!1){return t=fg(e,t),e.g+=8,t}var Pl=class{constructor(e){this.g=0,this.h=e}reset(){this.g=0}done(){return this.g===this.h.byteLength}left(){return this.h.byteLength-this.g}};function Qa(e){return e.h.byteLength-e.g}function Mt(e,t){e.h.setUint8(e.g,t),e.g+=1}function Rt(e,t){e.h.setUint16(e.g,t,void 0),e.g+=2}function _s(e,t){e.h.setUint32(e.g,t,void 0),e.g+=4}function Ol(e,t){e.h.setInt16(e.g,t,void 0),e.g+=2}function Fs(e,t){et(t,e.h,e.g,!1,1e3),e.g+=8}var Dl=class{constructor(e){this.h=e,this.g=0}get j(){return this.g}reset(){this.g=0}};function Ml(e,t,i){var n,r;if(e.length>t.length+23)t=e;else{e="";const s=(r=(n=document.currentScript)===null||n===void 0?void 0:n.src)!==null&&r!==void 0?r:i;s&&(i=s.lastIndexOf("/"),i!==-1&&(e+=s.substring(0,i+1))),t="importScripts('"+(e+t)+"');"}return t=URL.createObjectURL(new Blob([t],{type:"text/javascript"})),i=new Worker(t),URL.revokeObjectURL(t),i}function Yr(e){return 6<=e&&9>=e}var Ya;const pg=(Ya=document.currentScript)===null||Ya===void 0?void 0:Ya.src;function Xa(){return{flags:0,xpos:0,ypos:0,data1:0,data2:0,windowHandle:0,vwheel:0,hwheel:0,captureTs:0}}function vg(e,t){switch(e){case 3:case 4:return 14;case 8:case 9:case 10:case 5:case 7:return 26;case 12:return 24;case 18:return 2;case 17:return e=1,Yr(t.id)&&(e+=9),e;default:return 0}}function vr(e,t){return t>e.j?t-e.j:0}var gg=class{constructor(e){this.h=e,this.j=0,this.buffer=new ArrayBuffer(8388608),this.g=new Dl(new DataView(this.buffer)),this.initialized=!1,this.l=[],this.h=e}initialize(e){_s(this.g,1314280009),Mt(this.g,1),Mt(this.g,0),Ol(this.g,0),this.params=e,this.j=kt(this.h),this.initialized=!0,c.d("{5eeca93}","{46ee72b}")}},mg=class{constructor(e,t){this.h=!0,this.m=e,this.o=t}l(e){var t=e.data;if(t.input)e:{e=this.m,t=t.input,e.playbackBuffer===void 0&&(e.playbackBuffer=new ed(1150,"input_channel_v1"));let o="input_channel_v1";for(let d=0;d<t.length;d++){var i=t[d],n=i.header.packetId,r=void 0;switch(i.header.packetId){case 12:var s=i.data.index;_l(e,s)&&(r=s);break;case 17:s=i.data.id,jl(e,s)&&(r=s)}if(r!==void 0&&(o="input_channel_partially_reliable"),r=qi(e,e.playbackBuffer,Ag(n),!1,r),!r)break e;switch(n){case 4:case 3:i=i.data,xl(r,n,i.keycode,i.flags,i.captureTs);break;case 8:case 9:i=i.data,td(r,n,i.data1,i.captureTs);break;case 7:case 5:n=i.data,Xr(e,r,0,i.header.packetId==5,n.xpos,n.ypos,n.captureTs,!0);break;case 10:n=i.data,Ll(r,n.vwheel,n.captureTs);break;case 12:n=i.data,js(r,n.index,n.buttons,n.trigger,n.axes,n.captureTs,n.bitmap);break;case 18:i=i.data,n=i.id,i=i.control,r.setUint32(0,18,!0),r.setUint8(4,n),r.setUint8(5,i),r.setUint32(6,1);break;case 17:n=i.data,Yr(n.id)&&(i=n.data,Ul(r,n.id,i.ds4Btns,i.triggers,i.axes))}}fn(e,e.playbackBuffer,o)}else t.result?c.d("{5eeca93}","{6ab9f7d}",t.result):t.log&&c.d("{59381ac}","{0b0c6f9}",t.log)}j(){}stop(){var e;(e=this.g)===null||e===void 0||e.terminate()}start(){var e;if(this.playbackBuffer){var t={start:{playbackBuffer:this.playbackBuffer,loop:this.h,absStreamBeginTs:performance.timeOrigin+this.o.g}};c.d("{5eeca93}","{8a97b19}"),(e=this.g)===null||e===void 0||e.postMessage(t)}}initialize(e){if(8>e.buffer.byteLength)return c.e("{5eeca93}","{fbe135e}"),!1;var t=new DataView(e.buffer,0,8);const i=t.getUint32(0),n=t.getInt8(4);if(t=t.getInt8(5),i!=1314280009||n!=1||t!=0)return c.e("{5eeca93}","{9946103}"),!1;try{this.g=Ml(`
function g(a){const c=a.h.getUint8(a.g);a.g++;return c}function m(a){var c=a.h.getUint16(a.g,!1);a.g+=2;return c}function r(a){var c=a.h.getUint32(a.g,!1);a.g+=4;return c}function v(a){var c=a.h,n=a.g;let e;e=c.getUint32(n,!1);c=c.getUint32(n+4,!1);a.g+=8;return 4294967296*e+c}function y(a,c){if(!(c>a.h.byteLength-a.g)){var n=new z(new DataView(a.h.buffer,a.h.byteOffset+a.g,c));c=a.g+c;0<=c&&c<=a.h.byteLength&&(a.g=c);return n}}var z=class{constructor(a){this.g=0;this.h=a}done(){return this.g===this.h.byteLength}};const B=self;function C(a,c){return 0<c?a.g+c:0}async function D(a,c,n){const e=n-(performance.timeOrigin+performance.now()-a.absStreamBeginTs);0<e&&await new Promise(b=>setTimeout(b,e));0<c.length&&B.postMessage({input:c})}
async function E(a,c,n=!1){do{a.g=performance.timeOrigin+performance.now()-a.absStreamBeginTs;const q=new z(c);let w=[],u=0;for(;!q.done();){var e=y(q,16);if(void 0===e)return B.postMessage({log:"{76ef155}16{0da0ef8}"+(q.h.byteLength-q.g)}),!1;var b=e;e=v(b)/1E3;var d=r(b);b=r(b);e={recordedTs:e,packetId:d,size:b};b=y(q,e.size);if(void 0===b)return B.postMessage({log:"{fbf3a80}"+e.size+"{0da0ef8}"+(q.h.byteLength-q.g)}),!1;var f=void 0;d=a;switch(e.packetId){case 3:case 4:var l=b;b=m(l);f=m(l);var h=
m(l);d=C(d,v(l)/1E3);f={keycode:b,flags:f,scancode:h,captureTs:d};break;case 8:case 9:case 10:case 5:case 7:var k=b;b=m(k);f=m(k);h=m(k);l=m(k);var x=m(k),p=r(k),A=m(k),t=m(k);d=C(d,v(k)/1E3);f={flags:b,xpos:f,ypos:h,data1:l,data2:x,windowHandle:p,vwheel:A,hwheel:t,captureTs:d};break;case 12:p=b;b=m(p);f=m(p);h=m(p);l=m(p);x=[0,0,0,0];for(k=0;4>k;k++){A=k;t=p;const F=t.h.getInt16(t.g,!1);t.g+=2;x[A]=F}d=C(d,v(p)/1E3);f={index:b,bitmap:f,buttons:h,trigger:l,axes:x,captureTs:d};break;case 18:d=g(b);
b=g(b);f={id:d,control:b};break;case 17:if(f=void 0,d=g(b),6<=d&&9>=d){f=[0,0,0,0];for(h=0;4>h;h++)f[h]=g(b);h=[0,0,0];h[0]=g(b);h[1]=g(b);h[2]=g(b);l=[0,0];l[0]=g(b);l[1]=g(b);f={id:d,data:{ds4Btns:h,axes:f,triggers:l}}}}(d=f)?(b=a.g+e.recordedTs,0<u&&b>u&&(await D(a,w,u),w=[]),w.push({header:e,data:d}),u=b):B.postMessage({log:"{20d711f}"+e.packetId})}await D(a,w,u)}while(n);return!0}
async function G(a){var c=H;a.start&&(a=a.start,c.absStreamBeginTs=a.absStreamBeginTs,c={result:await E(c,a.playbackBuffer,a.loop)},B.postMessage(c))}class I{constructor(){this.g=this.absStreamBeginTs=0}}let H=new I;B.onmessage=async a=>{G(a.data)};

//# sourceMappingURL=inputplaybackworker.js.map
`,"inputplaybackworker.js",pg),this.g.onmessage=this.l.bind(this),this.g.onerror=this.j.bind(this)}catch(r){return c.e("{5eeca93}","{cb06694}",r.message),!1}return this.playbackBuffer=new DataView(e.buffer,8,e.buffer.byteLength-8),this.h=e.loop,!0}};class Za extends DataView{constructor(t,i,n,r){super(t,i,n),this.shift=0,this.setUint8=(s,o)=>super.setUint8(s+this.shift,o),this.setUint16=(s,o,d)=>super.setUint16(s+this.shift,o,d),this.setUint32=(s,o,d)=>super.setUint32(s+this.shift,o,d),this.setInt8=(s,o)=>super.setInt8(s+this.shift,o),this.setInt16=(s,o,d)=>super.setInt16(s+this.shift,o,d),this.setInt32=(s,o,d)=>super.setInt32(s+this.shift,o,d),this.setFloat32=(s,o,d)=>super.setFloat32(s+this.shift,o,d),this.setFloat64=(s,o,d)=>super.setFloat64(s+this.shift,o,d),this.shift=r??0}}class ed{constructor(t,i){this.j=new DataView(new ArrayBuffer(t)),this.g=new Dl(this.j),this.o=i,this.g.reset(),t=this.g,t.g+=9}get h(){return this.g}get m(){return this.o}get l(){return this.g.j-9}data(){return new DataView(this.j.buffer,9,this.l)}}function Ag(e){switch(e){case 3:case 4:return 18;case 8:case 9:return 18;case 10:return 22;case 5:case 7:return e==5?26:22;case 12:return 38;case 18:return 10;case 17:return 72;default:return 0}}function Lt(e,t,i=!0,n="input_channel_v1"){var r,s;if(n!="input_channel_partially_reliable"&&0<e.g.h&&(t=e.U(t)),t===void 0)return!1;if(e.G&&n=="input_channel_v1"&&!((r=e.P)===null||r===void 0)){if(r.initialized)e:{var o=new Pl(t);const G=vr(r,kt(r.h));for(;!o.done();){var d=Dt(o);switch(d){case 36:pr(o);break;case 33:case 34:d=d==33?at(o):o.left();var u=o,l=d;if(l>u.left())u=void 0;else{var h=new Pl(new DataView(u.h.buffer,u.h.byteOffset+u.g,l));l=u.g+l,0<=l&&l<=u.h.byteLength&&(u.g=l),u=h}if(u===void 0){c.e("{5eeca93}","{8400b62}",d,o.left());break e}h=r,l=u,d=G;var p=void 0;switch(u=xs(l,!0),u){case 3:case 4:p={keycode:0,flags:0,scancode:0,captureTs:0},p.keycode=at(l),p.flags=at(l),p.scancode=at(l),p.captureTs=vr(h,pr(l)/1e3);break;case 8:case 9:p=Xa(),p.data1=Dt(l),p.flags=Dt(l),p.windowHandle=xs(l),p.captureTs=vr(h,pr(l)/1e3);break;case 10:p=Xa(),p.hwheel=at(l),p.vwheel=at(l),p.flags=at(l),p.windowHandle=xs(l),p.captureTs=vr(h,pr(l)/1e3);break;case 5:case 7:p=u==5;var y=Xa();y.xpos=at(l),y.ypos=at(l),y.flags=at(l),p&&(y.data1=at(l),y.data2=at(l)),y.windowHandle=xs(l),y.captureTs=vr(h,pr(l)/1e3),p=y;break;case 12:const E={index:0,bitmap:0,buttons:0,trigger:0,axes:[0,0,0,0],captureTs:0};at(l,!0),E.index=at(l,!0),E.bitmap=at(l,!0),at(l,!0),E.buttons=at(l,!0),E.trigger=at(l,!0);for(let D=0;4>D;D++){p=E.axes,y=D;var N=l;const z=N.h.getInt16(N.g,!0);N.g+=2,p[y]=z}at(l,!0),at(l,!0),at(l,!0),E.captureTs=vr(h,pr(l,!0)/1e3),p=E;break;case 13:at(l);break;case 18:h=Dt(l),l=Dt(l),p={id:h,control:l};break;case 17:if(p=void 0,h=Dt(l),Yr(h)){for(p={ds4Btns:[0,0,0],triggers:[0,0],axes:[0,0,0,0]},Dt(l),Dt(l),Dt(l),y=0;4>y;y++)p.axes[y]=Dt(l);p.ds4Btns[0]=Dt(l),p.ds4Btns[1]=Dt(l),p.ds4Btns[2]=Dt(l),p.triggers[0]=Dt(l),p.triggers[1]=Dt(l),p={id:h,data:p}}}if(p===void 0?(c.d("{5eeca93}","{e255bfc}",u),d=void 0):d={header:{recordedTs:d,size:vg(u,p),packetId:u},data:p},u=d,u===void 0)break;switch(h=d=r,l=u.header,Fs(h.g,l.recordedTs),_s(h.g,l.packetId),_s(h.g,l.size),u.header.packetId){case 4:case 3:h=d,l=u.data,Rt(h.g,l.keycode),Rt(h.g,l.flags),Rt(h.g,l.scancode),Fs(h.g,l.captureTs);break;case 8:case 9:case 7:case 5:case 10:h=d,l=u.data,Rt(h.g,l.flags),Rt(h.g,l.xpos),Rt(h.g,l.ypos),Rt(h.g,l.data1),Rt(h.g,l.data2),_s(h.g,l.windowHandle),Rt(h.g,l.vwheel),Rt(h.g,l.hwheel),Fs(h.g,l.captureTs);break;case 12:for(h=d,l=u.data,Rt(h.g,l.index),Rt(h.g,l.bitmap),Rt(h.g,l.buttons),Rt(h.g,l.trigger),p=0;4>p;p++)Ol(h.g,l.axes[p]);Fs(h.g,l.captureTs);break;case 18:h=d,l=u.data,Mt(h.g,l.id),Mt(h.g,l.control);break;case 17:if(h=d,l=u.data,Mt(h.g,l.id),Yr(l.id)){for(l=l.data,p=0;4>p;p++)Mt(h.g,l.axes[p]);Mt(h.g,l.ds4Btns[0]),Mt(h.g,l.ds4Btns[1]),Mt(h.g,l.ds4Btns[2]),Mt(h.g,l.triggers[0]),Mt(h.g,l.triggers[1])}}d.l.push(u);break;default:c.e("{5eeca93}","{0028fe1}",d);break e}}}}if(r=window.performance.now(),o=e.V,o.da?(bd(o),o=!1):o=!0,!o)return!1;o=!1,2<e.h&&i&&(9>t.byteOffset?c.w("{57a6a4d}","{0fc6121}"):(t=new DataView(t.buffer,t.byteOffset-9,9+t.byteLength),t.setUint8(0,35),et(kt(e.L),t,1,!1,1e3)));try{let G=performance.now();switch(n){case"input_channel_partially_reliable":(s=e.m)===null||s===void 0||s.send(t);break;case"input_channel_v1":e.D.send(t);break;default:throw Error(`Invalid input channel ${n}`)}xh(e.W,performance.now()-G);const E=window.performance.now();e.o.fd+=1,t=E-r,5<t&&(e.o.hd+=1),10<t&&(e.o.gd+=1),o=!0}catch(G){G.stack&&!G.stack.includes("Could not send data")&&(c.e("{57a6a4d}","{7a6bf7c}",G),Us(e)&&e.C.Aa(G,"sendinput exception","{57a6a4d}.ts",0,0,!0))}return o}function td(e,t,i,n){e.setUint32(0,t,!0),e.setUint8(4,i),e.setUint8(5,0),e.setUint32(6,0),et(n,e,10,!1,1e3)}function Ll(e,t,i){e.setUint32(0,10,!0),e.setUint16(4,0,!1),e.setUint16(6,t,!1),e.setUint16(8,0,!1),e.setUint32(10,0),et(i,e,14,!1,1e3)}function Nl(e,t,i){const n=e.s(22);Ll(n,-t,i);try{Lt(e,n)}catch(r){c.e("{57a6a4d}","{3d81a57}",r),e.C.Aa(r,"send mousewheel exception","{57a6a4d}.ts",0,0,!0)}}function Xr(e,t,i,n,r,s,o=0,d=!1){let u=7,l=e.J.Qa,h=e.J.Ma;return n&&(u=5,e.G&&!d?(r=e.T(r,e.J.Qa),s=e.T(s,e.J.Ma),l=h=65535):d&&(l=h=65535)),e=0,u==5&&(e=4),t.setUint32(i,u,!0),t.setUint16(i+4,r,!1),t.setUint16(i+6,s,!1),t.setUint16(i+8,0,!1),t.setUint32(i+10+e,0,!1),et(o,t,i+14+e,!1,1e3),e&&(t.setUint16(i+10,l,!1),t.setUint16(i+12,h,!1)),i+(n?26:22)}function Us(e){return e.D.readyState==="open"&&(!e.m||e.m.readyState==="open")}function id(e,t,i,n=0){const r=e.s(26);Xr(e,r,0,!0,t,i,n);try{Us(e)&&Lt(e,r)}catch(s){c.e("{57a6a4d}","{dba1265}",s),e.C.Aa(s,"send CursorPos exception","{57a6a4d}.ts",0,0,!0)}}function xl(e,t,i,n,r=0){e.setUint32(0,t,!0),e.setUint16(4,i,!1),e.setUint16(6,n,!1),e.setUint16(8,0,!1),et(r,e,10,!1,1e3)}function yt(e,t,i,n,r=0){if(t!==4&&t!==3)c.e("{57a6a4d}","{66e269d}",t);else{var s=e.s(18);xl(s,t,i,n,r),Lt(e,s)}}function Sg(e,t){e.v=window.setTimeout(()=>{e.v=0,Lt(e)},t)}function fn(e,t,i){if(t.l!==0){i=i??t.m;var n=t.data();Lt(e,n,!0,i),t.g.reset(),e=t.g,e.g+=9}}function qi(e,t,i,n=!1,r){var s=i+(n?1:3)+(r===void 0?0:4);if(!(s>Qa(t.g)&&(fn(e,t),s>Qa(t.g)))){if(r!==void 0){var o;s=(o=e.N.get(r))!==null&&o!==void 0?o:1,e.N.set(r,(s+1)%65536),e=s,Mt(t.h,38),Mt(t.h,r),Rt(t.h,e)}return n?Mt(t.h,34):(Mt(t.h,33),Rt(t.h,i)),i>Qa(t.g)?i=void 0:(n=new Za(t.j.buffer,t.g.j,i),t=t.g,t.g+=i,i=n),i}}function js(e,t,i,n,r,s=0,o=0){e.setUint32(0,12,!0),e.setUint16(4,26,!0),e.setUint16(6,t,!0),e.setUint16(8,o,!0),e.setUint16(10,20,!0),e.setUint16(12,i,!0),e.setUint16(14,n,!0),e.setInt16(16,r[0],!0),e.setInt16(18,r[1],!0),e.setInt16(20,r[2],!0),e.setInt16(22,r[3],!0),e.setUint16(24,0,!0),e.setUint16(26,85,!0),e.setUint16(28,0,!0),et(s,e,30,!0,1e3)}function _l(e,t){return e.m?(t=1<<t,(t&e.R)==t):!1}function Fl(e,t,i){const n=qi(e,e.l,10,!0);n&&(n.setUint32(0,18,!0),n.setUint8(4,t),n.setUint8(5,i),n.setUint32(6,1),fn(e,e.l))}function Ul(e,t,i,n,r){e.setUint32(0,17,!0),e.setUint8(4,t),e.setUint8(5,4),e.setUint8(6,0),t=7,e.setUint8(t,1),e.setUint8(t+1,r[0]),e.setUint8(t+2,r[1]),e.setUint8(t+3,r[2]),e.setUint8(t+4,r[3]),e.setUint8(t+5,i[0]),e.setUint8(t+6,i[1]),e.setUint8(t+7,i[2]),e.setUint8(t+8,n[0]),e.setUint8(t+9,n[1]),e.setUint16(t+10,0,!0),e.setUint8(t+12,0),e.setInt16(t+13,0,!0),e.setInt16(t+15,0,!0),e.setInt16(t+17,0,!0),e.setInt16(t+19,0,!0),e.setInt16(t+21,0,!0),e.setInt16(t+23,0,!0),e.setUint32(t+25,0,!0),e.setUint8(t+29,0),e.setUint8(t+30,11),e.setUint8(t+31,0),e.setUint8(t+32,0),e.setUint8(t+33,0),t+=34,new Uint8Array(e.buffer,e.byteOffset+t,72-t).fill(0)}function jl(e,t){var i;return e.m&&(i=e.S[t])!==null&&i!==void 0?i:!1}var yg=class{constructor(e,t,i,n,r,s,o,d,u,l){if(this.h=this.M=0,this.buffer=new ArrayBuffer(1150),this.Z=new DataView(this.buffer),this.l=new ed(309,"input_channel_v1"),this.ja=new ArrayBuffer(658),this.j=new DataView(this.ja),this.ha=new ArrayBuffer(100),this.v=0,this.U=this.ea,this.s=this.$,this.I=[],this.N=new Map,this.R=0,this.S=[],this.G=!1,this.T=(h,p)=>Math.round(h/p*65535),this.L=d,this.V=e,this.g=t,this.W=r,this.J=n,this.D=s,this.D.onmessage=h=>{if(h=new DataView(h.data),this.h===0){let p=h.getUint16(0,!0);p==526?(this.O=this.ba.bind(this),this.h=h.getUint16(2,!0)):(this.O=this.K.bind(this),this.h=p),this.h==2?this.g.m=!0:2<this.h&&(this.g.m=!0,this.U=this.fa,this.s=this.aa),c.i("{57a6a4d}","{68c4654}",this.h)}else this.O(h,0)},this.m=u,this.C=o,this.o=i,this.O=this.K.bind(this),this.j.setUint8(9,34),this.j.setUint32(10,24,!0),this.m&&(this.N=new Map,this.F=new ed(325,"input_channel_partially_reliable"),l))for(this.R=l.Qe,e=0;64>e;e++)t=BigInt(1)<<BigInt(e),(t&l.Re)==t&&(this.S[e]=!0);(this.G=pa)&&(this.P=new gg(this.L),this.P.initialize({gg:!0}))}ba(e,t){var i=e.getUint16(t,!0);switch(i){case 267:this.K(e,t+2);break;default:switch(t=i&255,t){case 32:case 33:case 34:case 35:case 36:case 255:switch(i=t,i){case 34:switch(i=e.getUint32(1,!0),i){case 267:this.K(e,5);break;case 17:if(t=e.getUint8(5),Yr(t)){i=t-6;var n=e.getUint8(8),r=e.getUint8(9);if(n===5&&(r&1)===1){t=e.getUint8(12)<<8;const s=e.getUint8(13)<<8;for(const o of this.I){e=o,n=t,r=s;const d=e.O.get(i);d!==void 0&&ru(e,d,n,r)}}else c.w("{57a6a4d}","{d8b7bec}",n,r,t)}else c.w("{57a6a4d}","{6135ec1}",t);break;default:c.w("{57a6a4d}","{25be6a3}",i)}break;default:c.d("{57a6a4d}","{ba4ff6a}",i)}break;default:c.w("{57a6a4d}","{aea35b8}",i)}}}K(e,t){var i=e.getUint16(t,!0);if(i==1)if(i=e.getUint16(t+2,!0),6>i)c.e("{57a6a4d}","{1527181}",i);else{6<i&&c.w("{57a6a4d}","{78db114}",i),i=e.getUint16(t+4,!0);var n=e.getUint16(t+6,!0);e=e.getUint16(t+8,!0);for(const o of this.I){t=o;var r=n,s=e;const d=t.ac.get(i);d!==void 0&&ru(t,d,r,s)}}else c.w("{57a6a4d}","{c7cf6da}",i)}ea(e){this.v!==0&&(window.clearTimeout(this.v),this.v=0);var t=performance.now();this.M=t;for(var i=1,n=0;n<this.g.h;){i+=2;var r=this.g.g[n].gb;if(0<r){i+=19;for(var s=0;s<r;s++)i+=1+(this.g.g[n+s].eb?26:22);n+=r}else i+=this.g.g[n].eb?26:22,n++}i+=e?2+e.byteLength:0,i>this.buffer.byteLength?(i=new DataView(new ArrayBuffer(i)),this.o.dd++):i=new DataView(this.buffer,0,i),i.setUint8(0,255);var o=1;for(n=0;n<this.g.h;){if(r=o,o+=2,s=this.g.g[n],0<s.gb){var d=i,u=n,l=t,h=this.g.g[u],p=o;o+=19;for(let y=0;y<h.gb;++y){const N=this.g.g[u+y];d.setUint8(o,N.eb?26:22),o++,o=Xr(this,d,o,N.eb,N.x,N.y,N.captureTimestamp)}u=p,p=o-p,h=h.qc,d.setUint8(u,32),d.setUint16(u+1,p,!1),et(l,d,u+3,!1,1e3),et(h,d,u+11,!1,1e3),n+=s.gb}else o=Xr(this,i,o,s.eb,s.x,s.y,s.captureTimestamp),n++;i.setUint16(r,o-r-2)}if(this.g.j=0,e)for(i.setUint16(o,e.byteLength),o+=2,t=0;t<e.byteLength;t++)i.setUint8(o+t,e.getUint8(t));return i}fa(e){var t;if(e&&e.buffer!=this.buffer)return Lt(this),e;this.v!==0&&(window.clearTimeout(this.v),this.v=0),this.M=performance.now();for(var i=0,n=-1,r=0;r<this.g.h;r++)0<this.g.g[r].gb?(i+=9,n=this.g.g[r].gb):n===0&&(i+=9),i+=3+(this.g.g[r].eb?26:22),n--;if(i+=(t=e==null?void 0:e.byteLength)!==null&&t!==void 0?t:0,t=9+i,t>this.buffer.byteLength){if(t=new DataView(new ArrayBuffer(t),t-i,i),this.o.dd++,e)for(i=t.byteLength-e.byteLength,n=0;n<e.byteLength;n++)t.setUint8(i+n,e.getUint8(n))}else t=new DataView(this.buffer,this.buffer.byteLength-i,i);for(e=0,i=-1,n=0;n<this.g.h;n++)r=this.g.g[n],0<r.gb?(i=r.gb,t.setUint8(e,36),et(r.qc,t,e+1,!1,1e3),e+=9):i===0&&(t.setUint8(e,36),et(0,t,e+1,!1,1e3),e+=9),t.setUint8(e,33),t.setUint16(e+1,r.eb?26:22),e=Xr(this,t,e+3,r.eb,r.x,r.y,r.captureTimestamp),i--;return this.g.j=0,t}$(e){return new Za(this.ha,0,e)}aa(e){e+=1;const t=this.buffer.byteLength-e;return e=new Za(this.buffer,t,e,1),this.Z.setUint8(t,34),e}sendTextInput(e){let t=0,i=new DataView(e,0,e.byteLength),n=new ArrayBuffer(1021);for(;t<e.byteLength;){let s;if(1016>=e.byteLength-t)s=e.byteLength-t;else{s=t+1016;var r=!1;for(let o=0;4>o;o++)if((i.getUint8(s)&192)!=128){r=!0;break}else s--;if(r)s-=t;else{c.e("{57a6a4d}","{938b0d3}");break}}r=new DataView(n,0,s+5),r.setUint8(0,34),r.setUint32(1,23,!0),new Uint8Array(n).set(new Uint8Array(e,t,s),5),t+=s,Lt(this,r,!1)}}stop(){var e;if(0<this.D.bufferedAmount&&c.w("{57a6a4d}","{5e5b9e5}",this.D.bufferedAmount),this.m&&0<this.m.bufferedAmount&&c.w("{57a6a4d}","{3a88bc1}",this.m.bufferedAmount),this.G&&!((e=this.P)===null||e===void 0)){var t,i,n;try{const s=(i=(t=e.params)===null||t===void 0?void 0:t.fileName)!==null&&i!==void 0?i:"inputrecordfile";if(Jr([e.buffer.slice(0,e.g.j)],`${s}.dat`,"application/octet-stream"),!((n=e.params)===null||n===void 0)&&n.gg){var r=e.l;for(const d of r)d.header.recordedTs=Math.floor(1e3*d.header.recordedTs),d.data.captureTs&&(d.data.captureTs=Math.floor(1e3*d.data.captureTs));const o=JSON.stringify(e.l);Jr([o],`${s}-events.json`,"application/json")}}catch(s){c.e("{5eeca93}","{45fa32c}",s)}}}get ga(){return this.h}get da(){return this.M}vb(e){const t=qi(this,this.l,38,!0);t&&(js(t,0,0,0,nd([0,0,0,0]),0,e),fn(this,this.l))}Wc(e,t,i,n,r,s,o){3>this.h||!(e=_l(this,t)&&this.F?qi(this,this.F,38,!1,t):qi(this,this.l,38))||(s=xt(this.L,s),js(e,t,i,n,nd(r),s,o))}$b(e,t,i,n,r=0){const s=qi(this,this.l,38,!0);s&&(js(s,i,e,t,nd(n),0,r),fn(this,this.l))}Vc(){3>this.h||(Lt(this),fn(this,this.l),this.F&&fn(this,this.F))}Rc(){}yg(e){const t=qi(this,this.l,6,!0);t&&(t.setUint32(0,13,!0),t.setUint16(4,e?1:0,!1),fn(this,this.l))}eg(e){Fl(this,4>e?e+6:0,1)}Jf(e){Fl(this,4>e?e+6:0,3)}Tc(e,t,i,n,r){if(!(3>this.h)&&(t=4>t?t+6:0,e=jl(this,t)&&this.F?qi(this,this.F,72,!1,4+t):qi(this,this.l,72))){let s=0;const o=!!(i&4),d=!!(i&2),u=!!(i&8),l=!!(i&1);o||d||u||l?l?s=u?1:o?7:0:d?s=u?3:o?5:4:u?s=2:o&&(s=6):s=8,Ul(e,t,[s|(i&16384?16:0)|(i&4096?32:0)|(i&8192?64:0)|(i&32768?128:0),0|(i&256?1:0)|(i&512?2:0)|(n&255?4:0)|(n&65280?8:0)|(i&32?16:0)|(i&16?32:0)|(i&64?64:0)|(i&128?128:0),0|(i&65536?1:0)|(i&131072?2:0)],[n&255,(n&65280)>>8],[127.5*(r[0]+1),127.5*(r[1]+1),127.5*(r[2]+1),127.5*(r[3]+1)])}}},bg=class{constructor(){this.m=!1,this.j=0,this.l=Array(36);for(let e=0;e<this.g.length;e++)this.l[e]={eb:!1,x:0,y:0,captureTimestamp:0,gb:0,qc:0}}get g(){return this.l}get h(){return this.j}};function nd(e){return[Math.round(32767.5*(e[0]+1))-32768,Math.round(32767.5*(-e[1]+1))-32768,Math.round(32767.5*(e[2]+1))-32768,Math.round(32767.5*(-e[3]+1))-32768]}var Gl=class{constructor(e){this.g=e}enable(){this.g.Dc=!0}disable(){this.g.Dc=!1}updateInput(e,t,i){this.g.Dc&&(Si(Ai()),this.g.Ud=e,this.g.Vd=t,this.g.Td=i,this.g.Wd=!0)}};class Eg{constructor(t){this.buttons=t.Hb(t.ca),this.axes=t.Gb(t.ca),this.triggers=t.Ib(t.ca),this.timestamp=performance.now()}}const Bl={startDelay:0,duration:0,weakMagnitude:0,strongMagnitude:0};function Vl(e,t){return ld||(ld=new Pg(e,t)),ld}function On(e){var t,i,n=(i=(t=Aa)!==null&&t!==void 0?t:Re.gamepadPollInterval)!==null&&i!==void 0?i:4;e.ea=n;var r,s;n=(s=(r=wa)!==null&&r!==void 0?r:Re.allowHaptics)!==null&&s!==void 0?s:!0,e.allowHaptics=n;var o,d;r=(d=(o=Da)!==null&&o!==void 0?o:Re.synthesizeGamepadHid)!==null&&d!==void 0?d:!0,e.N=r}function rd(e,t){var i,n;On(e),t=t??0,ks&&(t|=1),Ps&&(t|=2),e.N&&t?(e.F=(i=ks)!==null&&i!==void 0?i:!!(t&1),e.P=(n=Ps)!==null&&n!==void 0?n:!!(t&2),gr(e,!0)):(e.F=!1,e.P=!1)}function gr(e,t=!1){var i=!1;if(e.g.Dc&&!e.g.ob)e.g.ob?i=!1:(c.i("{515a922}","{132d93a}",e.g.Mb),e.g.ob=!0,e.s={xd:"Nvidia Virtual Gamepad",state:0,buttons:0,triggers:0,axes:[]},sd(e,e.g.Mb,!1),i=!0);else if(!e.g.Dc&&e.g.ob)e:if(e.g.ob){c.i("{515a922}","{98ac7c2}",e.g.Mb),e.g.ob=!1,Wl(e);var n=e.g.Mb;for(var r of e.h)if(r&&r.Ca==1&&r.ia===n){i=!1;break e}i=od(e,n)}else i=!1;for(r=navigator.getGamepads(),n=0;n<r.length;n++){let d=r[n];if(d)if(Zl(e,d,n)){var s=e,o=d;s.h[n].ca=o,s.hapticsSupported=s.hapticsSupported||dd(o),es(s),t&&(i=e.h[n],s=i.Ca,o=pn(e,d),s!==o&&(s===1?(od(e,i.ia),i.Ca=o,i.ia=Ji(e,o),cd(e,i)):(eu(e,i),i.Ca=o,i.ia=Ji(e,o),sd(e,n,Xl(d)))),i=!0)}else Ar(e,n,!0),Yl(e,d,n)&&(i=!0);else Ar(e,n,!0)&&(i=!0)}if(i){e.vb();for(const d of e.h)(d==null?void 0:d.Ca)==2&&cd(e,d)}e.R=!0}function wg(e,t){On(e),e.qa=_a||(t&4)!=0,e.Ta=Fa||(t&2)!=0,gr(e,!0)}function Cg(e){On(e),e.aa=!0,gr(e,!0)}function sd(e,t,i){t=e.g.ob&&t===e.g.Mb?e.g.Mb:e.h[t].ia,e.j|=4>t?1<<t:0,t=4>t?1<<t+8:0,e.j=i?e.j|t:e.j&~t}function Hl(e){const t=e.buttons,i=e.triggers;return e=e.axes,"A:"+(4096&t?"1":"0")+"_B:"+(8192&t?"1":"0")+"_X:"+(16384&t?"1":"0")+"_Y:"+(32768&t?"1":"0")+"_LB:"+(256&t?"1":"0")+"_LSB:"+(64&t?"1":"0")+"_RB:"+(512&t?"1":"0")+"_RSB:"+(128&t?"1":"0")+"_LT:"+(255&i?"1":"0")+"_RT:"+(65280&i?"1":"0")+"_DU:"+(1&t?"1":"0")+"_DD:"+(2&t?"1":"0")+"_DL:"+(4&t?"1":"0")+"_DR:"+(8&t?"1":"0")+"_ST:"+(16&t?"1":"0")+"_BA:"+(32&t?"1":"0")+"_LS:"+(2<=e.length&&(e[0]===2||e[1]===2)?"1":"0")+"_RS:"+(e.length!==4||e[2]!==2&&e[3]!==2?"0":"1")}function Wl(e){if(e.s){for(const t of e.v)vf(t,e.s.xd,"0","0",0,!1,!0,e.s.state,Hl(e.s));e.s=void 0}}function od(e,t){return t===e.g.Mb&&e.g.ob?!1:(e.j&=~(4>t?1<<t:0),e.j&=~(4>t?1<<t+8:0),!0)}function Ji(e,t){let i=[];for(let n of e.h)n&&n.Ca==t&&(i[n.ia]=!0);for(e=0;i[e];)e++;return e}function zl(e,t){var i;for(let n of e.h){if(!n)continue;let r=n.ca;ad(e,r)&&(n.Ca===1?t.Wc(r.index,n.ia,0,0,[0,0,0,0],performance.now(),e.j,r.id):(i=t.Tc)===null||i===void 0||i.call(t,r.index,n.ia,0,0,[0,0,0,0],performance.now(),e.j,r.id))}t.Vc()}function mr(e,t){if(zl(e,t),e.l.delete(t),e.l.size==0&&(e.D=!1,On(e),es(e),ur)){for(const i of e.l)zl(e,i);e.windowRemoveEventListener("gamepadconnected",e.ba),e.windowRemoveEventListener("gamepaddisconnected",e.da),Zr(e)}}function Dn(e,t){e.l.add(t),e.l.size==1&&(e.D=!0,On(e),es(e),ur&&(e.windowAddEventListener("gamepadconnected",e.ba),e.windowAddEventListener("gamepaddisconnected",e.da),Zr(e),gr(e,!0)))}function ad(e,t){return!!(t.mapping=="standard"||e.Z||e.W||ql(e,t)||Jl(t)||Ql(e,t))}function Kl(e,t,i=!1){return e.R||(t|=2),i&&(t|=1),t}function Mn(e,t,i){return{xd:i,state:e.h[t.index]?e.h[t.index].Fa.state:Kl(e,0),buttons:e.h[t.index]?e.h[t.index].Fa.buttons:0,triggers:e.h[t.index]?e.h[t.index].Fa.triggers:0,axes:e.h[t.index]?e.h[t.index].Fa.axes:[]}}function pn(e,t){if(!e.N)return 1;if(e=e.ra&&e.F&&e.qa&&!e.aa){const i=Na,n=xa;if(!((t.id.includes("Vendor: 054c")||t.id.includes("Wireless Controller")&&t.id.includes("054c")||i||n)&&18<=t.buttons.length)||i||n)return 1;const r=t.id.includes("Product: 09cc")||t.id.includes("Product: 05c4")||t.id.includes("Product: 0ba0")||t.id.includes("Wireless Controller")&&t.id.includes("09cc");if(t=(t.id.includes("Product: 0ce6")||t.id.includes("Product: 0df2")||n)&&!La,e&&(r||t||i))return 2}return 1}function $l(e,t){const i=pn(e,t);return{ca:t,mc:!0,Ca:i,Hb:e.U,Ib:e.V,Gb:e.T,Fa:Mn(e,t,"Standard Gamepad"),ia:Ji(e,i)}}function ql(e,t){return!e.ja&&t.mapping!="standard"&&t.id.includes("Vendor: 054c")&&t.id.includes("Product: 0ce6")}function Jl(e){return e.mapping!="standard"&&e.id.includes("Vendor: 045e")&&e.id.includes("Product: 0b13")}function Ql(e,t){return e.M&&t.mapping!="standard"&&t.id.includes("Vendor: 045e")&&t.id.includes("Product: 0b12")}function Ig(e,t){if(e.Z)return $l(e,t);if(e.W){var i=pn(e,t);return{ca:t,mc:!0,Ca:i,Hb:e.Ea,Ib:e.V,Gb:e.Ba,Fa:Mn(e,t,"Standard Gamepad"),ia:Ji(e,i)}}return e.ma?null:t.mapping!="standard"||!t.id.includes("Vendor: 0955")||e.oa||e.na?t.id.includes("Vendor: 045e")&&(t.id.includes("Product: 0b13")||t.id.includes("Product: 0b20")||t.id.includes("Product: 0b05")||t.id.includes("Product: 02e0")||t.id.includes("Product: 02fd"))?(i=pn(e,t),{ca:t,mc:!0,Ca:i,Hb:e.U,Ib:e.V,Gb:e.T,Fa:Mn(e,t,"Standard Gamepad"),zg:!0,ia:Ji(e,i)}):t.mapping=="standard"?$l(e,t):ql(e,t)?(i=pn(e,t),{ca:t,mc:!1,Ca:i,Hb:e.za.bind(e),Ib:e.S.bind(e,3,4),Gb:e.ga,Fa:Mn(e,t,"Dual Sense Gamepad"),ia:Ji(e,i)}):Jl(t)?(i=pn(e,t),{ca:t,mc:!1,Ca:i,Hb:e.La.bind(e),Ib:e.S.bind(e,3,4),Gb:e.ga,Fa:Mn(e,t,"Xbox Series Gamepad"),ia:Ji(e,i)}):Ql(e,t)?(i=pn(e,t),{ca:t,mc:!1,Ca:i,Hb:e.Pa.bind(e),Ib:e.S.bind(e,2,5),Gb:e.ya,Fa:Mn(e,t,"Xbox Series Wired Gamepad"),ia:Ji(e,i)}):(c.e("{515a922}","{be4bfd9}",t),null):(i=pn(e,t),{ca:t,mc:!0,Ca:i,Hb:e.U,Ib:e.Ka,Gb:e.T,Fa:Mn(e,t,"Nvidia Shield Gamepad"),ia:Ji(e,i)})}function Yl(e,t,i){if(ad(e,t)){var n=Ig(e,t);if(n){e.hapticsSupported=e.hapticsSupported||dd(n.ca),es(e);const o=e.j;var r=e.h[i],s=e.o;const d=Xl(t);return e.h[i]=n,e.C[i]===void 0&&(e.C[i]=0),r&&Zl(e,t,i)?e.h[i].ia=r.ia:(e.o==0&&(e.gamepadPollInterval=e.ea,Zr(e)),e.o++,n.Ca===2?(cd(e,n),e.O.set(n.ia,i)):(sd(e,i,d),e.ac.set(n.ia,i))),t=o!==e.j,r=r?"Changing":"Adding",t?c.i("{515a922}","{96051ae}",r,i,d,n.ca.id):s!=e.o&&c.i("{515a922}","{98be0dd}",r,i,n.ca.id),t}for(s of e.l)s.Rc(t);return Ar(e,i)}for(n of e.l)n.Rc(t);return Ar(e,i)}function Ar(e,t,i=!1,n){let r=e.h[t];if(r){c.i("{515a922}","{1b26b8a}",t,r.ca.id);const s=r.Ca,o=e.G[t];if(o){const d=performance.now()-o.timestamp;if(3e3<=d&&o.axes.some(u=>.5<Math.abs(u))){c.w("{515a922}","{fde5612}",d,o.axes.join());for(const u of e.v)vt(u,"GamepadStuck",r.ca.id,d.toString(),o.axes.join())}}if(i){const[d,u]=Tg(r.ca.id);for(const l of e.v)vf(l,r.Fa.xd,d,u,r.ca.index,r.ca.g?0<r.ca.g.length:!1,n??Rg(e,r.ca.index),r.Fa.state,Hl(r.Fa))}if(delete e.h[t],delete e.C[t],delete e.G[t],e.hapticsSupported=kg(e),es(e),e.o--,e.o==0&&(e.gamepadPollInterval=100,Zr(e)),s===2)eu(e,r),e.O.delete(r.ia);else return e.ac.delete(r.ia),od(e,r.ia)}return!1}function Zr(e){e.I!=0&&(clearInterval(e.I),e.I=0),e.I=e.D&&!Rs?window.setInterval(e.xa,e.gamepadPollInterval):0}function Tg(e){let t=["-1","-1"];return(e=/Vendor:[ ]+([\w\d]+).+Product:[ ]+([\w\d]+)/.exec(e))&&3<=e.length&&(t=[e[1],e[2]]),t}function Xl(e){return e.id.includes("Xbox")||e.id.includes("xinput")}function dd(e){var t;return((t=e.vibrationActuator)===null||t===void 0?void 0:t.type)=="dual-rumble"}function es(e){var t,i;e.J=e.D&&e.hapticsSupported;var n=e.J,r;if(e.ha!=n&&(e.ha=n,e.allowHaptics))for(const s of e.l)(r=s.yg)===null||r===void 0||r.call(s,n);if(!e.J){n=navigator.getGamepads();for(let s of n)s&&(e.K[s.index]=0,e.L[s.index]=0,(i=(t=s.vibrationActuator)===null||t===void 0?void 0:t.playEffect)===null||i===void 0||i.call(t,"dual-rumble",Bl))}}function Zl(e,t,i){var n,r;return t.id!=null&&t.id==((r=(n=e.h[i])===null||n===void 0?void 0:n.ca)===null||r===void 0?void 0:r.id)}function cd(e,t){var i;switch(t.Ca){case 3:c.e("{515a922}","{ea001a4}",t.ca.id);break;case 2:for(const n of e.l)(i=n.eg)===null||i===void 0||i.call(n,t.ia);break;default:c.e("{515a922}","{36eeed4}",t.ca.id)}}function Rg(e,t){let i=!1;for(const n of e.h)if(n){t===n.ca.index&&(i=!0);break}return i}function kg(e){let t=!1;for(let i of e.h)i&&(t=t||dd(i.ca));return t}function eu(e,t){var i;switch(t.Ca){case 3:c.e("{515a922}","{2b2d286}",t.ca.id);break;case 2:for(const n of e.l)(i=n.Jf)===null||i===void 0||i.call(n,t.ia);break;default:c.e("{515a922}","{fafe5f9}",t.ca.id)}}function tu(e){switch(Number.parseFloat((e??0).toFixed(5))){case .71429:return 4;case-.42857:return 8;case-1:return 1;case .14286:return 2;case 1.28571:return 0;case 1:return 5;case-.71429:return 9;case .42857:return 6;case-.14286:return 10;default:return 0}}function iu(e,t){return(0>t?1:0)|(0<t?2:0)|(0>e?4:0)|(0<e?8:0)|0}function nu(e,t,i,n){e.buttons|=t,e.triggers|=i,e.axes.length===0?e.axes=[n[0],n[1],n[2],n[3]]:(e.axes[0]=e.axes[0]==2||e.axes[0]!==n[0]?2:e.axes[0],e.axes[1]=e.axes[1]==2||e.axes[1]!==n[1]?2:e.axes[1],e.axes[2]=e.axes[2]==2||e.axes[2]!==n[2]?2:e.axes[2],e.axes[3]=e.axes[3]==2||e.axes[3]!==n[3]?2:e.axes[3])}function Gs(e,t){e:{for(let i=0;i<e.m.length;i++){const n=e.m[i];if(n.Eb===t.Eb&&n.Jb===t.Jb&&n.Kb===t.Kb&&n.Ga===t.Ga){t=i;break e}}t=-1}t!==-1&&e.m.splice(t,1)}function ru(e,t,i,n){if(e.J){var r=e.h[t];if(r){let l=r.ca;if(l)if(i!=0||n!=0){var s=performance.now(),o=s-e.$[t];if(e.K[t]=i/65535,e.L[t]=n/65535,!r.zg||500<o){e.$[t]=s;var d,u;(u=(d=l.vibrationActuator)===null||d===void 0?void 0:d.playEffect)===null||u===void 0||u.call(d,"dual-rumble",{startDelay:0,duration:1e3,weakMagnitude:e.L[t],strongMagnitude:e.K[t]})}}else e.$[t]=performance.now(),e.K[t]=0,e.L[t]=0,(o=(s=l.vibrationActuator)===null||s===void 0?void 0:s.playEffect)===null||o===void 0||o.call(s,"dual-rumble",Bl)}}}function su(e){return On(e),gr(e),e.j}var Pg=class{constructor(e,t){var i,n;this.l=new Set,this.v=new Set,this.I=this.o=this.j=0,this.gamepadPollInterval=100,this.ea=4,this.K=[],this.L=[],this.$=[],this.ha=this.J=this.hapticsSupported=!1,this.allowHaptics=!0,this.D=!1,this.ta=new Set,this.R=this.ja=this.na=this.oa=this.M=this.Z=this.W=this.ma=!1,this.maxSchedulingDelay=0,this.m=[],this.P=this.F=this.N=!1,this.qa=!0,this.aa=this.Ta=!1,this.ac=new Map,this.O=new Map,this.windowAddEventListener=t&&t.windowAddEventListener?t.windowAddEventListener.bind(window):window.addEventListener.bind(window),this.windowRemoveEventListener=t&&t.windowRemoveEventListener?t.windowRemoveEventListener.bind(window):window.removeEventListener.bind(window),this.gamepadPollInterval=100,this.ba=this.sa.bind(this),this.da=this.va.bind(this),this.xa=this.fa.bind(this),this.h=[],this.G=[],this.C=[],t=e.os;const r=(n=(i=e.osVersion)!==null&&i!==void 0?i:e.osVer)!==null&&n!==void 0?n:"";this.W=(e=(t=="iOS"||t=="iPadOS")&&e.browser=="Safari")&&r.startsWith("13"),this.Z=e&&r.startsWith("14"),this.ma=e&&r=="12-",this.M=t=="ChromeOS",this.oa=t=="WebOS",this.na=t=="Tizen",this.ja=t=="Android",this.g={Mb:0,Dc:!1,ob:!1,Ud:0,Vd:0,Td:[],Wd:!1},this.Ua=new Gl(this.g),On(this),this.ra=!Ma,rd(this),c.d("{515a922}","{b0c674b}")}vb(e,t){if(e)e.vb(t??this.j);else for(const i of this.l)i.vb(t??this.j)}sa(e){Yl(this,e.gamepad,e.gamepad.index)&&this.vb()}va(e){Ar(this,e.gamepad.index,!0)&&this.vb()}U(e){return e=e.buttons,(e[0].value?4096:0)|(e[1].value?8192:0)|(e[2].value?16384:0)|(e[3].value?32768:0)|(e[4].value?256:0)|(e[5].value?512:0)|(e[8]&&e[8].value?32:0)|(e[9]&&e[9].value?16:0)|(e[10]&&e[10].value?64:0)|(e[11]&&e[11].value?128:0)|(e[12]&&e[12].value?1:0)|(e[13]&&e[13].value?2:0)|(e[14]&&e[14].value?4:0)|(e[15]&&e[15].value?8:0)|(e[16]&&e[16].value?65536:0)|(e[17]&&e[17].value?131072:0)|0}V(e){var t,i;e=e.buttons;let n=Math.round(255*((t=e[6])===null||t===void 0?NaN:t.value));return(Math.round(255*((i=e[7])===null||i===void 0?NaN:i.value))&255)<<8|n&255}Ka(e){var t,i;e=e.buttons;let n=Math.round(255*((t=e[7])===null||t===void 0?NaN:t.value));return(Math.round(255*((i=e[6])===null||i===void 0?NaN:i.value))&255)<<8|n&255}S(e,t,i){return(Math.round(127.5*(i.axes[t]+1))&255)<<8|Math.round(127.5*(i.axes[e]+1))&255}T(e){return e.axes}Ba(e){return[e.axes[0],-e.axes[1],e.axes[2],-e.axes[3]]}ga(e){return[e.axes[0],e.axes[1],e.axes[2],e.axes[5]]}ya(e){return[e.axes[0],e.axes[1],e.axes[3],e.axes[4]]}Ea(e){var t,i,n,r,s,o;let d=e.buttons;return e=e.axes,(!((t=d[0])===null||t===void 0)&&t.value?4096:0)|(!((i=d[1])===null||i===void 0)&&i.value?8192:0)|(!((n=d[2])===null||n===void 0)&&n.value?16384:0)|(!((r=d[3])===null||r===void 0)&&r.value?32768:0)|(!((s=d[4])===null||s===void 0)&&s.value?256:0)|(!((o=d[5])===null||o===void 0)&&o.value?512:0)|(0<e[5]?1:0)|(0>e[5]?2:0)|(0>e[4]?4:0)|(0<e[4]?8:0)|0}za(e){var t,i,n,r,s,o,d,u,l,h;let p=e.buttons;return e=this.M?iu(e.axes[6],e.axes[7]):tu(e.axes[9]),(!((t=p[1])===null||t===void 0)&&t.value?4096:0)|(!((i=p[2])===null||i===void 0)&&i.value?8192:0)|(!((n=p[0])===null||n===void 0)&&n.value?16384:0)|(!((r=p[3])===null||r===void 0)&&r.value?32768:0)|(!((s=p[4])===null||s===void 0)&&s.value?256:0)|(!((o=p[5])===null||o===void 0)&&o.value?512:0)|(!((d=p[8])===null||d===void 0)&&d.value?32:0)|(!((u=p[9])===null||u===void 0)&&u.value?16:0)|(!((l=p[10])===null||l===void 0)&&l.value?64:0)|(!((h=p[11])===null||h===void 0)&&h.value?128:0)|e}La(e){var t,i,n,r,s,o,d,u,l,h;let p=e.buttons;return e=tu(e.axes[9]),(!((t=p[0])===null||t===void 0)&&t.value?4096:0)|(!((i=p[1])===null||i===void 0)&&i.value?8192:0)|(!((n=p[3])===null||n===void 0)&&n.value?16384:0)|(!((r=p[4])===null||r===void 0)&&r.value?32768:0)|(!((s=p[6])===null||s===void 0)&&s.value?256:0)|(!((o=p[7])===null||o===void 0)&&o.value?512:0)|(!((d=p[10])===null||d===void 0)&&d.value?32:0)|(!((u=p[11])===null||u===void 0)&&u.value?16:0)|(!((l=p[13])===null||l===void 0)&&l.value?64:0)|(!((h=p[14])===null||h===void 0)&&h.value?128:0)|e}Pa(e){var t,i,n,r,s,o,d,u,l,h;let p=e.buttons;return e=iu(e.axes[6],e.axes[7]),(!((t=p[0])===null||t===void 0)&&t.value?4096:0)|(!((i=p[1])===null||i===void 0)&&i.value?8192:0)|(!((n=p[2])===null||n===void 0)&&n.value?16384:0)|(!((r=p[3])===null||r===void 0)&&r.value?32768:0)|(!((s=p[4])===null||s===void 0)&&s.value?256:0)|(!((o=p[5])===null||o===void 0)&&o.value?512:0)|(!((d=p[6])===null||d===void 0)&&d.value?32:0)|(!((u=p[7])===null||u===void 0)&&u.value?16:0)|(!((l=p[9])===null||l===void 0)&&l.value?64:0)|(!((h=p[10])===null||h===void 0)&&h.value?128:0)|e}$b(){for(const e of this.l)e.$b(this.g.Ud,this.g.Vd,this.g.Mb,this.g.Td,this.j)}fa(){var e,t=performance.now();this.pa&&(this.maxSchedulingDelay=Math.max(this.maxSchedulingDelay,t-this.pa-this.gamepadPollInterval)),this.pa=t,gr(this),t=0;for(let o of this.h){if(!o)continue;const d=o.ca.timestamp;let u=o.ca;if(!ad(this,u))continue;if(o.ca.timestamp<=this.C[u.index]){this.wa&&5e3<=performance.now()-o.ca.timestamp&&this.wa();continue}else this.C[u.index]=o.ca.timestamp;const l=this.G[u.index];var i=new Eg(o),n;if((n=l)&&(n=l.buttons==i.buttons&&l.triggers==i.triggers)){e:{n=l.axes;for(var r=0;r<n.length;r++)if(.01<Math.abs(n[r]-i.axes[r])){n=!0;break e}n=!1}n=!n}if(n)continue;this.G[u.index]=i,r=o.Ib(u);let h=o.Hb(u),p=o.Gb(u);for(let y of this.m){i=void 0,n=y.Eb;var s=y.Kb;const N=(y.Jb|n)===h;s=!!(255&s)==229.5<=(r&255)&&!!(65280&s)==58752<=(r&65280);const G=(((i=l==null?void 0:l.buttons)!==null&&i!==void 0?i:0)&n)===0&&(h&n)!==0;N&&s&&G&&y.Ga()}switch(o.Ca){case 1:for(const y of this.l)y.Wc(u.index,o.ia,h,r,p,d,this.j,u.id);break;case 2:for(const y of this.l)(e=y.Tc)===null||e===void 0||e.call(y,u.index,o.ia,h,r,p,o.ca.timestamp,this.j,u.id)}t++,nu(o.Fa,h,r,p)}if(t){Si(Ai());for(const o of this.l)o.Vc()}this.g.ob&&this.g.Wd&&(this.$b(),this.g.Wd=!1,this.s&&nu(this.s,this.g.Ud,this.g.Vd,this.g.Td))}getVirtualGamepadHandler(){return this.Ua}},ld=void 0;function ou(e,t,i,n){var r=[];r[0]=-.1<n[0]&&.1>n[0]?0:n[0],r[1]=-.1<n[1]&&.1>n[1]?0:n[1],r[2]=-.1<n[2]&&.1>n[2]?0:n[2],r[3]=-.1<n[3]&&.1>n[3]?0:n[3],n=r[e.Sf],r=r[e.Tf];const s=4-3*Math.min(1,Math.sqrt(n*n+r*r));e.zc=n*e.scale/s,e.Ac=r*e.scale/s,t=!!(t&4224)||58752<=(i&65280),i=229.5<=(i&255),n=e.oc,r=e.pc,e.oc=t,e.pc=i,!t&&n&&Sr(e,0,!1),!i&&r&&Sr(e,2,!1),t&&!n&&Sr(e,0,!0),i&&!r&&Sr(e,2,!0)}function Sr(e,t,i){t=new MouseEvent(i?e.ud:e.Sd,{button:t,buttons:(e.oc?1:0)|(e.pc?2:0)}),e.Te.dispatchEvent(t)}var Og=class{constructor(e,t){this.Bc=0,this.ug=8,this.tb=this.sb=this.Ac=this.zc=0,this.pc=this.oc=!1,this.scale=12,this.jc="mousemove",this.ud="mousedown",this.Sd="mouseup",this.Sf=2,this.Tf=3,this.u=t,this.Te=e,this.wg=this.vg.bind(this),H(this.u)&&(this.Sf=0,this.Tf=1)}Wc(e,t,i,n,r){ou(this,i,n,r)}Tc(e,t,i,n,r){ou(this,i,n,r)}vg(){this.sb=Math.sign(this.sb)!=Math.sign(this.zc)?this.zc:this.sb+this.zc,this.tb=Math.sign(this.tb)!=Math.sign(this.Ac)?this.Ac:this.tb+this.Ac;var e=0;let t=0;if((1<=this.sb||-1>=this.sb)&&(e=Math.trunc(this.sb),this.sb-=e),(1<=this.tb||-1>=this.tb)&&(t=Math.trunc(this.tb),this.tb-=t),e!=0||t!=0){e={movementX:e,movementY:t,isPrimary:!0};let i;this.jc=="pointerrawupdate"||this.jc=="pointermove"?i=new PointerEvent(this.jc,e):i=new MouseEvent("mousemove",e),this.Te.dispatchEvent(i)}}start(){this.Bc&&this.stop(),this.Bc=window.setInterval(this.wg,this.ug)}stop(){this.Bc&&(clearInterval(this.Bc),this.Bc=0)}reset(){this.oc&&Sr(this,0,!1),this.pc&&Sr(this,2,!1),this.sb=this.tb=this.zc=this.Ac=0,this.oc=this.pc=!1}vb(){}Vc(){}$b(){}Rc(){}},Dg=class{constructor(){this.y=this.x=0}Ze(){return this.x}$e(){return this.y}update(e,t){return this.x=e,this.y=t,!0}},Mg=class{constructor(){this.l=this.j=this.o=this.m=this.D=this.C=this.s=this.h=this.g=0,this.v=!1}Ze(){return this.g}$e(){return this.h}update(e,t,i){if(e===0&&t===0)return this.v?this.l=this.j=0:this.v=!0,!1;if(this.v=!1,this.j===0&&this.l===0){if(i<this.s)return this.j=e,this.l=t,!1}else e+=this.j,t+=this.l,this.l=this.j=0;var n=e*this.g+t*this.h,r=e*e+t*t,s=this.g*this.g+this.h*this.h,o=!0;if(.95>i-this.s&&0>n&&s!==0&&n*n>.81*r*s&&(n=Math.sqrt(r)/Math.sqrt(s),n=Math.abs(n-Math.trunc(n)),.5<n&&(n=1-n),.1>n&&(o=!1)),n=e-this.g,r=t-this.h,o&&(s=1+.1*Math.max(1,Math.min(16,i-this.s)),o=2*s*Math.abs(this.C),s=2*s*Math.abs(this.D),s=Math.max(8100,o*o+s*s),o=n*n+r*r<s,!o&&(this.m||this.o))){o=e-this.m;const d=t-this.o;o=o*o+d*d<s}return o?(this.C=.4*this.C+.6*n,this.D=.4*this.D+.6*r,this.g=e,this.h=t,this.s=i,this.o=this.m=0,!0):(this.m=e,this.o=t,!1)}};function Lg(e){return{vf:"image/x-icon",scale:1,...e}}const au={style:"default",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAOAAAADAAAABwAAAAYAAAAOAAABDAAAAZwAAAHYAAAB4AAAAf+AAAH/AAAB/gAAAfwAAAH4AAAB8AAAAeAAAAHAAAABgAAAAQAAAAAAAAAAAAAAAAAAAA////////////////////////////////////////////5////8P///+D////h////wf//98P///OD///xh///8Af///AP///wAH//8AD///AB///wA///8Af///AP///wH///8D////B////w////8f////P////3/////////8=",Ha:2,Ia:1},Ng=[{style:"none",Na:"",Ha:0,Ia:0},au,{style:"text",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfvwAAAAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAfPwAAAAAAAAAAAAAAAAAA/////////////////////////////////////+BA///Agf///z////8/////P////z////8/////P////z////8/////P////z////8/////P////z////8/////P////z////8/////P////z///+BA///Agf////////////8=",Ha:8,Ia:13},{style:"wait",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/8AAAzzAAAHDgAABfoAAAb2AAADbAAAAfgAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAB+AAAA/wAAAaWAAAH/gAABWoAAA//AAAP/wAAAAAAAAAAAAA//////////////////////////////////////////+AAf//gAH//4AB//+AAf//wAP//8AD///gB///8A////gf///8P////D////w////8P////D////gf///wD///4Af//8AD///AA///gAH//4AB//+AAf//gAH///////8=",Ha:7,Ia:12},{style:"crosshair",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAABjAAABgMAAAQBAAAIAIAACACAABAAQAAAIAAAEABAAAgAgAAIAIAABgMAAAICAAABjAAAAFAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////4////5T///53P//+97///fff//333//79+//+AAP//v37//999///fff//53P///d3///5T////j////////8=",Ha:8,Ia:8},{style:"progress",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4AAAAiAAAAPgAAABwAAAYIAAAOCAAADAgAABwcAAAYNgAAOCoABDA+AAZwAAAHYAAAB4AAAAf+AAAH/AAAB/gAAAfwAAAH4AAAB8AAAAeAAAAHAAAABgAAAAQAAAAAAAAAAAAAAAAAAAA///////////////////////+A////gP///4D///+A///5wf//8OP//+Dj///h4///wcH/98OA//ODgP/xh4D/8AeA//AP///wAH//8AD///AB///wA///8Af///AP///wH///8D////B////w////8f////P////3/////////8=",Ha:2,Ia:1},{style:"nwse-resize",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP4AAAB+AAAAPgAAAB4AAABuAAAA5gAAAcIAAEOAAABnAAAAdgAAAHgAAAB8AAAAfgAAAH8AAAAAAAAAAAAAA/////////////////////////////////////////////////////////////////////////////////wA///+AP///wD///+A////gP///wD//34A//88GP//GDz//wB+//8A////Af///wH///8A////AH///wA////////8=",Ha:9,Ia:8},{style:"nesw-resize",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfwAAAH4AAAB8AAAAeAAAAHYAAABnAAAAQ4AAAAHCAAAA5gAAAG4AAAAeAAAAPgAAAH4AAAD+AAAAAAAAAAAAA////////////////////////////////////////////////////////////////////////////////wA///8Af///AP///wH///8B////AP///wB+//8YPP//PBj//34A////AP///4D///+A////AP///gD///wA///////8=",Ha:9,Ia:9},{style:"ew-resize",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAEAABgBgAA4AcAAeAHgAPv98AH7/fgA+/3wAHgB4AA4AcAAGAGAAAgBAAAAAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////+/3///P8///j/H//w/w//4P8H/8AAA/+AAAH/AAAA/4AAAf/AAAP/4P8H//D/D//4/x///P8///7/f//////8=",Ha:13,Ia:8},{style:"ns-resize",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADgAAAB8AAAA/gAAAf8AAAP/gAAAAAAAADgAAAA4AAAAOAAAADgAAAA4AAAAOAAAADgAAAA4AAAAAAAAA/+AAAH/AAAA/gAAAHwAAAA4AAAAEAAAAAAAAAAAAAA//////////////////////////////////////+/////H////g////wH///4A///8AH//+AA///AAH///g////4P///+D////g////4P///+D////g////4P///AAH//4AD///AB///4A////Af///4P////H////7////////8=",Ha:9,Ia:12},{style:"move",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABwAAAA+AAAAHAAAABwAAAAcAAAAHAAAABwAAAgACAAf3fwAP93+AB/d/AAIAAgAABwAAAAcAAAAHAAAABwAAAAcAAAAPgAAABwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////f////j////wf///4D///8Af///wf///8H///vB7//zwef/4AAD/8AAAf+AAAD/wAAB/+AAA//zwef/+8Hv///B////wf///wB///+A////wf///+P////3///////////////////////8=",Ha:13,Ia:12},au,{style:"pointer",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH+AAAB/gAAA/4AAAP/AAAH/wAAB/8AAA//gAAP/4AAH/+AADttgABzbYAAY2wAAANsAAADYAAAAwAAAAMAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////////+Af///AD///wA///4AP//+AB///AAf//wAH//4AA//+AAP//AAD//gAA//wAAP/8IAH//mAH///gD///4H///+H////z////////8=",Ha:8,Ia:3},{style:"help",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAABgAAAAYAAAYHAAAOAYAADADAABwwwAAYMMAAODDABDAZgAZwDwAHYAAAB4AAAAf+AAAH/AAAB/gAAAfwAAAH4AAAB8AAAAeAAAAHAAAABgAAAAQAAAAAAAAAAAAAAAAAAAA/////////////+f////D////5//////////n////w///58P//8PB//+D4P//hzB//wYYf98OGH/ODhh/xh8A/8Afgf/AP8P/wAH//8AD///AB///wA///8Af///AP///wH///8D////B////w////8f////P////3/////////8=",Ha:2,Ia:1}];function du(e){e.preventDefault()}function ts(e){var t,i;return e.xb()&&e.cursorType!=2&&e.v.h&&(!e.g.pb||e.g.rd)&&((i=(t=Hd(e.R))===null||t===void 0?void 0:t.Fb())!==null&&i!==void 0?i:!0)}function yr(e){return e.m===1||e.m===2}function Nt(e){var t=ts(e);const i=yr(e),n=e.s&&!e.g.pb,r=e.La;if(!e.Fb||!t||i&&n===r)e.m!=1&&!t&&i&&(document.exitPointerLock?(e.m=3,document.exitPointerLock()):e.m=0);else if(t=e.H,t.requestPointerLock&&3>e.S){if(e.m===1){if(n===e.U)return;if(e.O){e.O.then(()=>{Nt(e)});return}e.aa?c.e("{70cc40b}","{d70c0a5}"):c.e("{70cc40b}","{da98287}")}e.m=1,e.U=n,t=t.requestPointerLock({unadjustedMovement:n}),(e.O=t)&&(e.aa=!0,t.then(()=>{e.m=2,e.U=null,e.O=void 0,e.La=n,e.S=0}).catch(s=>{e.m=0,s.name==="NotSupportedError"&&n?(c.i("{70cc40b}","{08fd91e}"),e.s=!1,Nt(e)):(s.name=="UnknownError"?(e.S++,c.w("{70cc40b}","{9f2ba9f}",e.S)):c.e("{70cc40b}","{4cdd98f}",s.name,s.message),vn(e))}))}else e.m=2}function xg(e,t){let i=new Uint8Array(t.data);switch(i[0]){case 0:case 1:t=i[1];let o=i[2],d=i[3];var n=i[4];let u=5,l=()=>{const N=i[u]+(i[u+1]<<8);return u+=2,N};var r="";n!=0&&(r=i.subarray(u,u+n),u+=n,r=new TextDecoder("utf-8").decode(r)),n=l();var s="";n!=0&&(s=i.subarray(u,u+n),u+=n,s=new TextDecoder("utf-8").decode(s));let h,p;u+4<=i.byteLength&&(h=l(),p=l());let y;u+2<=i.byteLength&&(y=l()/100),i[0]==0?lu(e,t,h,p):Ug(e,t,o,d,r,s,h,p,y);break;case 10:e.Pa.allowUnconfined&&jg(e,i[1]==1)}}function _g(e){let t="canvasId1";var i=document.getElementById(t);if(i&&i instanceof HTMLCanvasElement&&i.parentElement===e.parentElement)return i;if(i)do t="canvasId"+Math.round(1e4*Math.random()),i=document.getElementById(t);while(i);return i=document.createElement("canvas"),i.id=t,i.style.touchAction="none",i.style.pointerEvents="none",i.style.willChange="transform",e.insertAdjacentElement("afterend",i),i}function cu(e){var t,i;if(e.cursorType===0){var n=e.H.getBoundingClientRect(),r=(i=(t=e.H.parentElement)===null||t===void 0?void 0:t.getBoundingClientRect())!==null&&i!==void 0?i:new DOMRect(0,0,0,0);t=n.left-r.left+e.l.la*e.l.Ra,n=n.top-r.top+e.l.la*e.l.Oa,e.j.style.position="absolute",e.j.style.left=t+"px",e.j.style.top=n+"px",e.j.style.zIndex="200"}}function ud(e){var t=e.j.getContext("2d");if(t&&(e.h.kg=t,t=window.devicePixelRatio,e.h.ub!=t)){c.i("{70cc40b}","{b786ba9}",t),e.h.ub=t,e.h.Xc=!0;for(const i of e.$.values())i.style=void 0;Ln(e)}}function Bs(e,t){if(e.W&&e.I!==t)switch(e.C&&yu(e),e.I=t,e.C&&Su(e),t){case 1:e.G=4;break;case 2:e.G=8;break;case 3:e.G=16;break;default:e.G=0}}function lu(e,t,i,n){t>=e.Z.length?c.e("{70cc40b}","{de8eabe}",t):Au(e,e.Z[t],i,n)}function uu(e){e.N&&(window.clearTimeout(e.N),e.N=0)}function Fg(e){if(e.h.Sc){e.h.Sc=!1;var t=e.g.qb,i=e.g.rb;if(e.cursorType===0)if(e.ba&&e.g.pb){var n=pu(e.h.ub/e.g.cursor.scale);e.h.Xc&&(e.h.Xc=!1,vu(e,n));const r=e.g.cursor,s=e.h.ub;n/=s,t=(t*e.l.la-r.Ha*n)*s,i=(i*e.l.la-r.Ia*n)*s,e.fa||(t=Math.round(t),i=Math.round(i)),e.j.style.transform="translate("+t/s+"px, "+i/s+"px)",e.h.jd||(e.h.jd=!0,e.j.style.visibility="visible")}else gu(e)}}function Vs(e,t,i){hd(e,t-e.l.Ra,i-e.l.Oa)}function Ln(e){e.h.Sc=!0}function Hs(e,t,i){if(!e.F.has(t)){e.F.add(t),e=e.o;const n=e.s(18);td(n,8,t+1,i);try{Lt(e,n)}catch(r){c.e("{57a6a4d}","{b258856}",r),e.C.Aa(r,"send mousedown exception","{57a6a4d}.ts",0,0,!0)}}}function is(e,t,i){if(e.F.has(t)){e.F.delete(t),e=e.o;const n=e.s(18);td(n,9,t+1,i);try{Lt(e,n)}catch(r){c.e("{57a6a4d}","{c1ae1fc}",r),e.C.Aa(r,"send mouseup exception","{57a6a4d}.ts",0,0,!0)}}}function hu(e,t){if(t instanceof PointerEvent){if(zs(t))return;t.preventDefault()}let i=performance.now();if(e.v.h&&(!ts(e)||yr(e))&&(t.movementX!==0||t.movementY!==0)){e.lc(!0);var n=1,r=0,s=e.g.pb,o=e.D.h,d=u=>{if(e.T.update(u.movementX,u.movementY,u.timeStamp)){var l=e.T.Ze(),h=e.T.$e();if(s){if(e.g.rd){var p=e.V?e.h.ub:1;hd(e,e.g.qb+l/p,e.g.rb+h/p)}else Vs(e,u.offsetX,u.offsetY);e.h.Sc=!0,l=e.g.qb,h=e.g.rb}else e.V&&(p=e.h.ub,l+=e.g.Ld,h+=e.g.Md,e.g.Ld=l%p,e.g.Md=h%p,l/=p,h/=p);e:{if(p=e.D,u=xt(e.K,u.timeStamp),r%n!==0&&0<p.j){const y=p.l[p.j-1];if(y.eb===s&&y.qc===i){s?(y.x=l,y.y=h):(y.x+=l,y.y+=h);break e}}p.j==p.l.length?(p.l.push({eb:s,x:l,y:h,captureTimestamp:u,gb:0,qc:i}),p.j++):(p=p.l[p.j++],p.eb=s,p.x=l,p.y=h,p.captureTimestamp=u,p.gb=0,p.qc=i)}r++}};if(t instanceof PointerEvent&&e.da){const u=t.getCoalescedEvents();if(u.length==0)d(t);else{t=e.D.g.length,t=u.length>2*t?1:Math.max(t-e.D.h-4,1),u.length>t&&(n=Math.ceil(u.length/t),e.ja.Oc+=u.length);for(let l of u)d(l)}}else d(t);1<e.o.ga&&o===0&&e.D.h>o&&(e.D.l[o].gb=e.D.h-o)}}function hd(e,t,i){e.g.qb=Math.min(Math.max(t,0),e.l.Qa),e.g.rb=Math.min(Math.max(i,0),e.l.Ma),Ln(e)}function fu(e,t){if(e.l.Qa&&e.l.Ma){const i=t.Ma/e.l.Ma;e.g.qb*=t.Qa/e.l.Qa,e.g.rb*=i}e.l=t,cu(e),ud(e)}function pu(e){return 1.499<=e&&1.999>e?2:Math.max(1,Math.floor(e+.001))}function vu(e,t){const i=e.g.cursor;if(i.image){var n=e.h.ub,r=e.h.kg,s=i.image.width*t;t*=i.image.height;var o=Math.ceil(s),d=Math.ceil(t);o!==e.j.width||d!==e.j.height?(e.j.style.width=s/n+"px",e.j.style.height=t/n+"px",e.j.width=o,e.j.height=d,r.scale(1,1),r.imageSmoothingEnabled=!1):r.clearRect(0,0,e.j.width,e.j.height),r.drawImage(i.image,0,0,s,t)}else c.e("{70cc40b}","{bc9bdcd}")}function gu(e){e.h.jd&&(e.h.jd=!1,e.j.style.visibility="hidden")}function vn(e){const t=e.H;!e.xb()||ts(e)&&!yr(e)||e.cursorType==2?t.style.cursor="default":t.style.cursor=e.cursorType===0?"none":e.g.style}function mu(e,t){const i=()=>{if(e.g.sc=void 0,e.g.cursor=t,e.h.Xc=!0,e.cursorType===0)Ln(e);else{if(!t.style){var n=e.h.ub,r=1,s=1;e.Ka!==void 0&&(r=pu(n/t.scale),s=r/n),vu(e,r),n=e.j.toDataURL("image/bmp"),r=t.Ha*s,s=t.Ia*s;const o=e.h.ub,d=e.Ka;t.style=d?`${d}(url(${n}) ${o}x) ${r} ${s}, auto`:`url(${n}) ${r} ${s}, auto`}e.g.style=t.style,vn(e)}};if(e.cursorType!==0&&t.style)i();else if(t.style!=="none")if(t.image)t.image.width!==0||t.image.height!==0?i():e.g.sc=t.image;else{const n=new Image;t.image=n,!n.decode&&n.decoding&&(n.decoding="sync"),n.src=`data:${t.vf};base64,${t.Na}`,n.decode?(e.g.sc=n,n.decode().then(()=>{e.g.sc===n&&i()}).catch(()=>{e.g.sc===n&&(e.g.sc=void 0,mu(e,e.Z[1]))})):i()}else e.g.cursor=t,gu(e)}function Ug(e,t,i,n,r,s,o,d,u){if(0<s.length)i={Na:s,Ha:i,Ia:n,vf:r,scale:u||1},e.$.set(t,i);else if(i=e.$.get(t),i===void 0){c.e("{70cc40b}","{0196577}",t);return}Au(e,i,o,d)}function jg(e,t){e.g.rd=t,Nt(e)}function Au(e,t,i,n){const r=t.style!=="none";!e.g.pb&&r&&i!==void 0&&n!==void 0&&hd(e,i*e.l.Qa/65535,n*e.l.Ma/65535),e.g.pb=r,r||(e.g.Ld=0,e.g.Md=0),Nt(e),mu(e,t),vn(e)}function Ws(e){e.L!==0&&(window.clearTimeout(e.L),e.L=0)}function Su(e){e.cursorType==2?(e.M.jc=Nn(e),e.videoAddEventListener(Nn(e),e.J?e.pa:e.oa)):e.I!==0?(e.M.jc="pointerrawupdate",e.videoAddEventListener("pointerrawupdate",e.za)):(e.M.jc=Nn(e),e.videoAddEventListener(Nn(e),e.ya))}function fd(e){if(0<e.F.size){c.i("{70cc40b}","{041c67f}",e.F.size);for(const t of e.F)is(e,t,0)}}function yu(e){e.cursorType==2?e.videoRemoveEventListener(Nn(e),e.J?e.pa:e.oa):e.I!==0?e.videoRemoveEventListener("pointerrawupdate",e.za):e.videoRemoveEventListener(Nn(e),e.ya)}function Nn(e){return e.J?"pointermove":"mousemove"}var Gg=class{constructor(e,t,i,n,r,s,o,d,u,l,h,p){var y,N,G,E,D,z,Z,Q,ce,be,Me,xe,Je,Be,tt,gt,mt,dt;this.P=e,this.R=t,this.H=i,this.Pa=r,this.u=s,this.M=o,this.ja=d,this.D=u,this.o=l,this.v=h,this.K=p,this.$=new Map,this.Z=Ng.map(Lg),this.S=this.m=0,this.Fb=!1,this.F=new Set,this.aa=this.La=this.s=this.da=this.J=this.W=!1,this.G=this.I=0,this.fa=!1,this.va={passive:!1},this.ba=!0,this.C=!1,this.N=this.L=0,this.U=null,this.O=void 0,this.Xa=()=>{this.N=0,ts(this)&&!yr(this)&&(this.Fb=!0,Nt(this))},n.onmessage=nt=>xg(this,nt),this.l={Qa:i.clientWidth||window.screen.width,Ma:i.clientHeight||window.screen.height,Nf:1,Ra:0,Oa:0,videoWidth:0,videoHeight:0,Ec:0,offsetX:0,offsetY:0,la:1},e=window.zoneless,this.documentAddEventListener=(N=(y=e==null?void 0:e.documentAddEventListener)===null||y===void 0?void 0:y.bind(document))!==null&&N!==void 0?N:document.addEventListener.bind(document),this.documentRemoveEventListener=(E=(G=e==null?void 0:e.documentRemoveEventListener)===null||G===void 0?void 0:G.bind(document))!==null&&E!==void 0?E:document.removeEventListener.bind(document),this.videoAddEventListener=(Q=(z=(D=e==null?void 0:e.videoAddEventListener)===null||D===void 0?void 0:D.bind(i))!==null&&z!==void 0?z:(Z=e==null?void 0:e.documentAddEventListener)===null||Z===void 0?void 0:Z.bind(document))!==null&&Q!==void 0?Q:i.addEventListener.bind(i),this.videoRemoveEventListener=(xe=(be=(ce=e==null?void 0:e.videoRemoveEventListener)===null||ce===void 0?void 0:ce.bind(i))!==null&&be!==void 0?be:(Me=e==null?void 0:e.documentRemoveEventListener)===null||Me===void 0?void 0:Me.bind(document))!==null&&xe!==void 0?xe:i.removeEventListener.bind(i),this.ma=this.qa.bind(this),this.Ba=this.ab.bind(this),this.sa=this.ra.bind(this),this.Ea=this.ib.bind(this),this.ta=this.Ya.bind(this),this.ya=this.bb.bind(this),this.za=this.cb.bind(this),this.oa=this.na.bind(this),this.pa=this.Wa.bind(this),this.xa=this.Za.bind(this),this.wa=this.$a.bind(this),this.ga=this.Ta.bind(this),this.ha=this.Ua.bind(this),this.ea=!!r.windowedStreaming,this.cursorType=(Be=(Je=Vg())!==null&&Je!==void 0?Je:r.cursorType)!==null&&Be!==void 0?Be:this.ea?2:0,c.i("{70cc40b}","{3277c0e}",this.cursorType),this.g={pb:!1,rd:this.cursorType===0&&!r.allowUnconfined,qb:0,rb:0,Ld:0,Md:0,style:"",cursor:this.Z[0]},this.h={ub:1,Sc:!1,Xc:!1,jd:!1},this.Ka=["image-set","-webkit-image-set"].find(nt=>CSS.supports("cursor",`${nt}(url(image.bmp) 2x) 0 0, auto`)),this.cursorType===0?(this.j=_g(this.H),this.j.style.visibility="hidden",this.j.style.display="none"):this.j=document.createElement("canvas"),cu(this),ud(this),this.W="onpointerrawupdate"in this.H,this.da=(this.J=El())&&"getCoalescedEvents"in PointerEvent.prototype&&s.browser!=="Firefox",c.i("{70cc40b}","{f30b8ee}",this.da?"supported":"not supported"),this.W&&(i=Bg(),i!==void 0?Bs(this,i):ve(s)?Bs(this,3):Bs(this,1),c.i("{70cc40b}","{20be0c0}",this.G,i!==void 0?" (overridden)":"")),this.s=(tt=r.unadjustedMovement)!==null&&tt!==void 0?tt:J(this.u)?!this.ea&&Ee(this.u,84,0,4147,78):ve(this.u)||fe(this.u)?Ee(this.u,86,0,4240,198):!!B(this.u),r=ve(s)&&Ee(this.u,84,0,4147,94)&&!Ee(this.u,88,0,4324,139),r=J(this.u)||!r||!Ee(this.u,84,0,4147,94),((gt=ga)!==null&&gt!==void 0?gt:r)?this.T=new Mg:this.T=new Dg,["pointerlockchange","mozpointerlockchange"].forEach(nt=>this.documentAddEventListener(nt,this.xa)),["pointerlockerror","mozpointerlockerror"].forEach(nt=>this.documentAddEventListener(nt,this.wa)),ci(this.v,0,this.ga),ci(this.v,2,this.ha),se(this.u)||le(this.u)?this.V=!0:!ue(s)||Ee(s,99,0,4844,44)||fe(s)?this.V=!1:this.V=!0,this.cursorType===1&&lu(this,1),this.jb=this.cursorType===1&&((dt=(mt=ja)!==null&&mt!==void 0?mt:Re.pointerLockEscape)!==null&&dt!==void 0?dt:!0),this.kb=this.cursorType===1&&B(s),c.d("{70cc40b}","{ec7c4c5}")}uninitialize(){["pointerlockerror","mozpointerlockerror"].forEach(e=>this.documentRemoveEventListener(e,this.wa)),["pointerlockchange","mozpointerlockchange"].forEach(e=>this.documentRemoveEventListener(e,this.xa)),li(this.v,0,this.ga),li(this.v,2,this.ha),uu(this)}ab(e){zs(e)||(e.preventDefault(),this.qa(e),this.cursorType===2&&this.H.setPointerCapture(e.pointerId))}qa(e){var t;(t=this.R.T)===null||t===void 0||t.g==2&&(c.i("{4c846ba}","{89b1a9f}"),ic(t),Tf(t),Rf(t)),jd(this.v,!0),this.Fb=!0,t=xt(this.K,e.timeStamp),ts(this)&&!yr(this)?(Nt(this),this.g.pb&&(Vs(this,e.offsetX,e.offsetY),Ln(this),id(this.o,this.g.qb,this.g.rb,t))):(this.kb&&this.g.pb&&(uu(this),this.N=window.setTimeout(this.Xa,500)),Si(Ai()),Hs(this,e.button,t))}ib(e){zs(e)||(e.preventDefault(),this.ra(e))}ra(e){Si(Ai()),is(this,e.button,xt(this.K,e.timeStamp))}Ya(e){this.ea&&e.target!==this.H||(Nl(this.o,e.deltaY,xt(this.K,e.timeStamp)),e.preventDefault())}Wa(e){if(!zs(e)){if(e.preventDefault(),e.button!==-1){let t;switch(e.button){case 1:t=2;break;case 2:t=1;break;default:t=e.button}const i=xt(this.K,e.timeStamp);e.buttons&1<<t?Hs(this,e.button,i):is(this,e.button,i)}this.na(e)}}na(e){Vs(this,e.offsetX,e.offsetY),id(this.o,this.g.qb,this.g.rb,xt(this.K,e.timeStamp))}bb(e){hu(this,e)}cb(e){const t=0<this.o.g.h;hu(this,e),!t&&0<this.o.g.h&&(e=performance.now()-this.o.da,e>=this.G?Lt(this.o):Sg(this.o,this.G-e))}Ua(e){this.Fb=e,Nt(this),vn(this)}Za(){if(document.pointerLockElement instanceof HTMLElement)this.U=null,this.O=void 0,this.m=2;else{var e=this.m===2;this.m=0,Ws(this);var t=()=>{c.i("{70cc40b}","{d4b3de3}"),this.Fb=!1,vn(this)},i=this.P.Sa.has(27);this.jb&&e&&!i?this.L=window.setTimeout(()=>{t(),this.L!==0&&(Ws(this),gd(this.P,!0))},50):(e&&t(),gd(this.P,!1))}}$a(){this.aa||(this.m=0,this.s?(this.s=!1,c.e("{70cc40b}","{7599808}"),Nt(this)):(c.e("{70cc40b}","{d633cd1}"),vn(this)))}xb(){return this.C}Ta(e){e?(this.v.j&&(this.Fb=!0,Nt(this)),ud(this)):(Nt(this),this.L!==0&&(Ws(this),gd(this.P,!1)))}lc(e){this.ba!=e&&(Ln(this),this.ba=e)}};function Bg(){const e=Re.mouseCoalesceInterval;if(e!==void 0)return new Map([[0,0],[4,1],[8,2],[16,3]]).get(e)}function zs(e){return!(e.isPrimary&&e.pointerType!=="touch"&&e.pointerType!=="pen")}function Vg(){switch(Ua){case"hw":return 1;case"sw":return 0;case"free":return 2}}const Hg=[{tc:8,hc:128,ld:qs(),Yb:27,Zb:[]},{tc:46,hc:128,ld:qs(),Yb:27,Zb:[]}];function Wg(e,t,i,n){e.g.la===1&&(wd(e,t,n,i),e.L.delay(()=>{Hs(e.j,0,i)}))}function pd(e,t){e.g.la===1&&($s(e.L),is(e.j,0,t))}function vd(e){var t=e.j;t.fa=!1,Ln(t),1.1>e.g.la&&xn(e,e.g.offsetX,e.g.offsetY,1)}function br(e){return e.da?(bd(e),!1):e.F.h}function zg(e,t,i,n){e.g.la!==1||e.yb||e.D!==void 0?xn(e,e.g.offsetX+n.deltaX,e.g.offsetY+n.deltaY,e.g.la):wd(e,t,n,i)}function bu(e,t){if(t.length===2){var i=e.j;i.fa=!0,Ln(i),i=t[0],t=t[1];var n=Math.hypot(i.clientX-t.clientX,i.clientY-t.clientY),r=Math.hypot(i.clientX-i.deltaX-(t.clientX-t.deltaX),i.clientY-i.deltaY-(t.clientY-t.deltaY));const s=e.l.getBoundingClientRect(),o=Ru(e);n=n/r*e.g.la,n=Math.min(Math.max(n,1),3),r=(i.clientX+t.clientX)/2-s.left,r+=e.g.offsetX-o.nb-(s.width-r)/e.g.la,r=(n/e.g.la-1)*r*-1,r+=e.g.offsetX+(i.deltaX+t.deltaX)/2;let d=(i.clientY+t.clientY)/2-s.top;d+=e.g.offsetY-o.vertical-(s.height-d)/e.g.la,d=(n/e.g.la-1)*d*-1,d+=e.g.offsetY+(i.deltaY+t.deltaY)/2,xn(e,r,d,n)}}function Kg(e,t,i,n,r){switch($s(e.L),r){case 1:wd(e,t,n,i),e.L.delay(()=>{rs(e,0,i)});break;case 2:e.na++,Ct&&e.J===0&&(e.J=window.setTimeout(()=>{e.na===2?e.o.toggleOnScreenStats():e.na===3&&e.o.toggleOnScreenStats(!0),yd(e)},300)),rs(e,2,i);break;case 3:e.ja++,Ct&&e.J===0&&(e.J=window.setTimeout(()=>{e.ja===2?e.o.na():e.ja===3&&Rh(e.T),yd(e)},300)),rs(e,1,i);break;case 4:rs(e,3,i);break;case 5:rs(e,4,i)}}function gd(e,t){t&&(Ks(e),c.i("{8bacfa5}","{f46c4da}"),yt(e.h,3,27,0),yt(e.h,4,27,0))}function md(e){Eu(e),e.ha=window.setTimeout(()=>{e.T.send()},350)}function $g(e,t){t.getEntriesByType("longtask").forEach(i=>{let n=Math.round(i.duration);var r=e.kb,s;r.h&&r.g&&(i={duration:{timestamp:i.startTime-((s=r.l.g)!==null&&s!==void 0?s:0),duration:n},instanceId:r.instanceId},r.g.postMessage(i));var o;(o=e.o.h)===null||o===void 0||(r=o.g,r.K=Math.max(n,r.K)),c.i("{8bacfa5}","{7071359}",n)})}function qg(e,t){if(t)for(const r of t){if(t=r.remote.code,!t||(t=Qr.get(t),!t))continue;var i=r.remote.modifiers,n=[];i&1&&n.push(162),i&2&&n.push(164),i&4&&n.push(91),i&8&&n.push(160),i=n,n=r.local.key;const s=r.local.code;s?(n=Qr.get(s))&&e.Z.set(n,{tc:n,hc:r.local.modifiers,ld:qs(),Yb:t,Zb:i}):n&&e.$.set(n,{Ed:n,hc:r.local.modifiers,ld:qs(),Yb:t,Zb:i})}else for(i of Hg)i.Ed?e.$.set(i.Ed,i):i.tc&&e.Z.set(i.tc,i)}function Jg(e){var t,i,n,r,s,o,d;for(const u of e.Z.values())c.i("{8bacfa5}","{e7c6e9b}",(t=u.tc)===null||t===void 0?void 0:t.toString(16),(i=u.hc)===null||i===void 0?void 0:i.toString(16),(n=u.Yb)===null||n===void 0?void 0:n.toString(16),(r=u.Zb)===null||r===void 0?void 0:r.map(l=>l.toString(16)));for(const u of e.$.values())c.i("{8bacfa5}","{b5e3a31}",u.Ed,(s=u.hc)===null||s===void 0?void 0:s.toString(16),(o=u.Yb)===null||o===void 0?void 0:o.toString(16),(d=u.Zb)===null||d===void 0?void 0:d.map(l=>l.toString(16)))}function Ad(e,t){(e.da=t)&&e.v!==15&&(e.pa=e.v,e.toggleUserInput(!0)),t?Cu(e).forEach(i=>e.documentAddEventListener(i,e.Ea)):Cu(e).forEach(i=>e.documentRemoveEventListener(i,e.Ea))}function Eu(e){e.ha!==0&&(window.clearTimeout(e.ha),e.ha=0)}function wu(e,t){if((!e.oa||t.keyCode!==20)&&(!_(e.u)||t.keyCode===20)){var i=16;if(e.R&&e.ma||!t.getModifierState("CapsLock")||(i|=1),e.ab&&(i|=96,t.getModifierState("NumLock")&&(i|=2),t.getModifierState("ScrollLock")&&(i|=4)),i!=e.ea){e.ea=i,e=e.h;const n=e.s(5);t=n,t.setUint32(0,19,!0),t.setUint8(4,i);try{Lt(e,n),c.d("{57a6a4d}","{56c9613}",i.toString(2))}catch(r){c.e("{57a6a4d}","{cbe483c}",r),e.C.Aa(r,"LockKeys state synchronize exception","{57a6a4d}.ts",0,0,!0)}}}}function xn(e,t,i,n){e.g.la=n;let r=Ru(e);r.nb-=e.g.Ra,r.vertical-=e.g.Oa;let s=Math.max(r.vertical+Math.max(0,e.g.Ma-e.g.Ec+2*e.g.Oa),0),o=Math.max(r.vertical,0);r.nb=Math.max(r.nb,0),t=Math.min(Math.max(t,-1*r.nb),r.nb),i=Math.min(Math.max(i,-1*s),o),e.l.style.transform=`translate3d(${t}px,${i}px,0px) scale3d(${n},${n},1)`,e.g.offsetX=t,e.g.offsetY=i,fu(e.j,e.g)}function Sd(e,t){var i;return e.S?e.C?(e=!((i=t.code)===null||i===void 0)&&i.length?Qr.get(t.code):Qr.get(t.key),e??0):(t=t.code?Qr.get(t.code):lg.get(t.key),t??0):t.keyCode}function Qg(e,t){var i;if(!((i=Hd(e.o))===null||i===void 0)&&i.isVisible())return!1;if(e.oa)switch(t.code){case"Tab":return!t.altKey;case"ZoomToggle":case"SelectTask":case"BrightnessDown":case"BrightnessUp":case"AudioVolumeMute":case"AudioVolumeDown":case"AudioVolumeUp":return!1}return!0}function ns(e,t){var i=0;t.ctrlKey&&!t.code.startsWith("Control")&&(i|=2),t.altKey&&!t.code.startsWith("Alt")&&(i|=4),t.metaKey&&!t.code.startsWith("Meta")&&(i|=8);let n;return _(e.u)&&t.key.length===1&&('!@#$%^&*()~_+{}|:"<>?'.includes(t.key)?n=1:"1234567890`-=[]\\;',./".includes(t.key)&&(n=0)),n===void 0&&t.shiftKey&&!t.code.startsWith("Shift")&&(n=1),i|(n??0)}function Ks(e){if(0<e.Sa.size){c.i("{8bacfa5}","{7998ee8}",e.Sa.size);for(const t of e.Sa)yt(e.h,4,t,0);e.Sa.clear()}}function yd(e){window.clearTimeout(e.J),e.J=0,e.na=0,e.ja=0}function bd(e){Ad(e,!1),e.O.emit("StreamingEvent",{streamingWarnings:{code:4}}),e.pa!==void 0&&(e.toggleUserInput(!1,~e.pa&15),e.pa=void 0);var t=e.h;const i=t.s(4);i.setUint32(0,2,!0);try{t.D.send(i),c.d("{57a6a4d}","{5693344}")}catch(n){c.e("{57a6a4d}","{ab52f04}",n),t.C.Aa(n,"heartbeat exception","{57a6a4d}.ts",0,0,!0)}e.ib.zf()}function Cu(e){return[Nn(e.j),"pointerdown","touchstart"]}function Iu(e,t){t=new TextEncoder().encode(t),e.sendTextInput(t.buffer),e.textInputElement.value=""}function Ed(e){for(let t=e.length-1;0<=t;t--)if(kl.get(e.charAt(t))===void 0)return!1;return!0}function Tu(e,t){let i=!1;e.ea&16&&(i=(1&e.ea)!=0);for(let r=0;r<t.length;r++){var n=kl.get(t.charAt(r));if(!n){c.e("{8bacfa5}","{67554be}",t.charAt(r));return}const s=n.vkCode;n=n.shift?1:0,65<=s&&90>=s&&i&&(n=~n),n&&yt(e.h,3,160,0,performance.now()),yt(e.h,3,s,n,performance.now()),yt(e.h,4,s,n,performance.now()),n&&yt(e.h,4,160,0,performance.now())}e.textInputElement.value=""}function Ru(e){return{nb:e.g.Qa*(e.g.la-1)/2,vertical:e.g.Ma*(e.g.la-1)/2}}function wd(e,t,i,n){$s(e.L);const r=t.getBoundingClientRect();t=(i.clientX-r.left)/e.g.la,i=(i.clientY-r.top)/e.g.la,e.lc(!0),Vs(e.j,t,i);const{qb:s,rb:o}=e.j.g;id(e.h,s,o,n)}function rs(e,t,i){Hs(e.j,t,i),e.L.delay(()=>{is(e.j,t,i)})}var Yg=class{constructor(e,t,i,n,r,s,o,d,u,l,h,p,y,N,G,E,D,z,Z,Q){var ce,be,Me,xe,Je,Be,tt,gt,mt,dt,nt,Ke,Tt,Oe,ui,yi,ni,Xi,Gn,Bn,Vn,Hn;this.F=N,this.G=E,this.kb=D,this.ta=!1,this.Sa=new Set,this.v=0,this.yb=!1,this.S=!0,this.M=!1,this.J=0,this.L=new Xg,this.V=!1,this.K=0,this.ma=this.sa=!1,this.ha=this.ja=this.na=0,this.ya=this.xa="off",this.$=new Map,this.Z=new Map,this.ra=!1,this.qa=0,this.Ya=()=>{c.d("{8bacfa5}","{9c2578a}"),md(this)},this.Xa=()=>{this.ra=!0},this.Wa=()=>{this.ra=!1},this.u=h,this.o=e,this.l=t,this.U=r,this.ib=p,this.T=y,this.g={Qa:t.clientWidth||window.screen.width,Ma:t.clientHeight||window.screen.height,Nf:1,Ra:0,Oa:0,videoWidth:0,videoHeight:0,Ec:0,offsetX:0,offsetY:0,la:1},r=window.zoneless,this.windowAddEventListener=(be=(ce=r==null?void 0:r.windowAddEventListener)===null||ce===void 0?void 0:ce.bind(window))!==null&&be!==void 0?be:window.addEventListener.bind(window),this.windowRemoveEventListener=(xe=(Me=r==null?void 0:r.windowRemoveEventListener)===null||Me===void 0?void 0:Me.bind(window))!==null&&xe!==void 0?xe:window.removeEventListener.bind(window),this.documentAddEventListener=(Be=(Je=r==null?void 0:r.documentAddEventListener)===null||Je===void 0?void 0:Je.bind(document))!==null&&Be!==void 0?Be:document.addEventListener.bind(document),this.documentRemoveEventListener=(gt=(tt=r==null?void 0:r.documentRemoveEventListener)===null||tt===void 0?void 0:tt.bind(document))!==null&&gt!==void 0?gt:document.removeEventListener.bind(document),this.videoAddEventListener=(Ke=(dt=(mt=r==null?void 0:r.videoAddEventListener)===null||mt===void 0?void 0:mt.bind(t))!==null&&dt!==void 0?dt:(nt=r==null?void 0:r.documentAddEventListener)===null||nt===void 0?void 0:nt.bind(document))!==null&&Ke!==void 0?Ke:t.addEventListener.bind(t),this.videoRemoveEventListener=(yi=(Oe=(Tt=r==null?void 0:r.videoRemoveEventListener)===null||Tt===void 0?void 0:Tt.bind(t))!==null&&Oe!==void 0?Oe:(ui=r==null?void 0:r.documentRemoveEventListener)===null||ui===void 0?void 0:ui.bind(document))!==null&&yi!==void 0?yi:t.removeEventListener.bind(t),this.Pa=this.La.bind(this),this.Ua=this.Ta.bind(this),this.za=this.Ba.bind(this),this.va=this.jb.bind(this),this.ga=this.fa.bind(this),this.cb=this.Pb.bind(this),this.Za=this.Cb.bind(this),this.Ea=this.Ab.bind(this),this.bb=this.Ob.bind(this),this.N=this.Nb.bind(this),this.P=u,this.preventNavigation=!!o.preventNavigation,this.Db={Eb:H(this.u)?64:128,Jb:0,Kb:255,Ga:this.Bb.bind(this)},u=new bg,this.h=new yg(this,u,G,this.g,this.o,i,this.U,this.G,Z,z),this.s=new Og(this.l,this.u),this.j=new Gg(this,e,t,n,o,h,this.s,G,u,this.h,this.F,this.G),d?jr||L()?(this.D=new cg(this.l,this.videoAddEventListener,this.videoRemoveEventListener,this.h,this,this.G),c.i("{8bacfa5}","{60f3637}")):c.w("{8bacfa5}","{32104d3}"):c.i("{8bacfa5}","{6be89bf}"),!jr&&!L()||K(this.u)||(this.I=new ag(this.l,this.videoAddEventListener,this.videoRemoveEventListener,this,this.G)),this.O=s,this.ea=0,this.ab=J(this.u),this.oa=ve(this.u),this.R=fe(this.u),this.C=this.u.os==="Android",this.wa=V(this.u),e=B(this.u),t=!!o.windowedStreaming,c.i("{8bacfa5}","{fa2e72c}",t?"on":"off"),this.ab?(c.d("{8bacfa5}","{da5ae1d}"),this.aa=[20,144,145]):this.oa||this.u.os==="Linux"?(c.d("{8bacfa5}","{b7becf9}"),this.aa=[]):(c.d("{8bacfa5}","{098ce9c}"),this.aa=[20]),this.W=this.da=!1,PerformanceObserver?this.perf=new PerformanceObserver(ls=>$g(this,ls)):this.perf=null,ci(this.F,2,this.za),c.d("{8bacfa5}","{cc9c05b}"),window.ResizeObserver?(this.$a=new ResizeObserver(()=>{this.fa()}),this.$a.observe(this.l)):this.windowAddEventListener("resize",this.ga),(_(h)||le(h))&&window.IntersectionObserver&&(this.Ka=new IntersectionObserver(()=>{this.fa()},{threshold:[1]}),this.Ka.observe(this.l)),this.l.addEventListener("resize",this.ga),this.windowAddEventListener("orientationchange",this.Ya),(h=window.visualViewport)&&(this.g.Ec=h.height,h.addEventListener("resize",this.cb)),this.m=l,this.h.I.push(this.m),this.m.v.add(this.U),ca&&this.m.m.push(this.Db),this.Ba(this.F.j),ci(this.F,0,this.va),this.perf&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("longtask")&&this.perf.observe({entryTypes:["longtask"]}),aa&&Ai().initialize(this.l,this.u),(K(this.u)||this.C||_(this.u))&&(this.textInputElement=Q,this.C&&(this.xa=(Xi=(ni=this.textInputElement)===null||ni===void 0?void 0:ni.getAttribute("autocapitalize"))!==null&&Xi!==void 0?Xi:"off",this.ya=(Bn=(Gn=this.textInputElement)===null||Gn===void 0?void 0:Gn.getAttribute("autocorrect"))!==null&&Bn!==void 0?Bn:"off",(Vn=this.textInputElement)===null||Vn===void 0||Vn.setAttribute("autocapitalize","off"),(Hn=this.textInputElement)===null||Hn===void 0||Hn.setAttribute("autocorrect","off"))),(Oa||ha&&(e||t))&&(qg(this,o.streamingHotkeys),Jg(this))}uninitialize(){var e,t,i,n,r,s,o,d;Ad(this,!1);var u=this.l.paused;if(u=u!==void 0?u?"paused":"playing":"unknown",(this.l.paused||1>((e=this.l.currentTime)!==null&&e!==void 0?e:1))&&vt(this.U,"VideoPaused",u,(t=this.l.currentTime)===null||t===void 0?void 0:t.toFixed(2)),c.i("{8bacfa5}","{fdc8bf7}",u,this.l.currentTime),(i=this.Ka)===null||i===void 0||i.disconnect(),(n=this.$a)===null||n===void 0||n.disconnect(),e=this.m,e.o&&(e.vb(this.h,0),1>=e.ta.size)){t=!0;for(var l of e.h)l&&(l.Fa.state=Kl(e,l.Fa.state,!0),Ar(e,l.ca.index,!0,t),t=!1);Wl(e),e.j=0,e.o=0,e.g.ob=!1,e.gamepadPollInterval=100,Zr(e),e.h=[],e.R=!1}l=this.h,e=l.I.indexOf(this.m),-1<e&&l.I.splice(e,1),this.toggleRsdmm(!1),this.m.v.delete(this.U),this.toggleUserInput(!1),this.h.stop(),this.perf&&this.perf.disconnect(),this.windowRemoveEventListener("resize",this.ga),this.windowRemoveEventListener("orientationchange",this.Ya),this.l.removeEventListener("resize",this.ga),(r=window.visualViewport)===null||r===void 0||r.removeEventListener("resize",this.cb),li(this.F,2,this.za),this.V&&(mr(this.m,this.P),this.P.Cc(this.l)),this.j.uninitialize(),(s=this.ba)===null||s===void 0||s.stop(),li(this.F,0,this.va),Eu(this),(o=this.textInputElement)===null||o===void 0||o.setAttribute("autocapitalize",this.xa),(d=this.textInputElement)===null||d===void 0||d.setAttribute("autocorrect",this.ya),c.d("{8bacfa5}","{b6b2756}")}$b(){Us(this.h)&&this.m.$b()}fa(){var e=this.l,t;if(!(0>=e.videoWidth||0>=e.videoHeight)){var i=0,n=0;if(e.clientWidth/e.clientHeight>e.videoWidth/e.videoHeight){var r=e.clientHeight/e.videoHeight,s=e.videoWidth*r,o=e.videoHeight*r;n=(e.clientWidth-s)/2}else r=e.clientWidth/e.videoWidth,s=e.videoWidth*r,o=e.videoHeight*r,i=(e.clientHeight-o)/2;var d=1,u=1;this.g.Qa&&this.g.Ma&&(d=s/this.g.Qa,u=o/this.g.Ma),this.g.Qa=s,this.g.Ma=o,this.g.Nf=r,this.g.Oa=i,this.g.Ra=n,this.g.videoWidth=e.videoWidth,this.g.videoHeight=e.videoHeight,xn(this,this.g.offsetX*d,this.g.offsetY*u,this.g.la),fu(this.j,this.g),(t=this.D)===null||t===void 0||(e=this.g,i=this.l.getBoundingClientRect(),r=this.g.la,t.F={nb:i.left+window.pageXOffset+this.g.Ra*this.g.la,vertical:i.top+window.pageYOffset+this.g.Oa*this.g.la},t.m=65535/e.Qa,t.o=65535/e.Ma,t.m/=r,t.o/=r),t=this.T,e=this.g.Ra,t.Oa=this.g.Oa,t.Ra=e,md(this)}}Pb(){this.g.Ec=window.visualViewport.height,xn(this,this.g.offsetX,this.g.offsetY,this.g.la)}Cb(){c.d("{8bacfa5}","{b6fbd34}"),history.pushState(null,document.title,location.href)}La(e){var t,i;let n=this.ra;this.sa=!1;const r=xt(this.G,e.timeStamp);if(this.F.h){Qg(this,e)&&e.preventDefault();var s=this.R&&this.ma?e.code=="CapsLock":!1;s&&(n=n||s),wu(this,e);var o;!(o=e.code=="CapsLock"&&(e.key=="Alphanumeric"||e.key=="Katakana"||e.key=="Hiragana"))&&(o=e.code=="KanaMode")&&(o=e.key,o=o=="Hiragana"||o=="Katakana"||o=="Romaji"||o=="KanaMode"),o=!!o;var d=e.code=="Lang1"||e.key=="HangulMode";if(n=n||o||d,!this.aa.includes(e.keyCode)||o||s){if(s=s?160:Sd(this,e),s===0)this.ta=!0,this.O.emit("TextComposition",{compositionText:e.key,imeRecommendation:!0});else if(this.ta&&(this.ta=!1,this.O.emit("TextComposition",{compositionText:""})),!this.Sa.has(s)){this.Sa.add(s),o=!1;var u=Hd(this.o);if(d=void 0,s==187){o=this.o;var l;if((l=o.T)===null||l===void 0)var h=0;else l.g==1?(c.i("{4c846ba}","{1f67b97}"),l.g=2,h=!0):h=!1;h?(Wt(o,{latencyTrigger:!0}),o=!0):o=!1,o=!o}else if(e.ctrlKey&&e.altKey)if(!Ct&&!Hr||s!=119&&s!=219)if(Ct)switch(s){case 48:h=this.j;var p="UNSUPPORTED";if(h.W)switch(Bs(h,(h.I+1)%4),h.I){case 1:p="4ms";break;case 2:p="8ms";break;case 3:p="16ms";break;default:p="OFF"}Pi(h.R,"Non-vsync mouse events: "+p),c.i("{70cc40b}","{bac28ff}",p);break;case 49:this.o.Db();break;case 56:this.o.sendCustomMessage({messageType:"GpuViewStartRequest",messageRecipient:"GPUViewTraceControl",data:"GpuView"}),c.i("{93c7910}","{0915cd3}");break;case 68:h=this.o;var y;(y=h.T)===null||y===void 0?p=0:y.g==0?(y.g=1,c.i("{4c846ba}","{008dc86}"),Tf(y),Rf(y),p=!0):p=!1,p&&Wt(h,{pcmDumpTrigger:!0});break;case 71:this.Cc();break;case 76:u==null||nh(u,!u.isVisible()),Nt(this.j);break;case 83:Rh(this.T);break;case 115:h=this.o,h.ra?(yh(h.D),h.ra=!1,Xh(h),Pi(h,"Profiler: OFF, Stats: OFF")):(zh(h),Zh(h),Pi(h,"Profiler: ON, Stats: ON"));break;case 116:h=this.o,Un(h)?(Xh(h),Pi(h,"Stats: OFF")):(Zh(h),Pi(h,"Stats: ON"));break;case 117:this.o.toggleOnScreenStats(e.shiftKey);break;case 118:case 192:h=this.o,h.perfIndicator=!h.perfIndicator,Wt(h,{perfIndicator:{on:h.perfIndicator}});break;case 120:h=this.j,h.s=!h.s,Pi(h.R,"UnadjustedMovement: "+(h.s?"ON":"OFF")),c.i("{70cc40b}","{796c5cb}",h.s?"ON":"OFF");break;case 189:this.S=!this.S,Pi(this.o,"Position dependent keys: "+(this.S?"ON":"OFF")),c.i("{8bacfa5}","{61d2ab5}",this.S?"ON":"OFF");break;case 77:this.o.na();break;default:o=!0}else o=!0;else this.o.toggleStutterIndicator();else{e:{if((e.ctrlKey||e.shiftKey||e.metaKey||e.altKey)&&((d=this.Z.get(s))||(d=this.$.get(e.key)),d)){l=d.hc,l==128&&(l=this.R?4:1),y=e.ctrlKey;const G=e.altKey,E=e.metaKey,D=e.shiftKey;if((l&1?y:!y)&&(l&2?G:!G)&&(l&4?E:!E)&&(l&8?D:!D))break e}d=void 0}if(d){u=ns(this,e);for(h of d.ld)l=u&~Cd(h),u!=l&&(u=l,yt(this.h,4,h,u,r)),this.Sa.delete(h);for(p of d.Zb)u|=Cd(p),yt(this.h,3,p,u,r);yt(this.h,3,d.Yb,u,r),yt(this.h,4,d.Yb,u,r);for(var N of d.Zb)u&=~Cd(N),yt(this.h,4,N,u,r);this.Sa.delete(s)}else if(u!=null&&u.isVisible())if(s==13)u.toggle(),Nt(this.j);else if(s==82)u.reset(),Nt(this.j);else if(s==65)io(u,!u.bc.checked);else if(s==83)if(u.fc.length){for(h=`LDAT_${new Date().toISOString()}.csv`,p=["Sample #,Total,Render,Decode,Begin,Server + Rtd + Receive,Input Callback"],N=0;N<u.fc.length;N++)l=ah(u.fc[N]),p.push([N,l.total,l.Kf,l.decode,l.He,l.Of,l.ff].join());Jr([p.join(`
`)],h,"text/plain")&&c.i("{50c79eb}","{690879e}",h)}else c.w("{50c79eb}","{2884507}");else s==67?(c.i("{50c79eb}","{d2811a7}"),u.Ub.value="50",u.Vb.value="50",dh(u,.5,.5)):s==77?u.zb.checked=!u.zb.checked:o=!0;else o=!0}o&&(Si(Ai()),yt(this.h,3,s,ns(this,e),r)),e.key!="Hankaku"&&e.key!="Zenkaku"||s!=192||(n=!0),this.R&&e.metaKey&&!d&&(n=!0),this.C&&(e.code=="Backspace"&&(n=!0),e.code==""&&e.key=="Enter"&&(o=new CompositionEvent("compositionend",{data:(t=this.textInputElement)===null||t===void 0?void 0:t.value}),(i=this.textInputElement)===null||i===void 0||i.dispatchEvent(o))),n&&(yt(this.h,4,s,ns(this,e),r),this.Sa.delete(s))}}}}Ta(e){let t=!1;const i=xt(this.G,e.timeStamp);if(this.C&&e.code==""&&e.key=="Unidentified"&&!this.sa)yt(this.h,3,8,0,i),yt(this.h,4,8,0,i);else{var n=this.R&&this.ma?e.code=="CapsLock":!1;n&&(t=t||n),wu(this,e),(!this.aa.includes(e.keyCode)||n)&&(n=n?160:Sd(this,e),t&&(yt(this.h,3,n,ns(this,e),i),this.Sa.add(n)),this.Sa.has(n)&&(this.Sa.delete(n),Si(Ai()),yt(this.h,4,n,ns(this,e),i)))}}Ba(e){c.d("{8bacfa5}","{77df54c}",e?"fullscreen":"not fullscreen"),this.fa({}),e?(window.isSecureContext&&(e=window.navigator.keyboard)&&e.lock&&e.lock("Escape F11 BrowserBack BrowserForward BrowserRefresh BrowserHome BrowserFavorites BrowserSearch BrowserStop Sleep Power WakeUp KeyT KeyZ Slash Digit1 Digit2 Digit3 Digit4 Digit5 Digit6 Digit7 Digit8 Digit9 KeyM KeyD KeyN KeyS KeyK KeyL Space PrintScreen LaunchApp1 LaunchApp2 LaunchMail Comma Semicolon ArrowLeft ArrowRight BracketLeft BracketRight KeyW KeyQ KeyR KeyY KeyO KeyP KeyF KeyG".split(" ")),this.l.onclick=null,this.l.removeAttribute("controls")):(Ks(this),fd(this.j),window.isSecureContext&&(e=window.navigator.keyboard)&&e.unlock&&e.unlock())}toggleUserInput(e,t){if(c.d("{8bacfa5}","{2424824}",e,t),t=t??15,e){var i,n,r,s,o,d,u=!this.xb(),l=(this.v^t)&t;if(l){if(this.v|=l,l&4&&(this.M?(Dn(this.m,this.s),this.s.start()):(this.s.stop(),this.s.reset(),Dn(this.m,this.h))),l&1){var h=this.j;if(!h.C){if(h.C=!0,!_(h.u)){if(h.cursorType==2&&h.J){var p=h.M;p.ud="pointerdown",p.Sd="pointerup",h.videoAddEventListener("pointerdown",h.Ba),h.videoAddEventListener("pointerup",h.Ea)}else p=h.M,p.ud="mousedown",p.Sd="mouseup",h.videoAddEventListener("mousedown",h.ma),h.videoAddEventListener("mouseup",h.sa);h.u.os==="Xbox"||h.videoAddEventListener("contextmenu",du)}h.documentAddEventListener("wheel",h.ta,h.va),Su(h),h.cursorType===0&&(h.j.style.display="block"),Nt(h),vn(h)}}l&2&&(this.documentAddEventListener("keydown",this.Pa),this.documentAddEventListener("keyup",this.Ua),(i=this.textInputElement)===null||i===void 0||i.addEventListener("input",this.bb),(n=this.textInputElement)===null||n===void 0||n.addEventListener("compositionstart",this.N),(r=this.textInputElement)===null||r===void 0||r.addEventListener("compositionupdate",this.N),(s=this.textInputElement)===null||s===void 0||s.addEventListener("compositionend",this.N),this.K=0,this.wa&&((o=this.textInputElement)===null||o===void 0||o.addEventListener("focus",this.Xa),(d=this.textInputElement)===null||d===void 0||d.addEventListener("blur",this.Wa))),l&8&&(this.D&&!this.yb?this.D.start():this.I&&this.I.start()),u&&this.preventNavigation&&!this.W&&(this.W=!0,history.pushState(null,document.title,location.href),this.windowAddEventListener("popstate",this.Za))}}else{var y,N;(r=this.v&t)&&(this.v^=r,i=!this.xb(),r&4&&(this.M?(mr(this.m,this.s),this.s.stop(),this.s.reset()):mr(this.m,this.h)),r&1&&(n=this.j,n.C&&(fd(n),n.C=!1,_(n.u)||(n.cursorType==2&&n.J?(n.videoRemoveEventListener("pointerdown",n.Ba),n.videoRemoveEventListener("pointerup",n.Ea)):(n.videoRemoveEventListener("mousedown",n.ma),n.videoRemoveEventListener("mouseup",n.sa)),n.u.os==="Xbox"||n.videoRemoveEventListener("contextmenu",du)),n.documentRemoveEventListener("wheel",n.ta,n.va),yu(n),n.cursorType===0&&(n.j.style.display="none"),Nt(n),vn(n),Ws(n))),r&2&&(Ks(this),this.documentRemoveEventListener("keydown",this.Pa),this.documentRemoveEventListener("keyup",this.Ua),(u=this.textInputElement)===null||u===void 0||u.removeEventListener("input",this.bb),(h=this.textInputElement)===null||h===void 0||h.removeEventListener("compositionstart",this.N),(l=this.textInputElement)===null||l===void 0||l.removeEventListener("compositionupdate",this.N),(p=this.textInputElement)===null||p===void 0||p.removeEventListener("compositionend",this.N),this.wa&&((y=this.textInputElement)===null||y===void 0||y.removeEventListener("focus",this.Xa),(N=this.textInputElement)===null||N===void 0||N.removeEventListener("blur",this.Wa))),r&8&&(this.I&&this.I.stop(),this.D&&this.D.stop(),this.J!==0&&yd(this),n=this.L,n.Ga=void 0,ku(n)),i&&this.preventNavigation&&this.W&&(this.windowRemoveEventListener("popstate",this.Za),history.back(),this.W=!1))}}xb(){return this.v!==0}Bb(){const e=performance.now();e<this.qa+500?(this.qa=0,this.toggleRsdmm(!this.M)):this.qa=e}toggleRsdmm(e){da&&e!=this.M&&(e?(Dn(this.m,this.s),mr(this.m,this.h),this.s.start()):(this.s.stop(),this.s.reset(),Dn(this.m,this.h),mr(this.m,this.s)),this.M=e)}Yc(){return this.M}jb(e){e?(md(this),c.d("{8bacfa5}","{cb19d31}")):(c.d("{8bacfa5}","{8744dbe}"),Ks(this),fd(this.j))}Ab(){this.da&&bd(this)}getVirtualGamepadHandler(){return this.m.getVirtualGamepadHandler()}sendTextInput(e){this.h.sendTextInput(e)}Nb(e){switch(e.type){case"compositionstart":this.K=1;break;case"compositionupdate":!_(this.u)&&Ed(e.data)||this.O.emit("TextComposition",{compositionText:e.data,imeRecommendation:!0});break;case"compositionend":const t=this.C?e.data.trim():e.data;t.length&&(e=_(this.u)||!Ed(e.data),this.C&&!e?Tu(this,t):Iu(this,t),e&&this.O.emit("TextComposition",{compositionText:""})),this.K=0}}Ob(){this.sa=!0;let e=this.textInputElement.value;this.K==1&&(this.C&&1<e.length&&(e=e.charAt(e.length-1)),this.K=2),this.C&&Ed(e)?(Tu(this,e),this.K=0):this.K!=2&&Iu(this,e)}setVirtualKeyboardState(e){c.i("{8bacfa5}","{60b2d45}",e),this.yb!==e&&(this.yb=e,this.I&&this.D&&(this.yb?(this.D.stop(),this.I.start()):(this.I.stop(),this.g.la!==1&&xn(this,0,0,1),this.D.start())))}setKeyboardLayout(e){this.ma=e=="zh-TW"}scroll(e,t,i){0<i.length&&Nl(this.h,Math.sign(i[0].deltaY),t)}sendKeyEvent(e){Us(this.h)&&(Sd(this,e)?e.type==="keydown"?this.La(e):e.type==="keyup"&&this.Ta(e):e.type==="keydown"&&e.key.length===1&&(e=new TextEncoder().encode(e.key),this.sendTextInput(e.buffer)))}lc(e){this.j.lc(e)}Cc(){Ct&&(this.V=!this.V,this.P.Cc(this.l),this.V?Dn(this.m,this.P):mr(this.m,this.P))}startInputPlayback(e){var t;this.ba||(this.ba=new mg(this.h,this.G)),!((t=this.ba)===null||t===void 0)&&t.initialize(e)&&this.ba.start()}};function $s(e){e.h=!0,ku(e),Pu(e),e.h=!1}function ku(e){e.g!==0&&(window.clearTimeout(e.g),e.g=0)}function Pu(e){const t=e.Ga;t&&(e.Ga=void 0,t())}class Xg{constructor(){this.g=0,this.h=!1}delay(t){this.h?t():($s(this),this.Ga=t,this.g=window.setTimeout(()=>{this.g=0,Pu(this)},Zg))}}var Zg=30;function qs(){let e=[];return e.push(162),e.push(163),e.push(164),e.push(165),e.push(91),e.push(92),e.push(160),e.push(161),e}function Cd(e){switch(e){case 162:case 163:return 2;case 164:case 165:return 4;case 91:case 92:return 8;case 160:case 161:return 1}return 0}function e0(e,t,i){if(t.packetsReceived!==void 0&&t.packetsLost!==void 0&&i.packetsReceived!==void 0&&i.packetsLost!==void 0&&i.pliCount!==void 0&&t.pliCount!==void 0){var n=t.packetsLost-i.packetsLost,r=100-n/(t.packetsReceived-i.packetsReceived+n)*100;for((isNaN(r)||r===void 0)&&(r=0),t=t.pliCount-i.pliCount,0<t&&n&&(r=0),n=0;n<t+1;n++)e.networkLossScore=7*e.networkLossScore/8+r/8}}function Ou(e){return e.qualityScore=3*e.qualityScore/4+Math.min(e.latencyScore,e.networkLossScore,e.bandwidthScore)/4,{latencyScore:e.latencyScore,networkLossScore:e.networkLossScore,bandwidthScore:e.bandwidthScore,qualityScore:e.qualityScore}}var t0=class{constructor(e,t){this.maxBitrate=e/1e3,this.h=t/1e3,this.g=this.networkLossScore=this.bandwidthScore=this.latencyScore=this.qualityScore=100}reset(){this.g=this.networkLossScore=this.bandwidthScore=this.latencyScore=this.qualityScore=100}};function Id(){return hn===!1?Promise.resolve(0):window.navigator.permissions?window.navigator.permissions.query({name:"microphone"}).then(e=>{e=e.state;let t=2;return e=="granted"?t=5:e=="prompt"&&(t=1),t}).catch(()=>0):Promise.resolve(0)}function It(e,t,i=!0){e.h=t,e.h===3&&(e.M=!0),e.I&&i&&e.I.emit("MicCapture",{state:e.h})}function i0(e){hn!==!1&&(e.v||e.h==3||e.h==2||e.h==6||e.h==7?It(e,e.h):Id().then(t=>{t!==0&&It(e,t)}))}function Td(e){if(e.initialized)if(ss){e.o=!1,e.paused=!0,e.K=void 0;var t=e.h;if(navigator.mediaDevices.ondevicechange=()=>{},e.C){c.d("{223689a}","{6faf5bb}");let n=Lu();var i=e.C.getSenders()[0];i?i.replaceTrack(n.getTracks()[0]).then(()=>{c.d("{223689a}","{797fa55}"),It(e,5,!1),t===3&&(e.D=!0)}).catch(r=>{c.e("{223689a}","{79f26cc}",r),It(e,7,!1)}).finally(()=>{let r=e.g;e.g=null,r&&r.getTracks().forEach(s=>{s.stop()}),It(e,e.h),_(e.u)&&!Ce(e.u,!1,15,4)&&e.j()}):(c.e("{223689a}","{f7f0250}"),e.g=null)}else c.e("{223689a}","{9e75fa2}"),It(e,0)}else It(e,6)}function Js(e,t){var i;e.m=!0,e.s.set(t,((i=e.s.get(t))!==null&&i!==void 0?i:0)+1),c.d("{223689a}","{30f8637}",t)}async function Du(e,t){return e.v=!0,navigator.mediaDevices.getUserMedia({audio:t}).then(i=>{if(c.d("{223689a}","{b204737}"),It(e,5,!1),e.v=!1,e.g=i,_(e.u)&&(i.getTracks()[0].onended=()=>{e.N=performance.now(),c.i("{223689a}","{6b60d82}"),Td(e)}),e.g.oninactive=()=>{c.d("{223689a}","{eee54f1}"),e.J.clear(),e.g=null},e.paused)c.d("{223689a}","{21e76e1}"),e.g=null,It(e,7);else{var n=e.C.getSenders()[0];n?n.replaceTrack(i.getTracks()[0]).then(()=>{var r;c.i("{223689a}","{6c92139}");const s=(r=e.Da)!==null&&r!==void 0?r:e.H;if(_(e.u)&&!Ce(e.u,!1,15,4)&&s&&!s.muted){let o;s.srcObject&&(o=s.play(),c.i("{223689a}","{23a6493}",s.tagName)),o?o.then(()=>{c.d("{223689a}","{5593cbe}"),e.j()}).catch(d=>{e.j();try{vt(e.L,"WAR: Play Error",d==null?void 0:d.name,d==null?void 0:d.message),c.e("{223689a}","{69aae72}",d==null?void 0:d.name,d==null?void 0:d.message)}catch{}}):c.e("{223689a}","{b6a6508}")}It(e,3),e.D=!1,Ce(e.u,!1,15,4)&&(e.m=!1,e.G=!1)}).catch(r=>{c.e("{223689a}","{5c42246}",r),e.g=null,It(e,7)}):(c.e("{223689a}","{f7f0250}"),e.g=null)}}).catch(i=>{var n,r;_(e.u)&&!Ce(e.u,!1,15,4)&&e.j(),e.v=!1,i instanceof DOMException&&i.name==="NotAllowedError"?(c.e("{223689a}","{3f9bd66}"),It(e,2),e.G&&!e.m&&Js(e,"permissionDenied")):i instanceof DOMException&&i.name==="NotFoundError"?(c.e("{223689a}","{7f04869}"),It(e,4)):(i instanceof DOMException&&i.name==="NotReadableError"?(e.J.add((n=t.deviceId)!==null&&n!==void 0?n:"default"),c.e("{223689a}","{af7e08c}",(r=t.deviceId)!==null&&r!==void 0?r:"default",i.name,i.message),navigator.mediaDevices.enumerateDevices().then(s=>{for(const o of s)if(o.kind==="audioinput"&&o.deviceId!=="default"&&!e.J.has(o.deviceId)){c.d("{223689a}","{655d8b0}",o.deviceId,o.label),t.deviceId=o.deviceId,Du(e,t);break}}).catch(s=>{c.e("{223689a}","{930e826}",s.name,s.message)})):c.e("{223689a}","{c361fc5}",i.name,i.message),It(e,7))})}async function Qs(e,t){var i,n;e.initialized&&(ss?(e.o=!0,e.g!=null||e.v||(c.d("{223689a}","{981c872}",(i=t==null?void 0:t.deviceId)!==null&&i!==void 0?i:"default"),e.K=t,e.paused=!1,It(e,1,!1),t={sampleRate:48e3,deviceId:(n=e.K)===null||n===void 0?void 0:n.deviceId},ve(e.u)&&(t.googAutoGainControl2=!1),navigator.mediaDevices.ondevicechange=()=>{c.i("{223689a}","{50d0169}",!!e.g,e.v),e.g!=null||e.v||(c.d("{223689a}","{c849290}"),Qs(e,e.K))},await Du(e,t),e.F||Mu(e))):(c.e("{223689a}","{999b07b}"),It(e,6)))}function Mu(e){return navigator.mediaDevices.enumerateDevices().then(t=>{let i=0;c.d("{223689a}","{fa1ec18}",JSON.stringify(t));for(const n of t)n.kind=="audioinput"&&i++;switch(i){case 0:e.F="No Audio Input",e.l.Jd++;break;case 1:e.F="Built-in Microphone",e.l.pd++;break;default:e.F="Headset Microphone",e.l.zd++}c.d("{223689a}","{0d14ab6}",e.F)}).catch(()=>{c.e("{223689a}","{21131d5}")})}function Lu(){let e=bl(48e3);if(e){let t=e.createMediaStreamDestination().stream.getAudioTracks()[0];return e.close(),t.enabled=!0,new MediaStream([t])}throw Error("Mic stream is not supported")}function Ys(e){if(hn!==!1){if(e.g!=null){let t=e.g;e.J.clear(),e.g=null,navigator.mediaDevices&&(navigator.mediaDevices.ondevicechange=()=>{}),t.getTracks().forEach(i=>{i.stop()})}e.o=!1,It(e,5),Qe(e.L,"AudioInputType",e.M?"started":"not started",0,e.l.Jd,e.l.pd,e.l.zd),Ce(e.u,!1,15,4)&&Qe(e.L,"LowAudioVolume","",0,e.s.get("permissionDenied"),e.s.get("visibilityChange"),e.s.get("deviceChange")),e.C=null,e.I=null,e.H=void 0,e.Da=void 0,e.initialized=!1,e.l={Jd:0,pd:0,zd:0};for(const[t]of e.s)e.s.set(t,0);e.m=!1,e.D=!1,e.G=!1,e.M=!1}}function Rd(e){return e.F==="Built-in Microphone"}function Nu(e,t){Mu(e).then(()=>{t!==0&&Ce(e.u,!1,15,4)&&!e.m&&Rd(e)&&(e.o||e.D)&&Js(e,"deviceChange")})}var xu=class{constructor(e,t){this.I=null,this.h=0,this.o=!1,this.J=new Set,this.initialized=this.O=!1,this.N=0,this.D=this.G=this.m=!1,this.l={Jd:0,pd:0,zd:0},this.s=new Map([["permissionDenied",0],["visibilityChange",0],["deviceChange",0]]),this.M=!1,this.u=e,this.L=t,this.g=this.C=null,this.paused=this.v=!1,Ce(e,!1,15)&&(this.O=!0)}initialize(e,t,i,n){if(hn!==!1){if(this.C=e,this.I=t,this.H=i,this.Da=n,ss){if(e=Lu(),e==null){c.w("{223689a}","{360f38b}");return}this.C.addTrack(e.getAudioTracks()[0],e),this.o&&Qs(this,this.K)}else c.w("{223689a}","{5813c2b}");this.initialized=!0}}j(){var e,t,i;if(Ri&&this.O){var n=(t=(e=this.Da)===null||e===void 0?void 0:e.srcObject)!==null&&t!==void 0?t:(i=this.H)===null||i===void 0?void 0:i.srcObject;if(n){c.i("{223689a}","{ad4b8c2}");var r=n.getAudioTracks()[0];r.enabled=!1,setTimeout(()=>{r.enabled=!0},0)}}}getMicState(){return this.h}},ss=!!navigator.mediaDevices&&!(!window.AudioContext&&!window.webkitAudioContext);function _u(e,t){switch(e){case 0:var i,n=window.RTCPeerConnection;if(n)if(_(t))t=Ce(t,!1,14,3);else{switch(e=!1,K(t)&&(e=!0),window.chrome&&(ue(t)?Ee(t,77)&&(e=!0):e=!0),t.browser){case"Chrome":Ee(t,77)&&(e=!0);break;case"Chromium":case"Edge":case"Brave":case"Yandex":case"Samsung":case"Silk":case"Opera":e=!0;break;case"Edge_Legacy":e=!1;break;case"Safari":const r=n==null?void 0:n.prototype;if(n=r&&((i=r.hasOwnProperty)===null||i===void 0?0:i.call(r,"canTrickleIceCandidates")))e:if(t.browser!="Safari")n=!1;else{try{n=ge(t.browserVer,!1,16,4);break e}catch{A.Log.w("{d988e7f}","{07fd1dd}")}n=!0}n&&(e=!0)}t=e}else t=!1;return t;case 1:return ss;default:return!1}}function Fu(e){return!(se(e)||le(e)||_(e))}function Xs(e,t,i){var n,r,s,o;const d=4953600<=e*t;var u=i===30?1.25*i:Math.min(i,60);let l=e*t*u;return Wa(e,t)||d?(e=(r=(n=Ea)!==null&&n!==void 0?n:Re.bitsPerPixel1440p)!==null&&r!==void 0?r:.325,n=2073600*u,u=n+(3686400*u-n)/3,l=d?u+(l-u)/12:n+(l-n)/3):e=(o=(s=ba)!==null&&s!==void 0?s:Re.bitsPerPixel)!==null&&o!==void 0?o:.3,l=l*e/1200,120<=i&&!d&&(l=Math.min(5e4,Math.round(1.15*l))),[Math.round(l),5e4]}function Uu(e,t){return t*=1e3,t=3600*(e===120?.916*t+293098:.678*t+910569)/1e9/8,e===30&&(t*=.625),t=Math.round(.95*t)}async function ju(e){return n0(e)}function Gu(e){var t,i,n,r,s,o,d,u;const l=e.u,h=e.vd,p=e.Xf;var y=l.os==="iPadOS",N=ie(l),G,E=e.Xf,D,z=(G=le(l)&&!navigator.userAgent.includes("SamsungBrowser")&&(D=(z=window.webapis)===null||z===void 0?void 0:z.productinfo)!==null&&D!==void 0&&D.isUdPanelSupported()?E.includes("H265"):!1)||(se(l)&&navigator.userAgent.includes("PWA")?!!window.lge_webrtc_hevc_support:!1)||V(l);E=(t=Ra)!==null&&t!==void 0?t:Re.forceHdrSupport,t=E??(((i=Re.enableHdrSupport)!==null&&i!==void 0?i:le(l))&&le(l)?Bu(l,p):!1),i=(r=(n=Pa)!==null&&n!==void 0?n:Re.forceSdr10Support)!==null&&r!==void 0?r:!((s=Re.enableSdr10Support)!==null&&s!==void 0)||s?Bu(l,p):!1;const[Z,Q]=Os([e.Pd,e.Od]);if(e={width:Math.round(Z*h),height:Math.round(Q*h),fps:60,scaleFactor:Math.round(100*h)},n=void 0,z?n={width:3840,height:2160,fps:e.fps}:y&&1366<=Z?n={width:1600,height:1200,fps:e.fps}:N&&(n={width:2560,height:1440,fps:e.fps}),y=[{width:2560,height:1600,fps:120},{width:3840,height:1080,fps:120}],z&&y.push({width:3840,height:2160,fps:60}),N=!1,t){if(G)N=!0;else{var ce=(o=window.matchMedia)===null||o===void 0?void 0:o.call(window,"(dynamic-range: high)").matches;o=(d=window.matchMedia)===null||d===void 0?void 0:d.call(window,"(video-dynamic-range: high)").matches,d=(u=window.matchMedia)===null||u===void 0?void 0:u.call(window,"(color-gamut: p3)").matches,c.i("{5083445}","{f9f1c3b}",ce,o,d),N=(ce||o)&&d}ce=m0(l),!N&&ce&&(c.w("{5083445}","{e13aa38}"),N=!0)}return E&&(N=!0),u=pl(),kd={displayMode:e,maxAutoMode:n,maxSupportedModes:y,features:{vsync:0,vvsync:!1,hdr:N,reflex:!1,audioChannelCount:u,bitDepth:t?10:8,sdrBitDepth:i?10:8,hdr10PlusGamingData:ce}}}let kd;function Bu(e,t){return le(e)||se(e)||_(e)?t.includes("H265"):t.includes("AV1")}function os(e){let t=0;return e!=null&&e.supported&&(t|=1),e!=null&&e.smooth&&(t|=2),e!=null&&e.powerEfficient&&(t|=4),t}async function n0(e){var t=Qi;t.g={u:e,Xf:await Pd(e),Pd:window.screen.width,Od:window.screen.height,vd:window.devicePixelRatio},e=Gu(t.g);for(const i of t.h)i(e);return e}async function r0(e){await Zs(e,!0)}function Vu(e){return e.l=Er("av1").then(t=>(e.s=t,e.s)),e.l}function Hu(e){return e.m=Er("h265").then(t=>(e.v=t,e.v)),e.m}function s0(e){var t;window.removeEventListener("resize",e.j),window.removeEventListener("focus",e.j);const i=window.screen;(t=i.removeEventListener)===null||t===void 0||t.call(i,"change",e.j)}function o0(e){var t=Qi;t.h=t.h.filter(i=>i!==e),t.h.length===0&&s0(t)}function Er(e){const t=navigator.mediaCapabilities;return t?t.decodingInfo({type:"webrtc",video:{contentType:"video/"+e,width:1920,height:1080,framerate:60,bitrate:1e3*Xs(1920,1080,60)[0]}}).catch(i=>{c.w("{5083445}","{f5c2155}",e,i)}):Promise.resolve(void 0)}function Wu(){var e=Qi;return e.s?Promise.resolve(e.s):e.l?e.l:Vu(e)}function zu(){var e=Qi;return e.v?Promise.resolve(e.v):e.m?e.m:Hu(e)}function Zs(e,t){return t&&(e.refreshRate=void 0),e.refreshRate?Promise.resolve(e.refreshRate):e.o?e.o:d0(e)}async function a0(){return 117<=await Zs(Qi,!1)}function d0(e){return e.o=c0().then(t=>(e.refreshRate=t,e.refreshRate),()=>{var t;return(t=e.refreshRate)!==null&&t!==void 0?t:0}),e.o}function c0(){return new Promise((e,t)=>{let i=!1;const n=window.setTimeout(()=>{i=!0},4e3),r=[];let s,o=window.innerWidth,d=window.innerHeight,u=window.screenX,l=window.screenY;const h=()=>{window.requestAnimationFrame(()=>{if(i)c.w("{5083445}","{0b0c6f9}","Timed out during the refreshRate loop"),window.clearTimeout(n),t();else{if(window.innerWidth!=o||window.innerHeight!=d||u!=window.screenX||l!=window.screenY){o=window.innerWidth,d=window.innerHeight,u=window.screenX,l=window.screenY;var p=!0}else p=!1;p?(c.w("{5083445}","{824b461}"),r.length=0,h()):(p=performance.now(),r.length&&r[0]<=p-2e3?(s=Math.floor(r.length/2),c.d("{5083445}","{8c3d290}",s,r[r.length-1]-r[0]),p=s,window.clearTimeout(n),e(p)):(r.push(p),h()))}})};h()})}class l0{constructor(){this.h=[],this.C=!1,this.j=()=>{if(this.g){var t=window.screen.width,i=window.screen.height,n=window.devicePixelRatio;if(t!==this.g.Pd||i!==this.g.Od||n!==this.g.vd){this.g.Pd=t,this.g.Od=i,this.g.vd=n,t=Gu(this.g);for(const r of this.h)r(t)}}}}}var Qi=new l0,u0=1,h0=2,f0=4,Ku=7;async function p0(){const e=await Er("h264");if(e!==void 0)return!!(e!=null&&e.powerEfficient)}async function v0(e,t){var i,n,r;const s=(n=(i=Ca)!==null&&i!==void 0?i:Re.enableAv1Support)!==null&&n!==void 0?n:ve(e)?ue(e):J(e)?ue(e)||e.browser==="Edge":!1;return i=(r=Re.enableAv1ByResolutionAndFps)!==null&&r!==void 0?r:Ku,!s||$u(i,t)?!1:se(e)&&window.lge_webrtc_av1_support!=null?window.lge_webrtc_av1_support:(e=await Wu(),!!(e!=null&&e.powerEfficient))}function $u(e,t){return t&&(4953600<=t.width*t.height&&!(e&f0)||Wa(t.width,t.height)&&!(e&h0)||t.fps===120&&!(e&u0))}async function g0(e){var t,i,n;const r=(i=(t=Ia)!==null&&t!==void 0?t:Re.enableH265Support)!==null&&i!==void 0?i:le(e)||se(e)||V(e);if(t=(n=Re.enableH265ByResolutionAndFps)!==null&&n!==void 0?n:Ku,!r||$u(t))return!1;if(se(e)&&window.lge_webrtc_hevc_support!=null)return window.lge_webrtc_hevc_support;if(le(e)){var s,o,d;if(le(e)){e=(d=(o=(s=window.webapis)===null||s===void 0?void 0:s.productinfo)===null||o===void 0?void 0:o.getSmartTVServerVersion)===null||d===void 0?void 0:d.call(o);e:{if(e&&(s=e.match(/T-INFOLINK(\d+)-(\d+)/))){s={year:parseInt(s[1],10),version:parseInt(s[2],10)};break e}s=void 0}s?(o=s.year,s=s.version,c.i("{5083445}","{fc40a4b}",o,s),s=o===2021||2023<=o||o===2022&&1008<=s):(c.e("{5083445}","{e227976}",e),s=!1)}else s=!1;return s}return s=await zu(),!!(s!=null&&s.powerEfficient)}async function Pd(e,t){var i;let n=[];const r=(i=Ta)!==null&&i!==void 0?i:Re.codecList;if(r)for(const s of r)n.push(s);else t=v0(e,t),e=g0(e),await t&&n.push("AV1"),await e&&n.push("H265"),n.push("H264");return n}function m0(e){var t,i;const n=(t=ka)!==null&&t!==void 0?t:Re.hdr10gParams;if(n&&(t=n.split(",").map(o=>parseInt(o,10)),c.i("{5083445}","{4c54116}",t.join(", ")),3<=t.length&&!t.some(o=>isNaN(o)))){const[o,d,u]=t;return{version:o,peakLuminanceIndex:d,peakFullFrameLuminanceIndex:u}}if(le(e))try{const o=window.webapis.hdr10pluscloud;if(o){if((i=o==null?void 0:o.isHdr10plusGamingSupported())!==null&&i!==void 0&&i){var r=o==null?void 0:o.getPeakLuminanceIndex(),s=o==null?void 0:o.getFullFramePeakLuminanceIndex();return c.i("{5083445}","{a5dcb3f}",1,r,s),r===void 0||s===void 0?void 0:{version:1,peakLuminanceIndex:r,peakFullFrameLuminanceIndex:s}}c.i("{5083445}","{c91f105}")}else c.i("{5083445}","{e293b13}")}catch(o){c.w("{5083445}","{b510204}",o)}}function qu(e){if(navigator.mediaCapabilities){var t=performance.now();Er("h264").then(async i=>{if(i){var n=Er("h265; level-id=153;profile-id=1;tier-flag=1"),r=Er("h265; level-id=153;profile-id=2;tier-flag=1"),s=Wu(),o=zu();n=os(await n),r=os(await r),s=os(await s),o=os(await o),Qe(e,"MediaCapabilities2",`AV1: ${s}`,os(i),o,n,r),i=await Zs(Qi),o=await a0(),c.d("{5083445}","{1efbc27}",i,o),Qe(e,"DisplayCaps","Is120FpsSupported: "+o,i,0,0,0)}else Qe(e,"MediaCapabilities2","webrtc or h264 unsupported",performance.now()-t,-1,-1,-1)})}else Qe(e,"MediaCapabilities2","API unsupported",-1,-1,-1,-1)}function A0(e){let t={origin:"",time:"",mb:new Map,media:[]},i=new Map,n,r,s=!1;const o=()=>{if(s)if(r&&n)t.media.push({mediaType:r,xc:n,attributes:i}),n=r=void 0;else return c.e("{eb7c2d0}","{adc37a7}"),!1;else t.mb=i,s=!0;return i=new Map,!0};for(const u of e.split(/\r?\n/))if(!(2>u.length||u[1]!=="=")){var d=u[0];if(e=u.substr(2),d=="m"){if(!o())return;r=e.split(" ")[0]}else if(d=="a"){if(d=e.split(":",2),d.length!==1){if(d.length!==2){c.e("{eb7c2d0}","{f6bdb84}",e);return}if(e=d[0],d=d[1],e==="msid")if(n===void 0)n=d;else{c.e("{eb7c2d0}","{dc7fbec}",d);return}else i.set(e,d)}}else if(d=="t"){if(s){c.e("{eb7c2d0}","{14fc069}");return}t.time=e}else if(d=="o"){if(s){c.e("{eb7c2d0}","{eb0287a}");return}t.origin=e}}if(o())if(t.time===""||t.origin==="")c.e("{eb7c2d0}","{8e7e486}");else return t}function Od(e,t,i,n){const r=/^([^[.]+)(?:\[(\d+)\])?\.([^:]+): *(.+)$/;let s=!0;for(const u of e.split(/\r?\n/)){var o=r.exec(u);if(o){var d=o[1];e=o[2]!==void 0?Number.parseInt(o[2]):void 0;const l=o[4];o=d+"."+o[3],d=S0(d);const h=Ju(t,d,e),p=Ju(i,d,e);h&&p?p.has(o)?(c.d("{eb7c2d0}","{2beb68f}",n,o,l),h.set(o,l)):(c.w("{eb7c2d0}","{cc4fdef}",n,o,l),s=!1):(c.w("{eb7c2d0}","{a649ad8}",n,d,e),s=!1)}}return s}function S0(e){switch(e){case"video":case"vqos":case"qscore":case"bwe":case"clientPerfBr":case"packetPacing":return"video";case"audio":case"aqos":case"audioBitrate":return"audio";case"ri":return"application";case"mic":return"mic"}}function eo(e,t,i){e.set(i?"vqos.dfc.adjustResAndFps":"vqos.drc.enable",t?"1":"0")}function y0(e,t){let i=!0;const n=(o,d)=>(o=o.get(d))&&(o=parseInt(o),!Number.isNaN(o))?o:(c.e("{eb7c2d0}","{0a60213}",d),i=!1,0),r=(o,d)=>{if(o=o.get(d))try{return BigInt(o)}catch{c.e("{eb7c2d0}","{66a68eb}",o)}return c.e("{eb7c2d0}","{0a60213}",d),i=!1,BigInt(0)};e.qd=n(t.mb,"general.clientCapture");let s=0;for(const o of t.media){if(o.mediaType==="video"&&s<e.video.length){t=e.video[s];const d=o.attributes;t.Sb=n(d,"video.clientViewportWd"),t.Rb=n(d,"video.clientViewportHt"),t.ic=n(d,"video.maxFPS"),t.Ad=n(d,"video.initialBitrateKbps"),t.ef=n(d,"video.initialPeakBitrateKbps"),t.vc=n(d,"vqos.bw.maximumBitrateKbps"),t.bd=n(d,"vqos.bw.minimumBitrateKbps"),t.uc=0<n(d,"video.mapRtpTimestampsToFrames"),t.Uc=n(d,"video.dynamicRangeMode"),t.bitDepth=n(d,"video.bitDepth"),s++}o.mediaType==="application"&&(e.Lb.Kd=n(o.attributes,"ri.partialReliableThresholdMs"),e.Lb.bf=n(o.attributes,"ri.hidDeviceMask"),e.Lb.Qe=n(o.attributes,"ri.enablePartiallyReliableTransferGamepad"),e.Lb.Re=r(o.attributes,"ri.enablePartiallyReliableTransferHid"))}return i}function Ju(e,t,i){var n;return t===void 0?e.mb:(n=e.media.filter(r=>r.mediaType===t)[i??0])===null||n===void 0?void 0:n.attributes}function b0(e,t){let i=`v=0
o=${e.origin}
s=-
t=${e.time}
`;const n=(r,s)=>{for(const[o,d]of r){r=o;const u=d;u!==s.get(r)&&(i+=`a=${r}:${u}
`)}};n(e.mb,t.mb);for(const r of e.media)i+=`m=${r.mediaType} 0 RTP/AVP
`,i+=`a=msid:${r.xc}
`,e=t.media.find(s=>s.xc===r.xc),n(r.attributes,e.attributes);return i}function E0(e){switch(e){case 0:return 0;case 1:return 1;case 2:return c.w("{eb7c2d0}","{30c875c}"),0;default:return c.w("{eb7c2d0}","{7cd5754}",e),0}}function to(e){const t=e.j-e.g;return t!=0?(e.l-e.h)/t:0}class w0{constructor(){this.j=this.g=this.l=this.h=0}update(t,i){this.h==0&&this.g==0?(this.h=t,this.g=i):(this.j=i,this.l=t)}reset(){this.h=this.l,this.g=this.j}}function C0(e,t,i){var n,r,s,o;let d=(n=t.bytesReceived)!==null&&n!==void 0?n:0;n=(r=i.bytesReceived)!==null&&r!==void 0?r:0,t=(s=t.timestamp)!==null&&s!==void 0?s:0,i=(o=i.timestamp)!==null&&o!==void 0?o:0,t!=i&&(e.m=(d-n)/(125*(t-i)))}function I0(e,t){if(t.frameWidth&&t.frameHeight&&(e.streamingResolution={width:t.frameWidth,height:t.frameHeight}),t.framesDecoded){const i=e.P,n=t.timestamp;i!==n&&(e.fps=Math.floor((t.framesDecoded-e.F)/(n-i)*1e3)),e.F=t.framesDecoded,t.totalDecodeTime&&(e.o.update(t.totalDecodeTime,t.framesDecoded),e.sd=1e3*t.totalDecodeTime/t.framesDecoded)}t.framesReceived&&(e.N=t.framesReceived,t.totalInterFrameDelay&&(e.O=1e3*t.totalInterFrameDelay/(t.framesReceived-1))),t.framesDropped&&(e.J=t.framesDropped),t.packetsLost&&(e.M=t.packetsLost),t.pliCount&&(e.v=t.pliCount),e.P=t.timestamp}function Qu(e,t){e.L.innerText=Yu(e,t),e.j={value:0,count:0,max:0},e.l={value:0,count:0,max:0},e.o.reset()}function Yu(e,t){var i=`Seat: ${e.h.zoneName} (${e.h.Nd}) / ${e.h.gpuType}
`,n=`Game: CMS ${e.h.appId}`;e.avgGameFps!==void 0&&(n+=` / fps ${e.avgGameFps.toFixed()}`),i=i+(n+`
`)+`Stream: Current ${fr(e.streamingResolution)}@${e.fps} / Default: ${e.h.streamInfo.width}x${e.h.streamInfo.height}@${e.h.streamInfo.fps} / Codec ${e.codec}${e.hdr?e.s?` HDR10+G (${e.D?"C":"_"}${e.s?"S":"_"})`:" HDR":""} ${e.bitDepth} bpc
Network: RTD ${e.rtd}ms / FL ${e.v} / PL ${e.M} / J ${e.I.toFixed(2)}ms / Bitrate ${e.m.toFixed(2)}Mbps / BWU ${e.Qb.toFixed(2)}%
QOS: frame ${e.F} / FT ${e.O.toFixed(2)} / D ${(1e3*to(e.o)).toFixed(2)} / Q ${Math.floor(e.C.qualityScore)} / Marker ${e.R}
Client: ${e.u.os} ${e.h.clientAppVersion} ${e.h.clientLocale} Resolution ${fr({width:window.innerWidth*window.devicePixelRatio,height:window.innerHeight*window.devicePixelRatio})}
Input ${e.g.gf}
`,n=`DC ${Zu(e.j)}ms (${e.j.max.toFixed(2)}ms) / Blocked ${e.K}
`;const r=`Stats ${Zu(e.l)}ms (${e.l.max.toFixed(2)}ms) / FR ${e.N} / FDR ${e.J}
`,s=`Latency ${e.C.latencyScore.toFixed(1)} / Network ${e.C.networkLossScore.toFixed(1)} / Bandwidth ${e.C.bandwidthScore.toFixed(1)}
`,o=`VP ${e.g.kf?"y":"n"} / AP ${e.g.hf?"y":"n"} / UI ${e.g.xb?"y":"n"} / VKB ${e.g.yb?"y":"n"} / MS ${e.g.uf} / RSDMM ${+e.g.Yc}
`;return e=`KBL ${e.g.keyboardLayout} / ALM ${+e.g.appLaunchMode} / SWD ${e.T?"y":"n"} / ${e.dc}`,t&&(i+=n+r+s+o+e),i}var Xu=class{constructor(e,t,i){this.m=this.fps=0,this.Qb=4,this.M=this.rtd=this.I=this.J=this.N=this.F=this.P=this.G=0,this.streamingResolution={width:0,height:0},this.K=this.O=0,this.j={count:0,max:0,value:0},this.l={count:0,max:0,value:0},this.o=new w0,this.S=this.v=this.sd=0,this.codec="UNKNOWN",this.s=this.D=this.hdr=!1,this.bitDepth=8,this.T=!1,this.dc="",this.R=0,this.H=e,this.u=t,this.h=i,this.C={qualityScore:0,bandwidthScore:0,networkLossScore:0,latencyScore:0},e=document.getElementById("overlay-543d9968"),e||(e=document.createElement("div"),e.id="overlay-543d9968",e.style.display="none",e.style.position="fixed",_(this.u)?(e.style.top="env(safe-area-inset-top, 0)",e.style.left="max(24px, env(safe-area-inset-left, 0))"):(e.style.top="0",e.style.left="0"),e.style.padding="0.5em",e.style.backgroundColor="rgba(0,0,0,0.5)",e.style.zIndex="300",e.style.fontSize="12px",e.style.fontFamily="monospace",e.style.color="white",e.style.whiteSpace="pre",e.style.lineHeight="100%",e.style.pointerEvents="none",this.H.insertAdjacentElement("afterend",e)),this.L=e,this.g={kf:!1,hf:!1,xb:!1,yb:!1,uf:0,Yc:!1,keyboardLayout:"",appLaunchMode:0,gf:""}}};function Zu(e){let t=0;return 0<e.count&&(t=e.value/e.count),t.toFixed(2)}var T0={size:70},R0={size:80},k0={size:48},P0={size:88},O0={size:44},D0={size:16},M0={size:20};function eh(e){0<e.j.length&&(_n(e.g,e.j,5),e.j=[])}var L0=class{constructor(e,t){this.h=e,this.g=t,this.m=this.framesDropped=this.o=this.pliCount=this.framesDecoded=this.s=this.C=this.v=this.D=this.F=this.index=0,this.j=[],this.l=-1}sendVideoTrack(e){const t=e.framesDropped||0;t>=this.m&&(this.framesDropped=t-this.m,this.m=t);const i=new ArrayBuffer(O0.size),n=new DataView(i);n.setUint32(0,e.framesDecoded||0,!0),n.setUint32(4,t,!0),n.setUint32(8,e.frameHeight||0,!0),n.setUint32(12,e.frameWidth||0,!0),n.setUint32(16,e.framesReceived||0,!0),n.setFloat64(20,e.jitterBufferDelay||0,!0),et(e.jitterBufferEmittedCount||0,n,28,!0),n.setFloat64(36,kt(this.h),!0),_n(this.g,[i],3)}ua(){return this.framesDecoded}};function N0(e,t,i,n,r){return new Promise((s,o)=>{window.setTimeout(()=>{e:if(0>=n||0>=r)var d=-1;else{var u=new OffscreenCanvas(n,r).getContext("2d");if(u){try{u.drawImage(e,t,i,n,r,0,0,n,r),d=u.getImageData(0,0,n,r).data}catch(h){c.e("{0c7ed7c}","{b16b792}",h),d=-1;break e}var l=u=0;for(let h=0;h<d.length-3;h+=4)u+=.2126*d[h]+.7152*d[h+1]+.0722*d[h+2],l++;d=u/l/255}else c.e("{0c7ed7c}","{b72639c}"),d=-1}d===-1&&o(-1),s(d)},0)})}function x0(e,t){e.active!==t&&((e.active=t)?(c.i("{0c7ed7c}","{b56e30d}"),e.H.dispatchEvent(new Event("focus",{bubbles:!0})),e.H.addEventListener("pointerdown",e.j),e.H.addEventListener("mousedown",e.j)):(c.i("{0c7ed7c}","{00425c2}"),e.H.removeEventListener("pointerdown",e.j),e.H.removeEventListener("mousedown",e.j),e.g=[],e.h=[]))}function th(e,t){const i=e.H.videoWidth;return e=e.H.videoHeight,new DOMRect(t.x*i,t.y*e,t.width*i,t.height*e)}function _0(e,t,i){e.g.push({presentedFrames:i.presentedFrames,nd:t,presentationTime:i.presentationTime,receiveTime:i.receiveTime,processingDuration:i.processingDuration}),t=th(e,e.l),N0(e.H,t.x,t.y,t.width,t.height).then(n=>{var r=i.presentedFrames,s;if(e.g.length){var o=e.g[e.g.length-1];if(r!==o.presentedFrames)c.d("{0c7ed7c}","{06323ea}",r);else{for(o.ad=n;32<e.g.length;)e.g.shift();if(e.g.length!=1&&(n=e.g[e.g.length-2],!(n.presentedFrames<r-2||n.ad===void 0||n.ad===-1)&&o.ad-n.ad>e.m)){n=0;let d;const u={presentedFrames:r,nd:o.nd,presentationTime:o.presentationTime,receiveTime:o.receiveTime,processingDuration:o.processingDuration,Wb:0,wc:0};for(;e.h.length&&e.h[0].Wb<((s=o.receiveTime)!==null&&s!==void 0?s:o.presentationTime);)n++,d=e.h.shift();d&&(1<n&&c.d("{0c7ed7c}","{a4b8c55}",r,n),u.Wb=d.Wb,u.wc=d.wc,e.s&&e.s(u))}}}})}function F0(e){const t=th(e,e.l);return!(0>t.x||0>t.y||t.x+t.width>e.H.videoWidth||t.y+t.height>e.H.videoHeight)}function ih(e){const t={isPrimary:!0,pointerId:1,button:0};e.H.dispatchEvent(new PointerEvent("pointerdown",t)),e.H.dispatchEvent(new MouseEvent("mousedown")),window.setTimeout(()=>{e.H.dispatchEvent(new PointerEvent("pointerup",t)),e.H.dispatchEvent(new MouseEvent("mouseup"))},100)}var U0=class{constructor(e){this.active=!1,this.m=.06,this.l=new DOMRect(0,0,0,0),this.g=[],this.h=[],this.H=e,this.j=this.v.bind(this)}o(){return this.active}v(e){if(!this.g.length)c.w("{0c7ed7c}","{fe08a50}");else if(!(this.h.length&&100>e.timeStamp-this.h[this.h.length-1].Wb))for(this.h.push({Wb:e.timeStamp,wc:performance.now()});32<this.h.length;)this.h.shift()}};function io(e,t){e.bc.checked=t,e.s.disabled=!t,e.C.disabled=!t,e.l.style.color=t?"white":"gray"}function Dd(e,t=!1){t&&(e.g.style.bottom="5px",e.g.style.left="300px",e.g.style.top="",e.g.style.right="",e.g.style.width="150px",e.g.style.height="150px"),e.o()?(e.m.style.display="none",e.g.style.border="2px rgb(76, 175, 80) solid",e.g.style.backgroundColor="transparent"):(e.m.style.display="block",e.g.style.border="none",e.g.style.backgroundColor="rgb(105, 105, 105, 0.7)")}function nh(e,t){if(t!==e.visible){c.i("{50c79eb}","{5595c14}",t),e.visible=t;for(var i of[e.I,e.g,e.v])i===e.v&&t?Ld(e,e.h.value!=="Show hotkeys"):i.style.display=t?"block":"none";var n=El();if(i=n?"pointerdown":"mousedown",n=n?"pointermove":"mousemove",t){e.M(),j0(e.g,e.m),e.L.oninput=s=>{s=parseFloat(s.target.value);var o=e.j;0>=s||1<=s?c.e("{0c7ed7c}","{1cbd879}",s.toFixed(2)):o.m=s,e.O.innerHTML=(100*s).toFixed()+"%"},e.bc.oninput=s=>{io(e,s.target.checked)},e.s.oninput=s=>{e.R.innerHTML=s.target.value},e.C.oninput=s=>{e.S.innerHTML=s.target.value+" ms"},e.zb.oninput=s=>{e.zb.checked=s.target.checked};const r=(s,o)=>{o.value=Math.max(Math.min(parseInt(s.target.value),100),0).toFixed(0),dh(e,parseInt(e.Ub.value||"50")/100,parseInt(e.Vb.value||"50")/100)};e.Ub.oninput=s=>r(s,e.Ub),e.Vb.oninput=s=>r(s,e.Vb),e.F.onclick=()=>as(e,e.F.value==="Start"),e.h.onclick=()=>Ld(e,e.h.value==="Show hotkeys"),e.g.onmouseup=e.M.bind(e),e.g.onmousedown=()=>{e.o()&&ih(e.j)},ci(e.T,2,e.U),e.H.addEventListener(i,e.V),e.H.addEventListener(n,e.W)}else as(e,!1),e.L.oninput=null,e.bc.oninput=null,e.s.oninput=null,e.C.oninput=null,e.zb.oninput=null,e.Ub.oninput=null,e.Vb.oninput=null,e.F.onclick=null,e.h.onclick=null,e.g.onmouseup=null,e.g.onmousedown=null,e.m.onmousedown=null,li(e.T,2,e.U),e.H.removeEventListener(i,e.V),e.H.removeEventListener(n,e.W)}}function as(e,t){t&&!F0(e.j)?G0(e):t&&e.J?c.e("{50c79eb}","{89742e9}"):(x0(e.j,t),Dd(e),t?(e.F.value="Stop",e.bc.checked&&(c.i("{50c79eb}","{5974b2c}"),e.J=!0,e.Z=parseInt(e.s.value),e.K=window.setInterval(()=>{0<e.Z--?ih(e.j):(c.i("{50c79eb}","{d37e51d}"),rh(e),as(e,!1))},parseInt(e.C.value)))):(e.F.value="Start",e.J&&(e.K?(c.i("{50c79eb}","{d340c50}"),rh(e)):c.w("{50c79eb}","{6d8948b}")),sh(e),oh(e)))}function Md(e,t){e.value=t.toString(),e.dispatchEvent(new Event("input"))}function Ld(e,t){t?(e.h.value="Hide hotkeys",e.v.style.display="block"):(e.h.value="Show hotkeys",e.v.style.display="none")}function j0(e,t){let i=0,n=0,r=0,s=0;const o=document.onmouseup,d=document.onmousemove;t.onmousedown=u=>{u.preventDefault(),i=u.clientX,n=u.clientY,document.onmouseup=()=>{document.onmouseup=o,document.onmousemove=d},document.onmousemove=l=>{l.preventDefault(),r=i-l.clientX,s=n-l.clientY,i=l.clientX,n=l.clientY,e.style.top=e.offsetTop-s+"px",e.style.left=e.offsetLeft-r+"px"}}}function G0(e){e.N.style.display="block",window.setTimeout(()=>e.N.style.display="none",5e3)}function rh(e){window.clearInterval(e.K),e.K=0,e.J=!1}function sh(e){e.G!==0&&(window.clearTimeout(e.G),e.G=0)}function oh(e){e.D.innerHTML="",e.D.style.display="none"}function ah(e){var t;const i=(t=e.processingDuration)!==null&&t!==void 0?t:0;return{ff:e.wc-e.Wb,Of:e.receiveTime?e.receiveTime-e.wc:0,He:e.receiveTime&&e.processingDuration?e.presentationTime-e.processingDuration-e.receiveTime:0,decode:i,Kf:e.nd-e.presentationTime,total:e.nd-e.Wb}}function dh(e,t,i){const n=e.H.getBoundingClientRect(),r=e.g.getBoundingClientRect(),{paddingTop:s,paddingRight:o,paddingBottom:d,paddingLeft:u}=uh(e.H);t=n.left+u+(n.width-u-o)*t-r.width*t,e.g.style.top=(n.top+s+(n.height-s-d)*i-r.height*i).toString()+"px",e.g.style.left=t.toString()+"px",e.M()}function ds(){const e=document.createElement("div");return e.style.display="none",e.style.position="absolute",e.style.color="white",e.style.backgroundColor="rgb(105, 105, 105, 0.7)",e.style.padding="2px",e}function Nd(e){const t=document.createElement("div");return t.style.width="100%",t.style.borderBottom="1px dashed darkgray",t.style.paddingBottom="2px",t.innerHTML=e,t}function ch(e){const t=document.createElement("input");return t.type="button",t.value=e,t.style.margin="5px",t.style.backgroundColor="rgb(132, 130, 143, .7)",t.style.color="white",t.style.padding="8px 40px",t.style.border="none",t.style.borderRadius="4px",t.style.cursor="pointer",t}function lh(){const e=document.createElement("input");return e.type="checkbox",e}function ki(e){const t=document.createElement("label");return t.innerHTML=e,t}function xd(e,t,i,n=1){const r=document.createElement("input");return r.type="range",r.min=t.toString(),r.max=i.toString(),r.step=n.toString(),r.value=e.toString(),r}function B0(e){const t=document.createElement("div"),i=ki("Loupe Position:"),n=ki("X"),r=ki("Y");n.style.paddingLeft="10px",r.style.paddingLeft="10px",n.style.paddingRight="2px",r.style.paddingRight="2px";const s=()=>{const o=document.createElement("input");return o.type="number",o.min="0",o.max="100",o.step="1",o.placeholder="Int",o.style.width="40px",o};return e.Ub=s(),e.Vb=s(),t.appendChild(i),t.appendChild(n),t.appendChild(e.Ub),t.appendChild(ki("%")),t.appendChild(r),t.appendChild(e.Vb),t.appendChild(ki("%")),t}function uh(e){const t=i=>{if(!i)return 0;const n=i.length;return i.substring(n-1)==="%"?parseInt(i.substring(0,n-1)):i.substring(n-2)==="px"?parseInt(i.substring(0,n-2)):(c.w("{50c79eb}","{3351f27}",i),0)};return{paddingTop:t(e.style.paddingTop),paddingRight:t(e.style.paddingRight),paddingBottom:t(e.style.paddingBottom),paddingLeft:t(e.style.paddingLeft)}}var V0=class{constructor(e,t){this.T=t,this.visible=!1,this.fc=[],this.J=!1,this.Z=this.K=0,this.P={x:0,y:0},this.G=0,this.H=e,this.j=new U0(e),this.U=this.ba.bind(this),this.V=this.aa.bind(this),this.W=this.onmousemove.bind(this),t=ds();var i=Nd("Latency Display Analysis Tool (LDAT)");this.F=ch("Start"),this.h=ch("Show hotkeys"),t.style.bottom="0px",t.style.left="0px",t.style.margin="5px",this.h.style.border="1px solid white",this.h.style.fontSize="10px",this.h.style.padding="5px",this.h.style.position="absolute",this.h.style.right="0px",t.appendChild(i),t.appendChild(this.F),t.appendChild(this.h),i=t.appendChild;var n=document.createElement("div"),r=this.j.m;this.L=xd(r,.01,.2,.01),this.O=document.createElement("span");var s=ki("Activation Level"),o=document.createElement("span");this.O.innerHTML=(100*r).toFixed()+"%",o.style.paddingRight="2px",o.title="% increase in luminance used to determine whether a flash occurred",o.innerHTML="<sup> i </sup>",n.appendChild(s),n.appendChild(o),n.appendChild(this.L),n.appendChild(this.O),i.call(t,n),i=t.appendChild,n=document.createElement("div"),this.l=document.createElement("div"),this.bc=lh(),this.s=xd(20,5,100,5),this.C=xd(1e3,500,5e3,100),r=ki("Autofire"),s=ki("# Shots"),o=ki("Shot Delay"),this.R=document.createElement("span"),this.S=document.createElement("span"),this.R.innerHTML=this.s.value,this.S.innerHTML=this.C.value+" ms",this.s.id="shot-count-slider",this.l.appendChild(s),this.l.appendChild(this.s),this.l.appendChild(this.R),this.l.appendChild(document.createElement("br")),this.l.appendChild(o),this.l.appendChild(this.C),this.l.appendChild(this.S),n.appendChild(r),n.appendChild(this.bc),n.appendChild(this.l),i.call(t,n),t.appendChild(B0(this)),this.zb=lh(),i=document.createElement("span"),i.title="Simulate mouse move event whenever a mouse click is detected.  Introduces two 300 ms delays between move events and requires a minimum shot delay of 1 sec.",i.innerHTML="<sup> i </sup>",t.appendChild(ki("Move On Click")),t.appendChild(i),t.appendChild(this.zb),this.I=t,t=ds(),i=Nd("Loupe"),this.m=document.createElement("div"),this.m.style.cursor="move",this.m.style.width="100%",this.m.style.height="100%",this.m.innerHTML="Click here to drag the loupe to the area of the screen where flashes will occur.  Then, press start.",t.appendChild(i),t.appendChild(this.m),this.g=t,t=ds(),t.style.position="relative",t.style.backgroundColor="gray",t.style.textAlign="center",t.innerHTML="Warning: Must place loupe over video element to activate the LDAT.  Please reposition the loupe and then click start.",this.N=t,t=ds(),i=Nd("LDAT Hot Keys"),n=document.createElement("ul"),t.style.bottom="195px",t.style.left="0px",t.style.margin="5px",n.style.listStyle="none",n.style.paddingLeft="2px",n.style.margin="5px";for(var d of["Enter - Start/Stop","R - Reset","A - Turn On/Off Auto-Fire Mode","S - Save Log File","C - Center Loupe on Screen"])r=document.createElement("li"),r.innerHTML=d,n.append(r);t.appendChild(i),t.appendChild(n),this.v=t,d=ds(),d.style.bottom="325px",d.style.left="0px",d.style.margin="5px",this.D=d,e.insertAdjacentElement("afterend",this.I),this.I.insertAdjacentElement("afterend",this.g),this.g.insertAdjacentElement("afterend",this.N),this.I.insertAdjacentElement("beforebegin",this.v),this.v.insertAdjacentElement("beforebegin",this.D),this.j.s=this.$.bind(this),io(this,!1),this.zb.checked=!1,Dd(this,!0)}stop(){this.I.remove(),this.g.remove(),this.N.remove(),this.v.remove(),this.D.remove(),nh(this,!1),this.fc=[]}reset(){as(this,!1),Md(this.L,.06),Md(this.s,20),Md(this.C,1e3),io(this,!1),this.zb.checked=!1,Dd(this,!0),Ld(this,!1),this.Ub.value="",this.Vb.value="",this.fc=[]}isVisible(){return this.visible}toggle(){as(this,!this.o())}o(){return this.j.o()}Fb(){return!this.isVisible()||this.o()}aa(e){if(this.zb.checked&&this.o()&&!e.Xe){const t=(r,s)=>{switch(r){case 0:this.H.dispatchEvent(new PointerEvent("pointerup",s)),this.H.dispatchEvent(new MouseEvent("mouseup",s));break;case 1:r=new PointerEvent("pointerdown",s),s=new MouseEvent("mousedown",s),r.Xe=!0,s.Xe=!0,this.H.dispatchEvent(r),this.H.dispatchEvent(s);break;case 2:this.H.dispatchEvent(new PointerEvent("pointerrawupdate",s)),this.H.dispatchEvent(new PointerEvent("pointermove",s)),this.H.dispatchEvent(new MouseEvent("mousemove",s))}},i={button:2,isPrimary:!0,pointerId:1},n={clientX:(Math.max(e.clientX,0)||this.P.x)+64,clientY:Math.max(e.clientY,0)||this.P.y,movementX:64,isPrimary:!0};t(1,i),window.setTimeout(()=>{t(2,n),window.setTimeout(()=>{n.clientX-=64,n.movementX=-64,t(2,n),window.setTimeout(()=>t(0,i),300)},300)},300)}}onmousemove(e){this.P={x:e.clientX,y:e.clientY}}M(){var e=this.H.getBoundingClientRect();const t=this.g.getBoundingClientRect();if(this.H.style.paddingTop||this.H.style.paddingRight||this.H.style.paddingBottom||this.H.style.paddingLeft){const{paddingTop:i,paddingRight:n,paddingBottom:r,paddingLeft:s}=uh(this.H);e.x+=s,e.y+=i,e.width-=s+n,e.height-=i+r}t.x=(t.x-e.x)/e.width,t.y=(t.y-e.y)/e.height,t.width/=e.width,t.height/=e.height,e=this.j,0>=t.width||0>=t.height?c.e("{0c7ed7c}","{3e0eb8f}",t.width,t.height):e.l=t}ba(){this.M()}$(e){sh(this),this.fc.push(e);const t=ah(e),i=t.total.toFixed(),n=`Flash occurred at frame ${e.presentedFrames}. Latency: ${i} ms.`;c.i("{50c79eb}","{78905f8}",e.presentedFrames,i),c.d("{50c79eb}","{d3d4a0c}",i,t.ff.toFixed(),t.Of.toFixed(),t.He.toFixed(),t.decode.toFixed(),t.Kf.toFixed()),this.D.innerHTML=n,this.D.style.display="block",this.G=window.setTimeout(()=>{oh(this),this.G=0},5e3)}},H0=class{constructor(e){this.u=e,this.extraData=new Map,this.j=65535,this.h=[],this.g=1,this.l=this.m=0,this.saScores={gpuPerfScore:-1,serverPerfScore:-1,visualScore:-1,decoderScore:-1,downlinkLagScore:-1,downlinkCongestionScore:-1,uplinkScore:-1,overallScore:-1}}},hh=class extends Map{constructor(){super([["TCP",0],["MDNS",0],["IPV6",0],["IPV4",0],["UNKNOWN",0]])}};function W0(e){e.O=e.F.createDataChannel("stats_channel",{ordered:!1,reliable:!1,maxRetransmits:0}),e.O.binaryType="arraybuffer",cs(e.N,e.O,{open:()=>{e.U=1},close:()=>{vh(e),e.U=2}}),e.O.onmessage=t=>{var i=new DataView(t.data);if(t=i.getUint8(0),2<=t){e.W=i.getFloat64(1,!0)/1e6,e.jitter=1e3*i.getFloat64(9,!0),e.rtd=i.getFloat64(17,!0),e.g.I=e.jitter,e.g.rtd=e.rtd;var n=e.m,r=e.rtd;if(r&&(n.j=Math.min(n.j,r),n.extraData.set("Rtd",n.j)),3<=t&&(e.ja=i.getFloat64(25,!0),e.g.avgGameFps=e.ja,4<=t)){var s=i.getFloat32(33,!0);t=i.getFloat32(37,!0),n=i.getFloat32(41,!0);var o=i.getFloat32(45,!0),d=i.getFloat32(49,!0),u=i.getFloat32(53,!0),l=i.getFloat32(57,!0),h=i.getFloat32(61,!0);r=i.getFloat32(65,!0);var p=i.getFloat32(69,!0);i=e.m,i.saScores.gpuPerfScore=t,i.saScores.serverPerfScore=n,i.saScores.visualScore=o,i.saScores.decoderScore=d,i.saScores.downlinkLagScore=u,i.saScores.downlinkCongestionScore=l,i.saScores.uplinkScore=h,i.saScores.overallScore=s,i.extraData.set("WiFiScanScore",100*r),i.extraData.set("ThrottlingScore",100*p)}t=e.K,i=e.W,n=e.g,(r=e.W)&&n.m<=r&&(n.Qb=n.m/r*100),n.G=r,r=100,25<=n.Qb&&(r=(i-t.h)/(t.maxBitrate-t.h)*100),100<r&&(r=100),r===void 0||isNaN(r)||0>r||(t.bandwidthScore=15*t.bandwidthScore/16+r/16,t.bandwidthScore=Math.min(t.bandwidthScore,t.g)),t=e.K,i=e.rtd,n=0,250>i&&(n=100*(250-i)/240,n===void 0||isNaN(n))&&(n=0),t.latencyScore=15*t.latencyScore/16+n/16,t.latencyScore=Math.min(t.latencyScore,t.g)}else c.e("{5cea617}","{4f9f4b7}",t)}}function fh(e){var t,i,n,r;e.s=window.setInterval(()=>{$0(e)},(t=Re.getStatsInterval)!==null&&t!==void 0?t:96),window.chrome&&(e.G=window.setInterval(()=>{q0(e)},(i=Re.getDeprecatedStatsInterval)!==null&&i!==void 0?i:201)),(r=(n=e.H).requestVideoFrameCallback)===null||r===void 0||r.call(n,e.va)}async function z0(e){e.$=await p0(),e.$===void 0&&(e.m.g=0)}function ph(e,t){var i=performance.now();if(i>=e.da&&e.mediaType==="video"){Y0(e,t);var n=e.g,r=e.N,s,o,d,u,l,h,p,y,N,G,E=r.H.paused,D=(o=(s=r.Da)===null||s===void 0?void 0:s.paused)!==null&&o!==void 0?o:!1;s=(u=(d=r.m)===null||d===void 0?void 0:d.xb())!==null&&u!==void 0?u:!1,d=(h=(l=r.m)===null||l===void 0?void 0:l.yb)!==null&&h!==void 0?h:!1,l=r.La.getMicState(),h=(y=(p=r.m)===null||p===void 0?void 0:p.Yc())!==null&&y!==void 0?y:!1,p=r.keyboardLayout,y=r.appLaunchMode,(N=r.m)===null||N===void 0?r=void 0:(r=N.j,r=`${r.g.pb?"local":"alt"} ${yr(r)?"locked":"unlocked"}`),E={kf:E,hf:D,xb:s,yb:d,uf:l,Yc:h,keyboardLayout:p,appLaunchMode:y,gf:(G=r)!==null&&G!==void 0?G:""},n.g=E,Q0(e,t),e.L!==0&&Qu(e.g,e.L===2),Fd(e),e.l=t,e.da=i+1e3}for(const[be,Me]of e.P.entries()){n=be,G=Me;for(var z of G)if(G=t.get(z))switch(n){case"inbound-rtp":if(E=e.o,G=gh(e,t,G),G.kind==="audio")D=E,r=G,N=new ArrayBuffer(k0.size),s=new DataView(N),et(r.packetsReceived||0,s,0,!0),et(r.bytesReceived||0,s,8,!0),et(r.packetsLost||0,s,16,!0),s.setFloat64(24,r.lastPacketReceivedTimestamp||0,!0),s.setFloat64(32,r.jitter||0,!0),s.setFloat64(40,kt(D.h),!0),_n(D.g,[N],2),D=new ArrayBuffer(P0.size),r=new DataView(D),r.setFloat64(0,G.audioLevel||0,!0),et(G.concealedSamples||0,r,8,!0),et(G.concealmentEvents||0,r,16,!0),et(G.insertedSamplesForDeceleration||0,r,24,!0),r.setFloat64(32,G.jitterBufferDelay||0,!0),et(G.jitterBufferEmittedCount||0,r,40,!0),et(G.removedSamplesForAcceleration||0,r,48,!0),et(G.silentConcealedSamples||0,r,56,!0),r.setFloat64(64,G.totalSamplesReceived||0,!0),r.setFloat64(72,G.totalSamplesDuration||0,!0),r.setFloat64(80,kt(E.h),!0),_n(E.g,[D],4);else if(D=E,r=G,N=r.packetsLost||0,s=r.framesDecoded||0,p=r.totalDecodeTime||0,y=r.pliCount||0,d=D,l=N,h=s,u=p,o=y,l>=d.v&&(d.F=l-d.v,d.v=l),o>=d.o&&(d.pliCount=o-d.o,d.o=o),d.framesDecoded=h-d.C,0<d.framesDecoded&&u>d.s&&(d.D=1e3*(u-d.s)/d.framesDecoded,d.C=h,d.s=u),d=new ArrayBuffer(R0.size),l=new DataView(d),l.setUint32(0,s,!0),l.setUint32(4,r.keyFramesDecoded||0,!0),l.setUint32(8,r.nackCount||0,!0),l.setInt32(12,N,!0),l.setInt32(16,y,!0),et(r.bytesReceived||0,l,20,!0),et(r.packetsReceived||0,l,28,!0),l.setFloat64(36,p,!0),l.setFloat64(44,r.totalInterFrameDelay||0,!0),l.setFloat64(52,r.totalSquaredInterFrameDelay||0,!0),l.setFloat64(60,r.totalAssemblyTime||0,!0),l.setUint32(68,r.framesAssembledFromMultiplePackets||0,!0),l.setFloat64(72,kt(D.h),!0),_n(D.g,[d],1),E.sendVideoTrack(G),G.perFrameEntries){for(G=JSON.parse(G.perFrameEntries),D=[],r=E.l,N=0;N<G.length;N++)G[N].frameNumber>E.l&&(s=new ArrayBuffer(M0.size),p=new DataView(s),p.setUint32(0,G[N].frameNumber,!0),p.setFloat64(4,G[N].decodeTime,!0),p.setFloat64(12,G[N].assemblyTime,!0),D.push(s)),r=Math.max(r,G[N].frameNumber);E.l=r,0<D.length&&_n(E.g,D,6)}}}if((t=performance.memory)&&(n=t.usedJSHeapSize,G=t.totalJSHeapSize,t=n-e.ta,z=G-e.sa,e.ta=n,e.sa=G,!(0<=t&&0<=z))){n=e.v;var Z;n.h&&n.g&&(G={garbageCollectionStats:{timestamp:(Z=kt(n.l))!==null&&Z!==void 0?Z:0,deltaUsedHeapSize:t,deltaTotalHeapSize:z},instanceId:n.instanceId},n.g.postMessage(G))}Z=e.N,t=Z.D;var Q;if(t.h&&t.g&&(z={inputChannelStats:{timestamp:(Q=kt(t.l))!==null&&Q!==void 0?Q:0,bufferedAmount:Z.J.bufferedAmount,maxSchedulingDelay:Z.C.maxSchedulingDelay},instanceId:t.instanceId},t.g.postMessage(z)),Z.C.maxSchedulingDelay=0,i>=e.pa&&e.ba&&(Q=e.ba,Z=new ArrayBuffer(15),t=new DataView(Z),t.setUint8(0,2),t.setUint8(1,1),t.setUint8(2,1),t.setUint32(3,Q.xg,!0),t.setFloat64(7,Q.client,!0),mh(e,Z,"rtpmapping"),e.ba=void 0,e.pa=i+1e3),e.mediaType==="video"){yl(e.u)&&(Q=new ArrayBuffer(12),Z=new DataView(Q),Z.setUint8(0,1),Z.setUint8(1,1),Z.setUint16(2,e.o.F,!0),Z.setUint16(4,Math.round(e.o.D),!0),Z.setUint16(6,e.o.ua(),!0),Z.setUint16(8,e.o.pliCount,!0),Z.setUint16(10,e.o.framesDropped,!0),mh(e,Q,"clientperf")),Q=Ou(e.K),e.g.C=Q,Z=Ou(e.K),e.R.emit("StreamingQuality",Z),e.Ba&&(Q=e.g,e.R.emit("StreamingStats",{fps:Q.fps,sd:Q.sd,avgDecodeTime:1e3*to(Q.o),Hg:Q.G,Qb:Q.Qb,width:Q.streamingResolution.width,height:Q.streamingResolution.height})),Q=e.v;var ce;Q.h&&Q.g&&(Z={sq:{latencyScore:Z.latencyScore,bandwidthScore:Z.bandwidthScore,qualityScore:Z.qualityScore,networkLossScore:Z.networkLossScore,timestamp:(ce=kt(Q.l))!==null&&ce!==void 0?ce:0},instanceId:Q.instanceId},Q.g.postMessage(Z))}i>=e.oa&&(ce=e.g,c.i("{4155ac9}","{a02a36e}",ce.F,(1e3*to(ce.o)).toFixed(2),ce.J,ce.I.toFixed(2),ce.v,ce.rtd,ce.m.toFixed(2),ce.Qb.toFixed(2)),e.oa=i+5e3),i=performance.now()-i,ce=e.v,ce.h&&(ce.perf.GetStats+=i),ce=e.g,ce.l.value+=i,ce.l.count+=1,ce.l.max=Math.max(i,ce.l.max),e.za&&(e.mediaType=e.mediaType==="video"?"audio":"video")}function no(e,t,i){e.ha.Aa(t,`Exception in ${i} getStats`,"{5cea617}.ts",0,0,!0,"getStats")}function K0(e){e.F.getStats(null).then(t=>{let i=!1;for(let n of t.values())if(n.type==="track"&&(i=!0),["transport","inbound-rtp","candidate-pair"].includes(n.type)){n.kind==="audio"&&(e.za=!0);const r=e.P.get(n.type);r?r.includes(n.id)?c.e("{5cea617}","{76f5968}",n.id):r.push(n.id):e.P.set(n.type,[n.id])}e.ea=!i,c.i("{5cea617}","{1317761}",e.ea?"yes":"no"),e.ma=!0,e.l=t,ph(e,t)}).catch(t=>no(e,t,"init")).finally(()=>{e.J=!1})}function vh(e){e.s&&(clearInterval(e.s),e.s=0),e.G&&(clearInterval(e.G),e.G=0),eh(e.o)}function $0(e){if(!e.J)if(e.J=!0,e.U===0)e.F.getStats().then(t=>{e.l=t}).catch(t=>no(e,t,"early")).finally(()=>{e.J=!1});else if(e.U===1)if(e.ma){const t=e.F.getReceivers().find(i=>i.track.kind===e.mediaType&&i.track.enabled);t&&t.getStats().then(i=>ph(e,i)).catch(i=>no(e,i,"standard")).finally(()=>{e.J=!1})}else K0(e);else e.J=!1}function q0(e){if(!e.T){e.T=!0;var t=()=>{c.i("{5cea617}","{cf8b53f}"),e.T=!1,clearInterval(e.G),e.G=0};e.F.getStats(i=>{for(var n of i.result())if(n.type=="ssrc")for(var r of n.names()){n.stat("mediaType")==="video"&&(e.I.ts=kt(e.Z),e.I.timingFrameInfo=n.stat("googTimingFrameInfo"),e.I.targetDelayMs=+n.stat("googTargetDelayMs"),e.I.minPlayoutDelayMs=+n.stat("googMinPlayoutDelayMs"),e.I.currentDelayMs=+n.stat("googCurrentDelayMs"));break}if(i=e.o,n=e.I,r=n.timingFrameInfo.split(",",15),!(15>r.length)){var s=new ArrayBuffer(T0.size),o=new DataView(s);o.setUint32(0,n.targetDelayMs||0,!0),o.setUint32(4,n.minPlayoutDelayMs||0,!0),o.setUint32(8,n.currentDelayMs||0,!0),o.setFloat64(12,kt(i.h),!0),o.setFloat64(20,parseFloat(r[3])||0,!0),o.setFloat64(28,parseFloat(r[4])||0,!0),o.setFloat64(36,parseFloat(r[8])||0,!0),o.setFloat64(44,parseFloat(r[9])||0,!0),o.setFloat64(52,parseFloat(r[10])||0,!0),o.setFloat64(60,parseFloat(r[11])||0,!0),o.setUint8(68,parseFloat(r[13])||0),o.setUint8(69,parseFloat(r[14])||0),_n(i.g,[s],0)}e.T=!1},t).catch(t)}}function J0(e){var t=e.v,i;if(t.h&&(t.perf.RAFTS!=0&&(t.g&&t.g.postMessage({perf:t.perf,instanceId:t.instanceId}),t.perf.RAFTS=0,t.perf.DCSend=0,t.perf.GetStats=0,t.perf.FrameInfo=0),t.perf.RAFTS=(i=kt(t.l))!==null&&i!==void 0?i:0),!na){if(t=window.performance.now(),i=e.ya,i.getVideoPlaybackQuality){var n=i.getVideoPlaybackQuality();i={td:n.totalVideoFrames,Ne:n.droppedVideoFrames}}else i=i.webkitDecodedFrameCount!==void 0?{td:i.webkitDecodedFrameCount,Ne:(n=i.webkitDroppedFrameCount)!==null&&n!==void 0?n:0}:void 0;var r=i;if(r){const s=r.Ne;n=s-e.D.droppedVideoFrames,i=r.td-e.D.totalVideoFrames,e.D.droppedVideoFrames=s,e.D.totalVideoFrames=r.td,n==1?e.h.Qd++:1<n&&(e.h.cd+=n),r=e.v,r.h&&(r.perf.FrameInfo=Math.min(i,15)<<4|Math.min(n,15))}e.D.sg=t}}function _d(e,t,i=!1){e.g.L.style.display=t?"block":"none",t?(e.L=i?2:1,Qu(e.g,i),e.da=performance.now()):e.L=0}function Q0(e,t){var i,n=e.P.get("candidate-pair");if(n=n==null?void 0:n.map(s=>t.get(s)).find(s=>s)){6<=e.C.length&&e.C.splice(0,1),e.C.push(n);var r=(i=e.l)===null||i===void 0?void 0:i.get(n.id);r&&C0(e.g,n,r)}}function Fd(e){var t=e.g,i;const n={avgGameFps:(i=t.avgGameFps)!==null&&i!==void 0?i:0,fps:t.fps,rtd:t.rtd,avgDecodeTime:1e3*to(t.o),frameLoss:t.v-t.S,packetLoss:t.M,totalBandwidth:t.G,currentBitrateMbps:t.m,utilizedBandwidth:t.Qb,streamingResolution:t.streamingResolution,codec:t.codec,bitDepth:t.bitDepth,sdrHdrMode:t.hdr?1:0,hdr10PlusGaming:t.hdr&&t.s&&t.D};t.S=t.v,e.R.emit("StreamStatsUpdate",n)}function gh(e,t,i){return e.ea||(e=t.get(i.trackId))&&(i=Object.assign(e,i)),i}function Y0(e,t){var i,n,r,s=e.P.get("inbound-rtp");if(s&&e.l)if(s=s.map(u=>t.get(u)).find(u=>(u==null?void 0:u.kind)==="video"||(u==null?void 0:u.mediaType)==="video")){s=gh(e,t,s);var o=s.decoderImplementation,d=!1;o!=null&&o.indexOf&&(o!==e.j.dc&&o!=="unknown"&&(e.j.dc=o,e.g.dc=o),d=o.indexOf("fallback")!==-1),(d||o==="FFmpeg"||e.aa||e.$===!1)&&e.j.rc===-1&&(e.j.rc=(i=s.framesDecoded)!==null&&i!==void 0?i:e.V,im(e.v),i="Fallback to software decode at frame "+String(e.j.rc),c.i("{5cea617}","{953d211}",String(e.j.rc)),e.g.T=!0,oo(e.N,i),d?e.m.g=3:(e.aa||o==="FFmpeg"||e.$===!1)&&(e.m.g=2)),(i=e.l.get(s.id))?(e.j.cc.Wf++,(o=s.codecId)&&(o=t.get(o).mimeType.toUpperCase(),o.includes("H265")?e.M="H265":o.includes("AV1")?e.M="AV1":o.includes("H264")?e.M="H264":(c.d("{5cea617}","{4b31535}",o),e.M="UNKNOWN"),e.g.codec=e.M),e0(e.K,s,i),I0(e.g,s),e.V=(n=s.framesDecoded)!==null&&n!==void 0?n:0,e.wa=(r=s.packetsReceived)!==null&&r!==void 0?r:0,X0(e)):e.j.cc.Cf++}else e.j.cc.Le++}async function X0(e){const t={width:screen.width*window.devicePixelRatio,height:screen.height*window.devicePixelRatio},i={width:screen.width,height:screen.height},n=e.V,r=e.xa.l;var s=e.qa;if((s=!(t.width===s.width&&t.height===s.height))||(s=e.na,s=!(i.width===s.width&&i.height===s.height)),s||r!==e.fa){e.qa=t,e.na=i,s=await Zs(Qi),e.fa=r;var o=`Stream[0]: Client display[-1] resolution : {physical : ${fr(t)}@${s}, logical : ${fr(i)}@${s}} at frame#${n} topology: ${r}`;c.i("{5cea617}","{810d0ec}",fr(t),s,fr(i),s,n,r),oo(e.N,o)}}function mh(e,t,i){try{e.O.readyState==="open"&&e.O.send(t)}catch(n){c.e("{5cea617}","{78e74c5}",n),no(e,n,i)}}function Ah(e){if(!(2>e.C.length)){var t=e.C[0],i=e.C[e.C.length-1];e=i.requestsSent-t.requestsSent+i.consentRequestsSent-t.consentRequestsSent;var n=i.responsesReceived-t.responsesReceived;return t=i.packetsReceived-t.packetsReceived,{Hf:isNaN(e)?-1:e,If:isNaN(n)?-1:n,Gf:isNaN(t)?-1:t}}}function Z0(e){let t=new hh;if(!e.l)return t;for(const i of e.l.values())i.type==="local-candidate"&&(e=ro(i),t.set(e,t.get(e)+1));return t}function em(e){let t=new Set;if(!e.l)return t;for(const i of e.l.values())i.type==="local-candidate"&&(e=i,ro(e)==="IPV4"&&(e=Sh(e),e!=="UNKNOWN"&&t.add(e)));return t}var tm=class{constructor(e,t,i,n,r,s,o,d,u,l,h,p){var y,N,G,E,D,z,Z,Q,ce;this.Z=h,this.v=p,this.ra=!0,this.V=this.wa=this.G=this.s=0,this.M="UNKNOWN",this.ma=!1,this.P=new Map,this.ja=this.rtd=this.jitter=this.W=0,this.mediaType="video",this.sa=this.ta=this.da=this.L=0,this.C=[],this.na={width:0,height:0},this.qa={width:0,height:0},this.ea=this.T=this.J=!1,this.fa=this.oa=this.U=this.pa=0,this.aa=!1,this.R=e,this.N=t,this.H=i,this.F=n,this.uc=(N=(y=r.video)===null||y===void 0?void 0:y[0].uc)!==null&&N!==void 0?N:!1,this.bitDepth=(E=(G=r.video)===null||G===void 0?void 0:G[0].bitDepth)!==null&&E!==void 0?E:8,this.hdr=((D=r.video)===null||D===void 0?void 0:D[0].Uc)===1,this.ha=s,this.u=o,this.ga=d,this.xa=u,this.I={ts:0,timingFrameInfo:"",targetDelayMs:0,minPlayoutDelayMs:0,currentDelayMs:0},e=(Z=(z=r.video)===null||z===void 0?void 0:z[0].vc)!==null&&Z!==void 0?Z:0,r=(ce=(Q=r.video)===null||Q===void 0?void 0:Q[0].bd)!==null&&ce!==void 0?ce:0,this.K=new t0(e,r),this.g=new Xu(i,this.u,this.ga),this.g.bitDepth=this.bitDepth,this.g.hdr=this.hdr,Ct&&(this.S=new V0(i,u)),this.F=n,W0(this),this.Ba=this.R.hasListener("StreamingStats"),this.o=new L0(this.Z,this.v),this.j={cc:{Le:0,Cf:0,Wf:0},dc:"",rc:-1},this.D={sg:0,droppedVideoFrames:0,totalVideoFrames:0},this.ya=i,this.h=l,this.va=this.Ea.bind(this),fh(this),this.m=new H0(this.u),this.aa=this.u.gpuDetail.indexOf("SwiftShader")!==-1,z0(this)}Ea(e,t){var i,n,r,s=this.m,o=t.width,d=t.height;o*d<=s.m*s.l||(s.m=o,s.l=d,s.extraData.set("MaxStreamingWidth",o),s.extraData.set("MaxStreamingHeight",d)),s=this.o;var u,l,h;o=(u=t.receiveTime)!==null&&u!==void 0?u:0,u=t.presentationTime-o,o=1e3*((l=t.processingDuration)!==null&&l!==void 0?l:0),l=t.presentationTime,l=l!==void 0?l-s.h.g:0,d=new ArrayBuffer(D0.size);const p=new DataView(d);p.setFloat64(0,l,!0),p.setUint16(8,Math.min(100*u,65535),!0),p.setUint16(10,Math.min(100*o,65535),!0),p.setUint32(12,(h=t.rtpTimestamp)!==null&&h!==void 0?h:0,!0),s.j.push(d),s.j.length==120&&eh(s),!((i=this.S)===null||i===void 0)&&i.o()&&_0(this.S.j,e,t),this.uc&&t.rtpTimestamp&&t.receiveTime&&(this.ba={xg:t.rtpTimestamp,client:t.receiveTime-this.Z.g}),this.s!=0&&((r=(n=this.H).requestVideoFrameCallback)===null||r===void 0||r.call(n,this.va))}reset(){vh(this),this.K.reset(),this.g=new Xu(this.H,this.u,this.ga),this.l=void 0}stop(){var e;this.ra&&(this.ra=!1,this.s!=0&&(this.reset(),_d(this,!1)),(e=this.S)===null||e===void 0||e.stop(),Qe(this.ha,"InboundVideoStats",this.j.dc,this.j.cc.Wf,this.j.cc.Le,this.j.rc,this.j.cc.Cf))}toggleOnScreenStats(e,t){_d(this,t??this.L===0,e)}ua(){return this.V}fb(){return this.M}packetsReceived(){return this.wa}};function ro(e){return e.protocol==="tcp"?"TCP":(e=e.address||e.relatedAddress)?e.endsWith(".local")?"MDNS":e.indexOf(":")!==-1?"IPV6":"IPV4":"UNKNOWN"}function Sh(e){e=e.address||e.relatedAddress;var t=e==null?void 0:e.split(".");if((t==null?void 0:t.length)===4&&(e=parseInt(t[0]),t=parseInt(t[1]),!isNaN(e)&&!isNaN(t))){let i="UNKNOWN";return e===10?i="10/8":e===192&&t===168?i="192.168/16":e===172&&(t&240)===16&&(i="172.16/12"),i!=="UNKNOWN"&&c.d("{5cea617}","{343589d}",i),i}return c.i("{5cea617}","{fa2d6b9}"),"UNKNOWN"}function _n(e,t,i){var n;e.h&&e.g&&(i={webrtcStats:{type:i,stats:t},ackid:(n=e.s)===null||n===void 0?void 0:n.g++,instanceId:e.instanceId},e.g.postMessage(i,t))}function im(e){var t;if(e.h&&e.g){var i={clientEvent:{TS:(t=kt(e.l))!==null&&t!==void 0?t:0,eventtype:"SoftwareDecodeFallback"},instanceId:e.instanceId};e.g.postMessage(i)}}function yh(e){if(e.h=!1,e.g){const t={stopStats:!0,instanceId:e.instanceId};c.d("{1f5ec29}","{76b05dd}"),e.g.postMessage(t)}}var nm=class{constructor(e,t,i,n,r,s){this.instanceId=e,this.m=i,this.s=n,this.l=r,this.g=s,this.o=this.h=!1,this.perf={RAFTS:0,DCSend:0,GetStats:0,FrameInfo:0},this.g?(this.g.postMessage({initMessage:{sessionId:t},instanceId:this.instanceId}),c.d("{1f5ec29}","{404f264}")):c.e("{1f5ec29}","{c62bf29}")}startWebSocket(e,t,i,n){this.j=i,this.g&&(this.g.postMessage({startWebSocket:{signInURL:e,maxReceivedAckId:t,reconnect:n},instanceId:this.instanceId}),c.d("{1f5ec29}","{b3f6faa}"))}stopWebSocket(){if(this.g){const e={stopWebSocket:!0,instanceId:this.instanceId};c.d("{1f5ec29}","{7ac815d}"),this.g.postMessage(e)}this.j=void 0}uninitialize(){var e;this.o||((e=this.m)===null||e===void 0||vt(e,"Worker Thread Creation Failed")),this.g&&(e={uninitialize:!0,instanceId:this.instanceId},c.d("{1f5ec29}","{9212ec5}",this.instanceId),this.g.postMessage(e))}};function bh(e,t){var i,n,r,s;e.Aa(void 0,(i=t==null?void 0:t.message)!==null&&i!==void 0?i:"",(n=t==null?void 0:t.filename)!==null&&n!==void 0?n:"",(r=t==null?void 0:t.lineno)!==null&&r!==void 0?r:0,(s=t==null?void 0:t.colno)!==null&&s!==void 0?s:0,!0,"WorkerError")}function rm(e){var t=Eh;e.uninitialize(),t.g.delete(e.instanceId)}var Eh=new class{constructor(){this.g=new Map,this.h=[],this.j=[],this.s=0,this.o=e=>{e=e.data;const t=this.g.get(e.instanceId);t?e.initialized?(c.i("{1f5ec29}","{6ccab8d}"),t.o=!0):e.statsStarted?(t.h=!0,c.d("{1f5ec29}","{e98d45f}")):e.log?c.i("{cbf9f59}","{0b0c6f9}",e.log):e.exception?c.i("{cbf9f59}","{0b0c6f9}",e.exception):e.wsClose?t.j?_h(t.j,e.wsClose):c.e("{1f5ec29}","{900a6f2}"):e.wsMessage?t.j?Wd(t.j,e.wsMessage):c.e("{1f5ec29}","{900a6f2}"):e.wsOpening?t.j?c.i("{93c7910}","{6423101}"):c.e("{1f5ec29}","{900a6f2}"):e.wsOpen?t.j?Fh(t.j):c.e("{1f5ec29}","{900a6f2}"):e.uninitialized&&c.i("{1f5ec29}","{22b6f70}"):c.w("{1f5ec29}","{3a7e49f}",e.instanceId)},this.m=e=>{this.g.size?this.g.forEach(t=>{bh(t.m,e)}):this.j.push(e)},c.i("{1f5ec29}","{139da36}");try{this.l=Ml(`
var r={size:70,version:1,name:"DEPR"},u={size:80,version:3,name:"RTPV"},z={size:48,version:1,name:"RTPA"},A={size:88,version:1,name:"TRAA"},B={size:44,version:1,name:"TRAV"},C={size:16,version:2,name:"VFMD"},D={size:20,version:1,name:"PFDA"},E={size:0,version:1,name:""};function F(a){a.h&&(a.j("{890d3ae}"+a.h),a.h=0);a.g.clear()}function G(a,b){let c=a.g.get(b.type);c||(c=[],a.g.set(b.type,c));for(const g of b.stats)c.push(g)}
function H(a){switch(a){case 0:return r;case 1:return u;case 2:return z;case 3:return B;case 4:return A;case 5:return C;case 6:return D;default:return E}}
var I=class{constructor(a){this.j=a;this.g=new Map;this.h=0;F(this)}size(){let a=0;for(let [,b]of this.g){let c=b;for(let g of c)a+=g.byteLength}return a+=9*this.g.size}write(a,b){var c=b;for(let [h,f]of this.g){b=h;var g=f,l=c,e=c;c=g.length;var d=H(b);let k=d.name,n=new DataView(a.buffer);for(let m=0;4>m;m++)n.setUint8(e+m,k.charCodeAt(m));n.setUint8(e+4,d.version);n.setUint16(e+5,c,!0);n.setUint16(e+7,d.size,!0);l=c=l+9;e=a;d=0;for(let m of g)g=new Uint8Array(m),e.set(g,c+d),d+=m.byteLength;c=
l+d;1===b&&this.h++}return c}};function J(a,b=!1){const c=a.m+1;try{let g;a.sessionId&&(g="x-nv-sessionid."+a.sessionId);let l=a.url;b&&(l+="&reconnect=1");let e=new WebSocket(l,g);e.onopen=()=>{var d;a.h("{48fa30b}"+c);if(e===a.g){null===(d=a.j)||void 0===d?void 0:d.M();for(const h of a.l)h.stats?e.send(h.stats):e.send(JSON.stringify(h));for(const h of a.s)K(a,h);a.s=[]}};e.onclose=d=>{var h;a.h("{6406bff}"+c);e===a.g&&(null===(h=a.j)||void 0===h?void 0:h.L({error:a.u,code:d.code,reason:d.reason,wasClean:d.wasClean}),L(a),a.u=
!1)};e.onerror=()=>{a.h("{7605058}"+c);e===a.g&&(a.u=!0)};e.onmessage=d=>{if(a.j)try{let f=JSON.parse(d.data);a.o||a.h("{523f5b9}");M(a);if(!f.hb){if(void 0!==f.ack){var h=f.ack;for(let k=a.l.length-1;0<=k;k--)a.l[k].ackid<=h&&a.l.splice(k,1)}if(void 0!==f.ackid){if(a.maxReceivedAckId<f.ackid&&(a.j.H(f),a.maxReceivedAckId=f.ackid),a.g){let k=JSON.stringify({ack:a.maxReceivedAckId});a.h("{903be10}"+k);a.g.send(k)}}else void 0===f.ack&&a.j.H(f)}}catch(f){a.v("Error in local websocket message handling: "+
f+' "'+d.data+'"')}};a.g=e}catch(g){a.g=void 0,a.v("WebSocket creation exception: "+g+" for socket "+a.m)}a.m=c}function N(a){0!==a.o&&(self.clearTimeout(a.o),a.o=0)}function L(a){a.g&&(a.g.onclose=null,a.g.onerror=null,a.g.onmessage=null,a.g.onopen=null,a.g=void 0)}function M(a){N(a);a.o=self.setTimeout(()=>{var b;a.h("{6c3505a}"+(null===(b=a.g)||void 0===b?void 0:b.readyState)+"{754f60b}"+a.m);a.g||J(a,!0);M(a)},3E3)}
function K(a,b){void 0!==b.ackid&&void 0!==b.ackid&&a.l.push(b);a.g&&(b.stats?a.g.send(b.stats):a.g.send(JSON.stringify(b)))}
var O=class{constructor(a,b){this.sessionId=a;this.u=!1;this.l=[];this.s=[];this.maxReceivedAckId=this.o=0;this.url="";this.m=0;this.h=b.info;this.v=b.exception}initialize(a,b,c,g=!1){this.url=a;this.maxReceivedAckId=b;this.j=c;J(this,g);this.h("{fcf6f89}"+this.m)}uninitialize(a){var b;this.maxReceivedAckId=0;this.l=[];this.s=[];this.j=void 0;N(this);null===(b=this.g)||void 0===b?void 0:b.close(a);L(this);this.h("{986b258}"+a+"{754f60b}"+this.m)}send(a){this.j&&(this.g||J(this,!0),this.g&&this.g.readyState===
WebSocket.OPEN?K(this,a):this.s.push(a))}};const P=self;function Q(a){a.g=[];a.j=[];F(a.s);a.h=[];a.l=[];a.inputChannelStats=[];a.garbageCollectionStats=[];a.m=[]}function R(a,b,c,g,l,e){for(let d=0;4>d;d++)a.setUint8(b+d,c.charCodeAt(d));a.setUint8(b+4,g);a.setUint16(b+5,l,!0);a.setUint16(b+7,e,!0)}
function S(a){var b;if((a.g.length||a.j.length||a.s.size())&&a.C)try{a.C.ackid=a.v;var c=JSON.stringify(a.C),g=c.length,l=g+2,e=new ArrayBuffer(l);const w=new DataView(e);w.setUint16(0,g);for(g=2;g<l;++g)w.setUint8(g,c.charCodeAt(g-2));var d=new Uint8Array(e),h=13*a.g.length,f=72*a.j.length,k=12*a.h.length,n=10*a.l.length,m=12*a.inputChannelStats.length,v=16*a.garbageCollectionStats.length;const x=8*a.m.length;let t=9+d.length;h&&(t+=9+h);f&&(t+=9+f);k&&(t+=9+k);n&&(t+=9+n);m&&(t+=9+m);v&&(t+=9+v);
x&&(t+=9+x);t+=a.s.size();const y=new ArrayBuffer(t);var p=new DataView(y);c=0;(new Uint8Array(y)).set(d);c+=d.length;R(p,c,"BPRF",1,0,0);c+=9;if(h){R(p,c,"PERF",2,a.g.length,13);c+=9;d=p;l=c;for(e=0;e<a.g.length;e++)d.setFloat64(l,a.g[e].RAFTS,!0),d.setUint16(l+8,Math.min(1E3*a.g[e].DCSend,65535),!0),d.setUint16(l+10,Math.min(1E3*a.g[e].GetStats,65535),!0),d.setUint8(l+12,a.g[e].FrameInfo),l+=13;c+=h}if(f){R(p,c,"EVNT",1,a.j.length,72);c+=9;h=p;d=c;for(l=0;l<a.j.length;l++){h.setFloat64(d,a.j[l].TS,
!0);d+=8;var q=a.j[l].eventtype;for(e=0;e<q.length&&63>e;e++)h.setUint8(d+e,q.charCodeAt(e));h.setUint8(d+e,0);d+=64}c+=f}if(k){R(p,c,"SQEV",1,a.h.length,12);c+=9;f=p;q=c;for(h=0;h<a.h.length;h++)f.setUint8(q,a.h[h].qualityScore),f.setUint8(q+1,a.h[h].bandwidthScore),f.setUint8(q+2,a.h[h].latencyScore),f.setUint8(q+3,a.h[h].networkLossScore),f.setFloat64(q+4,a.h[h].timestamp,!0),q+=12;c+=k}if(n){R(p,c,"MTBD",1,a.l.length,10);c+=9;k=p;f=c;for(q=0;q<a.l.length;q++)k.setFloat64(f,a.l[q].timestamp,!0),
k.setUint16(f+8,Math.min(a.l[q].duration,65535),!0),f+=10;c+=n}if(m){R(p,c,"INPT",1,a.inputChannelStats.length,12);c+=9;n=p;k=c;for(f=0;f<a.inputChannelStats.length;f++)n.setFloat64(k,a.inputChannelStats[f].timestamp,!0),n.setUint16(k+8,Math.min(a.inputChannelStats[f].bufferedAmount,65535),!0),n.setUint16(k+10,Math.min(a.inputChannelStats[f].maxSchedulingDelay,65535),!0),k+=12;c+=m}if(v){R(p,c,"GRBG",1,a.garbageCollectionStats.length,16);c+=9;m=p;n=c;for(k=0;k<a.garbageCollectionStats.length;k++)m.setFloat64(n,
a.garbageCollectionStats[k].timestamp,!0),m.setInt32(n+8,T(a.garbageCollectionStats[k].deltaUsedHeapSize),!0),m.setInt32(n+12,T(a.garbageCollectionStats[k].deltaTotalHeapSize),!0),n+=16;c+=v}if(x){R(p,c,"MKPT",1,a.m.length,8);c+=9;v=p;p=c;for(m=0;m<a.m.length;m++)v.setFloat64(p,a.m[m],!0),p+=8;c+=x}const W=new Uint8Array(y);a.s.write(W,c);null===(b=a.o)||void 0===b?void 0:b.send({stats:y,ackid:a.v})}catch(w){a.F("Exception in perf/stats upload. Error : "+w.message+" stack: "+w.stack)}Q(a)}
function U(a,b,c){a.o=new O(a.sessionId,{info:a.u,exception:a.F});a.o.initialize(a.url,b,{H:a.J,M:a.K,L:a.I,N:a.G},c);a.G()}
function V(a,b){var c,g;b.perf?a.g.push(b.perf):b.clientEvent?a.j.push(b.clientEvent):b.startStats?(a.C=b.startStats.statsHeader,b={statsStarted:!0,instanceId:a.instanceId},a.D=self.setInterval(()=>S(a),5E3),P.postMessage(b),a.u("{5209d98}")):b.stopStats?(self.clearInterval(a.D),S(a),Q(a),a.u("{b58b6ad}")):b.webrtcStats?(b.ackid&&(a.v=b.ackid),b.webrtcStats.stats&&G(a.s,b.webrtcStats)):b.sq?a.h.push(b.sq):b.startWebSocket?(a.url=b.startWebSocket.signInURL,U(a,b.startWebSocket.maxReceivedAckId,b.startWebSocket.reconnect)):
b.stopWebSocket?(null===(c=a.o)||void 0===c?void 0:c.uninitialize(),a.o=void 0):b.send?null===(g=a.o)||void 0===g?void 0:g.send(b.send):b.duration?a.l.push(b.duration):b.inputChannelStats?a.inputChannelStats.push(b.inputChannelStats):b.garbageCollectionStats?a.garbageCollectionStats.push(b.garbageCollectionStats):b.qosMarker&&a.m.push(b.qosMarker)}
class X{constructor(a,b){this.instanceId=a;this.sessionId=b;this.g=[];this.j=[];this.url="";this.D=0;this.h=[];this.l=[];this.inputChannelStats=[];this.garbageCollectionStats=[];this.m=[];this.v=0;this.F=c=>{Y(c,this.instanceId)};this.J=c=>{P.postMessage({wsMessage:c,instanceId:this.instanceId})};this.I=c=>{P.postMessage({wsClose:c,instanceId:this.instanceId})};this.K=()=>{P.postMessage({wsOpen:!0,instanceId:this.instanceId})};this.G=()=>{P.postMessage({wsOpening:!0,instanceId:this.instanceId})};
this.u=c=>{P.postMessage({log:c,instanceId:this.instanceId})};this.s=new I(this.u);P.postMessage({initialized:!0,instanceId:a})}}function T(a){return 0>a?Math.max(a,-2147483648):Math.min(a,4294967295)}function Y(a,b=0){P.postMessage({exception:a,instanceId:b})}const Z=new Map;
P.onmessage=function(a){try{const b=a.data,c=b.instanceId;if(b.initMessage)Z.set(c,new X(c,b.initMessage.sessionId));else if(b.uninitialize)Z.delete(c),P.postMessage({uninitialized:!0,instanceId:c});else{const g=Z.get(c);g?V(g,b):P.postMessage({log:"{d710be2}"+c,instanceId:c})}}catch(b){Y("Worker onmessage exception: "+b)}};


`,"ragnarokworker.js"),this.l.onmessage=this.o.bind(this),this.l.onerror=this.m.bind(this),c.i("{1f5ec29}","{62dee75}")}catch(e){c.e("{1f5ec29}","{50fa2e5}",e.message),this.h.push({name:"RagnarokWorkerProblem",error:JSON.stringify(e)})}}};function Ud(e,t=!1){const i=e.m+1;try{let n;e.sessionId&&(n="x-nv-sessionid."+e.sessionId);let r=e.url;t&&(r+="&reconnect=1");let s=new WebSocket(r,n);s.onopen=()=>{var o;if(e.h("{48fa30b}"+i),s===e.g){(o=e.j)===null||o===void 0||Fh(o);for(const d of e.l)d.stats?s.send(d.stats):s.send(JSON.stringify(d));for(const d of e.s)Th(e,d);e.s=[]}},s.onclose=o=>{var d;e.h("{6406bff}"+i),s===e.g&&((d=e.j)===null||d===void 0||_h(d,{error:e.v,code:o.code,reason:o.reason,wasClean:o.wasClean}),Ch(e),e.v=!1)},s.onerror=()=>{e.h("{7605058}"+i),s===e.g&&(e.v=!0)},s.onmessage=o=>{if(e.j)try{let u=JSON.parse(o.data);if(e.o||e.h("{523f5b9}"),Ih(e),!u.hb){if(u.ack!==void 0){var d=u.ack;for(let l=e.l.length-1;0<=l;l--)e.l[l].ackid<=d&&e.l.splice(l,1)}if(u.ackid!==void 0){if(e.maxReceivedAckId<u.ackid&&(Wd(e.j,u),e.maxReceivedAckId=u.ackid),e.g){let l=JSON.stringify({ack:e.maxReceivedAckId});e.h("{903be10}"+l),e.g.send(l)}}else u.ack===void 0&&Wd(e.j,u)}}catch(u){e.C("Error in local websocket message handling: "+u+' "'+o.data+'"')}},e.g=s}catch(n){e.g=void 0,e.C("WebSocket creation exception: "+n+" for socket "+e.m)}e.m=i}function wh(e){e.o!==0&&(self.clearTimeout(e.o),e.o=0)}function Ch(e){e.g&&(e.g.onclose=null,e.g.onerror=null,e.g.onmessage=null,e.g.onopen=null,e.g=void 0)}function Ih(e){wh(e),e.o=self.setTimeout(()=>{var t;e.h("{6c3505a}"+((t=e.g)===null||t===void 0?void 0:t.readyState)+"{754f60b}"+e.m),e.g||Ud(e,!0),Ih(e)},3e3)}function Th(e,t){t.ackid!==void 0&&t.ackid!==void 0&&e.l.push(t),e.g&&(t.stats?e.g.send(t.stats):e.g.send(JSON.stringify(t)))}var sm=class{constructor(e,t){this.sessionId=e,this.v=!1,this.l=[],this.s=[],this.maxReceivedAckId=this.o=0,this.url="",this.m=0,this.h=t.info,this.C=t.exception}initialize(e,t,i,n=!1){this.url=e,this.maxReceivedAckId=t,this.j=i,Ud(this,n),this.h("{fcf6f89}"+this.m)}uninitialize(e){var t;this.maxReceivedAckId=0,this.l=[],this.s=[],this.j=void 0,wh(this),(t=this.g)===null||t===void 0||t.close(e),Ch(this),this.h("{986b258}"+e+"{754f60b}"+this.m)}send(e){this.j&&(this.g||Ud(this,!0),this.g&&this.g.readyState===WebSocket.OPEN?Th(this,e):this.s.push(e))}};function om(e){switch(e){case"H264":return"h264";case"H265":return"hevc";case"AV1":return"av1";default:return"video"}}function am(e,t,i){const{readable:n,writable:r}=t.createEncodedStreams();t=new TransformStream({start:()=>{c.i("{d7392d2}","{b96b3ec}",i.Id)},flush:()=>{},transform:(s,o)=>{if(!i.jf){const h=new Uint8Array(s.data);if(i.size+h.byteLength<=i.data.byteLength){var d=i.data,u=i.size,l=h;const p=l.byteLength;for(let y=0;y<p;++y)d.setUint8(u+y,l[y]);i.size+=h.byteLength}else i.jf=!0,c.w("{d7392d2}","{f35b2f4}",i.size,i.Id)}o.enqueue(s)}}),n.pipeThrough(t).pipeTo(r),e.streams.push(i)}var dm=class{constructor(e){this.g=e,this.streams=[]}start(e){if(this.g.qd&1){e=$a(e);for(let t=0;t<e.length;t++){const i={data:new DataView(new ArrayBuffer(209715200)),size:0,Id:"video",hg:om(this.g.video[t].nc),jf:!1};am(this,e[t].receiver,i)}}}};function Rh(e){e.g&&(e.j=!e.j,e.g.style.display=e.j?"block":"none")}function cm(e,t){let{width:i,height:n}={width:screen.width,height:screen.height};var r=()=>{let d;switch(window.orientation!==void 0?d=window.orientation:screen.orientation&&(d=screen.orientation.angle),d){case 90:case-90:case 270:return!1;default:return!0}};_(e.u)&&(t.top=Math.max(t.top,20),r()||(r=i,i=n,n=r)),r=(d=>{let u=d.offsetTop,l=d.offsetLeft;for(var h=d.offsetParent;h;)u+=h.offsetTop,l+=h.offsetLeft,h=h.offsetParent;h=d.clientHeight;let p=d.clientWidth;return e.u.os==="Android"&&(window.innerHeight>window.innerWidth&&d.clientHeight<d.clientWidth||window.innerHeight<window.innerWidth&&d.clientHeight>d.clientWidth)&&(c.w("{48f82fd}","{c9d343e}"),h=d.clientWidth,p=d.clientHeight),{top:u,left:l,bottom:Math.max(window.innerHeight-u-h,0),right:Math.max(window.innerWidth-l-p,0)}})(e.H);const s=Math.max(n-window.innerHeight,0)/2,o=Math.max(i-window.innerWidth,0)/2;return{top:Math.max(t.top-s-r.top-e.Oa,0)/(e.H.clientHeight-2*e.Oa),left:Math.max(t.left-o-r.left-e.Ra,0)/(e.H.clientWidth-2*e.Ra),bottom:Math.max(t.bottom-s-r.bottom-e.Oa,0)/(e.H.clientHeight-2*e.Oa),right:Math.max(t.right-o-r.right-e.Ra,0)/(e.H.clientWidth-2*e.Ra)}}var lm=class{constructor(e,t,i,n){this.m=e,this.H=t,this.u=i,this.l=n,this.h={top:-1,left:-1,bottom:-1,right:-1},this.Ra=this.Oa=0,this.j=!1,this.o=0,Ct&&(e=document.createElement("div"),e.style.display="none",e.style.position="absolute",e.style.color="white",e.style.backgroundColor="rgb(105, 105, 105, 0.7)",e.style.padding="2px",e.style.bottom="0px",e.style.left="0px",e.style.margin="5px",this.g=e,t.insertAdjacentElement("afterend",this.g))}uninitialize(){this.g&&this.g.remove()}send(){var e,t,i;if(!(0>=this.H.videoHeight||0>=this.H.videoWidth)){var n=ml(),r=cm(this,n);if(!ng(r,this.h)){var s=JSON.stringify(r,(o,d)=>d.toFixed?Number(d.toFixed(2)):d);c.d("{48f82fd}","{054b8b0}",JSON.stringify(n),s),(e=Re.sendInsetValueUpdateEvents)!==null&&e!==void 0&&e&&2>this.o++&&(e=(o,d=1)=>{for(const u of Object.keys(o)){const l=Math.round(o[u]*d);o[u]=isNaN(l)?-1:l}return o},n=e(Object.assign({},n)),e=e(Object.assign({},r),1e3),(t=this.l)===null||t===void 0||Qe(t,"InsetValueUpdate","Original",n.top,n.left,n.bottom,n.right),(i=this.l)===null||i===void 0||Qe(i,"InsetValueUpdate","Normalized",e.top,e.left,e.bottom,e.right)),this.h=Object.assign({},r);for(const o of Object.keys(r))r[o]=isNaN(r[o])?0:r[o];t={messageType:"SAFE_ZONE",messageRecipient:"NvGridSvc:NGS",data:JSON.stringify({safeZoneData:{type:"InsetValueUpdate",rect:r}})},this.m.sendCustomMessage(t),Ct&&this.g&&(this.g.innerText=`Safe Zone: 
Top: `+(100*Math.max(this.h.top,0)).toFixed()+`%
Right: `+(100*Math.max(this.h.right,0)).toFixed()+`%
Bottom: `+(100*Math.max(this.h.bottom,0)).toFixed()+`%
Left: `+(100*Math.max(this.h.left,0)).toFixed()+"%")}}}};function ci(e,t,i){e.g.get(t).push(i)}function li(e,t,i){e=e.g.get(t),i=e.indexOf(i),i!==-1&&e.splice(i,1)}function jd(e,t){if((e.S||e.F)&&Bd(e,t),e.h!==t){e.h=t;for(const i of e.g.get(0))i(t)}}function kh(e,t){if(e.C!==t){e.C=t;for(const i of e.g.get(3))i(t)}}function Ph(e,t){if(e.s!==t){e.s=t;for(const i of e.g.get(4))i(t)}}function Oh(e,t){return e.R?.22>=t.level:e.V||e.F?.2>=t.level:e.U?.1>=t.level:.33>=t.level}function Gd(e){return e.T?!1:window.screen.isExtended!==void 0}function Dh(){var e,t;return fa&&((e=Re.enableComputePressure)!==null&&e!==void 0?e:!0)&&((t=globalThis.PressureObserver)===null||t===void 0?void 0:t.prototype)&&PressureObserver.knownSources instanceof Array&&PressureObserver.knownSources.includes("cpu")}function Mh(e){switch(e){case"nominal":return 0;case"fair":return 1;case"serious":return 2;case"critical":return 3;default:return 0}}function Bd(e,t){if(e.v!==t){e.v=t;for(const i of e.g.get(1))i(t)}}function um(e){switch(e.o){case"nominal":return 60;case"fair":return 75;case"serious":return 90;case"critical":return 100}return-1}var hm=class{constructor(e){var t,i,n,r;this.g=new Map,this.C=this.s=this.j=!1,this.o=void 0,this.g.set(0,[]),this.g.set(2,[]),this.g.set(1,[]),this.g.set(3,[]),this.g.set(4,[]),this.g.set(5,[]),this.g.set(6,[]),this.S=$(e),this.V=Y(e),this.U=e.os==="iPadOS",this.R=fe(e),this.F=V(e),this.T=ie(e),this.h=this.v=document.hasFocus(),this.l=0,e=window.zoneless;const s=(i=(t=e==null?void 0:e.windowAddEventListener)===null||t===void 0?void 0:t.bind(window))!==null&&i!==void 0?i:window.addEventListener.bind(window),o=(r=(n=e==null?void 0:e.documentAddEventListener)===null||n===void 0?void 0:n.bind(document))!==null&&r!==void 0?r:document.addEventListener.bind(document);this.M=this.aa.bind(this),this.K=this.Z.bind(this),this.N=this.I.bind(this),this.O=this.ba.bind(this),this.P=this.da.bind(this),this.L=this.$.bind(this),this.J=this.W.bind(this),this.D=this.G.bind(this),s("focus",this.M),s("blur",this.K),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach(d=>o(d,this.N)),o("mouseenter",this.O),o("mouseleave",this.P),navigator.getBattery&&navigator.getBattery().then(d=>{kh(this,!d.charging),Ph(this,Oh(this,d)),d.addEventListener("chargingchange",this.L),d.addEventListener("levelchange",this.J)}),Gd(this)&&(this.G(),window.screen.addEventListener("change",this.D)),Dh()?(this.m=new PressureObserver(d=>{if(0<d.length){let u="nominal";for(const l of d)Mh(l.state)>Mh(u)&&(u=l.state);if(d=u,this.o!=d){this.o=d;for(const l of this.g.get(5))l()}}}),this.m.observe("cpu")):c.i("{0c4eeb2}","{c70b747}"),this.I()}uninitialize(){var e,t,i,n,r,s,o;const d=window.zoneless,u=(t=(e=d==null?void 0:d.windowRemoveEventListener)===null||e===void 0?void 0:e.bind(window))!==null&&t!==void 0?t:window.removeEventListener.bind(window),l=(n=(i=d==null?void 0:d.documentRemoveEventListener)===null||i===void 0?void 0:i.bind(document))!==null&&n!==void 0?n:document.removeEventListener.bind(document);u("focus",this.M),u("blur",this.K),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach(h=>l(h,this.N)),l("mouseenter",this.O),l("mouseleave",this.P),navigator.getBattery&&navigator.getBattery().then(h=>{h.removeEventListener("chargingchange",this.L),h.removeEventListener("levelchange",this.J)}),Gd(this)&&window.screen.removeEventListener("change",this.D),e=(r=this.m)===null||r===void 0?void 0:r.takeRecords(),e==null||e.map(h=>c.i("{0c4eeb2}","{4f27ba0}",JSON.stringify(h))),(s=this.m)===null||s===void 0||s.unobserve("cpu"),(o=this.m)===null||o===void 0||o.disconnect();for(const h of this.g.values())h.splice(0)}aa(){jd(this,!0)}Z(){jd(this,!1)}I(){var e=window.document;if(e=!!(document.fullscreen||e.webkitIsFullScreen==1||e.mozFullScreen||e.msFullscreenElement),this.j!==e){this.j=e;for(const t of this.g.get(2))t(e)}}ba(){Bd(this,!0)}da(){Bd(this,!1)}$(){navigator.getBattery().then(e=>{kh(this,!e.charging)})}W(){navigator.getBattery().then(e=>{Ph(this,Oh(this,e))})}G(){let e;if(e=window.screen.isExtended?3:0,c.i("{0c4eeb2}","{ee99c72}",e),this.l!==e){this.l=e;for(const t of this.g.get(6))t(e)}}};function fm(e){return e.trim().split(`
`).map(t=>t.trim())}function Lh(e){return e.split(`
m=`).map((t,i)=>(0<i?"m="+t:t).trim()+`\r
`)}function Vd(e,t){return fm(e).filter(i=>i.indexOf(t)===0)}function pm(e){return e=e.substr(14).split(" "),{algorithm:e[0].toLowerCase(),value:e[1].toUpperCase()}}function so(e){var t,i,n;if(!((t=e.j)===null||t===void 0)){var r=t.g,s=e.h,o=e.g;r.D===s&&r.s===o?r=!1:(c.i("{4155ac9}","{417fbf6}",s?"y":"n",o?"y":"n"),r.D=s,r.s=o,r=!0),r&&Fd(t)}(i=window.webapis)!==null&&i!==void 0&&i.hdr10pluscloud&&(e.hdr?e.h&&e.g?(t=2,e="HDR10+G"):(t=1,e="HDR"):(t=0,e="SDR"),i=(n=window.webapis.hdr10pluscloud.isHdr10plusGamingModeEnabled())!==null&&n!==void 0?n:0,t!==i&&(n=window.webapis.hdr10pluscloud.enableHdr10plusGamingMode(t),c.i("{a5dd7ef}","{fc86642}",e,n)))}var vm=class{constructor(){this.index=0,this.hdr=!1,this.h=!0,this.g=!1}};function gm(e,t){e=e.split(`\r
`);var i=-1;if(!t.length)return"H264";for(var n=0;n<e.length;n++)if(e[n].startsWith("m=video")){i=n;break}if(i===-1)return c.e("{93c7910}","{3ab33e3}"),"H264";for(i+=1,n=new Set;i<e.length&&!e[i].startsWith("m=");){var r=e[i];r.indexOf("a=rtpmap:")===0&&(r=r.slice(r.indexOf(" ")+1,r.indexOf("/")),r!=="H264"&&r!=="H265"&&r!=="AV1"||n.add(r)),i++}for(const s of t)if(n.has(s))return c.i("{93c7910}","{304c3b1}",s),s;return c.i("{93c7910}","{81357e4}"),"H264"}function mm(e,t,i,n){let r=e.split(`\r
`),s=-1;for(var o=0;o<r.length;o++)if(r[o].startsWith("m=video")){s=o;break}if(s===-1)return c.e("{93c7910}","{3ab33e3}"),e;for(s++,o=s;o<r.length;o++)if(r[o].startsWith("a=imageattr"))return c.d("{93c7910}","{b38bf22}"),e;for(e=new Set;s<r.length&&!r[s].startsWith("m=");)o=r[s],/a=rtpmap:.*H26[45]\//.test(o)?e.add(o.slice(9,o.indexOf(" "))):o.indexOf("a=fmtp:")===0&&(o=o.slice(7,o.indexOf(" ")),e.has(o)&&(s++,r.splice(s,0,`a=imageattr:${o} send [x=[960:${t}],y=[540:${i}],fps=[30:${n}]]`))),s++;return r.join(`\r
`)}function Am(e,t){let i=e.split(`\r
`),n=-1;for(let r=0;r<i.length;r++)if(i[r].indexOf("m=video")===0){n=r;break}if(n===-1)return c.e("{93c7910}","{e0899ab}","video"),e;for(c.d("{93c7910}","{5cc346f}","video",n),n++;i[n].indexOf("i=")===0||i[n].indexOf("c=")===0;)n++;return i[n].indexOf("b")===0?(c.d("{93c7910}","{e77177e}",n),i[n]="b=AS:"+t,i.join(`\r
`)):(c.d("{93c7910}","{3dfc348}",n),e=i.slice(0,n),e.push("b=AS:"+t),e=e.concat(i.slice(n,i.length)),e.join(`\r
`))}function Nh(e,t,i,n){let r=e.split(`\r
`),s=-1;for(let o=0;o<r.length;o++)if(r[o].indexOf("m=video")===0){s=o;break}if(s===-1)return c.e("{93c7910}","{e0899ab}","video"),e;for(c.d("{93c7910}","{5cc346f}","video",s),s++,e=";x-google-max-bitrate="+i+(";x-google-min-bitrate="+t)+(";x-google-start-bitrate="+n),t=new Set;s<r.length&&r[s].indexOf("m=")!==0;)i=r[s],i.indexOf("a=rtpmap:")===0&&0<i.indexOf("H264/")?t.add(i.slice(9,i.indexOf(" "))):i.indexOf("a=fmtp:")===0&&t.has(i.slice(7,i.indexOf(" ")))&&(r[s]+=e),s++;return r.join(`\r
`)}function Sm(e){var t=[];let i=e.split(`\r
`);var n="-1";let r;for(let s=0;s<i.length;s++)i[s].indexOf("a=rtpmap:")===0?(r=i[s].split(" ")[1],r.indexOf("opus")===0&&(n=i[s].split(" ")[0].slice(9),c.i("{93c7910}","{c3dd71b}","audio",n))):i[s].indexOf("a=fmtp:"+n+" ")===0&&(t.push(s),n="-1");if(t.length===0)return c.e("{93c7910}","{115f256}","audio"),e;e=-1,n=[];for(const s of t)t=i[s],c.d("{93c7910}","{9bb0e6f}",t),t+=";stereo=1",c.d("{93c7910}","{4f021eb}",t),n=n.concat(i.slice(e+1,s)),n.push(t),e=s;return n=n.concat(i.slice(e+1)),n.join(`\r
`)}function ym(e){e=e.split(`\r
`);for(var t=-1,i=0;i<e.length;i++)if(e[i].indexOf("m=audio")===0){t=i;break}if(t===-1)c.d("{93c7910}","{a939549}","audio");else{for(var n=i=void 0,r=void 0,s=void 0,o=t+1;o<e.length;o++)if(e[o].indexOf("a=rtpmap:")===0){var d=e[o].split(" ")[1];d.indexOf("red")===0?(n=e[o].split(" ")[0].slice(9),s=d.split("/")[2],c.i("{93c7910}","{4e6ce55}","audio",n,s)):d.indexOf("multiopus")===0&&(i=e[o].split(" ")[0].slice(9),r=d.split("/")[2],c.i("{93c7910}","{53ebbb1}","audio",i,r))}else if(e[o].indexOf("m=")===0){c.d("{93c7910}","{9fc6964}",e[o]);break}if(i){for(d=[],o=[],t+=1;t<e.length;t++)if(e[t].indexOf("a=rtpmap:"+n)===0||e[t].indexOf("a=rtcp-fb:"+n)===0||e[t].indexOf("a=fmtp:"+n)===0)o.push(e[t]);else if(e[t].indexOf("a=rtpmap:"+i)===0||e[t].indexOf("a=rtcp-fb:"+i)===0||e[t].indexOf("a=fmtp:"+i)===0)d.push(e[t]);else if(e[t].indexOf("m=")===0){c.d("{93c7910}","{9fc6964}",e[t]);break}return s&&s!==r&&(n=void 0,o=[],c.w("{93c7910}","{ad53601}",s,r)),{wd:n,We:i,Bg:o.join(`\r
`),Ag:d.join(`\r
`)}}c.d("{93c7910}","{cf4ee2d}","audio")}}function bm(e,t){let i=e.split(`\r
`),n=-1,r=-1;for(var s=0;s<i.length;s++)if(i[s].indexOf("m=audio")===0){n=s;break}if(n===-1)return c.d("{93c7910}","{e0899ab}","audio"),e;s=i.slice(0,n);let o=i[n].split(" ");if(o[3]!=="0")return c.d("{93c7910}","{794b3c6}","audio",o.join(" ")),e;for(t.wd?(o[3]=t.wd,o[4]=t.We):o[3]=t.We,s.push(o.join(" ")),e=n+1;e<i.length;e++)if(i[e].indexOf("m=")===0){r=e;break}return r===-1&&(r=i.length-1),s=s.concat(i.slice(n+1,r)),t.wd&&(s=s.concat(t.Bg.split(`\r
`))),s=s.concat(t.Ag.split(`\r
`)),s=s.concat(i.slice(r)),s.join(`\r
`)}function xh(e,t){var i,n=e.D;n.h&&(n.perf.DCSend+=t),(i=e.h)===null||i===void 0||(e=i.g,e.j.value+=t,e.j.count+=1,e.j.max=Math.max(t,e.j.max))}function Hd(e){if(Un(e))return e.h.S}function Pi(e,t){e.ea.innerHTML=t,e.ea.style.display="block",e.P&&clearTimeout(e.P),e.P=window.setTimeout(()=>{e.ea.style.display="none"},1e3)}function cs(e,t,i){const n=t.label;let r=!1;t.onopen=()=>{var s;c.d("{93c7910}","{8e9ee5d}",n),(s=i.open)===null||s===void 0||s.call(i),i.errorCode&&Jd(e)},t.onclosing=()=>{c.d("{93c7910}","{d0c8ae7}",n),r=!0},t.onclose=()=>{var s;c.d("{93c7910}","{a3c9826}",n),(s=i.close)===null||s===void 0||s.call(i),i.errorCode&&$d(e)},t.onerror=s=>{if(c.e("{93c7910}","{fcd64bb}",n),r&&i.errorCode)$d(e)||pt(e,15867907);else{var o=t.bufferedAmount;s=s==null?void 0:s.error,e.Z||vt(e.l,"ChannelError",n,s==null?void 0:s.name,s==null?void 0:s.message,o==null?void 0:o.toString()),c.e("{93c7910}","{db7ae96}",n,s==null?void 0:s.name,s==null?void 0:s.message),i.errorCode&&pt(e,i.errorCode)}}}function oo(e,t){Wt(e,{etwPrint:t})}function _h(e,t){const i=()=>{var n,r,s,o,d;const u=(n=t.code)!==null&&n!==void 0?n:1005;c.i("{93c7910}","{0a06f78}",u,(r=t.error)!==null&&r!==void 0?r:!1),gf(e.l,e.L,u,(o=(s=e.session)===null||s===void 0?void 0:s.signalConnectionInfo.ip)!==null&&o!==void 0?o:"",(d=t.reason)!==null&&d!==void 0?d:"",e.ga,t.wasClean),window.clearTimeout(e.F),e.F=0,Fn(e,{code:og(u),description:t.reason})};e.F!==0&&(t.error||t.code&&1002<=t.code&&1015>=t.code?(e.ga++,3>=e.ga?(jh(e),Vh(e)):i()):i()),t.wasClean||e.za++}function Wd(e,t){var i;c.i("{93c7910}","{39024c3}",wr(JSON.stringify(t))),t.ackid&&e.maxReceivedAckId<t.ackid&&(e.maxReceivedAckId=t.ackid),t.peer_info?(t.peer_info.name===e.name||e.id===0)&&(e.id=t.peer_info.id,c.d("{93c7910}","{c5faf27}",e.id)):t.peer_msg?Cm(e,t.peer_msg.from,t.peer_msg.msg):t.error&&(t.error==="peerRemoved"?(e.G!==0?(t=(i=Kd(e))!==null&&i!==void 0?i:3237094161,c.w("{93c7910}","{cbb35d3}")):t=3237094159,pt(e,t)):pt(e,3237094160))}function Fh(e){e.F!==0&&(window.clearTimeout(e.F),e.F=0,e.kb=Date.now()-e.Ab),e.I||e.G!==0||Im(e)}function Em(e){jh(e);let t=1e4;Re.signInTimeout&&Re.signInTimeout!==0&&(t=Re.signInTimeout,c.i("{93c7910}","{4f2f101}",t)),e.F=window.setTimeout(()=>e.signInTimeout(),t),e.Ab=Date.now(),Vh(e)}function Uh(e){c.d("{93c7910}","{440d709}",e.O.g,performance.timeOrigin)}function jh(e){var t=1;for(let i=1;10>i;i++)t*=10;t=""+Math.floor(Math.random()*t),t=t.padEnd(10,"0"),e.name="peer-"+t,c.d("{93c7910}","{f2b789d}",e.name),e.L=e.N+"/sign_in?peer_id="+e.name+"&version=2",e.signalingUrlQueryParameters&&(e.L+="&"+e.signalingUrlQueryParameters),c.d("{93c7910}","{05b8afd}",e.L)}function Fn(e,t){var i,n,r;if(!e.I){if(e.Bb=Date.now()-e.Cb,t===void 0){if(!Ga){var s;(s=e.R)===null||s===void 0||s.uninitialize(4001),e.R=void 0,e.D.startWebSocket(e.L,e.maxReceivedAckId,e,!0),Ts&&zh(e)}}else Tm(e);e.I=!0,e.G!==0&&(window.clearTimeout(e.G),e.G=0),t={sessionId:e.session.sessionId,subSessionId:e.session.subSessionId,streams:e.v,streamInfo:e.session.streamInfo,error:t,zoneName:e.session.zoneName,zoneAddress:e.session.zoneAddress,gpuType:e.session.gpuType,isResume:(i=e.isResume)!==null&&i!==void 0?i:!1,bitDepth:(r=(n=e.h)===null||n===void 0?void 0:n.bitDepth)!==null&&r!==void 0?r:8},e.ja.yc(t),e.ma.send()}}function zd(e,t){var i;try{if(((i=e.U)===null||i===void 0?void 0:i.readyState)==="open"){let n=performance.now();e.U.send(JSON.stringify(t)),xh(e,performance.now()-n)}else c.w("{93c7910}","{593db1b}")}catch(n){c.e("{93c7910}","{a585a6e}",n),e.l.Aa(n,"sendControlMessage exception","{93c7910}.ts",0,0,!0)}}function Gh(e){e.m&&(e.m.uninitialize(),e.m=void 0)}function Bh(e){var t;(t=e.h)===null||t===void 0||t.stop()}function wm(e){var t;if(!((t=e.ba)===null||t===void 0)){for(const n of t.streams){var i=new Date().toISOString();i=`streamkit-${n.Id}-${i}.${n.hg}`;const r=[new DataView(n.data.buffer,0,n.size)];Jr(r,i,"text/plain")&&c.i("{d7392d2}","{4b3378a}",i)}t.streams=[]}e.ba=void 0}async function Cm(e,t,i){var n;c.d("{93c7910}","{9978507}",t);try{const r=JSON.parse(i);if(r.type==="offer"){e.Za=!0;let s,o=r.sdp||"";c.d("{93c7910}","{ca9a155}",wr(o));const d=await e.Gc;if(e.s.video[0].nc=gm(o,d),r.nvstSdp){const l=(n=r.nvstServerOverrides)!==null&&n!==void 0?n:"";if(s=_m(e,r.nvstSdp,l),!s)return}e.ba=new dm(e.s),Lm(e,t);let u=Date.now();o=Nm(e,o),o=mm(o,e.s.video[0].Sb,e.s.video[0].Rb,e.s.video[0].ic),jm(e.u)&&(o=Fm(o)),c.d("{93c7910}","{542f9d5}",wr(o)),e.g.setRemoteDescription({type:r.type,sdp:o}).then(()=>{e.ya=Date.now()-u,xm(e),c.d("{93c7910}","{ab7b3af}",e.ya),Rm(e);const l=km(e);l?pt(e,l):(Dm(e),Pm(e),Om(e),u=Date.now(),e.g.createAnswer().then(h=>{var p;e.wa=Date.now()-u,c.d("{93c7910}","{2984003}",e.wa);const y=e.s.video[0].vc.toString(),N=e.s.video[0].bd.toString(),G=e.s.video[0].Ad.toString();c.d("{93c7910}","{b535c15}",wr(Qd((p=h.sdp)!==null&&p!==void 0?p:""))),h.sdp!==void 0&&(h.sdp=Am(h.sdp,y),window.chrome&&(h.sdp=Nh(h.sdp,N,y,G)),h.sdp=Sm(h.sdp),(p=ym(o))&&(h.sdp=bm(h.sdp,p)),c.d("{93c7910}","{1a048a7}",wr(Qd(h.sdp)))),u=Date.now(),e.g.setLocalDescription(h).then(()=>{if(e.xa=Date.now()-u,c.d("{93c7910}","{de86c01}",e.xa),h.sdp===void 0||window.chrome||(h.sdp=Nh(h.sdp,N,y,G)),h.sdp!==void 0&&s){var E=Lh(h.sdp),D=E.shift(),z=E[0],Z=D,Q=Vd(z+Z,"a=ice-ufrag:")[0];z=Vd(z+Z,"a=ice-pwd:")[0],Q=Q.substr(12),z=z.substr(10),E=Vd(E[0]+D,"a=fingerprint:").map(pm),D=Lh(s),D[0]+="a=general.icePassword:"+z+`\r
`,D[0]+="a=general.iceUserNameFragment:"+Q+`\r
`,D[0]+="a=general.dtlsFingerprint:"+E[0].value+`\r
`,s=D.join("")}$h(e,t,{type:h.type,sdp:h.sdp,nvstSdp:s}),c.i("{93c7910}","{bd70666}",JSON.stringify(e.v)),Jd(e)}).catch(E=>{c.e("{93c7910}","{ba2deaa}",E),pt(e,3237093902)})}).catch(h=>{c.d("{93c7910}","{40c0f69}",h)}))}).catch(l=>{c.e("{93c7910}","{ec2853e}",l),pt(e,3237093902)})}else if(r.candidate){c.d("{93c7910}","{cf4c103}");let s=Yh(e,r.candidate);c.d("{93c7910}","{43e80e0}",s),e.g.addIceCandidate({sdpMLineIndex:r.sdpMLineIndex,sdpMid:r.sdpMid,candidate:s}).then(()=>{c.d("{93c7910}","{db0ae14}"),e.pa=!0}).catch(o=>{c.e("{93c7910}","{62f207e}",o),vt(e.l,"AddCandidateFailed",o==null?void 0:o.name,o==null?void 0:o.message)}),c.d("{93c7910}","{9454009}")}}catch(r){i==="BYE"?pt(e,15868672):(c.e("{93c7910}","{93367fc}",r),e.l.Aa(r,"Invalid handlePeerMessage Response","{93c7910}.ts",0,0,!0))}}function Kd(e){var t;const i=Hh(e);let n;switch(e.videoStreamProgress){case 0:case 2:break;case 3:n=3237093922;break;case 5:n=3237093923;break;case 7:n=3237093924;break;default:n=3237093925}if((t=e.h)===null||t===void 0)var r=void 0;else e:{if(t.l){var s=r=0,o=0,d=0;for(const u of t.l.values())u.type==="candidate-pair"&&(t=u,r+=t.requestsSent+t.consentRequestsSent,s+=t.responsesReceived,t.Kg&&o++,t.state==="succeeded"&&d++);if(c.i("{5cea617}","{47c0ce7}",r,s),0<r&&s===0){r=3237093926;break e}if(!o){r=3237093927;break e}if(!d){r=3237093928;break e}}r=void 0}return e.id?e.Za?i!==15859712?n=i:e.pa?e.Ya?r?n=r:e.o&4&&(Yi(e.J)==="connecting"?n=3237093919:Yi(e.V)==="connecting"?n=3237093920:Yi(e.U)==="connecting"?n=3237093921:e.K&&Yi(e.K)==="connecting"&&(n=3237093936)):n=3237093903:n=3237093904:n=3237093913:n=3237093912,n}function pt(e,t){var i;if(!e.Z){if(e.Z=!0,Gh(e),Bh(e),e.I){const n={sessionId:e.session.sessionId,subSessionId:e.session.subSessionId,error:{code:t,description:void 0},zoneName:e.session.zoneName,zoneAddress:e.session.zoneAddress,isSessionAlive:Ha(t)};vt(e.l,"SignalingState",R(t),(i=e.g)===null||i===void 0?void 0:i.signalingState),c.i("{93c7910}","{89d3ea6}",e.g.signalingState),e.ja.yf(n)}else Fn(e,{code:t});c.e("{93c7910}","{573fb24}",R(t))}}function Vh(e){e.R=new sm(e.session.sessionId,{info:e.Mc.bind(e),exception:e.Lc.bind(e)}),e.R.initialize(e.L,e.maxReceivedAckId,e)}function Im(e){e.G=window.setTimeout(()=>{var t;e.G=0,c.i("{93c7910}","{d22df91}"),pt(e,(t=Kd(e))!==null&&t!==void 0?t:3237093895)},3e4),e.Cb=Date.now()}function Hh(e){const t=e.v.flatMap(i=>i.tracks);for(const i of e.$)if(!t.find(n=>n.trackId===i.trackId))return i.kind==="audio"?3237093914:3237093905;return c.d("{93c7910}","{4fef10b}"),t.length>e.$.length&&c.w("{93c7910}","{7861bb3}"),15859712}function $d(e){let t=!1;return window.chrome&&e.g.signalingState==="closed"&&(t=!0,pt(e,15867908)),t}function Tm(e){var t,i,n,r,s,o,d,u,l;const h=D=>{var z,Z;const Q=(z=D==null?void 0:D.get("TCP"))!==null&&z!==void 0?z:0;return D=(Z=D==null?void 0:D.get("IPV6"))!==null&&Z!==void 0?Z:0,Q+D};var p=(D,z)=>{let Z=0;if(z){D=`${D} local candidates:`;for(const[Q,ce]of z){z=Q;const be=ce;Z+=be,D+=` ${z}: ${be}`}c.i("{93c7910}","{0b0c6f9}",D)}return Z};const y=(t=e.h)===null||t===void 0?void 0:Z0(t);t=p("event",e.da);const N=p("stats",y);p=t-e.$a;let G="";const E=(i=e.g)===null||i===void 0?void 0:i.getReceivers().find(D=>D.track.kind==="video"&&D.track.enabled);(i=(o=(s=(r=(n=E==null?void 0:E.Ng)===null||n===void 0?void 0:n.Jg)===null||r===void 0?void 0:r.getSelectedCandidatePair)===null||s===void 0?void 0:s.call(r))===null||o===void 0?void 0:o.local)&&(G=`category: ${ro(i)}, type: ${i.type}`),Qe(e.l,"LocalCandidatesCategories",G,t,t-h(e.da),N,N-h(y)),n=(u=(d=e.h)===null||d===void 0?void 0:em(d))!==null&&u!==void 0?u:new Set,Qe(e.l,"LocalCandidateRanges",`${(l=e.g)===null||l===void 0?void 0:l.iceGatheringState}`,p,n==null?void 0:n.size,e.oa.size,new Set([...n,...e.oa]).size)}function Rm(e){for(const t of e.v)t.streamId==="stream_id"&&e.v.length===2?t.streamId="app_video_stream":t.streamId==="stream_id"?t.streamId="app_media_stream":t.streamId==="second_stream_id"&&(t.streamId="app_audio_stream")}function ao(e,t,i){e=e.g.getTransceivers().map(n=>n.receiver.track),e=new MediaStream(e.filter(n=>t.tracks.find(r=>r.trackId===n.id))),i.srcObject=e}function km(e){var t=e.v.find(n=>n.streamId==="app_media_stream");if(t)ao(e,t,e.H),c.i("{93c7910}","{a5e354c}");else{t=e.v.find(n=>n.streamId==="app_video_stream");var i=e.v.find(n=>n.streamId==="app_audio_stream");if(t&&i){const n={streamId:"app_media_stream",tracks:t.tracks.concat(i.tracks)};e.v.splice(e.v.indexOf(t),1),e.v.splice(e.v.indexOf(i),1),e.v.push(n),ao(e,n,e.H),c.i("{93c7910}","{e2dc4ec}")}else if(t)ao(e,t,e.H),c.i("{93c7910}","{07f3411}");else if(i){if(!e.Da)return 3237093937;ao(e,i,e.Da),c.i("{93c7910}","{243a50b}")}else c.w("{93c7910}","{c3a2679}")}}function Pm(e){try{if(e.g&&e.sendVideoTrack){const t=$a(e.g)[0];if(t){let i="",n=t.direction;t.direction!=="sendrecv"&&(t.direction="sendrecv",i=" ("+n+" direction is overridden by sendrecv)"),t.sender.replaceTrack(e.sendVideoTrack).then(()=>{c.i("{93c7910}","{b54f651}",i)}).catch(r=>{t.direction!==n&&(t.direction=n),c.w("{93c7910}","{d225159}",r)})}else c.w("{93c7910}","{8272b59}")}}catch(t){c.w("{93c7910}","{66082ec}",t)}}function Wh(e,t,i){c.w("{93c7910}","{4d3c418}",t,i),e.l.Aa(i,t,"{93c7910}.ts",0,0,!0)}function Om(e){var t,i,n,r,s=(t=e.s.video[0])===null||t===void 0?void 0:t.nc;if((t=$a(e.g)[0])&&s!==void 0)if(RTCRtpReceiver.getCapabilities&&RTCRtpSender.getCapabilities&&t.setCodecPreferences){var o=[s,"flexfec-03","rtx"];if(s=(i=RTCRtpReceiver.getCapabilities("video"))===null||i===void 0?void 0:i.codecs,i=[],s){for(const d of o)(o=s.filter(u=>u.mimeType==="video/"+d))&&i.push.apply(i,o);try{t.setCodecPreferences(i)}catch(d){Wh(e,"Failed to set codec preferences to receiver capabilities",d);try{i=i.concat((r=(n=RTCRtpSender.getCapabilities("video"))===null||n===void 0?void 0:n.codecs)!==null&&r!==void 0?r:[]),t.setCodecPreferences(i)}catch(u){Wh(e,"Failed to set codec preferences to sender and receiver capabilities",u)}}}}else c.w("{93c7910}","{274c489}")}function zh(e){var t=e.D,i={stats:{from:e.id,to:e.ta}};t.h=!1,t.g&&(i={startStats:{statsHeader:i},instanceId:t.instanceId},c.d("{1f5ec29}","{6897d5e}"),t.g.postMessage(i)),e.ra=!0}function Wt(e,t){Yi(e.U)==="connecting"?e.fa.push(t):zd(e,t)}function qd(e,t,i){var n;t===2&&((n=e.m)===null||n===void 0||Ad(n,!0)),c.d("{93c7910}","{5ba6173}",t,i),e.M.emit("StreamingEvent",{streamingWarnings:{code:t,secondsLeft:i}})}function Dm(e){var t;(t=e.ba)===null||t===void 0||t.start(e.g)}function Kh(e,t,i){t.candidate?(i||(i=ro(t.candidate),e.da.set(i,e.da.get(i)+1),i==="IPV4"&&(i=Sh(t.candidate),i!=="UNKNOWN"&&e.oa.add(i))),t.candidate.protocol==="tcp"?c.d("{93c7910}","{6f19d1e}"):(c.d("{93c7910}","{ac052fa}",t.candidate.port,t.candidate.protocol),$h(e,e.ta,{sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid,candidate:t.candidate.candidate}),e.Ya=!0)):c.d("{93c7910}","{a759d16}")}function $h(e,t,i){const n=JSON.stringify(i);i={peer_msg:{from:e.id,to:t,msg:n},ackid:e.Ba.g++},c.d("{93c7910}","{7ecb902}",t,n.length,wr(Qd(JSON.stringify(i)))),e.R?e.R.send(i):(e=e.D,e.g&&e.g.postMessage({send:i,instanceId:e.instanceId}))}function qh(e,t){let i=0;e.j.h&&(i|=2),e.j.v&&(i|=1),e.j.j&&(i|=16);const n={windowState:{streamIndex:0,frameNumber:t,windowStateFlags:i}};c.i("{93c7910}","{ca317d5}",i.toString(16),t),Wt(e,n)}function Jh(e,t){var i;let n=0;e.j.s&&(n|=4),e.j.C&&(n|=1),(i=e.h)===null||i===void 0||i.m.extraData.set("Power",n),i={systemState:{streamIndex:0,frameNumber:t,systemStateFlags:n}},c.i("{93c7910}","{455ccc0}",n.toString(16),t),Wt(e,i)}function Qh(e,t){var i;const n=um(e.j);if(n!=-1){if(!((i=e.h)===null||i===void 0)){var r=t;r==0&&(r=1),i.m.h.push({frameNumber:r,cpuUsage:n})}i={cpuUsage:{streamIndex:0,frameNumber:t,procCpuUsage:0,totalCpuUsage:n}},c.i("{93c7910}","{9bb3298}",n.toString(),t),Wt(e,i)}}function Mm(e,t){(t=Um(t))&&(t.onunmute=()=>{e.Ua=!1})}function Jd(e){0<e.$.length&&Yi(e.U)!=="connecting"&&Yi(e.V)!=="connecting"&&Yi(e.J)!=="connecting"&&(!e.K||Yi(e.K)!=="connecting")&&Hh(e)===15859712&&Fn(e)}function Lm(e,t){var i,n,r,s,o;c.d("{93c7910}","{d79ed0a}",t);try{let d={};Re.enableStunServer&&(d.iceServers=[{urls:"stun:s1.stun.gamestream.nvidia.com:19308"}]),(i=e.ba)===null||i===void 0||i.g.qd&&(d.encodedInsertableStreams=!0),c.d("{93c7910}","{93106c2}",JSON.stringify(d)),e.ta=t,e.g=new RTCPeerConnection(d);const u=l=>{var h,p;if(e.W){var y=e.W;Qe(e.l,"IceStats","disconnected",0,y.Hf,y.If,y.Gf),e.W=void 0}(y=(h=e.h)===null||h===void 0?void 0:Ah(h))&&Qe(e.l,"IceStats","failed",0,y.Hf,y.If,y.Gf),e.o|=16,e.o&4?e.h&&e.h.packetsReceived()==0?pt(e,3237093900):e.h&&e.h.ua()==0?pt(e,3237093901):l?pt(e,3237093906):pt(e,3237093899):pt(e,(p=Kd(e))!==null&&p!==void 0?p:3237093894)};if(e.g.onconnectionstatechange=()=>{if(e.g)switch(c.d("{93c7910}","{4ced155}",e.g.connectionState),e.g.connectionState){case"failed":$d(e)||u(!1)}else c.e("{93c7910}","{648f784}")},e.g.oniceconnectionstatechange=()=>{var l;if(e.g)switch(c.d("{93c7910}","{3a3143a}",e.g.iceConnectionState),e.g.iceConnectionState){case"new":e.o|=1;break;case"checking":e.o|=2;break;case"connected":e.W=void 0,e.o&32&&(e.M.emit("StreamingEvent",{streamingState:{state:"reconnected"}}),e.cb++),e.o|=4;break;case"completed":e.W=void 0,e.o|=12;break;case"failed":u(!0);break;case"disconnected":e.W=(l=e.h)===null||l===void 0?void 0:Ah(l),e.o&4&&e.M.emit("StreamingEvent",{streamingState:{state:"reconnecting"}}),e.o|=32;break;case"closed":e.o|=64,e.o&32&&pt(e,3237093892)}else c.e("{93c7910}","{648f784}")},e.g.ondatachannel=l=>{c.d("{93c7910}","{b364db9}",l.channel.label),l.channel.label=="control_channel"&&(cs(e,l.channel,{errorCode:3237093898,open:()=>{var h,p,y,N,G,E;e.U=l.channel;for(const D of e.fa)zd(e,D);c.d("{93c7910}","{038895c}",e.fa.length),e.fa=[],oo(e,`NvRtcClient Browser name: ${e.u.browser}, Browser version: ${e.u.browserFullVer}`),Wt(e,{etwPrintPair:{key:"GPU Detail",value:e.u.gpuDetail}}),qh(e,(p=(h=e.h)===null||h===void 0?void 0:h.ua())!==null&&p!==void 0?p:0),ci(e.j,0,e.S),ci(e.j,1,e.S),ci(e.j,2,e.S),navigator.getBattery&&(Jh(e,(N=(y=e.h)===null||y===void 0?void 0:y.ua())!==null&&N!==void 0?N:0),ci(e.j,4,e.ha),ci(e.j,3,e.ha)),Dh()&&(oo(e,"ClientGenericMapping: {ProcCpuUsage, TotalCpuUsage}"),Qh(e,(E=(G=e.h)===null||G===void 0?void 0:G.ua())!==null&&E!==void 0?E:0),ci(e.j,5,e.Xa)),Gd(e.j)&&(e.Pa(e.j.l),ci(e.j,6,e.Ea)),window.requestAnimationFrame(e.Ta)}}),l.channel.onmessage=h=>{try{let Q=JSON.parse(h.data);if(c.d("{93c7910}","{9371373}"),Q.exitMessage)pt(e,Xv(Q.exitMessage));else if(Q.timerNotification){var p=Q,y=p.timerNotification.code,N=0;switch(c.d("{c00be32}","{44bd2b6}",y),y){case 1:case 2:N=1;break;case 4:N=2;break;case 6:N=3}var G=N;G===0?c.e("{93c7910}","{de37ac5}",p.timerNotification.code):qd(e,G,p.timerNotification.secondsLeft)}else if(Q.debugMessage)Pi(e,Q.debugMessage.message);else if(Q.customMessage){var E=JSON.parse(Q.customMessage);if(E.messageRecipient==="Hdr10PlusGaming"){if(E.messageType==="Hdr10PlusGamingChange"&&E.data){const ce=JSON.parse(E.data);p=e.aa,G=ce;const be=(N=kd)===null||N===void 0?void 0:N.features.hdr10PlusGamingData;be!=null&&be.version?G.isSupported?(G.isOn?G.version===be.version&&G.peakLuminanceIndex===be.peakLuminanceIndex&&G.peakFullFrameLuminanceIndex===be.peakFullFrameLuminanceIndex?(p.g=!0,c.i("{a5dd7ef}","{09b4301}")):(p.g=!1,c.i("{a5dd7ef}","{6aed760}")):(p.g=!1,c.i("{a5dd7ef}","{a358edc}")),so(p)):c.i("{a5dd7ef}","{15eb580}"):c.i("{a5dd7ef}","{0eae5fd}",JSON.stringify(G))}}else e.M.emit("CustomMessage",E)}else if(Q.videoStreamProgressEvent)e.videoStreamProgress=Q.videoStreamProgressEvent.videoStreamProgress;else if(Q.gameSessionHdrMode){var D=e.aa,z=0<Q.gameSessionHdrMode.hdrMode,Z;D.hdr=z,(Z=D.j)===null||Z===void 0||Z.hdr!==z&&(c.i("{5cea617}","{3cc6c54}",z?"on":"off"),Z.hdr=z,Z.g.hdr=z,Fd(Z)),so(D)}else c.d("{93c7910}","{d14e0fd}")}catch(Q){c.e("{93c7910}","{a40734a}",Q),e.l.Aa(Q,"Error in control_channel message handling","{93c7910}.ts",0,0,!0)}})},c.d("{93c7910}","{d9ffda2}"),c.d("{93c7910}","{2bd4728}"),e.J=e.g.createDataChannel("input_channel_v1",{ordered:!0,reliable:!0}),e.J.binaryType="arraybuffer",cs(e,e.J,{errorCode:3237093896}),0<e.s.Lb.Kd){c.d("{93c7910}","{860d2d7}");let l={ordered:!1,maxPacketLifeTime:e.s.Lb.Kd};c.d("{93c7910}","{25e5dc3}",JSON.stringify(l)),e.K=e.g.createDataChannel("input_channel_partially_reliable",l),e.K.binaryType="arraybuffer",cs(e,e.K,{errorCode:3237093929})}if(e.V=e.g.createDataChannel("cursor_channel",{ordered:!0,reliable:!0}),e.V.binaryType="arraybuffer",cs(e,e.V,{errorCode:3237093897}),ig(e.session.appId)&&Cg(e.C),wg(e.C,e.s.Lb.bf),e.m=new Yg(e,e.H,e.J,e.V,e.l,e.M,e.Nb,e.appLaunchMode===2,e.Ob,e.C,e.u,e.ja,e.ma,e.j,e.Ka,e.O,e.D,e.s.Lb,e.K,e.textInputElement),e.qa&&(e.setKeyboardLayout(e.keyboardLayout),e.qa=!1),Is){c.d("{93c7910}","{9ae428b}");const l={zoneName:e.session.zoneName,clientAppVersion:(n=e.clientAppVersion)!==null&&n!==void 0?n:"",appId:e.session.appId,Nd:(r=e.Nd)!==null&&r!==void 0?r:"",gpuType:e.session.gpuType,streamInfo:(s=e.session.streamInfo[0])!==null&&s!==void 0?s:{width:0,height:0,fps:0},clientLocale:e.session.clientLocale};e.h=new tm(e.M,e,e.H,e.g,e.s,e.l,e.u,l,e.j,e.Ka,e.O,e.D),e.aa.j=e.h}e.g.addEventListener("icecandidate",e.ab),e.g.onsignalingstatechange=()=>{c.i("{93c7910}","{3236227}",e.g.signalingState)},e.g.onicecandidate=l=>Kh(e,l),e.g.g=l=>{c.w("{93c7910}","{9871b05}",l.port,l.url,l.errorCode,l.Ig)},((o=hn)!==null&&o!==void 0?o:!se(e.u))&&e.La.initialize(e.g,e.M,e.H,e.Da),e.g.ontrack=l=>{var h;const p=l.streams[0];c.d("{93c7910}","{47359d4}",p.id,l.track.kind,l.track.id,l.streams.length,R(e.o));let y={kind:l.track.kind==="video"?"video":"audio",trackId:l.track.id};l.track.kind!=="audio"||p.id!=="stream_id"&&p.id!=="app_media_stream"&&p.id!=="second_stream_id"&&p.id!=="app_audio_stream"||(e.sa=l.track.id,Mm(e,p),(h=e.T)===null||h===void 0||h.initialize(new MediaStream(p.getAudioTracks()))),(l=e.v.find(N=>N.streamId===p.id))?l.tracks.push(y):e.v.push({streamId:p.id,tracks:[y]}),Jd(e)}}catch(d){c.e("{93c7910}","{ff11182}",d),e.l.Aa(d,"Exception in creating peer connection","{93c7910}.ts",0,0,!0)}}function Yh(e,t){return c.d("{93c7910}","{2dd62a2}"),(e=e.session.mediaConnectionInfo.find(i=>i.usage===2||i.usage===17))?(t=t.split(" "),e.ip&&(t[4]=e.ip),e.port&&(t[5]=""+e.port),t=t.join(" "),c.d("{93c7910}","{1fbcd88}",t),t):(c.d("{93c7910}","{aee7283}"),t)}function Nm(e,t){return t.split(`\r
`).map(i=>i.startsWith("a=candidate:")?(e.pa=!0,"a="+Yh(e,i.substr(2))):i).join(`\r
`)}function xm(e){let t=e.g.getTransceivers();if(t.length===0)c.d("{93c7910}","{3399d9d}"),Fn(e,{code:3237093909});else{for(const i of t)i.mid==="3"&&i.receiver.track.id!==e.sa?(c.i("{93c7910}","{981392f}"),i.receiver.track.enabled=!1):e.$.push({trackId:i.receiver.track.id,kind:i.receiver.track.kind});c.d("{93c7910}","{648ae93}",JSON.stringify(e.$))}}function _m(e,t,i){var n,r=e.s,s=e.u;if(t=A0(t)){var o=t,d;const ni={origin:o.origin,time:o.time,mb:new Map,media:[]};ni.mb.set("general.clientSupportsIntraRefresh",B(s)?"0":"1"),ni.mb.set("general.clientCapture",(d=o.mb.get("general.clientCapture"))!==null&&d!==void 0?d:"0"),ni.mb.set("runtime.serverTraceCapture","2"),d=0;for(var u of o.media){if(o=new Map,u.mediaType==="video"&&d<r.video.length){var l=void 0,h=o,p=r.video[d],y=s,N=p.nc;h.set("vqos.fec.rateDropWindow","10"),h.set("vqos.fec.minRequiredFecPackets","2"),h.set("vqos.drc.minRequiredBitrateCheckEnabled","1"),h.set("video.dx9EnableNv12","1"),h.set("video.dx9EnableHdr","1"),h.set("vqos.qpg.enable","1"),h.set("vqos.resControl.qp.qpg.featureSetting","7"),h.set("bwe.useOwdCongestionControl","1"),h.set("video.enableRtpNack","1"),h.set("vqos.bw.txRxLag.minFeedbackTxDeltaMs","200"),h.set("vqos.fec.repairMinPercent","5"),h.set("vqos.fec.repairPercent","5"),h.set("vqos.fec.repairMaxPercent","35"),h.set("vqos.drc.bitrateIirFilterFactor","18"),h.set("video.packetSize","1140"),h.set("packetPacing.minNumPacketsPerGroup","15"),h.set("vqos.bllFec.enable","0");var G=void 0,E=J(y)||fe(y);((G=Re.enableOOFQosEnhancements)!==null&&G!==void 0?G:E)&&(h.set("vqos.adjustStreamingFpsDuringOutOfFocus","1"),h.set("vqos.resControl.cpmRtc.ignoreOutOfFocusWindowState","1"),h.set("vqos.resControl.perfHistory.rtcIgnoreOutOfFocusWindowState","1")),E=120<=p.ic;var D=p.ic===120,z=p.ic===240,Z=4953600<=p.Sb*p.Rb,Q=Wa(p.Sb,p.Rb)||Z,ce=2764800<=p.Sb*p.Rb;if((G=yl(y))&&h.set("vqos.resControl.cpmRtc.featureMask","3"),E&&(h.set("bwe.iirFilterFactor","8"),h.set("video.encoderFeatureSetting","47"),h.set("video.encoderPreset","6"),h.set("vqos.resControl.cpmRtc.badNwSkipFramesCount"," 600"),h.set("vqos.resControl.cpmRtc.decodeTimeThresholdMs","9"),D?(h.set("video.fbcDynamicFpsGrabTimeoutMs","6"),h.set("vqos.resControl.cpmRtc.serverResolutionUpdateCoolDownCount","6000")):z&&(h.set("video.fbcDynamicFpsGrabTimeoutMs","18"),h.set("vqos.resControl.cpmRtc.serverResolutionUpdateCoolDownCount","12000"),h.set("video.enableNextCaptureMode","1"),h.set("vqos.maxStreamFpsEstimate","240"),h.set("video.videoSplitEncodeStripsPerFrame","3"),h.set("video.updateSplitEncodeStateDynamically","1"))),(Q||42e3<=p.vc)&&(D?h.set("packetPacing.numGroups","3"):h.set("packetPacing.numGroups","5"),h.set("packetPacing.maxDelayUs","1000"),h.set("packetPacing.minNumPacketsFrame","10"),h.set("video.rtpNackQueueLength","1024"),h.set("video.rtpNackQueueMaxPackets","512"),h.set("video.rtpNackMaxPacketCount","25"),h.set("vqos.drc.qpMaxResThresholdAdj","4"),h.set("vqos.grc.qpMaxResThresholdAdj","4"),h.set("vqos.drc.iirFilterFactor","100"),h.set("vqos.qpg.enable","0"),h.set("vqos.resControl.qp.qpg.featureSetting","0"),Q&&(h.set("video.videoSplitEncodeStripsPerFrame","3"),h.set("video.updateSplitEncodeStateDynamically","1")),Z&&(h.set("video.encoderPreset","6"),h.set("vqos.drc.add1440pResLevelFor4kDrcTable","1"),h.set("vqos.drc.minAdaptiveQpThreshold","40"),h.set("vqos.grc.minAdaptiveQpThreshold","40"),h.set("vqos.drc.upperQpThreshold","40"),h.set("vqos.grc.upperQpThreshold","40"),h.set("vqos.drc.qpMaxResThresholdAdj","5"),h.set("vqos.grc.qpMaxResThresholdAdj","5"),h.set("vqos.drc.iirFilterFactor","100"),h.set("vqos.fec.repairMinPercent","0"),h.set("vqos.qpg.enable","0"),h.set("vqos.resControl.qp.qpg.featureSetting","0"))),N==="AV1"){var be=Q=z=D=void 0,Me=void 0,xe=void 0,Je=void 0,Be=void 0,tt=void 0,gt=void 0,mt=void 0,dt=void 0,nt=void 0,Ke=void 0,Tt=void 0,Oe=h;Oe.set("vqos.qpg.enable","0"),Oe.set("vqos.resControl.qp.qpg.featureSetting","0"),Oe.set("vqos.drc.minQpHeadroom","20"),Oe.set("vqos.drc.lowerQpThreshold","100"),Oe.set("vqos.drc.upperQpThreshold","200"),Oe.set("vqos.drc.minAdaptiveQpThreshold","180");let Xi=Number((Tt=Oe.get("vqos.drc.qpMaxResThresholdAdj"))!==null&&Tt!==void 0?Tt:"0");Oe.set("vqos.drc.qpMaxResThresholdAdj",(5*Xi).toString()),Oe.set("vqos.drc.qpCodecThresholdAdj","0"),Oe.set("vqos.dfc.minQpHeadroom",(Ke=Oe.get("vqos.drc.minQpHeadroom"))!==null&&Ke!==void 0?Ke:"0"),Oe.set("vqos.dfc.qpLowerLimit",(nt=Oe.get("vqos.drc.lowerQpThreshold"))!==null&&nt!==void 0?nt:"0"),Oe.set("vqos.dfc.qpMaxUpperLimit",(dt=Oe.get("vqos.drc.upperQpThreshold"))!==null&&dt!==void 0?dt:"0"),Oe.set("vqos.dfc.qpMinUpperLimit",(mt=Oe.get("vqos.drc.minAdaptiveQpThreshold"))!==null&&mt!==void 0?mt:"0"),Oe.set("vqos.dfc.qpMaxResThresholdAdj",(gt=Oe.get("vqos.drc.qpMaxResThresholdAdj"))!==null&&gt!==void 0?gt:"0"),Oe.set("vqos.dfc.qpCodecThresholdAdj",(tt=Oe.get("vqos.drc.qpCodecThresholdAdj"))!==null&&tt!==void 0?tt:"0"),Z&&(Oe.set("vqos.drc.minAdaptiveQpThreshold",(Be=Oe.get("vqos.drc.upperQpThreshold"))!==null&&Be!==void 0?Be:"0"),Oe.set("vqos.dfc.qpMinUpperLimit",(Je=Oe.get("vqos.dfc.qpMaxUpperLimit"))!==null&&Je!==void 0?Je:"0")),Oe.set("vqos.grc.minQpHeadroom",(xe=Oe.get("vqos.drc.minQpHeadroom"))!==null&&xe!==void 0?xe:"0"),Oe.set("vqos.grc.lowerQpThreshold",(Me=Oe.get("vqos.drc.lowerQpThreshold"))!==null&&Me!==void 0?Me:"0"),Oe.set("vqos.grc.upperQpThreshold",(be=Oe.get("vqos.drc.upperQpThreshold"))!==null&&be!==void 0?be:"0"),Oe.set("vqos.grc.minAdaptiveQpThreshold",(Q=Oe.get("vqos.drc.minAdaptiveQpThreshold"))!==null&&Q!==void 0?Q:"0"),Oe.set("vqos.grc.qpMaxResThresholdAdj",(z=Oe.get("vqos.drc.qpMaxResThresholdAdj"))!==null&&z!==void 0?z:"0"),Oe.set("vqos.grc.qpCodecThresholdAdj",(D=Oe.get("vqos.drc.qpCodecThresholdAdj"))!==null&&D!==void 0?D:"0"),ce&&Oe.set("video.videoSplitEncodeStripsPerFrame","23"),Oe.set("video.minQp","25")}if(h.set("video.clientViewportWd",p.Sb.toString()),h.set("video.clientViewportHt",p.Rb.toString()),h.set("video.maxFPS",p.ic.toString()),h.set("video.initialBitrateKbps",p.Ad.toString()),h.set("video.initialPeakBitrateKbps",p.ef.toString()),h.set("vqos.bw.maximumBitrateKbps",p.vc.toString()),h.set("vqos.bw.minimumBitrateKbps",p.bd.toString()),h.set("video.maxNumReferenceFrames","4"),h.set("video.mapRtpTimestampsToFrames",p.uc?"1":"0"),Y()&&(h.set("vqos.drc.stepDownMinHeight","480"),Ce(y,!1,14,5)||(ce=p.Sb/p.Rb*100,h.set("vqos.drc.stepDownResolutionAlignment","16"),h.set("vqos.drc.stepDownTargetAspectRatioX100",ce.toFixed(0)))),ce=h,D=p.dynamicStreamingMode,(E||D===2)&&(D!==1&&(ce.set("vqos.drc.enable","0"),ce.set("vqos.dfc.enable","1")),ce.set("vqos.dfc.decodeFpsAdjPercent","85"),ce.set("vqos.dfc.targetDownCooldownMs","250"),ce.set("vqos.dfc.dfcAlgoVersion","1"),ce.set("vqos.dfc.minTargetFps","60"),G&&ce.set("vqos.cpm.flags","1"),ce.set("vqos.resControl.dfc.useClientFpsPerf","0")),D!==void 0)switch(D){case 3:eo(ce,!0,E);break;case 2:eo(ce,!0,!0);break;case 1:eo(ce,!0,!1);break;case 0:eo(ce,!1,E)}y=le(y)?2:3,G=0,E=8,(N==="H265"||N==="AV1")&&(E=kd,ce=(l=E==null?void 0:E.features.hdr)!==null&&l!==void 0?l:!1,l=p.Uc===1,ce&&l?(y=4,G=p.Uc,E=Math.max(10,Math.min((E==null?void 0:E.features.bitDepth)||10,p.bitDepth))):E=Math.max(8,Math.min((E==null?void 0:E.features.sdrBitDepth)||8,p.bitDepth))),E===10&&N==="H265"&&h.set("video.minQp","14"),h.set("video.encoderCscMode",y.toString()),h.set("video.dynamicRangeMode",G.toString()),h.set("video.bitDepth",E.toString()),d++}u.mediaType==="application"&&(l=N=p=h=void 0,y=o,G=u,y.set("ri.partialReliableThresholdMs",(l=G.attributes.get("ri.partialReliableThresholdMs"))!==null&&l!==void 0?l:"0"),y.set("ri.hidDeviceMask",(N=G.attributes.get("ri.hidDeviceMask"))!==null&&N!==void 0?N:"0"),y.set("ri.enablePartiallyReliableTransferGamepad",(p=G.attributes.get("ri.enablePartiallyReliableTransferGamepad"))!==null&&p!==void 0?p:"0xff"),y.set("ri.enablePartiallyReliableTransferHid",(h=G.attributes.get("ri.enablePartiallyReliableTransferHid"))!==null&&h!==void 0?h:"0xffffffffffffffff")),ni.media.push({mediaType:u.mediaType,xc:u.xc,attributes:o})}s=ni;var ui,yi;u=(yi=(ui=Re.nvscClientConfigFields)===null||ui===void 0?void 0:ui.join(`
`))!==null&&yi!==void 0?yi:"",Od(u,s,t,"remoteconfig"),Od(i,s,t,"server"),i=Ct&&!Od(al,s,t,"client")?{error:3237093917}:y0(r,s)?{config:r,De:b0(s,t)}:{error:3237093918}}else i={error:3237093911};if(i.config&&i.De)return e.s=i.config,i.De;Fn(e,{code:(n=i.error)!==null&&n!==void 0?n:3237093910})}function Un(e){return!(!e.h||e.h.s==0)}function Xh(e){var t;(t=e.h)===null||t===void 0||t.s!=0&&(t.reset(),_d(t,!1))}function Zh(e){var t;(t=e.h)===null||t===void 0||t.s!=0||fh(t)}function ef(e){var t;if((t=e.h)===null||t===void 0)var i=void 0;else{e=t.m,t=t.ua();var n=0;if(J(e.u)?n=1:fe(e.u)?n=2:e.u.os==="Linux"&&(n=3),e.extraData.set("Platform",n),e.h.length===0||t===0)t=0;else{var r=n=0,s=0;for(const{frameNumber:o,cpuUsage:d}of e.h)n+=s*(o-r-1),n+=d,r=o,s=d;t>r&&(n+=s*(t-r)),t=n/t}t&&e.extraData.set("AvgTotalCPUUsage",t),e.extraData.set("DecodeType",e.g),e={saScores:e.saScores,extraData:e.extraData},c.i("{240ae89}","{d1eda5e}",e.saScores.overallScore,e.saScores.gpuPerfScore,e.saScores.serverPerfScore,e.saScores.visualScore,e.saScores.decoderScore,e.saScores.downlinkLagScore,e.saScores.downlinkCongestionScore,e.saScores.uplinkScore);for(i of e.extraData.entries())c.i("{240ae89}","{4d3c418}",i[0],i[1]);i=e}return i}var tf=class{constructor(e,t,i,n,r,s,o,d,u,l,h,p,y,N,G,E,D,z,Z,Q){var ce;this.O=h,this.signalingUrlQueryParameters=Q,this.name="",this.id=0,this.s={video:[],qd:0,Lb:{Kd:0,bf:0,Qe:0,Re:BigInt("0")}},this.ta=-1,this.I=this.Z=!1,this.G=this.P=this.o=0,this.ra=!1,this.F=this.za=0,this.pa=this.Ya=this.Za=!1,this.Ua=!0,this.stutterIndicator=this.perfIndicator=!1,this.va=0,this.$=[],this.v=[],this.L="",this.ga=0,this.Ba=new wt,this.Ab=this.wa=this.xa=this.ya=0,this.Cb=Date.now(),this.cb=this.Bb=this.kb=0,this.qa=!1,this.keyboardLayout="",this.videoStreamProgress=this.maxReceivedAckId=0,this.fa=[],this.sa="",this.S=this.Kc.bind(this),this.ha=this.Jc.bind(this),this.Xa=this.Ic.bind(this),this.Ea=this.Pa.bind(this),this.$a=0,this.da=new hh,this.ab=this.Hc.bind(this),this.oa=new Set,this.aa=new vm,this.u=u,this.H=t,this.Da=i,this.La=n,this.M=e,c.d("{93c7910}","{e1ca54d}",JSON.stringify(l)),l.finalizedStreamingFeatures||c.w("{93c7910}","{6f17ef5}"),this.session=l;let be;Pn?(be=Pn,c.d("{93c7910}","{55e5b30}",be)):p!=null&&p.maxBitrateKbps&&(be=p==null?void 0:p.maxBitrateKbps,c.d("{93c7910}","{965049f}",be)),z===void 0&&(p==null?void 0:p.drc)!==void 0&&(z=p.drc?3:0);for(const Be of l.streamInfo){be!=null?Q=be:(i=Xs(Be.width,Be.height,Be.fps)[0],c.d("{93c7910}","{aff4184}",i),Q=i),i=this.s.video,n=i.push,h=void 0;var Me=Q;Q=l.finalizedStreamingFeatures,Me=Math.max(4e3,Me);const tt=Math.max(4e3,Math.round(Me/4));Me={Sb:Be.width,Rb:Be.height,ic:Be.fps,dynamicStreamingMode:z,vc:Me,Ad:tt,ef:tt,uc:!0,bd:4e3,Uc:E0((h=Be.sdrHdrMode)!==null&&h!==void 0?h:0),bitDepth:sg(Q),nc:"UNKNOWN"},n.call(i,Me)}if(this.Gc=Pd(this.u,this.session.streamInfo[0]),rg(),this.l=d,d=l.appId,(z=Re.disableUnadjustedMovementForAppIds)&&z.indexOf(d)!==-1?(c.i("{d988e7f}","{265cfdc}",d),d=!1):d=ma,this.Nb={unadjustedMovement:d,...r},this.ja=e,this.Ob=s,this.C=o,this.T=y,this.textInputElement=N,this.appLaunchMode=l.appLaunchMode,this.clientAppVersion=G,this.isResume=E,this.Nd=D,Z){for(const Be of Z)if(Be.track instanceof MediaStreamTrack&&Be.track.kind==="video"){this.sendVideoTrack=Be.track;break}}if(this.sendVideoTrack=(ce=this.sendVideoTrack)!==null&&ce!==void 0?ce:p==null?void 0:p.sendVideoTrack,e=this.session.signalConnectionInfo.protocol,e=e.replace("http","ws"),this.N=e+"://"+this.session.signalConnectionInfo.ip+":"+this.session.signalConnectionInfo.port,(e=this.session.signalConnectionInfo.resourcePath)&&(this.N+=(e.charAt(0)==="/"?"":"/")+e,this.N.charAt(this.N.length-1)==="/"&&(this.N=this.N.slice(0,-1))),r=this.session.sessionId,s=this.l,o=this.Ba,l=this.O,e=Eh,0<e.h.length){for(var xe of e.h)vt(s,xe.name,xe.error);e.h=[]}if(0<e.j.length){for(var Je of e.j)bh(s,Je);e.j=[]}xe=e.s++,c.i("{1f5ec29}","{c194458}",xe,r),Je=new nm(xe,r,s,o,l,e.l),e.g.set(xe,Je),this.D=Je,this.O.g=performance.now(),this.ma=new lm(this,t,this.u,this.l),this.j=new hm(u),t=document.createElement("div"),t.style.position="absolute",t.style.zIndex="300",t.style.left="0",t.style.top="0",t.style.width="100%",t.style.display="none",t.style.fontSize="3em",t.style.color="white",t.style.backgroundColor="gray",t.style.textAlign="center",this.H.insertAdjacentElement("afterend",t),this.ea=t,this.ib={Eb:32768,Jb:256,Kb:255,Ga:this.na.bind(this)},this.jb={Eb:16384,Jb:512,Kb:65280,Ga:this.Db.bind(this)},this.Wa={Eb:16384,Jb:512,Kb:255,Ga:this.Fc.bind(this)},this.bb={Eb:8192,Jb:256,Kb:255,Ga:this.toggleOnScreenStats.bind(this)},this.Nc={Eb:4096,Jb:256,Kb:255,Ga:this.toggleStutterIndicator.bind(this)},this.Ka={od:0,Ee:0,Pc:0,fd:0,hd:0,gd:0,Qd:0,cd:0,Oc:0,dd:0},this.Ta=this.Pb.bind(this)}start(){Em(this),this.O.g=performance.now(),Uh(this),Ct&&(this.C.m.push(this.ib),this.C.m.push(this.jb),this.C.m.push(this.Wa),this.C.m.push(this.bb),this.C.m.push(this.Nc))}stop(e){var t,i,n,r;Qe(this.l,"StreamTimersAndReconnects",R(e),0,this.kb,this.Bb,this.cb);const s=o=>{c.i("{93c7910}","{a848987}",o),Qe(this.l,"PeerAPIDurationsAndMic",R(e),this.wa,this.ya,this.xa,o)};Id().then(o=>{s(o)}),Fn(this,{code:e,description:"Session stopped before stream connected"}),this.P&&(clearTimeout(this.P),this.P=0),this.ea.remove(),this.Z=!0;try{zd(this,{exitMessage:{code:Yv(e)}})}catch(o){c.e("{93c7910}","{d337883}",o)}Gh(this),this.J&&this.J.close(),(t=this.K)===null||t===void 0||t.close(),Bh(this),(i=this.g)===null||i===void 0||i.removeEventListener("icecandidate",this.ab),this.g&&this.g.close(),wm(this),this.G!==0&&(window.clearTimeout(this.G),this.G=0),this.F!==0&&(window.clearTimeout(this.F),this.F=0),yh(this.D),(n=this.R)===null||n===void 0||n.uninitialize(),this.D.stopWebSocket(),Uh(this),rm(this.D),this.sa&&this.Ua&&(c.e("{93c7910}","{283a180}"),vt(this.l,"Audio track muted")),0<this.za&&Qe(this.l,"WebSocketClose","",0,this.za,0,0),(r=this.T)===null||r===void 0||r.uninitialize(),this.ma.uninitialize(),li(this.j,0,this.S),li(this.j,1,this.S),li(this.j,2,this.S),li(this.j,4,this.ha),li(this.j,3,this.ha),li(this.j,5,this.Xa),li(this.j,6,this.Ea),this.j.uninitialize(),Gs(this.C,this.ib),Gs(this.C,this.jb),Gs(this.C,this.Wa),Gs(this.C,this.bb),this.H.srcObject=null,this.Da&&(this.Da.srcObject=null)}signInTimeout(){var e,t;this.F=0,c.i("{93c7910}","{6d6b337}"),gf(this.l,this.L,0,(t=(e=this.session)===null||e===void 0?void 0:e.signalConnectionInfo.ip)!==null&&t!==void 0?t:"","signInTimeout",this.ga,!1),Fn(this,{code:3237093907})}Mc(e){c.i("{8ba4138}","{0b0c6f9}",e)}Lc(e){this.l.Aa(void 0,e,"{8ba4138}.ts",0,0,!0),c.e("{8ba4138}","{0b0c6f9}",e)}setUpstreamMedia(){return Promise.resolve(!1)}unsetUpstreamMedia(){return Promise.resolve(!1)}stopUpstreamMedia(){return Promise.resolve(!1)}Hc(e){c.d("{93c7910}","{4742d5e}"),e.candidate&&this.$a++,!window.chrome&&this.g&&this.g.canTrickleIceCandidates&&this.g.onicecandidate&&Kh(this,e,!0)}Pb(){var e,t;(e=this.h)===null||e===void 0||J0(e),window.setTimeout(()=>{var i,n;if(this.Z||window.requestAnimationFrame(this.Ta),!((i=this.m)===null||i===void 0)){var r=i.j;r.I===0&&Lt(r.o),ur&&Rs&&i.m.fa()}(n=this.h)===null||n===void 0||na||(i=window.performance.now(),i>n.h.od+1e4?(n.h.od!==0&&c.i("{5cea617}","{5fa9066}",n.h.Pc,n.h.fd,n.h.hd,n.h.gd,n.D.totalVideoFrames-n.h.Ee,n.h.Qd,n.h.cd,n.h.Oc,n.h.dd),n.h.od=i,n.h.Ee=n.D.totalVideoFrames,n.h.Pc=1,n.h.fd=0,n.h.hd=0,n.h.gd=0,n.h.Qd=0,n.h.cd=0,n.h.Oc=0,n.h.dd=0):n.h.Pc+=1)}),(t=this.m)===null||t===void 0||Fg(t.j)}toggleOnScreenStats(e=!1,t){Ct&&(Un(this)?this.h.toggleOnScreenStats(e,t):Pi(this,"Stats is OFF. Please enable by ctrl+alt+F5/F6"))}na(){var e;if(!((e=this.h)===null||e===void 0)){var t=e.v;t.h&&t.g&&t.g.postMessage({qosMarker:kt(t.l),instanceId:t.instanceId}),e.g.R++,t=e.g,t.L.innerText=Yu(t,e.L===2)}Pi(this,"User marker added")}ua(){return this.h?this.h.ua():0}fb(){var e;let t=(e=this.h)===null||e===void 0?void 0:e.fb();return(t===void 0||t==="UNKNOWN")&&(t=this.s.video[0].nc),t}toggleUserInput(e,t){this.m?this.m.toggleUserInput(e,t):c.e("{93c7910}","{5a0e299}",e)}toggleRsdmm(e){var t;(t=this.m)===null||t===void 0||t.toggleRsdmm(e)}getVirtualGamepadHandler(){var e;return(e=this.m)===null||e===void 0?void 0:e.getVirtualGamepadHandler()}toggleStutterIndicator(e){this.stutterIndicator=e??!this.stutterIndicator,Wt(this,{stutterIndicator:{on:this.stutterIndicator}})}Db(){this.va^=1,Wt(this,{riDeviceOverlay:{bitmap:this.va}})}Fc(){var e;(e=this.m)===null||e===void 0||e.Cc()}sendTextInput(e){var t;(t=this.m)===null||t===void 0||t.sendTextInput(e)}setVirtualKeyboardState(e){var t;(t=this.m)===null||t===void 0||t.setVirtualKeyboardState(e)}setVideoTransforms(e,t,i){var n;if(!((n=this.m)===null||n===void 0)){const r=window.visualViewport;r&&(n.g.Ec=r.height),xn(n,e,t,i)}}sendCustomMessage(e){e={customMessage:JSON.stringify(e)},Wt(this,e)}setStreamingMaxBitrate(e,t,i){i||(Wt(this,{setMaxBitrate:{streamIndex:e,maxBitrate:t}}),c.d("{93c7910}","{6bbc1a2}",t))}setDrcDfcState(e,t,i){i||(Wt(this,{setDrcState:{streamIndex:e,state:!!(t&1)}}),Wt(this,{setDfcState:{streamIndex:e,state:!!(t&2)}}),c.d("{93c7910}","{0ed76f3}",t))}startInputPlayback(e){var t;(t=this.m)===null||t===void 0||t.startInputPlayback(e)}sendKeyEvent(e){var t;(t=this.m)===null||t===void 0||t.sendKeyEvent(e)}setKeyboardLayout(e){this.keyboardLayout=e,this.m?(this.sendCustomMessage({messageType:"kbLayout",messageRecipient:"KBLayoutChange",data:e}),this.m.setKeyboardLayout(e)):this.qa=!0}Kc(){Un(this)?qh(this,this.h.ua()):c.w("{93c7910}","{76bcede}")}Jc(){Un(this)?Jh(this,this.h.ua()):c.w("{93c7910}","{20ab5a1}")}Ic(){Un(this)?Qh(this,this.h.ua()):c.w("{93c7910}","{7b1f129}")}Pa(e){var t;Un(this)?(t=this.h)===null||t===void 0||t.m.extraData.set("Display",e):c.w("{93c7910}","{1b4b74e}")}};function Fm(e){var t,i;return!((i=(t=RTCRtpReceiver==null?void 0:RTCRtpReceiver.getCapabilities("video"))===null||t===void 0?void 0:t.codecs)===null||i===void 0)&&i.some(n=>{var r;return n.mimeType==="video/H265"&&((r=n.sdpFmtpLine)===null||r===void 0?void 0:r.includes("tier-flag=1"))})?(c.i("{93c7910}","{9da2c0f}"),e):(t=e.replace(RegExp("tier-flag=1","g"),"tier-flag=0"),t.localeCompare(e)&&c.i("{93c7910}","{c656b20}"),t)}function Um(e){let t=null;return e=e.getAudioTracks(),e.length&&(t=e[0]),t}function Yi(e){var t;return(t=e==null?void 0:e.readyState)!==null&&t!==void 0?t:"connecting"}function wr(e){return e.replace(/((ice-pwd|ufrag)(:|\s))((?!(\\|\s)).)*/g,"$1***")}function Qd(e){const t=RegExp('(candidate:[^"\\r\\n\\\\]+)(\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b)',"g");let i="";for(;i!==e;)i=e,e=e.replace(t,"$1***");return e}function jm(e){var t;return(t=Re.allowUpdateH265Tier)!==null&&t!==void 0?t:V(e)}function nf(e,t){e.h=!1,e.j=!1,e.g=t,e.g.onversionchange=()=>{c.w("{10dc2cc}","{65276d8}"),e.close(),e.g=void 0},e.g.onclose=()=>{c.w("{10dc2cc}","{342f7f8}"),e.h=!0,e.j=!0}}function co(e){if(e.l){if(!e.g)return pe(1,"Db not yet open");if(e.h)return pe(2,"Db is closing, unexpectedly: "+e.j+", visibility state hidden: "+(document.visibilityState==="hidden"))}else return pe(17,"Indexdb object not found")}function rf(e,t){const i=co(e);return i?Promise.reject(i):new Promise((n,r)=>{try{const s=e.g.transaction(t,"readwrite"),o=s.objectStore(t);s.oncomplete=()=>{c.i("{10dc2cc}","{30f23d1}")};const d=o.clear();d.onsuccess=()=>{n()},d.onerror=()=>{r(pe(80,"clear method failed)",s.error))}}catch(s){r(pe(81,"Unexpected Exception happened in clear",s))}})}function Yd(e,t){const i=co(e);return i?Promise.reject(i):new Promise((n,r)=>{try{const s=e.g.transaction(t,"readonly"),o=s.objectStore(t);s.oncomplete=()=>{c.i("{10dc2cc}","{59d1f78}")};const d=o.getAll();d.onsuccess=()=>{n(d.result)},d.onerror=()=>{r(pe(96,"getAll method failed",s.error))}}catch(s){r(pe(97,"Unexpected Exception in getAll",s))}})}var Gm=class{constructor(){this.l=window.indexedDB,this.version=2,this.j=this.h=!1,this.name="ragnarok",this.m=[{Vf:"exit-events",kd:{keyPath:["userId","sessionId","name"]},Uf:"exit-event-index"},{Vf:"telemetry-events",kd:{keyPath:["userId","sessionId","name","eventPayload.ts"]},Uf:"telemetry-event-index"}]}open(){return new Promise((e,t)=>{try{if(this.l){let i=this.l.open(this.name,this.version);i.onerror=()=>{t(pe(18,`${this.name} db opening failed`,i.error))},i.onsuccess=()=>{nf(this,i.result),e()},i.onupgradeneeded=n=>{c.i("{10dc2cc}","{1f70767}",n.oldVersion,n.newVersion),nf(this,i.result);const r=s=>{var o;const d=(o=this.g)===null||o===void 0?void 0:o.createObjectStore(s.Vf,s.kd);s.kd.keyPath&&(d==null||d.createIndex(s.Uf,s.kd.keyPath,{unique:!0}))};switch(n.oldVersion){case 0:r(this.m[0]);case 1:r(this.m[1])}},i.onblocked=()=>{t(pe(19,`${this.name} db blocked during opening`,i.error))}}else t(pe(17,"Indexdb object not found"))}catch(i){t(pe(20,"Unexpected Exception in open",i))}})}get(e,t){const i=co(this);return i?Promise.reject(i):new Promise((n,r)=>{try{const s=this.g.transaction(e,"readonly"),o=s.objectStore(e);s.oncomplete=()=>{c.i("{10dc2cc}","{82638ba}")};const d=o.get(t);d.onsuccess=()=>{n(d.result)},d.onerror=()=>{r(pe(32,"get method failed",s.error))}}catch(s){r(pe(33,"Unexpected Exception happened in get",s))}})}set(e,t){const i=co(this);return i?Promise.reject(i):new Promise((n,r)=>{try{const s=this.g.transaction(e,"readwrite"),o=s.objectStore(e);s.oncomplete=()=>{c.i("{10dc2cc}","{f993875}")};const d=o.put(t);d.onsuccess=()=>{n()},d.onerror=()=>{r(pe(48,"put method failed",s.error))}}catch(s){r(pe(49,"Unexpected Exception happened in set",s))}})}close(){var e;this.h=!0,(e=this.g)===null||e===void 0||e.close()}};function lo(e,t){const i=e.j.get(t);if(i){e.h=i;for(const n of e.g)n(e.getCurrentNetworkType())}else c.d("{aac1655}","{1e3c13d}",t)}class Bm{constructor(){var t;this.j=new Map([["Ethernet","ETHERNET"],["5GHz_WiFi","WIFI_5_0"],["2.4GHz_WiFi","WIFI_2_4"],["Others","OTHER"],["disconnected","UNKNOWN"],["wifi","WIFI"],["ethernet","ETHERNET"],["none","UNKNOWN"],["bluetooth","BLUETOOTH"],["wimax","WIMAX"],["other","OTHER"],["mobile","MOBILE"],["unknown","UNKNOWN"],["NONE","UNKNOWN"],["UNKNOWN","UNKNOWN"],["ETHERNET","ETHERNET"],["WIFI","WIFI"],["NET_PROXY","OTHER"],["2G","MOBILE_2G"],["2.5G","MOBILE_2G"],["3G","MOBILE_3G"],["4G","MOBILE_4G"]]),this.h="UNKNOWN",this.g=[],window.addEventListener("GFNNetworkInfo",n=>{c.d("{aac1655}","{2925c9d}",n.detail.state),lo(this,n.detail.state)});const i=navigator.connection;if(i!=null&&i.type&&(lo(this,i.type),i.addEventListener("change",()=>{var n;const r=(n=navigator.connection)===null||n===void 0?void 0:n.type;r&&(c.d("{aac1655}","{4a9e05b}",r),lo(this,r))})),!((t=window.tizen)===null||t===void 0)&&t.systeminfo){t=n=>{(n=n.networkType)&&(c.d("{aac1655}","{e9b5f27}",n),lo(this,n))};try{window.tizen.systeminfo.getPropertyValue("NETWORK",t),window.tizen.systeminfo.addPropertyValueChangeListener("NETWORK",t)}catch(n){c.w("{aac1655}","{7d035ae}",n)}}}registerCallback(t){this.g.push(t)}unregisterCallback(t){const i=this.g.findIndex(n=>n==t);i!==-1&&this.g.splice(i,1)}getCurrentNetworkType(){return this.h}}var Oi=new Bm;function jn(e,t,i,n){var r,s,o,d;c.e("{f7c1592}","{146ec91}",i,R(t.code),t.description),n&&(n=(o=(s=(r=t.error)===null||r===void 0?void 0:r.message)!==null&&s!==void 0?s:t.description)!==null&&o!==void 0?o:`Exception in ${i}`,e.G?e.G(t.error,n,"telemetryeventprocessor.ts",t.code,0,!0,(d=t.error)===null||d===void 0?void 0:d.name):c.w("{f7c1592}","{12e0846}"))}function Vm(e){var t,i,n,r;!((t=e.config)===null||t===void 0)&&t.server&&(!((i=e.config)===null||i===void 0)&&i.version)&&(t={method:"POST",headers:{"Content-Type":"application/json","X-Event-Protocol":(r=(n=e.commonData)===null||n===void 0?void 0:n.eventProtocol)!==null&&r!==void 0?r:"1.5"},body:JSON.stringify(e.commonData),retryCount:3,timeout:2e3},c.i("{f7c1592}","{056661f}",t.body),te(ec(e.config),t).then(()=>{}).catch(()=>{}))}function Xd(e,t){let i={};if(!e.g.commonData)return i;const n={name:t.name,ts:t.ts,parameters:t.parameters};return sf(i,e.g),e=i.commonData,e.clientId=t.clientConfig.clientId,e.eventSchemaVer=t.clientConfig.eventSchemaVer,e.sentTs=new Date().toISOString(),e.events=[n],i}function Hm(e,t){!e.j&&uf(t)&&e.m.then(()=>e.l.set("telemetry-events",t)).then(()=>{c.i("{f7c1592}","{f03d70b}")}).catch(i=>{const n=!e.D;e.D=!0,jn(e,i,"cacheTelemetryEventInDb",n)})}function Zd(e,t){if(e.g.commonData){var i=t.gdprLevel;let n=!1;e.g.commonData&&(i!=="functional"||e.g.commonData.deviceGdprFuncOptIn!=="Full"&&e.g.commonData.deviceGdprFuncOptIn!=="Temp"?(i==="technical"&&e.g.commonData.gdprTechOptIn==="Full"||i==="behavioral"&&e.g.commonData.gdprBehOptIn==="Full")&&(n=!0):n=!0),n&&(window.navigator.onLine?Vm(Xd(e,t)):Hm(e,{userId:e.g.commonData.userId,sessionId:e.g.commonData.sessionId,name:t.name,eventPayload:t}))}else e.C.push(t)}function sf(e,t){e.commonData=t.commonData?Object.assign({},t.commonData):void 0,e.experiments=[],e.config=t.config,e.telemetryEventIds=t.telemetryEventIds}function ec(e){return e.server+"/"+e.version+"/events/json"}function of(e,t){var i,n,r;e.h.userId=(n=(i=e.g.commonData)===null||i===void 0?void 0:i.userId)!==null&&n!==void 0?n:"",e.h.sessionId=(r=t.parameters.sessionId)!==null&&r!==void 0?r:"",e.h.name=t.name,e.h.eventPayload=t}function af(e){var t,i;!((t=e.config)===null||t===void 0)&&t.server&&(!((i=e.config)===null||i===void 0)&&i.version)&&e.experiments&&(e.commonData&&(e.commonData.sentTs=new Date().toISOString()),t=JSON.stringify(e.commonData),e=navigator.sendBeacon(ec(e.config),new Blob([t],{type:"text/plain"})),c.i("{f7c1592}","{b9367c5}",e,t))}function Wm(e){e.j||e.m.then(()=>rf(e.l,"exit-events")).then(()=>{c.i("{f7c1592}","{1b8f127}")}).catch(t=>{jn(e,t,"clearExitEventStoreInDb",!e.s),e.s||(e.s=!0)})}function tc(e){c.d("{f7c1592}","{badefed}",!0),Wm(e),e.h.eventPayload=void 0}function df(e,t){var i;const n=new oe({zoneAddress:t.zoneAddress,networkSessionId:(i=t.networkTestSessionId)!==null&&i!==void 0?i:"",sessionId:t.sessionId,subSessionId:t.subSessionId,resumeType:Ls(t.isResume),overrideConfigType:Vt.type,overrideConfigVersion:Vt.version,exitReason:pf(t.connectivityInfo,t.sleep),result:t.exitErrorCode,frameCount:t.frameCount,codec:Ms(t.codec),ipVersion:"UNKNOWN",streamDuration:Math.round(t.streamDuration),networkType:Ue(Oi.getCurrentNetworkType()),streamingProfileGuid:cf(e),systemInfoGuid:lf(e),cmsId:String(e.F)});return{name:n.name,gdprLevel:n.gdprLevel,parameters:n.parameters,ts:n.ts,clientConfig:de}}function cf(e){var t,i,n;return(n=(i=(t=e.g)===null||t===void 0?void 0:t.telemetryEventIds)===null||i===void 0?void 0:i.streamingProfileGuid)!==null&&n!==void 0?n:""}function lf(e){var t,i,n;return(n=(i=(t=e.g)===null||t===void 0?void 0:t.telemetryEventIds)===null||i===void 0?void 0:i.systemInfoGuid)!==null&&n!==void 0?n:""}function uf(e){return!!e.userId&&!!e.sessionId&&!!e.name}function hf(e){return e.j||!uf(e.h)?Promise.resolve():e.m.then(()=>e.l.set("exit-events",e.h)).then(()=>{c.i("{f7c1592}","{5d026f8}")}).catch(t=>{jn(e,t,"cacheExitEventInDb",!e.o),e.o||(e.o=!0)})}function zm(e){return e.j?Promise.resolve([]):e.m.then(()=>Yd(e.l,"exit-events")).then(t=>{c.i("{f7c1592}","{d938300}",t.length);let i=[];if(0<t.length)for(const n of t)n.eventPayload&&i.push(n.eventPayload);return i}).catch(t=>(jn(e,t,"getCachedExitEvents",!0),Promise.reject()))}function Km(e){return e.j?Promise.resolve():e.m.then(()=>Yd(e.l,"exit-events")).then(t=>{if(c.i("{f7c1592}","{ca568ff}",t.length),0<t.length){for(const i of t)i.eventPayload&&af(Xd(e,i.eventPayload));tc(e)}}).catch(t=>{jn(e,t,"sendCachedExitEvent",!0)})}function $m(e){e.j||e.m.then(()=>rf(e.l,"telemetry-events")).then(()=>{c.i("{f7c1592}","{8f62936}")}).catch(t=>{jn(e,t,"clearEventStoreInDb",!e.v),e.v||(e.v=!0)})}function ff(e){e.j||window.navigator.onLine&&e.m.then(()=>Yd(e.l,"telemetry-events")).then(t=>{if(c.i("{f7c1592}","{d4e574c}",t.length),0<t.length){$m(e);for(const i of t)i.eventPayload&&Zd(e,i.eventPayload)}}).catch(t=>{c.e("{f7c1592}","{aaaa3de}",t.code,t.description)})}var qm=class{constructor(){this.h={userId:"",sessionId:"",eventPayload:void 0,name:""},this.g={},this.v=this.D=this.s=this.o=!1,this.F="",this.C=[],this.j=!1,this.l=new Gm,this.m=this.l.open().catch(e=>{this.j=!0,jn(this,e,"TelemetryEventProcessorConstruction",!0)})}updateEventDataElements(e){var t;if(sf(this.g,e),this.g.commonData){c.d("{f7c1592}","{66f209c}");for(let i of this.C)Zd(this,i);this.C=[]}this.h.userId=(t=this.g.commonData)===null||t===void 0?void 0:t.userId}};function pf(e,t){var i;return t?"SleepExit":(i=e==null?void 0:e.description)!==null&&i!==void 0?i:"undefined"}function vt(e,t,i,n,r,s){t=new Yn({key1:t??"",key2:i??"",key3:n??"",key4:r??"",key5:s??"",moduleName:"RAGNAROK",networkType:Ue(Oi.getCurrentNetworkType()),overrideConfigType:Vt.type,overrideConfigVersion:Vt.version,cmsId:e.h(),sessionId:e.sessionId,subSessionId:e.subSessionId}),e.processEvent(t)}function vf(e,t,i,n,r,s,o,d,u){50<=e.D||(e.D++,t=new me({deviceName:t,deviceType:"GAMEPAD",vendorId:i,productId:n,deviceIndex:r,reportIndex:o?0:r,hapticsSupported:za(s),hapticsFeedbackCount:0,state:d,eventMapReceived:u,eventMapProcessed:u,sessionId:e.sessionId,subSessionId:e.subSessionId,cmsId:e.h()}),e.processEvent(t))}function Qe(e,t,i,n,r,s,o){t=new Xn({metricName:t,moduleName:"RAGNAROK",valueInt1:r,valueInt2:s,valueInt3:o,valueString:i,valueDouble:n,networkType:Ue(Oi.getCurrentNetworkType()),cmsId:e.h(),sessionId:e.sessionId,subSessionId:e.subSessionId}),e.processEvent(t)}function gf(e,t,i,n,r,s,o){t=new Cn({retryCount:s,sessionId:e.sessionId,subSessionId:e.subSessionId,serverId:n,url:t,overrideConfigType:Vt.type,overrideConfigVersion:Vt.version,disconnectionReason:r,cleanDisconnection:za(o),networkType:Ue(Oi.getCurrentNetworkType()),statusCode:i?i.toString():"",cmsId:e.h(),moduleName:"RAGNAROK"}),e.processEvent(t)}function Jm(e,t,i,n,r,s){e.subSessionId=t,e.sessionId=i,e.cmsId=n,e.isResume=r,e.zoneAddress=s}function Qm(e,t,i,n){var r,s,o;const d=W.getTelemetryEventIds(),u=new ne({zoneAddress:e.zoneAddress,networkSessionId:(r=d.networkSessionId)!==null&&r!==void 0?r:"",sessionId:e.sessionId,subSessionId:e.subSessionId,resumeType:Ls(e.isResume),overrideConfigType:Vt.type,overrideConfigVersion:Vt.version,result:i,codec:Ms(n),ipVersion:"UNKNOWN",launchDuration:Math.round(t),networkType:Ue(Oi.getCurrentNetworkType()),streamingProfileGuid:(s=d.streamingProfileGuid)!==null&&s!==void 0?s:"",systemInfoGuid:(o=d.systemInfoGuid)!==null&&o!==void 0?o:"",cmsId:e.cmsId});e.processEvent(u)}function mf(e,t,i,n,r,s){var o,d,u;const l=W.getTelemetryEventIds();t=new oe({zoneAddress:e.zoneAddress,sessionId:e.sessionId,subSessionId:e.subSessionId,resumeType:Ls(e.isResume),cmsId:e.cmsId,overrideConfigType:Vt.type,overrideConfigVersion:Vt.version,exitReason:i,result:t,frameCount:s,codec:Ms(r),ipVersion:"UNKNOWN",streamDuration:Math.round(n),networkType:Ue(Oi.getCurrentNetworkType()),streamingProfileGuid:(o=l.streamingProfileGuid)!==null&&o!==void 0?o:"",systemInfoGuid:(d=l.systemInfoGuid)!==null&&d!==void 0?d:"",networkSessionId:(u=l.networkSessionId)!==null&&u!==void 0?u:""}),e.m=e.j.cacheEvent(t,e.m)}function Af(e){e.j.processCachedEvent(e.m),e.m=0}function Ym(e,t){if(!e.l){Af(e);const i=()=>{const n=R(t.ig());mf(e,n,n,t.jg(),t.fb(),t.ua())};i(),e.l=window.setInterval(i,12e4)}}function Xm(e){e.l&&(window.clearInterval(e.l),e.l=0)}var Sf=class{constructor(){this.cmsId=this.subSessionId=this.sessionId="",this.isResume=!1,this.zoneAddress="",this.D=0,this.s=new Map,this.l=this.m=this.v=0,this.j=W.createTelemetryProvider(de)}Aa(e,t,i,n,r,s,o){var d;if(50<=this.v)var u=!1;else{var l=(u=this.s.get(t))!==null&&u!==void 0?u:0;10<=l?u=!1:(this.v++,this.s.set(t,l+1),u=!0)}u&&(e instanceof DOMException&&(e={name:e.name,message:e.message}),e=new wn({filename:i,lineno:n,stacktrace:(d=e==null?void 0:e.stack)!==null&&d!==void 0?d:"",colno:r,handled:za(s),category:o??"",message:t,moduleName:"RAGNAROK",sessionId:this.sessionId,subSessionId:this.subSessionId}),this.processEvent(e))}processEvent(e){this.j.processEvent(e)}h(){return this.cmsId}};function Zm(e,t){e.g.F=t}function eA(e,t,i,n,r,s,o,d,u,l){var h,p;const y=e.getTelemetryEventIds();t=new ne({zoneAddress:r,networkSessionId:l,sessionId:t,subSessionId:i,resumeType:Ls(n),overrideConfigType:Vt.type,overrideConfigVersion:Vt.version,result:o,codec:Ms(d),ipVersion:"UNKNOWN",launchDuration:Math.round(s),networkType:Ue(Oi.getCurrentNetworkType()),streamingProfileGuid:(h=y.streamingProfileGuid)!==null&&h!==void 0?h:"",systemInfoGuid:(p=y.systemInfoGuid)!==null&&p!==void 0?p:"",cmsId:u}),e.o({name:t.name,gdprLevel:t.gdprLevel,parameters:t.parameters,ts:t.ts,clientConfig:de})}function tA(e){return e.clientShutDownCallback?(c.d("{9838627}","{c7dcc4e}"),zm(e.g).then(t=>{for(const i of t)e.C(i);tc(e.g)}).catch(()=>{c.d("{9838627}","{41cf828}")})):(c.d("{9838627}","{77df598}"),Km(e.g))}function yf(e,t,i){let n=!1;e.clientShutDownCallback&&(n=e.clientShutDownCallback(t),c.d("{9838627}","{caf81d9}",n)),n||(c.d("{9838627}","{e939db1}"),i(t))}function bf(e,t,i){e.F.hasListener("TelemetryEvent")?e.F.emit("TelemetryEvent",t):i(t)}var Ef=class extends Sf{constructor(e,t){super(),this.F=e,this.g=t,this.g.G=this.Aa.bind(this)}processEvent(e){this.o({name:e.name,gdprLevel:e.gdprLevel,parameters:e.parameters,ts:e.ts,clientConfig:de})}h(){return this.g.F}},iA=class extends Ef{o(e){bf(this,e,()=>{Zd(this.g,e)})}C(e){yf(this,e,()=>{var t=this.g,i;c.d("{f7c1592}","{01dcfe5}",(i=e.parameters)===null||i===void 0?void 0:i.sessionId),of(t,e),af(Xd(t,t.h.eventPayload))})}getTelemetryEventIds(){return{streamingProfileGuid:cf(this.g),systemInfoGuid:lf(this.g)}}};function wf(e,t,i){i={name:t.name,gdprLevel:t.gdprLevel,priority:i,ts:t.ts,parameters:t.parameters},t=t.clientConfig,t.clientId===de.clientId?e=e.j:(e.G||(e.G=W.createTelemetryProvider(t)),e=e.G),e.processEvent(i)}class nA extends Ef{constructor(t,i){super(t,i),this.j=W.createTelemetryProvider(de)}o(t){bf(this,t,()=>{wf(this,t,!1)})}C(t){yf(this,t,()=>{wf(this,t,!0)})}getTelemetryEventIds(){return W.getTelemetryEventIds()}}function rA(e,t,i){return e?new nA(t,i):new iA(t,i)}function Cf(e){let t=document.createElement("div");return t.id=e.yd,t.className="genericdiv",t.style.display="grid",t.style.gridTemplateColumns="1fr 1fr",t.style.gridTemplateRows="1fr 1fr",e.visible=!0,e=document.createElement("p"),e.id="instruction",e.style.color="white",e.style.position="fixed",e.innerHTML="Connect GamePads",e.style.top="0",t.appendChild(e),t}var If=class{constructor(){this.yd="gamepadTester",this.visible=!1,this.wb=[],this.Rd=[],this.ac=new Map,Gr&&(document.body.appendChild(Cf(this)),this.start())}vb(e){for(let t=0;4>t;t++){const i=this.ac.get(t);i!==void 0&&!(e&1<<t)&&(this.wb[i]=null,this.ac.delete(t))}}Jf(e){for(let t=0;t<this.wb.length;t++){let i=this.wb[t];i&&i.ec&&i.ia==e&&(this.wb[t]=null)}}Wc(e,t,i,n,r,s,o,d){this.ac.set(t,e),this.wb[e]={index:e,ia:t,buttons:i,trigger:n,axes:r,name:d,ec:!1}}Tc(e,t,i,n,r,s,o,d){this.wb[e]={index:e,ia:t,buttons:i,trigger:n,axes:r,name:d,ec:!0}}Rc(e){4>e.index&&(this.Rd[e.index]={index:e.index,ia:e.index,buttons:-1,trigger:-1,axes:[-1],name:e.id,ec:!1})}Cc(e){let t=document.getElementById(this.yd);t?(t.remove(),this.wb=[],this.visible=!1):(e.insertAdjacentElement("afterend",Cf(this)),this.start())}start(){let e,t=document.getElementById(this.yd);if(t==null)c.e("{e13a879}","{0c955af}");else{var i=.49*window.innerWidth,n=.4*window.innerHeight,r=.3*i,s=.7*i,o=.8*n,d=.8*n,u=.07*i,l=E=>E?{left:{X:E.axes[0],Y:E.axes[1]},right:{X:E.axes[2],Y:E.axes[3]}}:null,h=E=>{E.style.position="absolute",E.style.width="2%",E.style.height="3.5%",E.style.backgroundColor="red",E.style.borderRadius="50%",E.style.transform="translate(-50%, -50%)"},p=E=>{let D=l(E);if(t.querySelector(`.gamepad${E.index}`).querySelector(".leftStick")===null){var z=document.createElement("div");z.className="gamepadJoystickPointer leftStick",h(z),z.style.left=`${r+D.left.X*u}px`,z.style.top=`${o+D.left.Y*u}px`,t.querySelector(`.gamepad${E.index}`).querySelector(".gamepadContainer").appendChild(z)}else z=t.querySelector(`.gamepad${E.index}`).querySelector(".leftStick"),z.style.opacity="1",z.style.left=`${r+u*D.left.X}px`,z.style.top=`${o+D.left.Y*u}px`;t.querySelector(`.gamepad${E.index}`).querySelector(".rightStick")===null?(z=document.createElement("div"),z.className="gamepadJoystickPointer rightStick",h(z),z.style.left=`${s+D.right.X*u}px`,z.style.top=`${d+D.right.Y*u}px`,t.querySelector(`.gamepad${E.index}`).querySelector(".gamepadContainer").appendChild(z)):(E=t.querySelector(`.gamepad${E.index}`).querySelector(".rightStick"),E.style.opacity="1",E.style.left=(s+D.right.X*u).toString()+"px",E.style.top=(d+D.right.Y*u).toString()+"px")},y=(E,D,z,Z)=>{var Q=E.getContext("2d");if(Q){Q.beginPath();var ce=z===!0?1:z===!1?0:z;switch(Q.fillStyle=z?Z?"#006FCD":"#0e7a0d":"grey",z=be=>{if(Q){var Me=.12*ce;Q.rect(E.width*be,E.height*(.07+(.12-Me)),.02*E.width,E.height*Me),Q.closePath(),Q.fill(),Q.beginPath(),Q.fillStyle="grey",Q.rect(E.width*be,.07*E.height,.02*E.width,E.height*(.12-Me))}},D){case 0:Q.moveTo(.14*E.width,.48*E.height),Q.lineTo(.19*E.width,.48*E.height),Q.lineTo(.165*E.width,.54*E.height),Q.lineTo(.14*E.width,.48*E.height);break;case 1:Q.moveTo(.14*E.width,.66*E.height),Q.lineTo(.19*E.width,.66*E.height),Q.lineTo(.165*E.width,.61*E.height),Q.lineTo(.14*E.width,.66*E.height);break;case 2:Q.moveTo(.09*E.width,.55*E.height),Q.lineTo(.09*E.width,.61*E.height),Q.lineTo(.135*E.width,.57*E.height),Q.lineTo(.09*E.width,.55*E.height);break;case 3:Q.moveTo(.24*E.width,.55*E.height),Q.lineTo(.24*E.width,.61*E.height),Q.lineTo(.195*E.width,.57*E.height),Q.lineTo(.24*E.width,.55*E.height);break;case 4:Q.arc(.7*E.width,.4*E.height,.02*E.width,0,2*Math.PI);break;case 5:Q.arc(.3*E.width,.4*E.height,.02*E.width,0,2*Math.PI);break;case 6:Q.arc(.3*E.width,.8*E.height,.07*E.width,0,2*Math.PI);break;case 7:Q.arc(.7*E.width,.8*E.height,.07*E.width,0,2*Math.PI);break;case 8:Q.rect(.13*E.width,.23*E.height,.07*E.width,.05*E.height);break;case 9:Q.rect(.815*E.width,.23*E.height,.07*E.width,.05*E.height);break;case 12:Q.arc(.85*E.width,.65*E.height,.02*E.width,0,2*Math.PI);break;case 13:Q.arc(.9*E.width,.55*E.height,.02*E.width,0,2*Math.PI);break;case 14:Q.arc(.8*E.width,.55*E.height,.02*E.width,0,2*Math.PI);break;case 15:Q.arc(.85*E.width,.45*E.height,.02*E.width,0,2*Math.PI);break;case-1:z(.155);break;case-2:z(.84);break;case 16:if(!Z)break;Q.arc(.5*E.width,.5*E.height,.02*E.width,0,2*Math.PI);break;case 17:Z&&(Q.roundRect?Q.roundRect(.395*E.width,.085*E.height,.21*E.width,.18*E.height,.02*E.width):Q.arc(.5*E.width,.175*E.height,.02*E.width,0,2*Math.PI))}Q.closePath(),Q.fill()}},N=E=>{if(t.querySelector(`.gamepad${E.index}`)===null){var D=document.createElement("div");D.className=`gamepad gamepad${E.index}`,D.style.display="flex",D.style.flexDirection="column",D.style.justifyContent="space-between",D.style.height="98%";var z=document.createElement("p");z.className="active",z.style.margin="0px";var Z=document.createElement("span");Z.className="gamepadPlayerNumber",Z.style.color="white",Z.style.background=E.ec?"#006FCD":"#0e7a0d",Z.style.position="relative",Z.style.marginRight="0.5vw",Z.innerHTML=E.ec?"S":"X",Z.style.fontSize="1.5vw",z.appendChild(Z),Z=document.createElement("span"),Z.className="gamepadPlayerNumber",Z.style.color="white",Z.style.position="relative",Z.innerHTML=`P${E.index+1}|${E.name}`,Z.style.fontSize="1.5vw",z.appendChild(Z),D.appendChild(z),E=document.createElement("div"),E.className="gamepadContainer",E.style.position="relative",E.style.width=`${i+2}px`,E.style.height=`${n}px`,z=document.createElement("canvas"),z.className="canvas",z.width=i,z.height=n,z.style.width=`${i}px`,z.style.height=`${n}px`,z.style.border="1px solid white",E.appendChild(z),D.appendChild(E),t.appendChild(D),(D=t.querySelector("#instruction"))&&(D.style.display="none")}},G=()=>{if(this.visible){for(let z=0;z<this.wb.length;z++){var E=this.wb[z];if(E){var D=E.ec;t.querySelector(`.gamepad${E.index}`)||N(E),p(E);let Z=t.querySelector(`.gamepad${E.index}`).querySelector("canvas"),Q=D?2:0;for(let ce=0;16>ce;ce++)y(Z,ce,(E.buttons&1<<ce)!=0,D);1<=Q&&y(Z,16,E.buttons&65536,D),2<=Q&&y(Z,17,E.buttons&131072,D),y(Z,-1,(E.trigger&255)/255,D),y(Z,-2,(E.trigger>>8&255)/255,D)}else this.Rd[z]?!t.querySelector(`.gamepad${z}`)&&(N(this.Rd[z]),E=t.querySelector(`.gamepad${z}`).querySelector("canvas"),D=E.getContext("2d"))&&(D.font="20px Arial",D.fillStyle="white",D.textAlign="center",D.fillText("Unsupported Gamepad",E.width/2,E.height/2)):((E=t.querySelector(`.gamepad${z}`))&&t.removeChild(E),1>=t.childNodes.length&&(E=t.querySelector("#instruction"))&&(E.style.display="block"))}e=window.requestAnimationFrame(G)}else window.cancelAnimationFrame(e)};G()}}$b(){}Vc(){}};function Tf(e){if(c.i("{4c846ba}","{b11cb24}"),e.l){try{e.h=new MediaRecorder(e.l)}catch(t){c.e("{4c846ba}","{0d1420e}",t);return}e.h&&(e.h.onstart=()=>{},e.h.onstop=()=>{c.i("{4c846ba}","{7a944b4}")},e.h.ondataavailable=t=>{t.data&&0<t.data.size&&(e.s.push(t.data),e.v.push(e.s),++e.m,e.s=[])},c.i("{4c846ba}","{ffb713f}",e.h)),e.o=!1}else c.e("{4c846ba}","{74475ae}")}function ic(e){var t;(t=e.h)===null||t===void 0||t.stop(),e.h=void 0,e.j!==0&&(window.clearTimeout(e.j),e.j=0)}function Rf(e){let t;if(e.g==1)t=18e5;else if(e.g==2)t=3e3;else return;e.h&&!e.o&&(e.h.start(),e.o=!0,e.j=window.setTimeout(()=>{c.i("{4c846ba}","{2282d21}"),ic(e)},t),c.i("{4c846ba}","{4f438e3}"))}var kf=class{constructor(){this.o=!1,this.s=[],this.v=[],this.g=this.m=this.j=0}initialize(e){this.l=e}uninitialize(){ic(this),this.downloadAudio(),this.l=void 0,this.g=0}downloadAudio(){if(this.g!=0){for(let e=0;e<this.m;++e)Jr(this.v[e],"audioCapture_"+e+".wmv","audio/webm")&&c.i("{4c846ba}","{c24ed3b}");this.m=0,this.v=[]}}};function nc(e,t){return e.h=t,e.h===15868704||e.h===15859712?(oi(e.g,!1),!1):(oi(e.g,!0),rr(e.g),e.j)}var Pf=class{constructor(e){this.subSessionId=this.sessionId="",this.h=0,this.j=!1,this.l=e,this.g=new Tn(this,1e4,1e4)}Qf(e){(this.h===15867909||this.h===15867908)&&(e.Ja="other");var t=this.l,i=R(this.h);e=new Zn({eventSequence:e.Ja,sleepTime:Math.round(e.duration/1e3),error:i,timeToSleep:Math.round((e.Se-e.Rf)/1e3),moduleName:"RAGNAROK",cmsId:t.h(),sessionId:this.sessionId,subSessionId:this.subSessionId}),t.processEvent(e),oi(this.g,!1),this.j=!0}reset(e,t){this.sessionId=e,this.subSessionId=t,this.h=0,this.j=!1}};function kt(e){return performance.now()-e.g}var sA=class{constructor(){this.g=0}};function xt(e,t){var i;return((i=Re.usePerfNowCaptureTimestamp)!==null&&i!==void 0?i:!window.chrome)?kt(e):t-e.g}var Of=class extends sA{};performance.mark("GfnRBegin");function oA(e){var t,i,n;if(Re.sendNonEssentialMetricEvents){var r=performance.getEntriesByName("GfnJsInitStart")[0];const s=performance.getEntriesByName("platformBegin")[0],o=performance.getEntriesByName("GfnRBegin")[0],d=performance.getEntriesByType("navigation");r=Math.round((t=r==null?void 0:r.startTime)!==null&&t!==void 0?t:-1),t=Math.round((i=s==null?void 0:s.startTime)!==null&&i!==void 0?i:-1),Qe(e.l,"PerformanceTiming","application timings",r,t,Math.round((n=o==null?void 0:o.startTime)!==null&&n!==void 0?n:-1),t-r),d.length?(i=d[d.length-1],Qe(e.l,"PerformanceTiming","load timings",Math.round(i.loadEventStart),Math.round(i.loadEventEnd),Math.round(i.domContentLoadedEventStart),Math.round(i.domContentLoadedEventEnd))):Qe(e.l,"PerformanceTiming","navigation timings unsupported",0,0,0,0)}}function rc(e){if(e.g){const i=e.g.getSessionId(),n=e.g.getSubSessionId();c.d("{9d1820c}","{2fd42df}",i,n);var t=e.l;t.subSessionId=n,t.s.clear(),t.v=0,t=e.l,t.sessionId=i,t.D=0,e.M.reset(i,n),e=e.v,e.o=!1,e.s=!1,e.D=!1,e.v=!1}}function Df(e,t){var i,n,r,s,o,d,u,l,h,p;e.K&&(e.K=!1,e.framesDecoded=(n=(i=e.h)===null||i===void 0?void 0:i.ua())!==null&&n!==void 0?n:0,i={sessionId:(s=(r=e.g)===null||r===void 0?void 0:r.getSessionId())!==null&&s!==void 0?s:"",subSessionId:(d=(o=e.g)===null||o===void 0?void 0:o.getSubSessionId())!==null&&d!==void 0?d:"",zoneName:(l=(u=e.g)===null||u===void 0?void 0:u.getZoneName())!==null&&l!==void 0?l:"",zoneAddress:((h=e.g)===null||h===void 0?void 0:h.getZoneAddress())||e.j.serverAddress,error:{code:t}},r=uo(e,i,performance.now()-e.startTime),Ys(e.m),(!e.h||!((p=e.h)===null||p===void 0)&&p.I)&&oc(e,r),dc(e,t),e.cancelSessionSetup())}function sc(e){e.I!==0&&(window.clearTimeout(e.I),e.I=0)}function oc(e,t){var i;sc(e);var n=e.l;let r;r=df(n.g,t),n.C(r),tc(n.g),e.s&&((i=e.V)===null||i===void 0||i.dropCachedEvent(e.s),e.s=0),t=t.streamDuration,document.visibilityState==="hidden"&&(e.C+=performance.now()-e.J),i=0,t&&(i=Math.max(0,100*(t-e.C)/t)),Qe(e.l,"sessionVisibilityMetrics","",i,Math.round(t),Math.round(e.C),0),e.C=0,e.J=0}function uo(e,t,i,n,r){var s,o,d,u;return{exitErrorCode:t.error?R(t.error.code):R(15859712),sessionId:t.sessionId,subSessionId:t.subSessionId,zoneAddress:t.zoneAddress,streamDuration:i,frameCount:e.framesDecoded,codec:(o=(s=e.h)===null||s===void 0?void 0:s.fb())!==null&&o!==void 0?o:"UNKNOWN",isResume:e.isResume,connectivityInfo:n,sleep:r??!1,networkTestSessionId:(u=(d=e.F)===null||d===void 0?void 0:d.ka.networkSessionId)!==null&&u!==void 0?u:""}}function ho(e){var t,i,n;const r=Nf(e,R((t=e.S)!==null&&t!==void 0?t:15867911)),s=e.I;e.useTelemetryV2?(t={name:r.name,gdprLevel:r.gdprLevel,priority:!0,ts:r.ts,parameters:r.parameters},e.s=(n=(i=e.V)===null||i===void 0?void 0:i.cacheEvent(t,e.s))!==null&&n!==void 0?n:0,i=Promise.resolve()):i=hf(e.v),i.then(()=>{s===e.I&&dA(e)}).catch(()=>{c.e("{9d1820c}","{204a7ac}")})}function fo(e){return{code:3237093380,description:e+" called before initialize"}}function Mf(e,t){var i,n,r,s,o,d,u,l,h,p,y;let N={sessionId:(n=(i=e.g)===null||i===void 0?void 0:i.getSessionId())!==null&&n!==void 0?n:"",subSessionId:(s=(r=e.g)===null||r===void 0?void 0:r.getSubSessionId())!==null&&s!==void 0?s:"",error:{code:3237089284,description:"Quitting due to exception"},streamInfo:(o=e.G)===null||o===void 0?void 0:o.streamInfo,zoneName:(u=(d=e.g)===null||d===void 0?void 0:d.getZoneName())!==null&&u!==void 0?u:"",zoneAddress:(h=(l=e.g)===null||l===void 0?void 0:l.getZoneAddress())!==null&&h!==void 0?h:"",gpuType:(y=(p=e.g)===null||p===void 0?void 0:p.getGpuType())!==null&&y!==void 0?y:"",isResume:e.isResume};e.yc(N,!0),c.e("{9d1820c}","{90f98fb}",t),e.l.Aa(t,"Exception happened in session call","{9d1820c}.ts",0,0,!0)}function aA(e,t){var i=ae();e.yc({sessionId:"",subSessionId:i,error:t,zoneName:"",zoneAddress:"",gpuType:"",isResume:e.isResume},!0)}function Lf(e,t,i,n){var r;if(e.G=void 0,e.ba=!1,e.g){rd(e.T,i.ka.additionalInputDevices),i.ka.remoteControllersBitmap=su(e.T);try{Zm(e.l,i.ka.appId,(r=i.ka.shortName)!==null&&r!==void 0?r:""),e.startTime=performance.now(),Vi(e.M.g),c.d("{9d1820c}","{892168d}",_e(JSON.stringify(i.ka)));const s=e.g;s.putOrPostSession(i.ka,t,n).then(o=>(rc(e),c.d("{9d1820c}","{92a2573}",o==null?void 0:o.sessionId,o==null?void 0:o.subSessionId),(o==null?void 0:o.state)==="ready_for_connection"?(c.d("{9d1820c}","{2042e0a}"),e.G=o,new Promise(d=>{d(o)})):s.getSession(o.sessionId,!0))).then(o=>{e.G=o,c.d("{9d1820c}","{315afdc}",o==null?void 0:o.sessionId),e.startStreaming(i)}).catch(o=>{var d,u,l,h,p,y;if(rc(e),o.code){o.code!=15867905&&o.code!=15867906||!s.getSessionId()||e.ba||e.sendDeleteRequest(s.getSessionId(),s),c.e("{9d1820c}","{09efe49}",R(o.code));let N={sessionId:(d=s.getSessionId())!==null&&d!==void 0?d:"",subSessionId:(u=s.getSubSessionId())!==null&&u!==void 0?u:"",error:o,sessionList:o.sessionList,streamInfo:(l=e.G)===null||l===void 0?void 0:l.streamInfo,zoneName:(h=s.getZoneName())!==null&&h!==void 0?h:"",zoneAddress:(p=s.getZoneAddress())!==null&&p!==void 0?p:"",gpuType:(y=s.getGpuType())!==null&&y!==void 0?y:"",isResume:e.isResume};e.yc(N,!0)}else Mf(e,o)})}catch(s){Mf(e,s)}}else e.emit("SessionStartResult",{sessionId:"",subSessionId:"",zoneName:"",zoneAddress:"",gpuType:"",isResume:e.isResume,error:fo(e.isResume?"Resume":"Start")})}function Nf(e,t){var i,n,r,s,o,d,u,l,h,p=e.v,y=(n=(i=e.g)===null||i===void 0?void 0:i.getSessionId())!==null&&n!==void 0?n:"";return i=(s=(r=e.g)===null||r===void 0?void 0:r.getSubSessionId())!==null&&s!==void 0?s:"",r=((o=e.g)===null||o===void 0?void 0:o.getZoneAddress())||e.j.serverAddress,o=(u=(d=e.h)===null||d===void 0?void 0:d.ua())!==null&&u!==void 0?u:0,d=(h=(l=e.h)===null||l===void 0?void 0:l.fb())!==null&&h!==void 0?h:"UNKNOWN",e=df(p,{exitErrorCode:t,sessionId:y,subSessionId:i,zoneAddress:r,streamDuration:performance.now()-e.startTime,frameCount:o,codec:d,isResume:e.isResume,sleep:!1,networkTestSessionId:""}),of(p,e),e}function dA(e){sc(e),e.I=window.setTimeout(()=>ho(e),12e4)}function xf(e){e.U&&(window.clearTimeout(e.U),e.U=0)}function ac(e){window.removeEventListener("pagehide",e.ja),window.removeEventListener("online",e.fa),document.removeEventListener("visibilitychange",e.ma),navigator.mediaDevices&&navigator.mediaDevices.removeEventListener("devicechange",e.Z),se(e.u)&&(document.removeEventListener("SystemIdle",e.ha),xf(e))}function _f(e,t){e.S=void 0,ff(e.v),e.K=!0,window.addEventListener("pagehide",e.ja),window.addEventListener("online",e.fa),document.addEventListener("visibilitychange",e.ma),navigator.mediaDevices&&navigator.mediaDevices.addEventListener("devicechange",e.Z),e.isResume=t,e.P&&vt(e.l,"SessionSetupInProgressError",e.isResume?"resume":"start"),e.P=!0}function Ff(e,t){var i,n,r;if(t={ka:Object.assign({},t),Xd:[]},t.ka.streamParams)for(const d of t.ka.streamParams){const u=document.getElementById(d.videoTagId);if(u==null||!(u instanceof HTMLVideoElement)){aA(e,{code:3237094400,description:"Didn't find video element for videoTagId: "+d.videoTagId});return}t.Xd.push({H:u})}if(t.ka.keyboardLayout=(i=t.ka.keyboardLayout)!==null&&i!==void 0?i:fe(e.u)?"m-us":"en_US",(t.ka.appLaunchMode===void 0||t.ka.appLaunchMode===0)&&(t.ka.appLaunchMode=T()||K(e.u)||e.u.os==="Xbox"||x(e.u)?1:0),hr)if(t.ka.metaData)for(const d in hr)t.ka.metaData[d]=hr[d];else t.ka.metaData=hr;Wr!==void 0&&(t.ka.appLaunchMode=Wr,c.d("{9d1820c}","{c4969b1}",Wr));const s=!!ln&&!!un,o=!!$i;return(s||o)&&((n=t.ka.streamParams)===null||n===void 0||n.forEach(d=>{s&&(d.width=ln,d.height=un),o&&(d.fps=$i)}),(r=t.ka.monitorSettings)===null||r===void 0||r.forEach(d=>{s&&(d.widthInPixels=ln,d.heightInPixels=un),o&&(d.framesPerSecond=$i)}),s&&c.i("{9d1820c}","{92a6b38}",ln,un),o&&c.d("{9d1820c}","{6618bcd}",$i)),e.F=t,e.F}function dc(e,t){e.h&&(e.h.stop(t),e.h=void 0)}function po(e,t,i){var n,r;t={sessionId:t,subSessionId:(r=(n=e.g)===null||n===void 0?void 0:n.getSubSessionId())!==null&&r!==void 0?r:"",framesDecoded:e.framesDecoded,error:i},cc(e),_(e.u)&&e.o&&(c.d("{9d1820c}","{b9b1288}"),e.setMicRecordingEnabled(!1)),e.emit("SessionStopResult",t)}function cc(e){Ri&&(window.ios15AudioContext&&(window.ios15AudioContext.close(),window.ios15AudioContext=void 0,c.i("{9d1820c}","{0ac2a42}")),window.ios15AudioStream=void 0,navigator.mediaDevices&&e.O&&navigator.mediaDevices.removeEventListener("devicechange",e.O))}function cA(e){if(Ri)if(window.ios15AudioContext)c.i("{9d1820c}","{e2aba64}");else{var t=new(window.AudioContext||window.webkitAudioContext)({latencyHint:"interactive",sampleRate:48e3});t.onstatechange=()=>{t.state==="suspended"&&(t.resume(),e.m.j(),c.i("{9d1820c}","{faee684}"))},window.ios15AudioContext=t,window.ios15AudioStream=t.createMediaStreamDestination(),navigator.mediaDevices&&e.O&&navigator.mediaDevices.addEventListener("devicechange",e.O),c.i("{9d1820c}","{b5f7b9b}")}}function Uf(e,t){e.P=!1,t.error&&(e.K=!1,ac(e)),e.emit("SessionStartResult",t)}function jf(e,t,i,n){var r,s,o,d,u;if(cc(e),n){const l=n.connectivityInfo;l&&!l.kc?(sc(e),n=Nf(e,R((s=(r=t.error)===null||r===void 0?void 0:r.code)!==null&&s!==void 0?s:15867911)),e.useTelemetryV2?(r={name:n.name,gdprLevel:n.gdprLevel,priority:!0,ts:n.ts,parameters:n.parameters},e.s=(d=(o=e.V)===null||o===void 0?void 0:o.cacheEvent(r,e.s))!==null&&d!==void 0?d:0):hf(e.v).catch(()=>{c.e("{9d1820c}","{0c2de99}")})):oc(e,n)}dc(e,t.error?t.error.code:15859712),i?Uf(e,t):(t.error&&(i=Sl(t.error.code,e.u),t.isResumable=i,t.isSessionAlive=Ha(t.error.code,i),c.i("{9d1820c}","{723f7be}",i)),e.K=!1,e.P=!1,ac(e),e.h&&(i=(u=e.h)===null||u===void 0?void 0:ef(u))&&e.emit("StreamQualityReport",i),e.emit("StreamStopped",t))}var lA=class extends Qn{constructor(e){var t;super(),this.u=e,this.o=this.$=!1,this.ea=new If,this.P=!1,this.O=this.Z=void 0,this.ga=!1,this.R=this.J=this.U=this.I=0,this.ba=this.K=!1,this.s=this.C=0,this.useTelemetryV2=!1,ee.isCallbackRegistered()||ee.register(this.aa.bind(this)),this.j={clientIdentification:"GFN-PC",clientVersion:"29.0",deviceHashId:"",serverAddress:""},this.startTime=performance.now(),this.ja=this.sa.bind(this),this.fa=this.kc.bind(this),this.ma=this.Ba.bind(this),this.za=this.ra.bind(this),this.framesDecoded=0,this.v=new qm,this.useTelemetryV2=(t=Re.useTelemetryV2)!==null&&t!==void 0?t:!0,this.l=rA(this.useTelemetryV2,this,this.v),this.useTelemetryV2&&(this.V=W.createTelemetryProvider(de)),this.M=new Pf(this.l),this.isResume=!1,this.N=ot,this.da=new kf,window.addEventListener("error",this.za),e=window.zoneless,this.m=new xu(this.u,this.l),this.O=this.m.j.bind(this.m),this.Z=this.na.bind(this),this.qa=new Of,this.T=Vl(this.u,e),Gr&&Dn(this.T,this.ea),this.ha=this.oa.bind(this),Bi(this.l),oA(this),qu(this.l),Re.sendNonEssentialMetricEvents&&Qe(this.l,"PlatformDetailsExecutionTime","",this.u.totalTime,0,0,0),Oi.registerCallback(i=>{var n;(n=this.g)===null||n===void 0||n.setNetworkType(i)})}ra(e){return c.e("{9d1820c}","{8516485}",e.filename,e.lineno,e.colno),this.l.Aa(e.error,e.error&&e.error.message?e.error.message:e.message,e.filename,e.lineno,e.colno,!1),Re.terminateUnhandledException&&Df(this,3237093392),!1}sa(){var e,t;this.ga||(this.ga=!0,Df(this,((e=this.S)!==null&&e!==void 0?e:!((t=this.h)===null||t===void 0)&&t.I)?15867912:15867905))}kc(){c.i("{9d1820c}","{a9a135f}"),ff(this.v)}Ba(){var e;if(c.i("{9d1820c}","{478a408}",document.visibilityState,!!this.h),this.h){var t=this.F.Xd[0].H,i=Ce(this.u,!1,15,4)&&ua,n=Ce(this.u,!1,15,4)&&this.o&&la;document.visibilityState==="hidden"?(this.J=performance.now(),i&&(c.i("{9d1820c}","{cbd3b6e}"),t.muted=!0),ho(this)):document.visibilityState==="visible"&&(this.C+=performance.now()-this.J,i&&(c.i("{9d1820c}","{05deefa}"),t.muted=!1),n?(t=(e=Re.userTerminatedMicRecorderThreshold)!==null&&e!==void 0?e:2e3,this.J-this.m.N<t?(c.i("{9d1820c}","{862bd20}"),this.m.G=!0,this.setMicRecordingEnabled(!0,this.L)):(this.o=!1,this.L=void 0)):Ce(this.u,!1,15,4)&&!this.m.m&&Rd(this.m)&&this.m.D&&Js(this.m,"visibilityChange"))}}ya(e){c.d("{9d1820c}","{972bb72}",JSON.stringify(e)),this.l.o(e)}va(e){this.emit("ActiveSessionsResult",e)}wa(e){this.emit("ProgressUpdate",e)}xa(e){this.emit("SessionUpdate",e)}initialize(e,t=ot){var i,n,r,s,o,d,u;if(c.i("{9d1820c}","{16f11e6}","Local"),c.d("{9d1820c}","{e85ad66}",navigator.userAgent),!e)return c.e("{9d1820c}","{a98b177}"),!1;Object.assign(this.j,e),(i=this.g)===null||i===void 0||i.uninitialize(),!this.j.serverAddress||F(this.j.serverAddress)?(c.d("{9d1820c}","{e2d9a04}"),this.g=new U):this.g=new X(this.u,!0),e=this.g;var l,h,p,y,N,G,E,D,z,Z,Q,ce;c.d("{9d1820c}","{3c652b7}"),rc(this),e.addListener("TelemetryEvent",this.ya.bind(this)),e.addListener("Log",this.aa.bind(this)),e.addListener("ActiveSessionsResult",this.va.bind(this)),e.addListener("ProgressUpdate",this.wa.bind(this)),e.addListener("SessionUpdate",this.xa.bind(this)),this.j.clientHeaders=(l=this.j.clientHeaders)!==null&&l!==void 0?l:new Map,l=Sa||this.j.clientType||"BROWSER",(i=l!=="NATIVE")&&this.j.clientHeaders.set("nv-browser-version",this.u.browserFullVer);var be=this.j.clientHeaders;for(var[Me]of be){const xe=Me;zr&&xe.toLowerCase()==="nv-device-os"&&be.set(xe,zr),Kr&&xe.toLowerCase()==="nv-device-type"&&be.set(xe,Kr),va.deviceModel&&xe.toLowerCase()==="nv-device-model"&&be.set(xe,va.deviceModel),$r&&xe.toLowerCase()==="nv-client-streamer"&&be.set(xe,$r),qr&&xe.toLowerCase()==="nv-client-id"&&be.set(xe,qr)}return Me={deviceOs:(p=(h=zr)!==null&&h!==void 0?h:this.u.os)!==null&&p!==void 0?p:this.u.deviceOS,deviceOsVer:(y=this.u.osVersion)!==null&&y!==void 0?y:this.u.osVer,deviceType:(G=(N=Kr)!==null&&N!==void 0?N:this.u.platformType)!==null&&G!==void 0?G:this.u.deviceType,deviceModel:(D=(E=va.deviceModel)!==null&&E!==void 0?E:this.u.model)!==null&&D!==void 0?D:this.u.deviceModel,clientIdentification:(z=this.j.clientIdentification)!==null&&z!==void 0?z:"GFN-PC",clientVersion:(Z=this.j.clientVersion)!==null&&Z!==void 0?Z:"29.0",clientAppVersion:this.j.clientAppVersion,clientStreamer:(Q=$r)!==null&&Q!==void 0?Q:"WEBRTC",clientId:qr||this.j.clientId,browserType:i?(ce=this.u.browser)===null||ce===void 0?void 0:ce.toUpperCase():void 0,clientPlatformName:ya||"browser",clientType:l,deviceHashId:this.j.deviceHashId,serverAddress:this.j.serverAddress,authTokenCallback:this.j.authTokenCallback,clientHeaders:this.j.clientHeaders},e.initialize(Me),e.setNetworkType(Oi.getCurrentNetworkType()),this.N={...t},(n=(o=this.N).windowedStreaming)!==null&&n!==void 0||(o.windowedStreaming=this.j.windowedStreaming),(r=(d=this.N).windowedStreaming)!==null&&r!==void 0||(d.windowedStreaming=t.cursorType===2),(s=(u=this.N).cursorType)!==null&&s!==void 0||(u.cursorType=this.j.cursorType),this.l.clientShutDownCallback=this.j.clientShutDownCallback,!0}downloadAudio(){this.da.downloadAudio()}updateEventDataElements(e){var t,i,n;if(c.i("{9d1820c}","{4008dc4}",JSON.stringify(e)),this.useTelemetryV2){const D=e.commonData;var r=e.config;if(r){const z=ec(r);var s,o,d,u,l;r={clientVariant:(s=D==null?void 0:D.clientVariant)!==null&&s!==void 0?s:"undefined",clientType:(o=D==null?void 0:D.clientType)!==null&&o!==void 0?o:"undefined",clientVer:(d=D==null?void 0:D.clientVer)!==null&&d!==void 0?d:"undefined",productName:(u=D==null?void 0:D.productName)!==null&&u!==void 0?u:"undefined",productVersion:(l=D==null?void 0:D.productVersion)!==null&&l!==void 0?l:"undefined"},s=(0,A.translatePlatformInfoForPayload)(this.u),o=(D==null?void 0:D.deviceModel)||this.u.model||this.u.deviceModel,d=(D==null?void 0:D.deviceMake)||this.u.make||this.u.vendor,u=((t=D==null?void 0:D.deviceOSVersion)!==null&&t!==void 0?t:"")||this.u.osVersion||this.u.osVer,t={...this.u,deviceId:(i=D==null?void 0:D.deviceId)!==null&&i!==void 0?i:"",deviceOS:s.os,deviceOSVersion:u,osVersion:u,deviceType:s.deviceType,deviceModel:o,model:o,deviceMake:d,make:d,browserType:s.browser},W.configure(r,t,z??1)}var h,p,y;i={gdprFuncOptIn:(h=D==null?void 0:D.gdprFuncOptIn)!==null&&h!==void 0?h:"None",gdprTechOptIn:(p=D==null?void 0:D.gdprTechOptIn)!==null&&p!==void 0?p:"None",gdprBehOptIn:(y=D==null?void 0:D.gdprBehOptIn)!==null&&y!==void 0?y:"None"};var N,G,E;h={deviceGdprFuncOptIn:(N=D==null?void 0:D.deviceGdprFuncOptIn)!==null&&N!==void 0?N:"None",deviceGdprTechOptIn:(G=D==null?void 0:D.deviceGdprTechOptIn)!==null&&G!==void 0?G:"None",deviceGdprBehOptIn:(E=D==null?void 0:D.deviceGdprBehOptIn)!==null&&E!==void 0?E:"None"},W.updateClientCommonData({userId:D==null?void 0:D.userId,externalUserId:D==null?void 0:D.externalUserId,idpId:D==null?void 0:D.idpId},h,i,D==null?void 0:D.integrationId)}this.v.updateEventDataElements(e),e.telemetryEventIds&&(W.setTelemetryEventIds(e.telemetryEventIds),(n=this.g)===null||n===void 0||n.updateTelemetryEventIds(e.telemetryEventIds)),this.h&&!this.P&&ho(this)}getActiveSessions(){this.g?this.g.getAllActiveSessions():this.emit("ActiveSessionsResult",{sessionList:[],error:fo("ActiveSessions")})}startSession(e){_f(this,!1),(e=Ff(this,e))&&Lf(this,0,e)}updateAdState(e){var t;return this.g?(t=this.g)===null||t===void 0?void 0:t.updateAdState(e):3237093380}getSession(e){this.g?this.g.getSession(e,!1).then(t=>{var i,n;let r={sessionId:(i=t==null?void 0:t.sessionId)!==null&&i!==void 0?i:"",appId:t==null?void 0:t.appId,subSessionId:(n=t==null?void 0:t.subSessionId)!==null&&n!==void 0?n:"",state:t==null?void 0:t.state,status:t==null?void 0:t.state};this.emit("GetSessionResult",r)}).catch(t=>{var i,n;let r={sessionId:e,subSessionId:(n=(i=this.g)===null||i===void 0?void 0:i.getSubSessionId())!==null&&n!==void 0?n:"",error:t};this.emit("GetSessionResult",r)}):this.emit("GetSessionResult",{sessionId:"",subSessionId:"",error:fo("GetSession")})}resume(){this.resumeSession(this.F.ka,this.g.getSessionId())}resumeSession(e,t){_f(this,!0),(e=Ff(this,e))&&Lf(this,2,e,t)}stopSession(e,t){var i,n,r,s,o,d,u;this.g?(t!==void 0&&c.i("{9d1820c}","{ae7f61b}",R(t)),e===this.g.getSessionId()||e===void 0?(t===15867910?this.ba=!0:this.$=!1,Ys(this.m),this.framesDecoded=(n=(i=this.h)===null||i===void 0?void 0:i.ua())!==null&&n!==void 0?n:0,oi(this.M.g,!1),i=uo(this,{sessionId:(r=this.g.getSessionId())!==null&&r!==void 0?r:"",subSessionId:(s=this.g.getSubSessionId())!==null&&s!==void 0?s:"",error:t?{code:t}:void 0,zoneName:(o=this.g.getZoneName())!==null&&o!==void 0?o:"",zoneAddress:this.g.getZoneAddress()||this.j.serverAddress,gpuType:(d=this.g.getGpuType())!==null&&d!==void 0?d:"",isResume:this.isResume},performance.now()-this.startTime),e=(u=this.g.getSessionId())!==null&&u!==void 0?u:"",this.h?(this.K=!1,ac(this),this.h.I&&oc(this,i),dc(this,t??(this.h.I?15859712:15867905)),t===15867910?(c.d("{9d1820c}","{12bc45e}",e),po(this,e)):this.sendDeleteRequest(e,this.g)):this.G?po(this,e):this.cancelSessionSetup()):e&&this.sendDeleteRequest(e,this.g)):this.emit("SessionStopResult",{sessionId:"",subSessionId:"",error:fo("StopSession")})}pauseSession(e){this.stopSession(e,15867910)}startStreaming(e){var t,i,n,r,s;const o={sessionId:(i=(t=this.g)===null||t===void 0?void 0:t.getSessionId())!==null&&i!==void 0?i:"",subSessionId:(r=(n=this.g)===null||n===void 0?void 0:n.getSubSessionId())!==null&&r!==void 0?r:"",progressState:"StartingStreamer",queuePosition:0,eta:0,ads:[],isAdsRequired:!1};this.emit("SessionUpdate",o),this.emit("ProgressUpdate",{...o,state:o.progressState}),t=F(this.j.serverAddress)?"":this.j.serverAddress.split(".")[0];const{H:d}=e.Xd[0];if(Ce(this.u,!1,15)){d.streamKitOldPlay||(d.streamKitOldPlay=d.play);const u=Br&&Ce(this.u,!0,15,1);d.play=()=>{if(Ri&&(c.i("{9d1820c}","{4a5b360}"),cc(this),cA(this),this.m.j()),u){c.i("{9d1820c}","{8f5cd77}");const l=d.srcObject;d.srcObject=null,d.srcObject=l}return d.streamKitOldPlay.apply(d)}}Vr&&(Ce(this.u,!0,15,0)||Ce(this.u,!0,15,1))&&(d.hasAttribute("data-shouldautoplay")?d.setAttribute("autoplay",""):(d.setAttribute("data-shouldautoplay",""),d.removeAttribute("autoplay"))),this.h=new tf(this,d,void 0,this.m,this.N,this.ea,this.T,this.l,this.u,this.G,this.qa,e.ka.streamParams[0],this.da,this.j.textInputElement,this.j.clientAppVersion,this.isResume,t,void 0,void 0,e.ka.signalingUrlQueryParameters),this.h.start(),e.ka.keyboardLayout&&this.h.setKeyboardLayout(e.ka.keyboardLayout),this.useTelemetryV2?((s=this.V)===null||s===void 0||s.processCachedEvent(this.s),e=Promise.resolve()):e=tA(this.l),e.then(()=>{ho(this)}).catch(()=>{c.e("{9d1820c}","{c761bfd}")})}yc(e,t){var i,n,r,s,o,d;if(e.error){const u=nc(this.M,e.error.code);u&&(e.error.code=Va(e.error.code,this.u)),Ka(this.j.serverAddress,e.error.code).then(l=>{var h,p,y;this.framesDecoded=(p=(h=this.h)===null||h===void 0?void 0:h.ua())!==null&&p!==void 0?p:0,e.zoneAddress||(e.zoneAddress=this.j.serverAddress),e.error&&(e.error.code=Ba(e.error.code,l)),h=void 0,t||(h=uo(this,e,0,l,u),this.S=(y=e.error)===null||y===void 0?void 0:y.code),jf(this,e,!0,h)})}else eA(this.l,e.sessionId,e.subSessionId,this.isResume,e.zoneAddress||this.j.serverAddress,Math.round(performance.now()-this.startTime),R(15859712),(n=(i=this.h)===null||i===void 0?void 0:i.fb())!==null&&n!==void 0?n:"UNKNOWN",this.F?String((r=this.F)===null||r===void 0?void 0:r.ka.appId):"",(o=(s=this.F)===null||s===void 0?void 0:s.ka.networkSessionId)!==null&&o!==void 0?o:""),this.startTime=performance.now(),document.visibilityState==="hidden"&&(this.J=this.startTime),this.C=0,this.isResume&&this.o&&this.setMicRecordingEnabled(!0,this.L),Uf(this,e),this.$&&((d=this.h)===null||d===void 0||d.toggleUserInput(!0,this.pa)),se(this.u)&&document.addEventListener("SystemIdle",this.ha)}yf(e){var t,i;Ys(this.m),c.d("{9d1820c}","{a94b484}");let n=nc(this.M,e.error.code);n&&(e.error.code=Va(e.error.code,this.u)),this.framesDecoded=(i=(t=this.h)===null||t===void 0?void 0:t.ua())!==null&&i!==void 0?i:0,e.zoneAddress||(e.zoneAddress=this.j.serverAddress),Ka(this.j.serverAddress,e.error.code).then(r=>{var s;e.error.code=Ba(e.error.code,r),r=uo(this,e,performance.now()-this.startTime,r,n),this.S=(s=e.error)===null||s===void 0?void 0:s.code,Qe(this.l,"HotPlug","",0,this.R,0,0),this.R=0,jf(this,e,!1,r)})}zf(){xf(this)}sendDeleteRequest(e,t){t.sendDeleteRequest(e).then(()=>{c.d("{9d1820c}","{fee1eea}",e),po(this,e)},i=>{c.e("{9d1820c}","{50e2a6e}",e),po(this,e,i)})}isMicSupported(){return ss}setMicRecordingEnabled(e,t){c.i("{9d1820c}","{f5b2f30}",e),e?(this.o=!0,this.L=t,Qs(this.m,this.L)):(this.o=!1,this.L=void 0,Td(this.m))}getMicState(){i0(this.m)}shouldDefaultEnableMic(){return Fu(this.u)}sendCustomMessage(e){var t;(t=this.h)===null||t===void 0||t.sendCustomMessage(e)}toggleUserInput(e,t){var i;(i=this.h)===null||i===void 0||i.toggleUserInput(e,t),this.$=e,this.pa=t}toggleRsdmm(e){var t;(t=this.h)===null||t===void 0||t.toggleRsdmm(e)}getVirtualGamepadHandler(){var e;return(e=this.h)===null||e===void 0?void 0:e.getVirtualGamepadHandler()}setAuthInfo(e){var t;(t=this.g)===null||t===void 0||t.setAuthInfo(e)}sendTextInput(e){var t;(t=this.h)===null||t===void 0||t.sendTextInput(e)}setVirtualKeyboardState(e){var t;(t=this.h)===null||t===void 0||t.setVirtualKeyboardState(e)}setVideoTransforms(e,t,i){var n;(n=this.h)===null||n===void 0||n.setVideoTransforms(e,t,i)}toggleOnScreenStats(){var e;Ct&&((e=this.h)===null||e===void 0||e.toggleOnScreenStats())}toggleStutterIndicator(){var e;(e=this.h)===null||e===void 0||e.toggleStutterIndicator()}setKeyboardLayout(e){var t;c.i("{9d1820c}","{10717a6}",e),(t=this.h)===null||t===void 0||t.setKeyboardLayout(e)}sendKeyEvent(e){var t;(t=this.h)===null||t===void 0||t.sendKeyEvent(e)}setStreamingMaxBitrate(e,t=0){var i;(i=this.h)===null||i===void 0||i.setStreamingMaxBitrate(t,e)}setDrcDfcState(e,t=0){var i;(i=this.h)===null||i===void 0||i.setDrcDfcState(t,e?3:0)}setHdr10PlusGaming(e){var t;(t=this.h)===null||t===void 0||(t=t.aa,t.h=e,so(t))}startInputPlayback(e){var t;(t=this.h)===null||t===void 0||t.startInputPlayback(e)}oa(e){var t;e.detail.idle&&((t=this.h)===null||t===void 0||qd(t,2,60),this.U=window.setTimeout(()=>{var i;(i=this.h)===null||i===void 0||pt(i,15867913)},6e4))}na(){Nu(this.m,this.R),this.R++}cancelSessionSetup(){!this.h&&this.g&&this.g.cancelSessionSetup()}},uA=A.AuthType,hA=A.LogImpl,fA=A.performHttpRequest,pA=A.PayloadOSType,vA=A.PayloadBrowserType,gA=A.PayloadDeviceType,mA=A.ClientHeaderOSType,AA=A.ClientHeaderBrowserType,SA=A.ClientHeaderDeviceType,yA=A.SdrHdrMode,bA=A.BitDepth,EA=A.NetworkType,wA=A.PlatformOS,CA=A.PlatformBrowser,IA=A.translatePlatformInfoForPayload,TA=A.translatePlatformInfoForClientHeader;performance.mark("GfnNskBegin");function Cr(e,t,i){var n;if(e.streamingState!==4&&e.streamingState!==0){var r=e.streamingState;e.streamingState=4,Xm(e.h),Qe(e.h,"HotPlug","",0,e.s,0,0),_(e.u)&&e.m&&(c.d("{0a9be04}","{b9b1288}"),e.captureMic(!1)),Ys(e.j),(n=e.g)===null||n===void 0||n.stop(t);var s=nc(e.F,t);s&&(t=Va(t,e.u)),Ka(e.zoneAddress,t).then(o=>{var d;if(t=Ba(t,o),r!==1){var u=Sl(t,e.u);u={code:t,isResumable:u,isSessionAlive:Ha(t,u),reason:3};var l=new Set([3237093892,15867907,3237093896,3237093897,3237093898,3237093899,3237093900,3237093895,3237093901,3237093906,3237093929,15867908,15868418,3237094151,3237094158]);i?u.reason=0:l.has(t)?u.reason=2:(t&268435200)===15868672&&(u.reason=1),(l=(d=e.g)===null||d===void 0?void 0:ef(d))&&e.l.streamQualityReport&&e.l.streamQualityReport(l),e.l.onStreamStopped(u);var h,p,y,N;l=R(t),d=performance.now()-e.startTime,u=(p=(h=e.g)===null||h===void 0?void 0:h.fb())!==null&&p!==void 0?p:"UNKNOWN",h=(N=(y=e.g)===null||y===void 0?void 0:y.ua())!==null&&N!==void 0?N:0,y=e.h,N=l,p=pf(o,s),mf(y,N,p,d,u,h),o.kc?Af(y):c.d("{9838627}","{30029be}",N,p)}Gf(e),lc(e),e.g=void 0,e.startTime=0,e.isResume=!1,e.J=void 0,e.G=0,e.s=0,e.sessionId="",e.subSessionId="",e.zoneAddress="",e.zoneName="",e.H=void 0,e.Da=void 0,e.m=!1,e.v=void 0,e.appId=0,e.setSupportedHidTypes(0),e.setGamepadRsdmm(!1);var G,E,D,z;y=window.zoneless,o=(E=(G=y==null?void 0:y.windowRemoveEventListener)===null||G===void 0?void 0:G.bind(window))!==null&&E!==void 0?E:window.removeEventListener.bind(window),G=(z=(D=y==null?void 0:y.documentRemoveEventListener)===null||D===void 0?void 0:D.bind(document))!==null&&z!==void 0?z:document.removeEventListener.bind(document),o("pagehide",e.N),o("error",e.M),G("visibilitychange",e.O),navigator.mediaDevices&&navigator.mediaDevices.removeEventListener("devicechange",e.I),se(e.u)&&(G("SystemIdle",e.L),lc(e))})}}function RA(e){var t,i,n;if(Re.sendNonEssentialMetricEvents){var r=performance.getEntriesByName("GfnJsInitStart")[0];const s=performance.getEntriesByName("platformBegin")[0],o=performance.getEntriesByName("GfnNskBegin")[0],d=performance.getEntriesByType("navigation");r=Math.round((t=r==null?void 0:r.startTime)!==null&&t!==void 0?t:-1),t=Math.round((i=s==null?void 0:s.startTime)!==null&&i!==void 0?i:-1),Qe(e.h,"PerformanceTiming","application timings",r,t,Math.round((n=o==null?void 0:o.startTime)!==null&&n!==void 0?n:-1),t-r),d.length?(i=d[d.length-1],Qe(e.h,"PerformanceTiming","load timings",Math.round(i.loadEventStart),Math.round(i.loadEventEnd),Math.round(i.domContentLoadedEventStart),Math.round(i.domContentLoadedEventEnd))):Qe(e.h,"PerformanceTiming","navigation timings unsupported",0,0,0,0)}}function kA(e){var t;const i={errorCode:void 0,streamParams:Object.assign({},e),Da:void 0,Yd:[]};if(0<i.streamParams.downstreamParams.length||!e.audioTagId){for(var n of i.streamParams.downstreamParams)(e=document.getElementById(n.videoTagId))&&e instanceof HTMLVideoElement&&i.Yd.push(e);if(!i.Yd.length)return{errorCode:3237094400}}else if((n=document.getElementById(e.audioTagId))&&n instanceof HTMLAudioElement)i.Da=n;else return{errorCode:3237094401};const r=!!ln&&!!un,s=!!$i;return(r||s)&&((t=i.streamParams.downstreamParams)===null||t===void 0||t.forEach(o=>{r&&(o.width=ln,o.height=un),s&&(o.fps=$i)}),r&&c.i("{0a9be04}","{92a6b38}",ln,un),s&&c.d("{0a9be04}","{6618bcd}",$i)),i}function Gf(e){Ri&&(window.ios15AudioContext&&(window.ios15AudioContext.close(),window.ios15AudioContext=void 0,c.i("{0a9be04}","{0ac2a42}")),window.ios15AudioStream=void 0,navigator.mediaDevices&&e.C&&navigator.mediaDevices.removeEventListener("devicechange",e.C))}function PA(e){if(Ri)if(window.ios15AudioContext)c.i("{0a9be04}","{e2aba64}");else{var t=new(window.AudioContext||window.webkitAudioContext)({latencyHint:"interactive",sampleRate:48e3});t.onstatechange=()=>{t.state==="suspended"&&(t.resume(),e.j.j(),c.i("{0a9be04}","{faee684}"))},window.ios15AudioContext=t,window.ios15AudioStream=t.createMediaStreamDestination(),navigator.mediaDevices&&e.C&&navigator.mediaDevices.addEventListener("devicechange",e.C),c.i("{0a9be04}","{b5f7b9b}")}}function OA(e){var t,i,n,r;const s=window.zoneless,o=(i=(t=s==null?void 0:s.windowAddEventListener)===null||t===void 0?void 0:t.bind(window))!==null&&i!==void 0?i:window.addEventListener.bind(window);t=(r=(n=s==null?void 0:s.documentAddEventListener)===null||n===void 0?void 0:n.bind(document))!==null&&r!==void 0?r:document.addEventListener.bind(document),o("pagehide",e.N),o("error",e.M),t("visibilitychange",e.O),navigator.mediaDevices&&navigator.mediaDevices.addEventListener("devicechange",e.I),se(e.u)&&t("SystemIdle",e.L)}function lc(e){e.D&&(window.clearTimeout(e.D),e.D=0)}var DA=class{constructor(e,t,i){this.u=e,this.l=t,this.S=i,this.K=new If,this.P=new kf,this.startTime=this.streamingState=0,this.isResume=!1,this.s=this.G=this.D=0,this.zoneName=this.zoneAddress=this.subSessionId=this.sessionId="",this.m=!1,this.appId=0,this.M=n=>(c.e("{0a9be04}","{8516485}",n.filename,n.lineno,n.colno),this.h.Aa(n.error,n.error&&n.error.message?n.error.message:n.message,n.filename,n.lineno,n.colno,!1),Re.terminateUnhandledException&&Cr(this,3237093392),!1),this.O=()=>{var n;if(c.i("{0a9be04}","{478a408}",document.visibilityState,!!this.g),this.g){var r=this.H,s=this.Da,o=r&&s&&Ce(this.u,!1,15,4)&&ua,d=Ce(this.u,!1,15,4)&&this.m&&la;document.visibilityState==="hidden"?(this.G=performance.now(),o&&(c.i("{0a9be04}","{cbd3b6e}"),r.muted=!0,s.muted=!0)):document.visibilityState==="visible"&&(o&&(c.i("{0a9be04}","{05deefa}"),r.muted=!1,s.muted=!1),d?(r=(n=Re.userTerminatedMicRecorderThreshold)!==null&&n!==void 0?n:2e3,this.G-this.j.N<r?(c.i("{0a9be04}","{862bd20}"),this.j.G=!0,this.captureMic(!0,this.v)):(this.m=!1,this.v=void 0)):Ce(this.u,!1,15,4)&&!this.j.m&&Rd(this.j)&&this.j.D&&Js(this.j,"visibilityChange"))}},this.N=()=>{var n,r;Cr(this,((n=this.J)!==null&&n!==void 0?n:!((r=this.g)===null||r===void 0)&&r.I)?15867912:15867905)},this.I=()=>{Nu(this.j,this.s),this.s++},this.L=n=>{var r;n.detail.idle&&((r=this.g)===null||r===void 0||qd(r,2,60),this.D=window.setTimeout(()=>{var s;(s=this.g)===null||s===void 0||pt(s,15867913)},6e4))},this.C=()=>{this.j.j()},e=window.zoneless,this.R=new Of,this.o=Vl(this.u,e),this.h=new Sf,this.j=new xu(this.u,this.h),this.F=new Pf(this.h),Gr&&Dn(this.o,this.K),Bi(this.h),RA(this),qu(this.h),Re.sendNonEssentialMetricEvents&&Qe(this.h,"PlatformDetailsExecutionTime","",this.u.totalTime,0,0,0),c.i("{0a9be04}","{16f11e6}","Local"),c.d("{0a9be04}","{e85ad66}",navigator.userAgent)}startStreaming(e){var t,i,n,r,s,o,d,u,l,h,p,y,N,G,E;if(this.streamingState!==4&&this.streamingState!==0)return c.w("{0a9be04}","{60a7ff5}"),vt(this.h,"SessionSetupInProgressError",e.resume?"resume":"start"),3237085186;const D=kA(e);if(D.errorCode)return D.errorCode;if(e=D.streamParams,this.H=D.Yd[0],this.Da=D.Da,this.isResume=(t=e.resume)!==null&&t!==void 0?t:!1,this.sessionId=e.sessionId,this.subSessionId=(i=e.subSessionId)!==null&&i!==void 0?i:"",this.zoneAddress=(n=e.zoneAddress)!==null&&n!==void 0?n:"",this.zoneName=(s=(r=e.statTelemetryInfo)===null||r===void 0?void 0:r.zoneName)!==null&&s!==void 0?s:"",this.appId=(d=(o=e.statTelemetryInfo)===null||o===void 0?void 0:o.appId)!==null&&d!==void 0?d:0,Jm(this.h,this.subSessionId,this.sessionId,this.appId.toString(),this.isResume,this.zoneAddress),this.F.reset(this.sessionId,this.subSessionId),Ce(this.u,!1,15)){const z=this.H;z.streamKitOldPlay||(z.streamKitOldPlay=this.H.play);const Z=Br&&Ce(this.u,!0,15,1);this.H.play=()=>{var Q,ce,be;if(Ri&&(c.i("{0a9be04}","{4a5b360}"),Gf(this),PA(this),this.j.j()),Z){c.i("{0a9be04}","{8f5cd77}");const Me=(ce=(Q=this.H)===null||Q===void 0?void 0:Q.srcObject)!==null&&ce!==void 0?ce:null;!((be=this.H)===null||be===void 0)&&be.srcObject&&(this.H.srcObject=null,this.H.srcObject=Me)}return z.streamKitOldPlay.apply(this.H)}}return Vr&&(Ce(this.u,!0,15,0)||Ce(this.u,!0,15,1))&&(this.H.hasAttribute("data-shouldautoplay")?this.H.setAttribute("autoplay",""):(this.H.setAttribute("data-shouldautoplay",""),this.H.removeAttribute("autoplay"))),n={ip:"",port:0,appLevelProtocol:0,usage:0,protocol:0},e.mediaConnectionInfo&&(n.ip=e.mediaConnectionInfo.address,n.port=e.mediaConnectionInfo.port,n.usage=2),r={ip:e.signalConnectionInfo.address,port:e.signalConnectionInfo.port,protocol:e.signalConnectionInfo.secure?"wss":"ws",resourcePath:e.signalConnectionInfo.resourcePath},t=e.downstreamParams[0],s={width:t.width,height:t.height,fps:t.fps,sdrHdrMode:t.sdrHdrMode},i={appId:this.appId,appLaunchMode:e.enableTouchInput?2:0,clientLocale:(l=(u=e.statTelemetryInfo)===null||u===void 0?void 0:u.clientLocale)!==null&&l!==void 0?l:"",gpuType:(p=(h=e.statTelemetryInfo)===null||h===void 0?void 0:h.gpuType)!==null&&p!==void 0?p:"",mediaConnectionInfo:[n],sessionId:this.sessionId,signalConnectionInfo:r,state:"ready_for_connection",streamInfo:[s],subSessionId:this.subSessionId,zoneAddress:this.zoneAddress,zoneName:this.zoneName,finalizedStreamingFeatures:e.streamingFeatures},u={width:t.width,height:t.height,fps:t.fps,maxBitrateKbps:t.maxBitrateKbps,videoTagId:t.videoTagId,audioTagId:e.audioTagId},l={...ot},(y=l.windowedStreaming)!==null&&y!==void 0||(l.windowedStreaming=e.windowedStreaming),(N=l.cursorType)!==null&&N!==void 0||(l.cursorType=e.cursorType),this.g=new tf(this,this.H,this.Da,this.j,l,this.K,this.o,this.h,this.u,i,this.R,u,this.P,this.S.textInputElement,(G=e.statTelemetryInfo)===null||G===void 0?void 0:G.clientAppVersion,this.isResume,(E=e.statTelemetryInfo)===null||E===void 0?void 0:E.region,t.dynamicStreamingMode,e.upstreamParams,e.signalConnectionInfo.queryParameters),OA(this),this.streamingState=1,Vi(this.F.g),this.startTime=performance.now(),this.g.start(),e.keyboardLayout&&this.g.setKeyboardLayout(e.keyboardLayout),15859712}stopStreaming(e){!this.g||this.streamingState!==1&&this.streamingState!==2||(e=e??15859712,c.i("{0a9be04}","{ae7f61b}",R(e)),this.streamingState=3,Cr(this,e,!0))}getStreamingState(){return this.streamingState}sendCustomMessage(e){var t;return(t=this.g)===null||t===void 0||t.sendCustomMessage(e),!!this.g}setStreamingMaxBitrate(e,t,i){var n;return(n=this.g)===null||n===void 0||n.setStreamingMaxBitrate(t??0,e,i),!!this.g}setDynamicStreamingMode(e,t,i){var n;return(n=this.g)===null||n===void 0||n.setDrcDfcState(t??0,e,i),!!this.g}setHdr10PlusGaming(e){var t;return(t=this.g)===null||t===void 0||(t=t.aa,t.h=e,so(t)),!!this.g}setKeyboardLayout(e){var t;return(t=this.g)===null||t===void 0||t.setKeyboardLayout(e),!!this.g}setSupportedHidTypes(e){rd(this.o,e)}setGamepadRsdmm(e){var t;return this.g?((t=this.g)===null||t===void 0||t.toggleRsdmm(e),!0):!1}getVirtualInputController(){return this}getGamepadBitmap(){return su(this.o)}captureUserInput(e,t){var i;return(i=this.g)===null||i===void 0||i.toggleUserInput(e,t),!!this.g}sendTextInput(e){var t;return(t=this.g)===null||t===void 0||t.sendTextInput(e),!!this.g}getMicState(){return Id()}captureMic(e,t){return this.g?(this.v=(this.m=e)?t:void 0,this.m?Qs(this.j,t):Td(this.j),!0):!1}setVideoTransforms(e,t,i){var n;return(n=this.g)===null||n===void 0||n.setVideoTransforms(e,t,i),!!this.g}setUpstreamMedia(e,t){var i;return this.g?(i=this.g)===null||i===void 0?void 0:i.setUpstreamMedia(e,t):Promise.resolve(!1)}unsetUpstreamMedia(e){var t;return this.g?(t=this.g)===null||t===void 0?void 0:t.unsetUpstreamMedia(e):Promise.resolve(!1)}stopUpstreamMedia(e){var t;return this.g?(t=this.g)===null||t===void 0?void 0:t.stopUpstreamMedia(e):Promise.resolve(!1)}startInputPlayback(e){var t;(t=this.g)===null||t===void 0||t.startInputPlayback(e)}yc(e){var t,i,n,r,s,o,d,u;let l=15859712;if(e.error)l=e.error.code,this.l.onStreamStartFailed(l),Cr(this,l);else if(!((t=e.streamInfo)===null||t===void 0)&&t.length&&(!((i=e.streams)===null||i===void 0)&&i.length)){this.streamingState=2,t={streams:[],separateAudioStream:!!e.streams.find(h=>{const p=h.tracks.find(y=>y.kind==="video");return h=h.tracks.find(y=>y.kind==="audio"),!p&&h})};for(const h of e.streamInfo)i={width:h.width,height:h.height,fps:h.fps,sdrHdrMode:h.sdrHdrMode,bitDepth:(n=e.bitDepth)!==null&&n!==void 0?n:8,codec:(r=this.g)===null||r===void 0?void 0:r.fb(),videoTagId:(o=(s=this.H)===null||s===void 0?void 0:s.tagName)!==null&&o!==void 0?o:""},t.streams.push(i);this.l.onStreamStarted(t),this.isResume&&this.m&&this.captureMic(!0,this.v)}else l=3237093905,c.e("{0a9be04}","{0cfb100}"),this.l.onStreamStartFailed(l),Cr(this,l);Qm(this.h,Math.round(performance.now()-this.startTime),R(l),(u=(d=this.g)===null||d===void 0?void 0:d.fb())!==null&&u!==void 0?u:"UNKNOWN"),l===15859712&&Ym(this.h,{ua:()=>{var h,p;return(p=(h=this.g)===null||h===void 0?void 0:h.ua())!==null&&p!==void 0?p:0},ig:()=>{var h;return(h=this.J)!==null&&h!==void 0?h:15867911},fb:()=>{var h,p;return(p=(h=this.g)===null||h===void 0?void 0:h.fb())!==null&&p!==void 0?p:"UNKNOWN"},jg:()=>performance.now()-this.startTime}),this.startTime=performance.now()}yf(e){Cr(this,e.error.code)}zf(){lc(this)}emit(e,...t){if(t.length)switch(e){case"StreamingEvent":t[0].streamingWarnings&&this.l.onStreamWarning(t[0].streamingWarnings);break;case"StreamingQuality":this.l.onStreamQuality(t[0]);break;case"MicCapture":this.l.onMicStateUpdate&&t[0].state!==void 0&&this.l.onMicStateUpdate(t[0].state);break;case"TextComposition":this.l.onTextComposition(t[0]);break;case"CustomMessage":this.l.onCustomMessage&&this.l.onCustomMessage(t[0]);break;case"StreamStatsUpdate":this.l.onStreamStatistics(t[0])}}addListener(){}removeListener(){}removeAllListeners(){}removeAllListenersOfEvent(){}hasListener(){return!0}setClientSupportsVirtualGamepad(){this.o.getVirtualGamepadHandler().enable()}handleVirtualGamepadState(e,t,i){this.o.getVirtualGamepadHandler().updateInput(e,t,i)}setVirtualKeyboardState(e){var t;return(t=this.g)===null||t===void 0||t.setVirtualKeyboardState(e),!!this.g}handleVirtualKeyInput(e){var t;return(t=this.g)===null||t===void 0||t.sendKeyEvent(e),!!this.g}};window.Ragnarok=window.Ragnarok||{},window.Ragnarok.GridApp=lA,window.Ragnarok.ChooseStreamingSettings=function(e=0,t,i){return vl(e,t,gl(i))},window.Ragnarok.ChooseStreamingResolution=function(e=0,t){return t=t==null?void 0:t.map(i=>({resolution:i,frameRate:60})),vl(e,t,gl()).resolution},window.Ragnarok.InitializeUtils=function(){},window.Ragnarok.GetSupportedAudioChannelCount=pl,window.Ragnarok.GetDeviceCapabilities=ju,window.Ragnarok.getSupportedCodecs=Pd,window.Ragnarok.VirtualButton={A:4096,B:8192,X:16384,Y:32768,LB:256,RB:512,LT:255,RT:65280,BACK:32,START:16,STICK_LEFT:64,STICK_RIGHT:128,DPAD_UP:1,DPAD_DOWN:2,DPAD_LEFT:4,DPAD_RIGHT:8},window.Ragnarok.VirtualGamepadHandler=Gl,window.Ragnarok.ConfigureRagnarokSettings=fl,window.Ragnarok.CHANGELIST="rel-71-24504671",window.Ragnarok.AddPlatformTelemetry=function(e){Bi(e)},window.Ragnarok.registerLogCallback=function(e){e?A.Logger.register(e):A.Logger.unregister()},window.Ragnarok.DeviceOS={WINDOWS:"WINDOWS",MACOS:"MACOS",SHIELD:"SHIELD",ANDROID:"ANDROID",IOS:"IOS",IPADOS:"IPADOS",CHROMEOS:"CHROMEOS",LINUX:"LINUX",TIZEN:"TIZEN",WEBOS:"WEBOS",TVOS:"TVOS",XBOX:"XBOX",STEAMOS:"STEAMOS",CCOS:"CCOS",VISIONOS:"VISIONOS"},window.Ragnarok.DeviceType={DESKTOP:"DESKTOP",LAPTOP:"LAPTOP",TV:"TV",PHONE:"PHONE",TABLET:"TABLET",CONSOLE:"CONSOLE",HMD:"HMD"},window.Ragnarok.DeviceModel={STEAMDECK:"STEAMDECK",XBOX_ONE:"XBOXONE",XBOX_SERIES:"XBOXSERIES",VISION_PRO:"VISIONPRO",QUEST:"QUEST"},window.Ragnarok.DeviceVendor={APPLE:"APPLE",LG:"LG",SAMSUNG:"SAMSUNG",TIZEN_LICENSED:"TIZENLICENSED",MICROSOFT:"MICROSOFT",AMAZON:"AMAZON",HKMC:"HKMC",SONY:"SONY",PHILIPS:"PHILIPS",GOOGLE:"GOOGLE",NVIDIA:"NVIDIA",XIAOMI:"XIAOMI",TVISION:"TVISION",UNKNOWN:""},window.Ragnarok.IsFeatureSupported=_u,window.Ragnarok.CalculateMaxBitrateKbps=function(e,t,i){return Xs(e,t,i)[0]},window.Ragnarok.CalculateDataUsage=function(e,t){return Uu(e,t)},window.Ragnarok.AuthType=uA,window.Ragnarok.LogImpl=hA,window.Ragnarok.performHttpRequest=fA,window.Ragnarok.PayloadOSType=pA,window.Ragnarok.PayloadBrowserType=vA,window.Ragnarok.PayloadDeviceType=gA,window.Ragnarok.ClientHeaderOSType=mA,window.Ragnarok.ClientHeaderBrowserType=AA,window.Ragnarok.ClientHeaderDeviceType=SA,window.Ragnarok.SdrHdrMode=yA,window.Ragnarok.BitDepth=bA,window.Ragnarok.NetworkType=EA,window.Ragnarok.PlatformName=wA,window.Ragnarok.BrowserName=CA,window.Ragnarok.translatePlatformDetailsForPayload=IA,window.Ragnarok.translatePlatformDetailsForClientHeader=TA,window.Ragnarok.EVENTS={SESSION_START_RESULT:"SessionStartResult",SESSION_STOP_RESULT:"SessionStopResult",ACTIVE_SESSIONS_RESULT:"ActiveSessionsResult",PROGRESS_UPDATE:"ProgressUpdate",SESSION_UPDATE:"SessionUpdate",STREAM_STOPPED:"StreamStopped",STREAMING_EVENT:"StreamingEvent",GETSESSIONRESULT:"GetSessionResult",GET_SESSION_RESULT:"GetSessionResult",LOG_EVENT:"Log",STREAMING_QUALITY:"StreamingQuality",MIC_CAPTURE:"MicCapture",CUSTOM_MESSAGE:"CustomMessage",TEXT_COMPOSITION:"TextComposition",STREAM_STATS_UPDATE:"StreamStatsUpdate",TELEMETRY_EVENT:"TelemetryEvent",STREAM_QUALITY_REPORT:"StreamQualityReport"},window.Ragnarok.HotkeyModifier={None:0,Ctrl:1,Alt:2,Meta:4,Shift:8,Default:128},window.Ragnarok.defaultInputConfigFlags=ot,window.Ragnarok.StreamingProfilePreset={BALANCED:0,DATASAVER:1,COMPETITIVE:2},window.Ragnarok.TrackType=we,window.Ragnarok.STREAMING_STATE={RECONNECTING:"reconnecting",RECONNECTED:"reconnected"},window.Ragnarok.RNotificationCode=qe,window.Ragnarok.ClientType={BROWSER:"BROWSER",GFNSDK:"GFNSDK",NATIVE:"NATIVE"},window.Ragnarok.SessionState={INITIALIZING:"initializing",READY_FOR_CONNECTION:"ready_for_connection",STREAMING:"streaming",PAUSED:"paused",RESUMING:"resuming",FINISHED:"finished",UNKNOWN:"unknown"},window.Ragnarok.SessionProgressState={CONNECTING:"Connecting",IN_QUEUE:"InQueue",CONFIGURING:"Configuring",PREVIOUS_SESSION_CLEANUP:"PreviousSessionCleanup",STARTING_STREAMER:"StartingStreamer"},window.Ragnarok.AppLaunchMode={Default:0,GamepadFriendly:1,TouchFriendly:2},window.Ragnarok.createSessionControl=function(e){const t=new bs;if(t.init(e))return t;throw Error("Session Control initialization failure.")},window.Ragnarok.Usage={UNKNOWN:0,CONTROL:1,VIDEO:2,AUDIO:3,INPUT:4,CUSTOM:5,USB:6,RTSP:7,GAMESTREAM_CONTROL:8,GAMESTREAM_SECURE_CONTROL:9,SESSION_CONTROL:10,NETWORK_TEST_CONTROL:11,RTSPRU:12,AUDIO_INPUT:13,SIGNALING:14,MEDIA:15,RTSPS:16,BUNDLE:17},window.Ragnarok.Protocol={UNKNOWN:0,TCP:1,UDP:2},window.Ragnarok.AppLevelProtocol={UNKNOWN:0,RTSP:1,HTTP:2,RTSPRU:3,SOCKET:4,HTTPS:5,RTSPS:6},window.Ragnarok.AdState={UNKNOWN:0,NOT_STARTED:1,STARTED:2,PAUSED:3,RESUMED:4,FINISHED:5,CANCELED:6},window.Ragnarok.AdAction={UNKNOWN:0,START:1,PAUSE:2,RESUME:3,FINISH:4,CANCEL:5},window.Ragnarok.updateSessionParameters=function(e,t){var i;t=JSON.parse(t),e.monitorSettings=(i=t.clientRequestMonitorSettings)!==null&&i!==void 0?i:[],e.streamingFeatures=t.requestedStreamingFeatures},window.Ragnarok.isResumableSessionState=ps,window.Ragnarok.getResumableSession=function(e,t){for(const i of e)if(i.appId===t&&ps(i.state))return i},window.Ragnarok.isCancelCode=ar,window.Ragnarok.ScErrorCode=Es,window.Ragnarok.configureSessionControlSettings=$e,window.Ragnarok.GsErrorCode=Es,window.Ragnarok.GridServerSettings=De,window.Ragnarok.ConfigureGridServerSettings=function(e){$e(e)},window.Ragnarok.getPlatformDetails=an,window.Ragnarok.LogLevel=re,window.Ragnarok.CLIENT_VERSION="29.0",window.Ragnarok.CLIENT_IDENTIFICATION="GFN-PC",window.Ragnarok.SESSIONMODIFY_ACTION={UNKNOWN:0,PAUSE:1,RESUME:2,Fg:3,Eg:4,Dg:5,Cg:6,Gg:7},window.Ragnarok.AudioFormat={UNKNOWN:0,STEREO:1,UP_TO_5_1_SURROUND_PCM:2,UP_TO_7_1_SURROUND_PCM:3},window.Ragnarok.ClientStreamer={CLASSIC:"NVIDIA-CLASSIC",WEBRTC:"WEBRTC"},window.Ragnarok.GS_EVENTS={ACTIVE_SESSIONS_RESULT:"ActiveSessionsResult",PROGRESS_UPDATE:"ProgressUpdate",SESSION_UPDATE:"SessionUpdate",TELEMETRY_EVENT:"TelemetryEvent",LOG_EVENT:"Log"},window.Ragnarok.GridServer=X,window.Ragnarok.PassThruServer=U,window.Ragnarok.RErrorCode={Success:15859712,AuthProviderError:3237085185,InvalidOperation:3237085186,NoNetwork:3237089281,NetworkError:3237089282,GetActiveSessionServerError:3237089283,ExceptionHappened:3237089284,AuthTokenNotUpdated:3237093377,SessionFinishedState:3237093378,ResponseParseFailure:3237093379,GridAppNotInitialized:3237093380,InvalidServerResponse:3237093381,PutOrPostInProgress:3237093382,GridServerNotInitialized:3237093383,DOMExceptionInGridServer:3237093384,InvalidAdStateTransition:3237093386,SessionServerErrorBegin:3237093632,RequestForbidden:3237093634,ServerInternalTimeout:3237093635,ServerInternalError:3237093636,ServerInvalidRequest:3237093637,ServerInvalidRequestVersion:3237093638,SessionListLimitExceeded:3237093639,InvalidRequestDataMalformed:3237093640,InvalidRequestDataMissing:3237093641,RequestLimitExceeded:3237093642,SessionLimitExceeded:3237093643,InvalidRequestVersionOutOfDate:3237093644,SessionEntitledTimeExceeded:3237093645,AuthFailure:3237093646,InvalidAuthenticationMalformed:3237093647,InvalidAuthenticationExpired:3237093648,InvalidAuthenticationNotFound:3237093649,EntitlementFailure:3237093650,InvalidAppIdNotAvailable:3237093651,InvalidAppIdNotFound:3237093652,InvalidSessionIdMalformed:3237093653,InvalidSessionIdNotFound:3237093654,EulaUnAccepted:3237093655,MaintenanceStatus:3237093656,ServiceUnAvailable:3237093657,SteamGuardRequired:3237093658,SteamLoginRequired:3237093659,SteamGuardInvalid:3237093660,SteamProfilePrivate:3237093661,InvalidCountryCode:3237093662,InvalidLanguageCode:3237093663,MissingCountryCode:3237093664,MissingLanguageCode:3237093665,SessionNotPaused:3237093666,EmailNotVerified:3237093667,InvalidAuthenticationUnsupportedProtocol:3237093668,InvalidAuthenticationUnknownToken:3237093669,InvalidAuthenticationCredentials:3237093670,SessionNotPlaying:3237093671,InvalidServiceResponse:3237093672,AppPatching:3237093673,GameNotFound:3237093674,NotEnoughCredits:3237093675,InvitationOnlyRegistration:3237093676,RegionNotSupportedForRegistration:3237093677,SessionTerminatedByAnotherClient:3237093678,DeviceIdAlreadyUsed:3237093679,ServiceNotExist:3237093680,SessionExpired:3237093681,SessionLimitPerDeviceReached:3237093682,ForwardingZoneOutOfCapacity:3237093683,RegionNotSupportedIndefinitely:3237093684,RegionBanned:3237093685,RegionOnHoldForFree:3237093686,RegionOnHoldForPaid:3237093687,AppMaintenanceStatus:3237093688,ResourcePoolNotConfigured:3237093689,InsufficientVmCapacity:3237093690,InsufficientRouteCapacity:3237093691,InsufficientScratchSpaceCapacity:3237093692,RequiredSeatInstanceTypeNotSupported:3237093693,ServerSessionQueueLengthExceeded:3237093694,RegionNotSupportedForStreaming:3237093695,SessionForwardRequestAllocationTimeExpired:3237093696,SessionForwardGameBinariesNotAvailable:3237093697,GameBinariesNotAvailableInRegion:3237093698,UekRetrievalFailed:3237093699,EntitlementFailureForResource:3237093700,SessionInQueueAbandoned:3237093701,MemberTerminated:3237093702,SessionRemovedFromQueueMaintenance:3237093703,ZoneMaintenanceStatus:3237093704,GuestModeCampaignDisabled:3237093705,RegionNotSupportedAnonymousAccess:3237093706,InstanceTypeNotSupportedInSingleRegion:3237093707,InvalidZoneForQueuedSession:3237093710,SessionWaitingAdsTimeExpired:3237093711,UserCancelledWatchingAds:3237093712,StreamingNotAllowedInLimitedMode:3237093713,ForwardRequestJPMFailed:3237093714,MaxSessionNumberLimitExceeded:3237093715,GuestModePartnerCapacityDisabled:3237093716,SessionRejectedNoCapacity:3237093717,SessionInsufficientPlayabilityLevel:3237093718,SessionServerErrorEnd:3237093887,StreamerErrorCategory:3237093888,StreamErrorGeneric:3237093889,StreamerSignInFailure:3237093890,StreamerHangingGetFailure:3237093891,StreamerNetworkError:3237093892,StreamerVideoPlayError:3237093893,StreamerIceConnectionFailed:3237093894,StreamerGetRemotePeerTimedOut:3237093895,StreamInputChannelError:3237093896,StreamCursorChannelError:3237093897,StreamControlChannelError:3237093898,StreamerReConnectionFailed:3237093899,StreamerNoVideoPacketsReceivedEver:3237093900,StreamerNoVideoFramesLossyNetwork:3237093901,StreamerSetSDPFailure:3237093902,StreamerNoLocalCandidates:3237093903,StreamerNoRemoteCandidates:3237093904,StreamerNoVideoTrack:3237093905,StreamerIceReConnectionFailed:3237093906,StreamerSignInTimeout:3237093907,StreamerSignInWorkerFailure:3237093908,StreamerNoTracksReceivedInSdp:3237093909,StreamerNvstSdpFailure:3237093910,StreamerNvstSdpParseFailure:3237093911,StreamerNoPeerInfo:3237093912,StreamerNoOffer:3237093913,StreamerNoAudioTrack:3237093914,StreamerInvalidRemoteConfigOverride:3237093915,StreamerInvalidServerOverride:3237093916,StreamerInvalidClientOverride:3237093917,StreamerConfigUpdateFailure:3237093918,StreamerInputChannelNotOpen:3237093919,StreamerCursorChannelNotOpen:3237093920,StreamerControlChannelNotOpen:3237093921,StreamerVideoAdapterInitTimeOut:3237093922,StreamerVideoFrameProviderInitTimeOut:3237093923,StreamerVideoEncoderInitTimeOut:3237093924,StreamerVideoSetupTimeOut:3237093925,StreamerNoStunResponsesReceived:3237093926,StreamerNoNominatedCandidatePairs:3237093927,StreamerNoSucceededCandidatePairs:3237093928,StreamPartiallyReliableInputChannelError:3237093929,StreamerPartiallyReliableInputChannelNotOpen:3237093936,StreamerNeedAudioElement:3237093937,SessionSetupCancelled:15867905,SessionSetupCancelledDuringQueuing:15867906,StreamerDataChannelClosing:15867907,SystemSleepDuringStreaming:15867908,SystemSleepDuringSessionSetup:15867909,PauseSession:15867910,DelayedSessionError:15867911,WebPageClosed:15867912,ClientDisconnectedUserIdle:15867913,UnhandledException:3237093392,NoInternetDuringSessionSetup:15868417,NoInternetDuringStreaming:15868418,StreamDisconnectedFromServer:15868672,ServerDisconnectedNoResponse:3237094145,ServerDisconnectedRemoteInputError:3237094146,ServerDisconnectedFrameGrabFailed:3237094147,ServerDisconnectedConfigUnAvailable:3237094148,ServerDisconnectedInvalidCommand:3237094149,ServerDisconnectedInvalidMouseState:3237094150,ServerDisconnectedNetworkError:3237094151,ServerDisconnectedGameLaunchFailed:3237094152,ServerDisconnectedVideoFirstFrameSendFailed:3237094153,ServerDisconnectedVideoNextFrameSendFailed:3237094154,ServerDisconnectedFrameGrabTimedOut:3237094155,ServerDisconnectedFrameEncodeTimedOut:3237094156,ServerDisconnectedFrameSendTimedOut:3237094157,ServerDisconnectedNetworkTimedOut:3237094158,ServerDisconnectedPeerRemovedByServer:3237094159,ServerDisconnectedUnknownError:3237094160,ServerDisconnectedPeerRemovedBeforeStream:3237094161,ServerDisconnectedIntended:15868704,ServerDisconnectedHotKey:15868705,ServerDisconnectedUserLoggedInDifferentAccount:15868706,ServerDisconnectedWindowedMode:15868707,ServerDisconnectedUserIdle:15868708,ServerDisconnectedUnAuthorizedProcessDetected:15868709,ServerDisconnectedMaliciousProcessDetected:15868710,ServerDisconnectedUnKnownProcessDetected:15868711,ServerDisconnectedMinerProcessDetected:15868712,ServerDisconnectedStreamingUnsupported:15868713,ServerDisconnectedAnotherClient:15868714,ServerDisconnectedCodeIntegrityViolation:15868715,ServerDisconnectedUnauthorizedActivityDetected:15868716,ServerDisconnectedGameNotOwnedByUser:15868717,ServerDisconnectedProtectedContent:15868718,ServerDisconnectedDisplayTopologyChanged:15868719,ServerDisconnectedAbruptly:15868688,ServerDisconnectedUnknownFromPm:15868736,ServerDisconnectedUserEntitledMinutesExceeded:15868737,ServerDisconnectedClientReconnectTimeLimitExceeded:15868738,ServerDisconnectedOperatorCommandedTermination:15868739,ServerDisconnectedConcurrentSessionLimitExceeded:15868740,ServerDisconnectedMaxSessionTimeLimitExceeded:15868741,ServerDisconnectedBifrostInitiatedSessionPause:15868742,ServerDisconnectedSystemCommandTermination:15868743,ServerDisconnectedMultipleLogin:15868744,ServerDisconnectedMaintenanceMode:15868745,ServerDisconnectedMultipleTab:15868752,InvalidVideoElement:3237094400,InvalidAudioElement:3237094401,WebSocketClosed:3237097472,WebSocketNormalClosure:3237101567,WebSocketGoingAway:3237101566,WebSocketProtocolError:3237101565,WebSocketUnsupportedData:3237101564,WebSocketNoStatusRcvd:3237101562,WebSocketInvalidFramePayloadData:3237101560,WebSocketPolicyViolation:3237101559,WebSocketMessageTooBig:3237101558,WebSocketMandatoryExt:3237101557,WebSocketInternalError:3237101556,WebSocketServiceRestart:3237101555,WebSocketTryAgainLater:3237101554,WebSocketBadGateway:3237101553,WebSocketTLSHandshakeFailure:3237101552,WebSocketUnauthorized:3237101551,WebSocketForbidden:3237101550,WebSocketTimeout:3237101549},window.Ragnarok.VsyncType={OFF:0,ON:1,ADAPTIVE:2},window.Ragnarok.getDeviceCapabilities=ju,window.Ragnarok.serializeDeviceCapabilities=function(e){return JSON.stringify(e)},window.Ragnarok.prefetchDeviceCapabilities=function(){var e=Qi;e.C||(e.C=!0,r0(e),Vu(e),Hu(e))},window.Ragnarok.registerDeviceCapabilitiesChanged=function(e){var t=Qi;if(t.h.push(e),0<t.h.length){var i;e=window.screen,(i=e.addEventListener)===null||i===void 0||i.call(e,"change",t.j),window.addEventListener("focus",t.j),window.addEventListener("resize",t.j)}},window.Ragnarok.unregisterDeviceCapabilitiesChanged=function(e){o0(e)},window.Ragnarok.decodeWsErrorCodes=function(e){switch(e){case 3237101567:return 1e3;case 3237101566:return 1001;case 3237101565:return 1002;case 3237101564:return 1003;case 3237101562:return 1005;case 3237093890:return 1006;case 3237101560:return 1007;case 3237101559:return 1008;case 3237101558:return 1009;case 3237101557:return 1010;case 3237101556:return 1011;case 3237101555:return 1012;case 3237101554:return 1013;case 3237101553:return 1014;case 3237101552:return 1015;case 3237101551:return 3e3;case 3237101550:return 3003;case 3237101549:return 3008}if(3237097472<=e&&3237101567>=e)return e-3237097472+4e3},window.Ragnarok.getStreamerType=function(){return"WEBRTC"},window.Ragnarok.BrowserFeature={Streaming:0,MicCapture:1},window.Ragnarok.isFeatureSupported=_u,window.Ragnarok.shouldDefaultEnableMic=Fu,window.Ragnarok.getRecommendedBitrate=Xs,window.Ragnarok.getStreamStartParameters=function(e){e=JSON.parse(e);const t={downstreamParams:[],signalConnectionInfo:{address:"",port:0},enableTouchInput:e.appLaunchMode===2,sessionId:e.sessionId,subSessionId:e.subSessionId,audioTagId:"",zoneAddress:e.zoneAddress,statTelemetryInfo:{appId:e.appId,zoneName:e.zoneName,gpuType:e.gpuType},streamingFeatures:e.finalizedStreamingFeatures};for(const i of e.monitorSettings)t.downstreamParams.push({width:i.widthInPixels,height:i.heightInPixels,fps:i.framesPerSecond,videoTagId:"",sdrHdrMode:i.sdrHdrMode});for(const i of e.connectionInfo)switch(i.usage){case 14:t.signalConnectionInfo.address=i.ip,t.signalConnectionInfo.port=i.port,t.signalConnectionInfo.secure=i.appLevelProtocol===5,t.signalConnectionInfo.resourcePath=i.resourcePath;break;case 2:case 17:t.mediaConnectionInfo={address:i.ip,port:i.port}}return t},window.Ragnarok.estimateDataUsage=Uu,window.Ragnarok.createNskStreamClient=function(e,t,i){return new DA(e,t,i)},window.Ragnarok.configureStreamKitSettings=fl,window.Ragnarok.getNetworkTypeDetector=function(){return Oi},window.Ragnarok.HidType={NONE:0,DS4:1,DS5:2},window.Ragnarok.InputType={None:0,Mouse:1,Keyboard:2,Gamepad:4,Touch:8,All:15},window.Ragnarok.VideoCodecType={H264:"H264",H265:"H265",AV1:"AV1",UNKNOWN:"UNKNOWN"},window.Ragnarok.MicState={UNINITIALIZED:0,PERMISSION_PENDING:1,PERMISSION_DENIED:2,STARTED:3,NO_SUITABLE_DEVICE:4,STOPPED:5,UNSUPPORTED:6,ERROR:7},window.Ragnarok.DynamicStreamingMode={NONE:0,DRC:1,DFC:2,ALL:3},window.Ragnarok.MediaTrackKind=we,window.Ragnarok.StreamStopReason={CLIENT_DISCONNECTED:0,SERVER_DISCONNECTED:1,NETWORK_ERROR:2,ERROR:3},window.Ragnarok.StreamWarningType=qe,window.Ragnarok.CursorType={SOFTWARE:0,HARDWARE:1,FREE:2},window.Ragnarok.StreamingState={NONE:0,STARTING_STREAM:1,STREAMING:2,STOPPING_STREAM:3,STOPPED:4}},134:(C,w,S)=>{var m=S(985);function A(R){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[R.type]||R.type}function H(R,B,Y,se,ve){var J=m.writeRtpDescription(R.kind,B);if(J+=m.writeIceParameters(R.iceGatherer.getLocalParameters()),J+=m.writeDtlsParameters(R.dtlsTransport.getLocalParameters(),Y==="offer"?"actpass":ve||"active"),J+="a=mid:"+R.mid+`\r
`,R.rtpSender&&R.rtpReceiver?J+=`a=sendrecv\r
`:R.rtpSender?J+=`a=sendonly\r
`:R.rtpReceiver?J+=`a=recvonly\r
`:J+=`a=inactive\r
`,R.rtpSender){var fe=R.rtpSender._initialTrackId||R.rtpSender.track.id;R.rtpSender._initialTrackId=fe;var le="msid:"+(se?se.id:"-")+" "+fe+`\r
`;J+="a="+le,J+="a=ssrc:"+R.sendEncodingParameters[0].ssrc+" "+le,R.sendEncodingParameters[0].rtx&&(J+="a=ssrc:"+R.sendEncodingParameters[0].rtx.ssrc+" "+le,J+="a=ssrc-group:FID "+R.sendEncodingParameters[0].ssrc+" "+R.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return J+="a=ssrc:"+R.sendEncodingParameters[0].ssrc+" cname:"+m.localCName+`\r
`,R.rtpSender&&R.sendEncodingParameters[0].rtx&&(J+="a=ssrc:"+R.sendEncodingParameters[0].rtx.ssrc+" cname:"+m.localCName+`\r
`),J}function _(R,B){var Y=!1;return R=JSON.parse(JSON.stringify(R)),R.filter(function(se){if(se&&(se.urls||se.url)){var ve=se.urls||se.url;se.url&&!se.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var J=typeof ve=="string";return J&&(ve=[ve]),ve=ve.filter(function(fe){var le=fe.indexOf("turn:")===0&&fe.indexOf("transport=udp")!==-1&&fe.indexOf("turn:[")===-1&&!Y;return le?(Y=!0,!0):fe.indexOf("stun:")===0&&B>=14393&&fe.indexOf("?transport=udp")===-1}),delete se.url,se.urls=J?ve[0]:ve,!!ve.length}})}function V(R,B){var Y={codecs:[],headerExtensions:[],fecMechanisms:[]},se=function(J,fe){J=parseInt(J,10);for(var le=0;le<fe.length;le++)if(fe[le].payloadType===J||fe[le].preferredPayloadType===J)return fe[le]},ve=function(J,fe,le,T){var L=se(J.parameters.apt,le),K=se(fe.parameters.apt,T);return L&&K&&L.name.toLowerCase()===K.name.toLowerCase()};return R.codecs.forEach(function(J){for(var fe=0;fe<B.codecs.length;fe++){var le=B.codecs[fe];if(J.name.toLowerCase()===le.name.toLowerCase()&&J.clockRate===le.clockRate){if(J.name.toLowerCase()==="rtx"&&J.parameters&&le.parameters.apt&&!ve(J,le,R.codecs,B.codecs))continue;le=JSON.parse(JSON.stringify(le)),le.numChannels=Math.min(J.numChannels,le.numChannels),Y.codecs.push(le),le.rtcpFeedback=le.rtcpFeedback.filter(function(T){for(var L=0;L<J.rtcpFeedback.length;L++)if(J.rtcpFeedback[L].type===T.type&&J.rtcpFeedback[L].parameter===T.parameter)return!0;return!1});break}}}),R.headerExtensions.forEach(function(J){for(var fe=0;fe<B.headerExtensions.length;fe++){var le=B.headerExtensions[fe];if(J.uri===le.uri){Y.headerExtensions.push(le);break}}}),Y}function ie(R,B,Y){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[B][R].indexOf(Y)!==-1}function x(R,B){var Y=R.getRemoteCandidates().find(function(se){return B.foundation===se.foundation&&B.ip===se.ip&&B.port===se.port&&B.priority===se.priority&&B.protocol===se.protocol&&B.type===se.type});return Y||R.addRemoteCandidate(B),!Y}function F(R,B){var Y=new Error(B);return Y.name=R,Y.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[R],Y}C.exports=function(R,B){function Y(T,L){L.addTrack(T),L.dispatchEvent(new R.MediaStreamTrackEvent("addtrack",{track:T}))}function se(T,L){L.removeTrack(T),L.dispatchEvent(new R.MediaStreamTrackEvent("removetrack",{track:T}))}function ve(T,L,K,$){var ae=new Event("track");ae.track=L,ae.receiver=K,ae.transceiver={receiver:K},ae.streams=$,R.setTimeout(function(){T._dispatchEvent("track",ae)})}var J=function(T){var L=this,K=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(ae){L[ae]=K[ae].bind(K)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",T=JSON.parse(JSON.stringify(T||{})),this.usingBundle=T.bundlePolicy==="max-bundle",T.rtcpMuxPolicy==="negotiate")throw F("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(T.rtcpMuxPolicy||(T.rtcpMuxPolicy="require"),T.iceTransportPolicy){case"all":case"relay":break;default:T.iceTransportPolicy="all";break}switch(T.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:T.bundlePolicy="balanced";break}if(T.iceServers=_(T.iceServers||[],B),this._iceGatherers=[],T.iceCandidatePoolSize)for(var $=T.iceCandidatePoolSize;$>0;$--)this._iceGatherers.push(new R.RTCIceGatherer({iceServers:T.iceServers,gatherPolicy:T.iceTransportPolicy}));else T.iceCandidatePoolSize=0;this._config=T,this.transceivers=[],this._sdpSessionId=m.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(J.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(J.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),J.prototype.onicecandidate=null,J.prototype.onaddstream=null,J.prototype.ontrack=null,J.prototype.onremovestream=null,J.prototype.onsignalingstatechange=null,J.prototype.oniceconnectionstatechange=null,J.prototype.onconnectionstatechange=null,J.prototype.onicegatheringstatechange=null,J.prototype.onnegotiationneeded=null,J.prototype.ondatachannel=null,J.prototype._dispatchEvent=function(T,L){this._isClosed||(this.dispatchEvent(L),typeof this["on"+T]=="function"&&this["on"+T](L))},J.prototype._emitGatheringStateChange=function(){var T=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",T)},J.prototype.getConfiguration=function(){return this._config},J.prototype.getLocalStreams=function(){return this.localStreams},J.prototype.getRemoteStreams=function(){return this.remoteStreams},J.prototype._createTransceiver=function(T,L){var K=this.transceivers.length>0,$={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:T,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&K)$.iceTransport=this.transceivers[0].iceTransport,$.dtlsTransport=this.transceivers[0].dtlsTransport;else{var ae=this._createIceAndDtlsTransports();$.iceTransport=ae.iceTransport,$.dtlsTransport=ae.dtlsTransport}return L||this.transceivers.push($),$},J.prototype.addTrack=function(T,L){if(this._isClosed)throw F("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var K=this.transceivers.find(function(Se){return Se.track===T});if(K)throw F("InvalidAccessError","Track already exists.");for(var $,ae=0;ae<this.transceivers.length;ae++)!this.transceivers[ae].track&&this.transceivers[ae].kind===T.kind&&($=this.transceivers[ae]);return $||($=this._createTransceiver(T.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(L)===-1&&this.localStreams.push(L),$.track=T,$.stream=L,$.rtpSender=new R.RTCRtpSender(T,$.dtlsTransport),$.rtpSender},J.prototype.addStream=function(T){var L=this;if(B>=15025)T.getTracks().forEach(function($){L.addTrack($,T)});else{var K=T.clone();T.getTracks().forEach(function($,ae){var Se=K.getTracks()[ae];$.addEventListener("enabled",function(ue){Se.enabled=ue.enabled})}),K.getTracks().forEach(function($){L.addTrack($,K)})}},J.prototype.removeTrack=function(T){if(this._isClosed)throw F("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(T instanceof R.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var L=this.transceivers.find(function(ae){return ae.rtpSender===T});if(!L)throw F("InvalidAccessError","Sender was not created by this connection.");var K=L.stream;L.rtpSender.stop(),L.rtpSender=null,L.track=null,L.stream=null;var $=this.transceivers.map(function(ae){return ae.stream});$.indexOf(K)===-1&&this.localStreams.indexOf(K)>-1&&this.localStreams.splice(this.localStreams.indexOf(K),1),this._maybeFireNegotiationNeeded()},J.prototype.removeStream=function(T){var L=this;T.getTracks().forEach(function(K){var $=L.getSenders().find(function(ae){return ae.track===K});$&&L.removeTrack($)})},J.prototype.getSenders=function(){return this.transceivers.filter(function(T){return!!T.rtpSender}).map(function(T){return T.rtpSender})},J.prototype.getReceivers=function(){return this.transceivers.filter(function(T){return!!T.rtpReceiver}).map(function(T){return T.rtpReceiver})},J.prototype._createIceGatherer=function(T,L){var K=this;if(L&&T>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var $=new R.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty($,"state",{value:"new",writable:!0}),this.transceivers[T].bufferedCandidateEvents=[],this.transceivers[T].bufferCandidates=function(ae){var Se=!ae.candidate||Object.keys(ae.candidate).length===0;$.state=Se?"completed":"gathering",K.transceivers[T].bufferedCandidateEvents!==null&&K.transceivers[T].bufferedCandidateEvents.push(ae)},$.addEventListener("localcandidate",this.transceivers[T].bufferCandidates),$},J.prototype._gather=function(T,L){var K=this,$=this.transceivers[L].iceGatherer;if(!$.onlocalcandidate){var ae=this.transceivers[L].bufferedCandidateEvents;this.transceivers[L].bufferedCandidateEvents=null,$.removeEventListener("localcandidate",this.transceivers[L].bufferCandidates),$.onlocalcandidate=function(Se){if(!(K.usingBundle&&L>0)){var ue=new Event("icecandidate");ue.candidate={sdpMid:T,sdpMLineIndex:L};var Ee=Se.candidate,Ce=!Ee||Object.keys(Ee).length===0;if(Ce)($.state==="new"||$.state==="gathering")&&($.state="completed");else{$.state==="new"&&($.state="gathering"),Ee.component=1,Ee.ufrag=$.getLocalParameters().usernameFragment;var ge=m.writeCandidate(Ee);ue.candidate=Object.assign(ue.candidate,m.parseCandidate(ge)),ue.candidate.candidate=ge,ue.candidate.toJSON=function(){return{candidate:ue.candidate.candidate,sdpMid:ue.candidate.sdpMid,sdpMLineIndex:ue.candidate.sdpMLineIndex,usernameFragment:ue.candidate.usernameFragment}}}var pe=m.getMediaSections(K._localDescription.sdp);Ce?pe[ue.candidate.sdpMLineIndex]+=`a=end-of-candidates\r
`:pe[ue.candidate.sdpMLineIndex]+="a="+ue.candidate.candidate+`\r
`,K._localDescription.sdp=m.getDescription(K._localDescription.sdp)+pe.join("");var Ue=K.transceivers.every(function(_e){return _e.iceGatherer&&_e.iceGatherer.state==="completed"});K.iceGatheringState!=="gathering"&&(K.iceGatheringState="gathering",K._emitGatheringStateChange()),Ce||K._dispatchEvent("icecandidate",ue),Ue&&(K._dispatchEvent("icecandidate",new Event("icecandidate")),K.iceGatheringState="complete",K._emitGatheringStateChange())}},R.setTimeout(function(){ae.forEach(function(Se){$.onlocalcandidate(Se)})},0)}},J.prototype._createIceAndDtlsTransports=function(){var T=this,L=new R.RTCIceTransport(null);L.onicestatechange=function(){T._updateIceConnectionState(),T._updateConnectionState()};var K=new R.RTCDtlsTransport(L);return K.ondtlsstatechange=function(){T._updateConnectionState()},K.onerror=function(){Object.defineProperty(K,"state",{value:"failed",writable:!0}),T._updateConnectionState()},{iceTransport:L,dtlsTransport:K}},J.prototype._disposeIceAndDtlsTransports=function(T){var L=this.transceivers[T].iceGatherer;L&&(delete L.onlocalcandidate,delete this.transceivers[T].iceGatherer);var K=this.transceivers[T].iceTransport;K&&(delete K.onicestatechange,delete this.transceivers[T].iceTransport);var $=this.transceivers[T].dtlsTransport;$&&(delete $.ondtlsstatechange,delete $.onerror,delete this.transceivers[T].dtlsTransport)},J.prototype._transceive=function(T,L,K){var $=V(T.localCapabilities,T.remoteCapabilities);L&&T.rtpSender&&($.encodings=T.sendEncodingParameters,$.rtcp={cname:m.localCName,compound:T.rtcpParameters.compound},T.recvEncodingParameters.length&&($.rtcp.ssrc=T.recvEncodingParameters[0].ssrc),T.rtpSender.send($)),K&&T.rtpReceiver&&$.codecs.length>0&&(T.kind==="video"&&T.recvEncodingParameters&&B<15019&&T.recvEncodingParameters.forEach(function(ae){delete ae.rtx}),T.recvEncodingParameters.length?$.encodings=T.recvEncodingParameters:$.encodings=[{}],$.rtcp={compound:T.rtcpParameters.compound},T.rtcpParameters.cname&&($.rtcp.cname=T.rtcpParameters.cname),T.sendEncodingParameters.length&&($.rtcp.ssrc=T.sendEncodingParameters[0].ssrc),T.rtpReceiver.receive($))},J.prototype.setLocalDescription=function(T){var L=this;if(["offer","answer"].indexOf(T.type)===-1)return Promise.reject(F("TypeError",'Unsupported type "'+T.type+'"'));if(!ie("setLocalDescription",T.type,L.signalingState)||L._isClosed)return Promise.reject(F("InvalidStateError","Can not set local "+T.type+" in state "+L.signalingState));var K,$;if(T.type==="offer")K=m.splitSections(T.sdp),$=K.shift(),K.forEach(function(Se,ue){var Ee=m.parseRtpParameters(Se);L.transceivers[ue].localCapabilities=Ee}),L.transceivers.forEach(function(Se,ue){L._gather(Se.mid,ue)});else if(T.type==="answer"){K=m.splitSections(L._remoteDescription.sdp),$=K.shift();var ae=m.matchPrefix($,"a=ice-lite").length>0;K.forEach(function(Se,ue){var Ee=L.transceivers[ue],Ce=Ee.iceGatherer,ge=Ee.iceTransport,pe=Ee.dtlsTransport,Ue=Ee.localCapabilities,_e=Ee.remoteCapabilities,Fe=m.isRejected(Se)&&m.matchPrefix(Se,"a=bundle-only").length===0;if(!Fe&&!Ee.rejected){var He=m.getIceParameters(Se,$),Ne=m.getDtlsParameters(Se,$);ae&&(Ne.role="server"),(!L.usingBundle||ue===0)&&(L._gather(Ee.mid,ue),ge.state==="new"&&ge.start(Ce,He,ae?"controlling":"controlled"),pe.state==="new"&&pe.start(Ne));var je=V(Ue,_e);L._transceive(Ee,je.codecs.length>0,!1)}})}return L._localDescription={type:T.type,sdp:T.sdp},T.type==="offer"?L._updateSignalingState("have-local-offer"):L._updateSignalingState("stable"),Promise.resolve()},J.prototype.setRemoteDescription=function(T){var L=this;if(["offer","answer"].indexOf(T.type)===-1)return Promise.reject(F("TypeError",'Unsupported type "'+T.type+'"'));if(!ie("setRemoteDescription",T.type,L.signalingState)||L._isClosed)return Promise.reject(F("InvalidStateError","Can not set remote "+T.type+" in state "+L.signalingState));var K={};L.remoteStreams.forEach(function(ge){K[ge.id]=ge});var $=[],ae=m.splitSections(T.sdp),Se=ae.shift(),ue=m.matchPrefix(Se,"a=ice-lite").length>0,Ee=m.matchPrefix(Se,"a=group:BUNDLE ").length>0;L.usingBundle=Ee;var Ce=m.matchPrefix(Se,"a=ice-options:")[0];return Ce?L.canTrickleIceCandidates=Ce.substr(14).split(" ").indexOf("trickle")>=0:L.canTrickleIceCandidates=!1,ae.forEach(function(ge,pe){var Ue=m.splitLines(ge),_e=m.getKind(ge),Fe=m.isRejected(ge)&&m.matchPrefix(ge,"a=bundle-only").length===0,He=Ue[0].substr(2).split(" ")[2],Ne=m.getDirection(ge,Se),je=m.parseMsid(ge),rt=m.getMid(ge)||m.generateIdentifier();if(Fe||_e==="application"&&(He==="DTLS/SCTP"||He==="UDP/DTLS/SCTP")){L.transceivers[pe]={mid:rt,kind:_e,protocol:He,rejected:!0};return}!Fe&&L.transceivers[pe]&&L.transceivers[pe].rejected&&(L.transceivers[pe]=L._createTransceiver(_e,!0));var Pe,ht,ct,Ve,Xe,St,lt,We,Ye,ze=m.parseRtpParameters(ge),qt,Ft;Fe||(qt=m.getIceParameters(ge,Se),Ft=m.getDtlsParameters(ge,Se),Ft.role="client"),lt=m.parseRtpEncodingParameters(ge);var ri=m.parseRtcpParameters(ge),Mi=m.matchPrefix(ge,"a=end-of-candidates",Se).length>0,Jt=m.matchPrefix(ge,"a=candidate:").map(function(ut){return m.parseCandidate(ut)}).filter(function(ut){return ut.component===1});if((T.type==="offer"||T.type==="answer")&&!Fe&&Ee&&pe>0&&L.transceivers[pe]&&(L._disposeIceAndDtlsTransports(pe),L.transceivers[pe].iceGatherer=L.transceivers[0].iceGatherer,L.transceivers[pe].iceTransport=L.transceivers[0].iceTransport,L.transceivers[pe].dtlsTransport=L.transceivers[0].dtlsTransport,L.transceivers[pe].rtpSender&&L.transceivers[pe].rtpSender.setTransport(L.transceivers[0].dtlsTransport),L.transceivers[pe].rtpReceiver&&L.transceivers[pe].rtpReceiver.setTransport(L.transceivers[0].dtlsTransport)),T.type==="offer"&&!Fe){Pe=L.transceivers[pe]||L._createTransceiver(_e),Pe.mid=rt,Pe.iceGatherer||(Pe.iceGatherer=L._createIceGatherer(pe,Ee)),Jt.length&&Pe.iceTransport.state==="new"&&(Mi&&(!Ee||pe===0)?Pe.iceTransport.setRemoteCandidates(Jt):Jt.forEach(function(ut){x(Pe.iceTransport,ut)})),We=R.RTCRtpReceiver.getCapabilities(_e),B<15019&&(We.codecs=We.codecs.filter(function(ut){return ut.name!=="rtx"})),St=Pe.sendEncodingParameters||[{ssrc:(2*pe+2)*1001}];var Qt=!1;if(Ne==="sendrecv"||Ne==="sendonly"){if(Qt=!Pe.rtpReceiver,Xe=Pe.rtpReceiver||new R.RTCRtpReceiver(Pe.dtlsTransport,_e),Qt){var Ut;Ye=Xe.track,je&&je.stream==="-"||(je?(K[je.stream]||(K[je.stream]=new R.MediaStream,Object.defineProperty(K[je.stream],"id",{get:function(){return je.stream}})),Object.defineProperty(Ye,"id",{get:function(){return je.track}}),Ut=K[je.stream]):(K.default||(K.default=new R.MediaStream),Ut=K.default)),Ut&&(Y(Ye,Ut),Pe.associatedRemoteMediaStreams.push(Ut)),$.push([Ye,Xe,Ut])}}else Pe.rtpReceiver&&Pe.rtpReceiver.track&&(Pe.associatedRemoteMediaStreams.forEach(function(ut){var Ni=ut.getTracks().find(function(Sn){return Sn.id===Pe.rtpReceiver.track.id});Ni&&se(Ni,ut)}),Pe.associatedRemoteMediaStreams=[]);Pe.localCapabilities=We,Pe.remoteCapabilities=ze,Pe.rtpReceiver=Xe,Pe.rtcpParameters=ri,Pe.sendEncodingParameters=St,Pe.recvEncodingParameters=lt,L._transceive(L.transceivers[pe],!1,Qt)}else if(T.type==="answer"&&!Fe){Pe=L.transceivers[pe],ht=Pe.iceGatherer,ct=Pe.iceTransport,Ve=Pe.dtlsTransport,Xe=Pe.rtpReceiver,St=Pe.sendEncodingParameters,We=Pe.localCapabilities,L.transceivers[pe].recvEncodingParameters=lt,L.transceivers[pe].remoteCapabilities=ze,L.transceivers[pe].rtcpParameters=ri,Jt.length&&ct.state==="new"&&((ue||Mi)&&(!Ee||pe===0)?ct.setRemoteCandidates(Jt):Jt.forEach(function(ut){x(Pe.iceTransport,ut)})),(!Ee||pe===0)&&(ct.state==="new"&&ct.start(ht,qt,"controlling"),Ve.state==="new"&&Ve.start(Ft));var Li=V(Pe.localCapabilities,Pe.remoteCapabilities),en=Li.codecs.filter(function(ut){return ut.name.toLowerCase()==="rtx"}).length;!en&&Pe.sendEncodingParameters[0].rtx&&delete Pe.sendEncodingParameters[0].rtx,L._transceive(Pe,Ne==="sendrecv"||Ne==="recvonly",Ne==="sendrecv"||Ne==="sendonly"),Xe&&(Ne==="sendrecv"||Ne==="sendonly")?(Ye=Xe.track,je?(K[je.stream]||(K[je.stream]=new R.MediaStream),Y(Ye,K[je.stream]),$.push([Ye,Xe,K[je.stream]])):(K.default||(K.default=new R.MediaStream),Y(Ye,K.default),$.push([Ye,Xe,K.default]))):delete Pe.rtpReceiver}}),L._dtlsRole===void 0&&(L._dtlsRole=T.type==="offer"?"active":"passive"),L._remoteDescription={type:T.type,sdp:T.sdp},T.type==="offer"?L._updateSignalingState("have-remote-offer"):L._updateSignalingState("stable"),Object.keys(K).forEach(function(ge){var pe=K[ge];if(pe.getTracks().length){if(L.remoteStreams.indexOf(pe)===-1){L.remoteStreams.push(pe);var Ue=new Event("addstream");Ue.stream=pe,R.setTimeout(function(){L._dispatchEvent("addstream",Ue)})}$.forEach(function(_e){var Fe=_e[0],He=_e[1];pe.id===_e[2].id&&ve(L,Fe,He,[pe])})}}),$.forEach(function(ge){ge[2]||ve(L,ge[0],ge[1],[])}),R.setTimeout(function(){L&&L.transceivers&&L.transceivers.forEach(function(ge){ge.iceTransport&&ge.iceTransport.state==="new"&&ge.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),ge.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},J.prototype.close=function(){this.transceivers.forEach(function(T){T.iceTransport&&T.iceTransport.stop(),T.dtlsTransport&&T.dtlsTransport.stop(),T.rtpSender&&T.rtpSender.stop(),T.rtpReceiver&&T.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},J.prototype._updateSignalingState=function(T){this.signalingState=T;var L=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",L)},J.prototype._maybeFireNegotiationNeeded=function(){var T=this;this.signalingState!=="stable"||this.needNegotiation===!0||(this.needNegotiation=!0,R.setTimeout(function(){if(T.needNegotiation){T.needNegotiation=!1;var L=new Event("negotiationneeded");T._dispatchEvent("negotiationneeded",L)}},0))},J.prototype._updateIceConnectionState=function(){var T,L={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function($){$.iceTransport&&!$.rejected&&L[$.iceTransport.state]++}),T="new",L.failed>0?T="failed":L.checking>0?T="checking":L.disconnected>0?T="disconnected":L.new>0?T="new":L.connected>0?T="connected":L.completed>0&&(T="completed"),T!==this.iceConnectionState){this.iceConnectionState=T;var K=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",K)}},J.prototype._updateConnectionState=function(){var T,L={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function($){$.iceTransport&&$.dtlsTransport&&!$.rejected&&(L[$.iceTransport.state]++,L[$.dtlsTransport.state]++)}),L.connected+=L.completed,T="new",L.failed>0?T="failed":L.connecting>0?T="connecting":L.disconnected>0?T="disconnected":L.new>0?T="new":L.connected>0&&(T="connected"),T!==this.connectionState){this.connectionState=T;var K=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",K)}},J.prototype.createOffer=function(){var T=this;if(T._isClosed)return Promise.reject(F("InvalidStateError","Can not call createOffer after close"));var L=T.transceivers.filter(function(ue){return ue.kind==="audio"}).length,K=T.transceivers.filter(function(ue){return ue.kind==="video"}).length,$=arguments[0];if($){if($.mandatory||$.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");$.offerToReceiveAudio!==void 0&&($.offerToReceiveAudio===!0?L=1:$.offerToReceiveAudio===!1?L=0:L=$.offerToReceiveAudio),$.offerToReceiveVideo!==void 0&&($.offerToReceiveVideo===!0?K=1:$.offerToReceiveVideo===!1?K=0:K=$.offerToReceiveVideo)}for(T.transceivers.forEach(function(ue){ue.kind==="audio"?(L--,L<0&&(ue.wantReceive=!1)):ue.kind==="video"&&(K--,K<0&&(ue.wantReceive=!1))});L>0||K>0;)L>0&&(T._createTransceiver("audio"),L--),K>0&&(T._createTransceiver("video"),K--);var ae=m.writeSessionBoilerplate(T._sdpSessionId,T._sdpSessionVersion++);T.transceivers.forEach(function(ue,Ee){var Ce=ue.track,ge=ue.kind,pe=ue.mid||m.generateIdentifier();ue.mid=pe,ue.iceGatherer||(ue.iceGatherer=T._createIceGatherer(Ee,T.usingBundle));var Ue=R.RTCRtpSender.getCapabilities(ge);B<15019&&(Ue.codecs=Ue.codecs.filter(function(Fe){return Fe.name!=="rtx"})),Ue.codecs.forEach(function(Fe){Fe.name==="H264"&&Fe.parameters["level-asymmetry-allowed"]===void 0&&(Fe.parameters["level-asymmetry-allowed"]="1"),ue.remoteCapabilities&&ue.remoteCapabilities.codecs&&ue.remoteCapabilities.codecs.forEach(function(He){Fe.name.toLowerCase()===He.name.toLowerCase()&&Fe.clockRate===He.clockRate&&(Fe.preferredPayloadType=He.payloadType)})}),Ue.headerExtensions.forEach(function(Fe){var He=ue.remoteCapabilities&&ue.remoteCapabilities.headerExtensions||[];He.forEach(function(Ne){Fe.uri===Ne.uri&&(Fe.id=Ne.id)})});var _e=ue.sendEncodingParameters||[{ssrc:(2*Ee+1)*1001}];Ce&&B>=15019&&ge==="video"&&!_e[0].rtx&&(_e[0].rtx={ssrc:_e[0].ssrc+1}),ue.wantReceive&&(ue.rtpReceiver=new R.RTCRtpReceiver(ue.dtlsTransport,ge)),ue.localCapabilities=Ue,ue.sendEncodingParameters=_e}),T._config.bundlePolicy!=="max-compat"&&(ae+="a=group:BUNDLE "+T.transceivers.map(function(ue){return ue.mid}).join(" ")+`\r
`),ae+=`a=ice-options:trickle\r
`,T.transceivers.forEach(function(ue,Ee){ae+=H(ue,ue.localCapabilities,"offer",ue.stream,T._dtlsRole),ae+=`a=rtcp-rsize\r
`,ue.iceGatherer&&T.iceGatheringState!=="new"&&(Ee===0||!T.usingBundle)&&(ue.iceGatherer.getLocalCandidates().forEach(function(Ce){Ce.component=1,ae+="a="+m.writeCandidate(Ce)+`\r
`}),ue.iceGatherer.state==="completed"&&(ae+=`a=end-of-candidates\r
`))});var Se=new R.RTCSessionDescription({type:"offer",sdp:ae});return Promise.resolve(Se)},J.prototype.createAnswer=function(){var T=this;if(T._isClosed)return Promise.reject(F("InvalidStateError","Can not call createAnswer after close"));if(!(T.signalingState==="have-remote-offer"||T.signalingState==="have-local-pranswer"))return Promise.reject(F("InvalidStateError","Can not call createAnswer in signalingState "+T.signalingState));var L=m.writeSessionBoilerplate(T._sdpSessionId,T._sdpSessionVersion++);T.usingBundle&&(L+="a=group:BUNDLE "+T.transceivers.map(function(ae){return ae.mid}).join(" ")+`\r
`),L+=`a=ice-options:trickle\r
`;var K=m.getMediaSections(T._remoteDescription.sdp).length;T.transceivers.forEach(function(ae,Se){if(!(Se+1>K)){if(ae.rejected){ae.kind==="application"?ae.protocol==="DTLS/SCTP"?L+=`m=application 0 DTLS/SCTP 5000\r
`:L+="m=application 0 "+ae.protocol+` webrtc-datachannel\r
`:ae.kind==="audio"?L+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:ae.kind==="video"&&(L+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),L+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+ae.mid+`\r
`;return}if(ae.stream){var ue;ae.kind==="audio"?ue=ae.stream.getAudioTracks()[0]:ae.kind==="video"&&(ue=ae.stream.getVideoTracks()[0]),ue&&B>=15019&&ae.kind==="video"&&!ae.sendEncodingParameters[0].rtx&&(ae.sendEncodingParameters[0].rtx={ssrc:ae.sendEncodingParameters[0].ssrc+1})}var Ee=V(ae.localCapabilities,ae.remoteCapabilities),Ce=Ee.codecs.filter(function(ge){return ge.name.toLowerCase()==="rtx"}).length;!Ce&&ae.sendEncodingParameters[0].rtx&&delete ae.sendEncodingParameters[0].rtx,L+=H(ae,Ee,"answer",ae.stream,T._dtlsRole),ae.rtcpParameters&&ae.rtcpParameters.reducedSize&&(L+=`a=rtcp-rsize\r
`)}});var $=new R.RTCSessionDescription({type:"answer",sdp:L});return Promise.resolve($)},J.prototype.addIceCandidate=function(T){var L=this,K;return T&&!(T.sdpMLineIndex!==void 0||T.sdpMid)?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function($,ae){if(L._remoteDescription)if(!T||T.candidate==="")for(var Se=0;Se<L.transceivers.length&&!(!L.transceivers[Se].rejected&&(L.transceivers[Se].iceTransport.addRemoteCandidate({}),K=m.getMediaSections(L._remoteDescription.sdp),K[Se]+=`a=end-of-candidates\r
`,L._remoteDescription.sdp=m.getDescription(L._remoteDescription.sdp)+K.join(""),L.usingBundle));Se++);else{var ue=T.sdpMLineIndex;if(T.sdpMid){for(var Ee=0;Ee<L.transceivers.length;Ee++)if(L.transceivers[Ee].mid===T.sdpMid){ue=Ee;break}}var Ce=L.transceivers[ue];if(Ce){if(Ce.rejected)return $();var ge=Object.keys(T.candidate).length>0?m.parseCandidate(T.candidate):{};if(ge.protocol==="tcp"&&(ge.port===0||ge.port===9)||ge.component&&ge.component!==1)return $();if((ue===0||ue>0&&Ce.iceTransport!==L.transceivers[0].iceTransport)&&!x(Ce.iceTransport,ge))return ae(F("OperationError","Can not add ICE candidate"));var pe=T.candidate.trim();pe.indexOf("a=")===0&&(pe=pe.substr(2)),K=m.getMediaSections(L._remoteDescription.sdp),K[ue]+="a="+(ge.type?pe:"end-of-candidates")+`\r
`,L._remoteDescription.sdp=m.getDescription(L._remoteDescription.sdp)+K.join("")}else return ae(F("OperationError","Can not add ICE candidate"))}else return ae(F("InvalidStateError","Can not add ICE candidate without a remote description"));$()})},J.prototype.getStats=function(T){if(T&&T instanceof R.MediaStreamTrack){var L=null;if(this.transceivers.forEach(function($){$.rtpSender&&$.rtpSender.track===T?L=$.rtpSender:$.rtpReceiver&&$.rtpReceiver.track===T&&(L=$.rtpReceiver)}),!L)throw F("InvalidAccessError","Invalid selector.");return L.getStats()}var K=[];return this.transceivers.forEach(function($){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(ae){$[ae]&&K.push($[ae].getStats())})}),Promise.all(K).then(function($){var ae=new Map;return $.forEach(function(Se){Se.forEach(function(ue){ae.set(ue.id,ue)})}),ae})};var fe=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];fe.forEach(function(T){var L=R[T];if(L&&L.prototype&&L.prototype.getStats){var K=L.prototype.getStats;L.prototype.getStats=function(){return K.apply(this).then(function($){var ae=new Map;return Object.keys($).forEach(function(Se){$[Se].type=A($[Se]),ae.set(Se,$[Se])}),ae})}}});var le=["createOffer","createAnswer"];return le.forEach(function(T){var L=J.prototype[T];J.prototype[T]=function(){var K=arguments;return typeof K[0]=="function"||typeof K[1]=="function"?L.apply(this,[arguments[2]]).then(function($){typeof K[0]=="function"&&K[0].apply(null,[$])},function($){typeof K[1]=="function"&&K[1].apply(null,[$])}):L.apply(this,arguments)}}),le=["setLocalDescription","setRemoteDescription","addIceCandidate"],le.forEach(function(T){var L=J.prototype[T];J.prototype[T]=function(){var K=arguments;return typeof K[1]=="function"||typeof K[2]=="function"?L.apply(this,arguments).then(function(){typeof K[1]=="function"&&K[1].apply(null)},function($){typeof K[2]=="function"&&K[2].apply(null,[$])}):L.apply(this,arguments)}}),["getStats"].forEach(function(T){var L=J.prototype[T];J.prototype[T]=function(){var K=arguments;return typeof K[1]=="function"?L.apply(this,arguments).then(function(){typeof K[1]=="function"&&K[1].apply(null)}):L.apply(this,arguments)}}),J}},985:C=>{var w={};w.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},w.localCName=w.generateIdentifier(),w.splitLines=function(S){return S.trim().split(`
`).map(function(m){return m.trim()})},w.splitSections=function(S){var m=S.split(`
m=`);return m.map(function(A,H){return(H>0?"m="+A:A).trim()+`\r
`})},w.getDescription=function(S){var m=w.splitSections(S);return m&&m[0]},w.getMediaSections=function(S){var m=w.splitSections(S);return m.shift(),m},w.matchPrefix=function(S,m){return w.splitLines(S).filter(function(A){return A.indexOf(m)===0})},w.parseCandidate=function(S){var m;S.indexOf("a=candidate:")===0?m=S.substring(12).split(" "):m=S.substring(10).split(" ");for(var A={foundation:m[0],component:parseInt(m[1],10),protocol:m[2].toLowerCase(),priority:parseInt(m[3],10),ip:m[4],address:m[4],port:parseInt(m[5],10),type:m[7]},H=8;H<m.length;H+=2)switch(m[H]){case"raddr":A.relatedAddress=m[H+1];break;case"rport":A.relatedPort=parseInt(m[H+1],10);break;case"tcptype":A.tcpType=m[H+1];break;case"ufrag":A.ufrag=m[H+1],A.usernameFragment=m[H+1];break;default:A[m[H]]=m[H+1];break}return A},w.writeCandidate=function(S){var m=[];m.push(S.foundation),m.push(S.component),m.push(S.protocol.toUpperCase()),m.push(S.priority),m.push(S.address||S.ip),m.push(S.port);var A=S.type;return m.push("typ"),m.push(A),A!=="host"&&S.relatedAddress&&S.relatedPort&&(m.push("raddr"),m.push(S.relatedAddress),m.push("rport"),m.push(S.relatedPort)),S.tcpType&&S.protocol.toLowerCase()==="tcp"&&(m.push("tcptype"),m.push(S.tcpType)),(S.usernameFragment||S.ufrag)&&(m.push("ufrag"),m.push(S.usernameFragment||S.ufrag)),"candidate:"+m.join(" ")},w.parseIceOptions=function(S){return S.substr(14).split(" ")},w.parseRtpMap=function(S){var m=S.substr(9).split(" "),A={payloadType:parseInt(m.shift(),10)};return m=m[0].split("/"),A.name=m[0],A.clockRate=parseInt(m[1],10),A.channels=m.length===3?parseInt(m[2],10):1,A.numChannels=A.channels,A},w.writeRtpMap=function(S){var m=S.payloadType;S.preferredPayloadType!==void 0&&(m=S.preferredPayloadType);var A=S.channels||S.numChannels||1;return"a=rtpmap:"+m+" "+S.name+"/"+S.clockRate+(A!==1?"/"+A:"")+`\r
`},w.parseExtmap=function(S){var m=S.substr(9).split(" ");return{id:parseInt(m[0],10),direction:m[0].indexOf("/")>0?m[0].split("/")[1]:"sendrecv",uri:m[1]}},w.writeExtmap=function(S){return"a=extmap:"+(S.id||S.preferredId)+(S.direction&&S.direction!=="sendrecv"?"/"+S.direction:"")+" "+S.uri+`\r
`},w.parseFmtp=function(S){for(var m={},A,H=S.substr(S.indexOf(" ")+1).split(";"),_=0;_<H.length;_++)A=H[_].trim().split("="),m[A[0].trim()]=A[1];return m},w.writeFmtp=function(S){var m="",A=S.payloadType;if(S.preferredPayloadType!==void 0&&(A=S.preferredPayloadType),S.parameters&&Object.keys(S.parameters).length){var H=[];Object.keys(S.parameters).forEach(function(_){S.parameters[_]?H.push(_+"="+S.parameters[_]):H.push(_)}),m+="a=fmtp:"+A+" "+H.join(";")+`\r
`}return m},w.parseRtcpFb=function(S){var m=S.substr(S.indexOf(" ")+1).split(" ");return{type:m.shift(),parameter:m.join(" ")}},w.writeRtcpFb=function(S){var m="",A=S.payloadType;return S.preferredPayloadType!==void 0&&(A=S.preferredPayloadType),S.rtcpFeedback&&S.rtcpFeedback.length&&S.rtcpFeedback.forEach(function(H){m+="a=rtcp-fb:"+A+" "+H.type+(H.parameter&&H.parameter.length?" "+H.parameter:"")+`\r
`}),m},w.parseSsrcMedia=function(S){var m=S.indexOf(" "),A={ssrc:parseInt(S.substr(7,m-7),10)},H=S.indexOf(":",m);return H>-1?(A.attribute=S.substr(m+1,H-m-1),A.value=S.substr(H+1)):A.attribute=S.substr(m+1),A},w.parseSsrcGroup=function(S){var m=S.substr(13).split(" ");return{semantics:m.shift(),ssrcs:m.map(function(A){return parseInt(A,10)})}},w.getMid=function(S){var m=w.matchPrefix(S,"a=mid:")[0];if(m)return m.substr(6)},w.parseFingerprint=function(S){var m=S.substr(14).split(" ");return{algorithm:m[0].toLowerCase(),value:m[1]}},w.getDtlsParameters=function(S,m){var A=w.matchPrefix(S+m,"a=fingerprint:");return{role:"auto",fingerprints:A.map(w.parseFingerprint)}},w.writeDtlsParameters=function(S,m){var A="a=setup:"+m+`\r
`;return S.fingerprints.forEach(function(H){A+="a=fingerprint:"+H.algorithm+" "+H.value+`\r
`}),A},w.parseCryptoLine=function(S){var m=S.substr(9).split(" ");return{tag:parseInt(m[0],10),cryptoSuite:m[1],keyParams:m[2],sessionParams:m.slice(3)}},w.writeCryptoLine=function(S){return"a=crypto:"+S.tag+" "+S.cryptoSuite+" "+(typeof S.keyParams=="object"?w.writeCryptoKeyParams(S.keyParams):S.keyParams)+(S.sessionParams?" "+S.sessionParams.join(" "):"")+`\r
`},w.parseCryptoKeyParams=function(S){if(S.indexOf("inline:")!==0)return null;var m=S.substr(7).split("|");return{keyMethod:"inline",keySalt:m[0],lifeTime:m[1],mkiValue:m[2]?m[2].split(":")[0]:void 0,mkiLength:m[2]?m[2].split(":")[1]:void 0}},w.writeCryptoKeyParams=function(S){return S.keyMethod+":"+S.keySalt+(S.lifeTime?"|"+S.lifeTime:"")+(S.mkiValue&&S.mkiLength?"|"+S.mkiValue+":"+S.mkiLength:"")},w.getCryptoParameters=function(S,m){var A=w.matchPrefix(S+m,"a=crypto:");return A.map(w.parseCryptoLine)},w.getIceParameters=function(S,m){var A=w.matchPrefix(S+m,"a=ice-ufrag:")[0],H=w.matchPrefix(S+m,"a=ice-pwd:")[0];return A&&H?{usernameFragment:A.substr(12),password:H.substr(10)}:null},w.writeIceParameters=function(S){return"a=ice-ufrag:"+S.usernameFragment+`\r
a=ice-pwd:`+S.password+`\r
`},w.parseRtpParameters=function(S){for(var m={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},A=w.splitLines(S),H=A[0].split(" "),_=3;_<H.length;_++){var V=H[_],ie=w.matchPrefix(S,"a=rtpmap:"+V+" ")[0];if(ie){var x=w.parseRtpMap(ie),F=w.matchPrefix(S,"a=fmtp:"+V+" ");switch(x.parameters=F.length?w.parseFmtp(F[0]):{},x.rtcpFeedback=w.matchPrefix(S,"a=rtcp-fb:"+V+" ").map(w.parseRtcpFb),m.codecs.push(x),x.name.toUpperCase()){case"RED":case"ULPFEC":m.fecMechanisms.push(x.name.toUpperCase());break}}}return w.matchPrefix(S,"a=extmap:").forEach(function(R){m.headerExtensions.push(w.parseExtmap(R))}),m},w.writeRtpDescription=function(S,m){var A="";A+="m="+S+" ",A+=m.codecs.length>0?"9":"0",A+=" UDP/TLS/RTP/SAVPF ",A+=m.codecs.map(function(_){return _.preferredPayloadType!==void 0?_.preferredPayloadType:_.payloadType}).join(" ")+`\r
`,A+=`c=IN IP4 0.0.0.0\r
`,A+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,m.codecs.forEach(function(_){A+=w.writeRtpMap(_),A+=w.writeFmtp(_),A+=w.writeRtcpFb(_)});var H=0;return m.codecs.forEach(function(_){_.maxptime>H&&(H=_.maxptime)}),H>0&&(A+="a=maxptime:"+H+`\r
`),A+=`a=rtcp-mux\r
`,m.headerExtensions&&m.headerExtensions.forEach(function(_){A+=w.writeExtmap(_)}),A},w.parseRtpEncodingParameters=function(S){var m=[],A=w.parseRtpParameters(S),H=A.fecMechanisms.indexOf("RED")!==-1,_=A.fecMechanisms.indexOf("ULPFEC")!==-1,V=w.matchPrefix(S,"a=ssrc:").map(function(B){return w.parseSsrcMedia(B)}).filter(function(B){return B.attribute==="cname"}),ie=V.length>0&&V[0].ssrc,x,F=w.matchPrefix(S,"a=ssrc-group:FID").map(function(B){var Y=B.substr(17).split(" ");return Y.map(function(se){return parseInt(se,10)})});F.length>0&&F[0].length>1&&F[0][0]===ie&&(x=F[0][1]),A.codecs.forEach(function(B){if(B.name.toUpperCase()==="RTX"&&B.parameters.apt){var Y={ssrc:ie,codecPayloadType:parseInt(B.parameters.apt,10)};ie&&x&&(Y.rtx={ssrc:x}),m.push(Y),H&&(Y=JSON.parse(JSON.stringify(Y)),Y.fec={ssrc:ie,mechanism:_?"red+ulpfec":"red"},m.push(Y))}}),m.length===0&&ie&&m.push({ssrc:ie});var R=w.matchPrefix(S,"b=");return R.length&&(R[0].indexOf("b=TIAS:")===0?R=parseInt(R[0].substr(7),10):R[0].indexOf("b=AS:")===0?R=parseInt(R[0].substr(5),10)*1e3*.95-16e3:R=void 0,m.forEach(function(B){B.maxBitrate=R})),m},w.parseRtcpParameters=function(S){var m={},A=w.matchPrefix(S,"a=ssrc:").map(function(V){return w.parseSsrcMedia(V)}).filter(function(V){return V.attribute==="cname"})[0];A&&(m.cname=A.value,m.ssrc=A.ssrc);var H=w.matchPrefix(S,"a=rtcp-rsize");m.reducedSize=H.length>0,m.compound=H.length===0;var _=w.matchPrefix(S,"a=rtcp-mux");return m.mux=_.length>0,m},w.parseMsid=function(S){var m,A=w.matchPrefix(S,"a=msid:");if(A.length===1)return m=A[0].substr(7).split(" "),{stream:m[0],track:m[1]};var H=w.matchPrefix(S,"a=ssrc:").map(function(_){return w.parseSsrcMedia(_)}).filter(function(_){return _.attribute==="msid"});if(H.length>0)return m=H[0].value.split(" "),{stream:m[0],track:m[1]}},w.parseSctpDescription=function(S){var m=w.parseMLine(S),A=w.matchPrefix(S,"a=max-message-size:"),H;A.length>0&&(H=parseInt(A[0].substr(19),10)),isNaN(H)&&(H=65536);var _=w.matchPrefix(S,"a=sctp-port:");if(_.length>0)return{port:parseInt(_[0].substr(12),10),protocol:m.fmt,maxMessageSize:H};var V=w.matchPrefix(S,"a=sctpmap:");if(V.length>0){var ie=w.matchPrefix(S,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(ie[0],10),protocol:ie[1],maxMessageSize:H}}},w.writeSctpDescription=function(S,m){var A=[];return S.protocol!=="DTLS/SCTP"?A=["m="+S.kind+" 9 "+S.protocol+" "+m.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+m.port+`\r
`]:A=["m="+S.kind+" 9 "+S.protocol+" "+m.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+m.port+" "+m.protocol+` 65535\r
`],m.maxMessageSize!==void 0&&A.push("a=max-message-size:"+m.maxMessageSize+`\r
`),A.join("")},w.generateSessionId=function(){return Math.random().toString().substr(2,21)},w.writeSessionBoilerplate=function(S,m,A){var H,_=m!==void 0?m:2;S?H=S:H=w.generateSessionId();var V=A||"thisisadapterortc";return`v=0\r
o=`+V+" "+H+" "+_+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},w.writeMediaSection=function(S,m,A,H){var _=w.writeRtpDescription(S.kind,m);if(_+=w.writeIceParameters(S.iceGatherer.getLocalParameters()),_+=w.writeDtlsParameters(S.dtlsTransport.getLocalParameters(),A==="offer"?"actpass":"active"),_+="a=mid:"+S.mid+`\r
`,S.direction?_+="a="+S.direction+`\r
`:S.rtpSender&&S.rtpReceiver?_+=`a=sendrecv\r
`:S.rtpSender?_+=`a=sendonly\r
`:S.rtpReceiver?_+=`a=recvonly\r
`:_+=`a=inactive\r
`,S.rtpSender){var V="msid:"+H.id+" "+S.rtpSender.track.id+`\r
`;_+="a="+V,_+="a=ssrc:"+S.sendEncodingParameters[0].ssrc+" "+V,S.sendEncodingParameters[0].rtx&&(_+="a=ssrc:"+S.sendEncodingParameters[0].rtx.ssrc+" "+V,_+="a=ssrc-group:FID "+S.sendEncodingParameters[0].ssrc+" "+S.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return _+="a=ssrc:"+S.sendEncodingParameters[0].ssrc+" cname:"+w.localCName+`\r
`,S.rtpSender&&S.sendEncodingParameters[0].rtx&&(_+="a=ssrc:"+S.sendEncodingParameters[0].rtx.ssrc+" cname:"+w.localCName+`\r
`),_},w.getDirection=function(S,m){for(var A=w.splitLines(S),H=0;H<A.length;H++)switch(A[H]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return A[H].substr(2)}return m?w.getDirection(m):"sendrecv"},w.getKind=function(S){var m=w.splitLines(S),A=m[0].split(" ");return A[0].substr(2)},w.isRejected=function(S){return S.split(" ",2)[1]==="0"},w.parseMLine=function(S){var m=w.splitLines(S),A=m[0].substr(2).split(" ");return{kind:A[0],port:parseInt(A[1],10),protocol:A[2],fmt:A.slice(3).join(" ")}},w.parseOLine=function(S){var m=w.matchPrefix(S,"o=")[0],A=m.substr(2).split(" ");return{username:A[0],sessionId:A[1],sessionVersion:parseInt(A[2],10),netType:A[3],addressType:A[4],address:A[5]}},w.isValidSDP=function(S){if(typeof S!="string"||S.length===0)return!1;for(var m=w.splitLines(S),A=0;A<m.length;A++)if(m[A].length<2||m[A].charAt(1)!=="=")return!1;return!0},C.exports=w},771:C=>{C.exports=Jf()},754:C=>{C.exports=hv}},g={};function I(C){var w=g[C];if(w!==void 0)return w.exports;var S=g[C]={exports:{}};return a[C](S,S.exports,I),S.exports}I.n=C=>{var w=C&&C.__esModule?()=>C.default:()=>C;return I.d(w,{a:w}),w},I.d=(C,w)=>{for(var S in w)I.o(w,S)&&!I.o(C,S)&&Object.defineProperty(C,S,{enumerable:!0,get:w[S]})},I.o=(C,w)=>Object.prototype.hasOwnProperty.call(C,w),I.r=C=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(C,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(C,"__esModule",{value:!0})};var M={};(()=>{/*!*******************************!*\
  !*** ./index.js + 16 modules ***!
  \*******************************/I.r(M),I.d(M,{AdAction:()=>he,AdState:()=>re,AddPlatformTelemetry:()=>rn,AppLaunchMode:()=>or,AppLevelProtocol:()=>q,AudioFormat:()=>ar,AuthType:()=>En,BitDepth:()=>Xn,BrowserFeature:()=>gs,BrowserName:()=>er,CHANGELIST:()=>nn,CLIENT_IDENTIFICATION:()=>fs,CLIENT_VERSION:()=>gi,CalculateDataUsage:()=>qn,CalculateMaxBitrateKbps:()=>sn,ChooseStreamingResolution:()=>pi,ChooseStreamingSettings:()=>fi,ClientHeaderBrowserType:()=>Gt,ClientHeaderDeviceType:()=>Yn,ClientHeaderOSType:()=>Nr,ClientStreamer:()=>ps,ClientType:()=>Tn,ConfigureGridServerSettings:()=>Ii,ConfigureRagnarokSettings:()=>vi,CursorType:()=>lr,DeviceModel:()=>Gi,DeviceOS:()=>Ui,DeviceType:()=>ji,DeviceVendor:()=>Bi,DynamicStreamingMode:()=>ws,EVENTS:()=>tr,GS_EVENTS:()=>$o,GetDeviceCapabilities:()=>$n,GetSupportedAudioChannelCount:()=>yn,GridApp:()=>Zt,GridServer:()=>qo,GridServerSettings:()=>ti,GsErrorCode:()=>ai,HidType:()=>_r,HotkeyModifier:()=>ir,InitializeUtils:()=>Lr,InputType:()=>Es,IsFeatureSupported:()=>bn,LogImpl:()=>Jn,LogLevel:()=>xr,MediaTrackKind:()=>ea,MicState:()=>Fr,NetworkType:()=>Zn,PassThruServer:()=>Jo,PayloadBrowserType:()=>Qn,PayloadDeviceType:()=>dn,PayloadOSType:()=>an,PlatformName:()=>Cn,Protocol:()=>k,RErrorCode:()=>Qo,RNotificationCode:()=>sr,SESSIONMODIFY_ACTION:()=>Ko,STREAMING_STATE:()=>rr,ScErrorCode:()=>Bt,SdrHdrMode:()=>wn,SessionProgressState:()=>Rn,SessionState:()=>Hi,StreamStopReason:()=>Ur,StreamWarningType:()=>ta,StreamingProfilePreset:()=>nr,StreamingState:()=>Cs,TrackType:()=>cn,Usage:()=>P,VideoCodecType:()=>Zo,VirtualButton:()=>ei,VirtualGamepadHandler:()=>_i,VsyncType:()=>ii,configureSessionControlSettings:()=>Wi,configureStreamKitSettings:()=>kn,createNskStreamClient:()=>Xo,createSessionControl:()=>b,decodeWsErrorCodes:()=>di,defaultInputConfigFlags:()=>In,estimateDataUsage:()=>Yo,getDeviceCapabilities:()=>mi,getNetworkTypeDetector:()=>bs,getPlatformDetails:()=>zi,getRecommendedBitrate:()=>Ss,getResumableSession:()=>De,getStreamStartParameters:()=>ys,getStreamerType:()=>cr,getSupportedCodecs:()=>si,isCancelCode:()=>$e,isFeatureSupported:()=>ms,isResumableSessionState:()=>Le,performHttpRequest:()=>on,prefetchDeviceCapabilities:()=>dr,registerDeviceCapabilitiesChanged:()=>st,registerLogCallback:()=>Fi,serializeDeviceCapabilities:()=>vs,shouldDefaultEnableMic:()=>As,translatePlatformDetailsForClientHeader:()=>Vi,translatePlatformDetailsForPayload:()=>oi,unregisterDeviceCapabilitiesChanged:()=>Ti,updateSessionParameters:()=>Te});var C={};I.r(C),I.d(C,{fixNegotiationNeeded:()=>pe,shimAddTrackRemoveTrack:()=>Ce,shimAddTrackRemoveTrackWithNative:()=>Ee,shimGetDisplayMedia:()=>L,shimGetSendersWithDtmf:()=>ae,shimGetStats:()=>Se,shimGetUserMedia:()=>T,shimMediaStream:()=>K,shimOnTrack:()=>$,shimPeerConnection:()=>ge,shimSenderReceiverGetStats:()=>ue});var w={};I.r(w),I.d(w,{shimGetDisplayMedia:()=>Ne,shimGetUserMedia:()=>He,shimPeerConnection:()=>je,shimReplaceTrack:()=>rt});var S={};I.r(S),I.d(S,{shimAddTransceiver:()=>Ye,shimCreateAnswer:()=>Ft,shimCreateOffer:()=>qt,shimGetDisplayMedia:()=>ht,shimGetParameters:()=>ze,shimGetUserMedia:()=>Pe,shimOnTrack:()=>ct,shimPeerConnection:()=>Ve,shimRTCDataChannel:()=>We,shimReceiverGetStats:()=>St,shimRemoveStream:()=>lt,shimSenderGetStats:()=>Xe});var m={};I.r(m),I.d(m,{shimAudioContext:()=>Ni,shimCallbacksAPI:()=>Jt,shimConstraints:()=>Ut,shimCreateOfferLegacy:()=>ut,shimGetUserMedia:()=>Qt,shimLocalStreamsAPI:()=>ri,shimRTCIceServerUrls:()=>Li,shimRemoteStreamsAPI:()=>Mi,shimTrackEventTransceiver:()=>en});var A={};I.r(A),I.d(A,{removeAllowExtmapMixed:()=>Xt,shimConnectionState:()=>Yt,shimMaxMessageSize:()=>xi,shimRTCIceCandidate:()=>wi,shimSendThrowTypeError:()=>jt});let H=!0,_=!0;function V(v,j,X){const U=v.match(j);return U&&U.length>=X&&parseInt(U[X],10)}function ie(v,j,X){if(!v.RTCPeerConnection)return;const U=v.RTCPeerConnection.prototype,c=U.addEventListener;U.addEventListener=function(te,W){if(te!==j)return c.apply(this,arguments);const de=ne=>{const oe=X(ne);oe&&(W.handleEvent?W.handleEvent(oe):W(oe))};return this._eventMap=this._eventMap||{},this._eventMap[j]||(this._eventMap[j]=new Map),this._eventMap[j].set(W,de),c.apply(this,[te,de])};const ee=U.removeEventListener;U.removeEventListener=function(te,W){if(te!==j||!this._eventMap||!this._eventMap[j])return ee.apply(this,arguments);if(!this._eventMap[j].has(W))return ee.apply(this,arguments);const de=this._eventMap[j].get(W);return this._eventMap[j].delete(W),this._eventMap[j].size===0&&delete this._eventMap[j],Object.keys(this._eventMap).length===0&&delete this._eventMap,ee.apply(this,[te,de])},Object.defineProperty(U,"on"+j,{get(){return this["_on"+j]},set(te){this["_on"+j]&&(this.removeEventListener(j,this["_on"+j]),delete this["_on"+j]),te&&this.addEventListener(j,this["_on"+j]=te)},enumerable:!0,configurable:!0})}function x(v){return typeof v!="boolean"?new Error("Argument type: "+typeof v+". Please use a boolean."):(H=v,v?"adapter.js logging disabled":"adapter.js logging enabled")}function F(v){return typeof v!="boolean"?new Error("Argument type: "+typeof v+". Please use a boolean."):(_=!v,"adapter.js deprecation warnings "+(v?"disabled":"enabled"))}function R(){if(typeof window=="object"){if(H)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function B(v,j){_&&console.warn(v+" is deprecated, please use "+j+" instead.")}function Y(v){const{navigator:j}=v,X={browser:null,version:null};if(typeof v>"u"||!v.navigator)return X.browser="Not a browser.",X;if(j.mozGetUserMedia)X.browser="firefox",X.version=V(j.userAgent,/Firefox\/(\d+)\./,1);else if(j.webkitGetUserMedia||v.isSecureContext===!1&&v.webkitRTCPeerConnection&&!v.RTCIceGatherer)X.browser="chrome",X.version=V(j.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(j.mediaDevices&&j.userAgent.match(/Edge\/(\d+).(\d+)$/))X.browser="edge",X.version=V(j.userAgent,/Edge\/(\d+).(\d+)$/,2);else if(v.RTCPeerConnection&&j.userAgent.match(/AppleWebKit\/(\d+)\./))X.browser="safari",X.version=V(j.userAgent,/AppleWebKit\/(\d+)\./,1),X.supportsUnifiedPlan=v.RTCRtpTransceiver&&"currentDirection"in v.RTCRtpTransceiver.prototype;else return X.browser="Not a supported browser.",X;return X}function se(v){return Object.prototype.toString.call(v)==="[object Object]"}function ve(v){return se(v)?Object.keys(v).reduce(function(j,X){const U=se(v[X]),c=U?ve(v[X]):v[X],ee=U&&!Object.keys(c).length;return c===void 0||ee?j:Object.assign(j,{[X]:c})},{}):v}function J(v,j,X){!j||X.has(j.id)||(X.set(j.id,j),Object.keys(j).forEach(U=>{U.endsWith("Id")?J(v,v.get(j[U]),X):U.endsWith("Ids")&&j[U].forEach(c=>{J(v,v.get(c),X)})}))}function fe(v,j,X){const U=X?"outbound-rtp":"inbound-rtp",c=new Map;if(j===null)return c;const ee=[];return v.forEach(te=>{te.type==="track"&&te.trackIdentifier===j.id&&ee.push(te)}),ee.forEach(te=>{v.forEach(W=>{W.type===U&&W.trackId===te.id&&J(v,W,c)})}),c}const le=R;function T(v){const j=v&&v.navigator;if(!j.mediaDevices)return;const X=Y(v),U=function(W){if(typeof W!="object"||W.mandatory||W.optional)return W;const de={};return Object.keys(W).forEach(ne=>{if(ne==="require"||ne==="advanced"||ne==="mediaSource")return;const oe=typeof W[ne]=="object"?W[ne]:{ideal:W[ne]};oe.exact!==void 0&&typeof oe.exact=="number"&&(oe.min=oe.max=oe.exact);const me=function(we,qe){return we?we+qe.charAt(0).toUpperCase()+qe.slice(1):qe==="deviceId"?"sourceId":qe};if(oe.ideal!==void 0){de.optional=de.optional||[];let we={};typeof oe.ideal=="number"?(we[me("min",ne)]=oe.ideal,de.optional.push(we),we={},we[me("max",ne)]=oe.ideal,de.optional.push(we)):(we[me("",ne)]=oe.ideal,de.optional.push(we))}oe.exact!==void 0&&typeof oe.exact!="number"?(de.mandatory=de.mandatory||{},de.mandatory[me("",ne)]=oe.exact):["min","max"].forEach(we=>{oe[we]!==void 0&&(de.mandatory=de.mandatory||{},de.mandatory[me(we,ne)]=oe[we])})}),W.advanced&&(de.optional=(de.optional||[]).concat(W.advanced)),de},c=function(W,de){if(X.version>=61)return de(W);if(W=JSON.parse(JSON.stringify(W)),W&&typeof W.audio=="object"){const ne=function(oe,me,we){me in oe&&!(we in oe)&&(oe[we]=oe[me],delete oe[me])};W=JSON.parse(JSON.stringify(W)),ne(W.audio,"autoGainControl","googAutoGainControl"),ne(W.audio,"noiseSuppression","googNoiseSuppression"),W.audio=U(W.audio)}if(W&&typeof W.video=="object"){let ne=W.video.facingMode;ne=ne&&(typeof ne=="object"?ne:{ideal:ne});const oe=X.version<66;if(ne&&(ne.exact==="user"||ne.exact==="environment"||ne.ideal==="user"||ne.ideal==="environment")&&!(j.mediaDevices.getSupportedConstraints&&j.mediaDevices.getSupportedConstraints().facingMode&&!oe)){delete W.video.facingMode;let me;if(ne.exact==="environment"||ne.ideal==="environment"?me=["back","rear"]:(ne.exact==="user"||ne.ideal==="user")&&(me=["front"]),me)return j.mediaDevices.enumerateDevices().then(we=>{we=we.filter(ot=>ot.kind==="videoinput");let qe=we.find(ot=>me.some(wt=>ot.label.toLowerCase().includes(wt)));return!qe&&we.length&&me.includes("back")&&(qe=we[we.length-1]),qe&&(W.video.deviceId=ne.exact?{exact:qe.deviceId}:{ideal:qe.deviceId}),W.video=U(W.video),le("chrome: "+JSON.stringify(W)),de(W)})}W.video=U(W.video)}return le("chrome: "+JSON.stringify(W)),de(W)},ee=function(W){return X.version>=64?W:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[W.name]||W.name,message:W.message,constraint:W.constraint||W.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},te=function(W,de,ne){c(W,oe=>{j.webkitGetUserMedia(oe,de,me=>{ne&&ne(ee(me))})})};if(j.getUserMedia=te.bind(j),j.mediaDevices.getUserMedia){const W=j.mediaDevices.getUserMedia.bind(j.mediaDevices);j.mediaDevices.getUserMedia=function(de){return c(de,ne=>W(ne).then(oe=>{if(ne.audio&&!oe.getAudioTracks().length||ne.video&&!oe.getVideoTracks().length)throw oe.getTracks().forEach(me=>{me.stop()}),new DOMException("","NotFoundError");return oe},oe=>Promise.reject(ee(oe))))}}}function L(v,j){if(!(v.navigator.mediaDevices&&"getDisplayMedia"in v.navigator.mediaDevices)&&v.navigator.mediaDevices){if(typeof j!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}v.navigator.mediaDevices.getDisplayMedia=function(U){return j(U).then(c=>{const ee=U.video&&U.video.width,te=U.video&&U.video.height,W=U.video&&U.video.frameRate;return U.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c,maxFrameRate:W||3}},ee&&(U.video.mandatory.maxWidth=ee),te&&(U.video.mandatory.maxHeight=te),v.navigator.mediaDevices.getUserMedia(U)})}}}function K(v){v.MediaStream=v.MediaStream||v.webkitMediaStream}function $(v){if(typeof v=="object"&&v.RTCPeerConnection&&!("ontrack"in v.RTCPeerConnection.prototype)){Object.defineProperty(v.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(X){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=X)},enumerable:!0,configurable:!0});const j=v.RTCPeerConnection.prototype.setRemoteDescription;v.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=U=>{U.stream.addEventListener("addtrack",c=>{let ee;v.RTCPeerConnection.prototype.getReceivers?ee=this.getReceivers().find(W=>W.track&&W.track.id===c.track.id):ee={track:c.track};const te=new Event("track");te.track=c.track,te.receiver=ee,te.transceiver={receiver:ee},te.streams=[U.stream],this.dispatchEvent(te)}),U.stream.getTracks().forEach(c=>{let ee;v.RTCPeerConnection.prototype.getReceivers?ee=this.getReceivers().find(W=>W.track&&W.track.id===c.id):ee={track:c};const te=new Event("track");te.track=c,te.receiver=ee,te.transceiver={receiver:ee},te.streams=[U.stream],this.dispatchEvent(te)})},this.addEventListener("addstream",this._ontrackpoly)),j.apply(this,arguments)}}else ie(v,"track",j=>(j.transceiver||Object.defineProperty(j,"transceiver",{value:{receiver:j.receiver}}),j))}function ae(v){if(typeof v=="object"&&v.RTCPeerConnection&&!("getSenders"in v.RTCPeerConnection.prototype)&&"createDTMFSender"in v.RTCPeerConnection.prototype){const j=function(c,ee){return{track:ee,get dtmf(){return this._dtmf===void 0&&(ee.kind==="audio"?this._dtmf=c.createDTMFSender(ee):this._dtmf=null),this._dtmf},_pc:c}};if(!v.RTCPeerConnection.prototype.getSenders){v.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const c=v.RTCPeerConnection.prototype.addTrack;v.RTCPeerConnection.prototype.addTrack=function(W,de){let ne=c.apply(this,arguments);return ne||(ne=j(this,W),this._senders.push(ne)),ne};const ee=v.RTCPeerConnection.prototype.removeTrack;v.RTCPeerConnection.prototype.removeTrack=function(W){ee.apply(this,arguments);const de=this._senders.indexOf(W);de!==-1&&this._senders.splice(de,1)}}const X=v.RTCPeerConnection.prototype.addStream;v.RTCPeerConnection.prototype.addStream=function(ee){this._senders=this._senders||[],X.apply(this,[ee]),ee.getTracks().forEach(te=>{this._senders.push(j(this,te))})};const U=v.RTCPeerConnection.prototype.removeStream;v.RTCPeerConnection.prototype.removeStream=function(ee){this._senders=this._senders||[],U.apply(this,[ee]),ee.getTracks().forEach(te=>{const W=this._senders.find(de=>de.track===te);W&&this._senders.splice(this._senders.indexOf(W),1)})}}else if(typeof v=="object"&&v.RTCPeerConnection&&"getSenders"in v.RTCPeerConnection.prototype&&"createDTMFSender"in v.RTCPeerConnection.prototype&&v.RTCRtpSender&&!("dtmf"in v.RTCRtpSender.prototype)){const j=v.RTCPeerConnection.prototype.getSenders;v.RTCPeerConnection.prototype.getSenders=function(){const U=j.apply(this,[]);return U.forEach(c=>c._pc=this),U},Object.defineProperty(v.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Se(v){if(!v.RTCPeerConnection)return;const j=v.RTCPeerConnection.prototype.getStats;v.RTCPeerConnection.prototype.getStats=function(){const[U,c,ee]=arguments;if(arguments.length>0&&typeof U=="function")return j.apply(this,arguments);if(j.length===0&&(arguments.length===0||typeof U!="function"))return j.apply(this,[]);const te=function(de){const ne={};return de.result().forEach(me=>{const we={id:me.id,timestamp:me.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[me.type]||me.type};me.names().forEach(qe=>{we[qe]=me.stat(qe)}),ne[we.id]=we}),ne},W=function(de){return new Map(Object.keys(de).map(ne=>[ne,de[ne]]))};if(arguments.length>=2){const de=function(ne){c(W(te(ne)))};return j.apply(this,[de,U])}return new Promise((de,ne)=>{j.apply(this,[function(oe){de(W(te(oe)))},ne])}).then(c,ee)}}function ue(v){if(!(typeof v=="object"&&v.RTCPeerConnection&&v.RTCRtpSender&&v.RTCRtpReceiver))return;if(!("getStats"in v.RTCRtpSender.prototype)){const X=v.RTCPeerConnection.prototype.getSenders;X&&(v.RTCPeerConnection.prototype.getSenders=function(){const ee=X.apply(this,[]);return ee.forEach(te=>te._pc=this),ee});const U=v.RTCPeerConnection.prototype.addTrack;U&&(v.RTCPeerConnection.prototype.addTrack=function(){const ee=U.apply(this,arguments);return ee._pc=this,ee}),v.RTCRtpSender.prototype.getStats=function(){const ee=this;return this._pc.getStats().then(te=>fe(te,ee.track,!0))}}if(!("getStats"in v.RTCRtpReceiver.prototype)){const X=v.RTCPeerConnection.prototype.getReceivers;X&&(v.RTCPeerConnection.prototype.getReceivers=function(){const c=X.apply(this,[]);return c.forEach(ee=>ee._pc=this),c}),ie(v,"track",U=>(U.receiver._pc=U.srcElement,U)),v.RTCRtpReceiver.prototype.getStats=function(){const c=this;return this._pc.getStats().then(ee=>fe(ee,c.track,!1))}}if(!("getStats"in v.RTCRtpSender.prototype&&"getStats"in v.RTCRtpReceiver.prototype))return;const j=v.RTCPeerConnection.prototype.getStats;v.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof v.MediaStreamTrack){const U=arguments[0];let c,ee,te;return this.getSenders().forEach(W=>{W.track===U&&(c?te=!0:c=W)}),this.getReceivers().forEach(W=>(W.track===U&&(ee?te=!0:ee=W),W.track===U)),te||c&&ee?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():ee?ee.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return j.apply(this,arguments)}}function Ee(v){v.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(te=>this._shimmedLocalStreams[te][0])};const j=v.RTCPeerConnection.prototype.addTrack;v.RTCPeerConnection.prototype.addTrack=function(te,W){if(!W)return j.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const de=j.apply(this,arguments);return this._shimmedLocalStreams[W.id]?this._shimmedLocalStreams[W.id].indexOf(de)===-1&&this._shimmedLocalStreams[W.id].push(de):this._shimmedLocalStreams[W.id]=[W,de],de};const X=v.RTCPeerConnection.prototype.addStream;v.RTCPeerConnection.prototype.addStream=function(te){this._shimmedLocalStreams=this._shimmedLocalStreams||{},te.getTracks().forEach(ne=>{if(this.getSenders().find(me=>me.track===ne))throw new DOMException("Track already exists.","InvalidAccessError")});const W=this.getSenders();X.apply(this,arguments);const de=this.getSenders().filter(ne=>W.indexOf(ne)===-1);this._shimmedLocalStreams[te.id]=[te].concat(de)};const U=v.RTCPeerConnection.prototype.removeStream;v.RTCPeerConnection.prototype.removeStream=function(te){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[te.id],U.apply(this,arguments)};const c=v.RTCPeerConnection.prototype.removeTrack;v.RTCPeerConnection.prototype.removeTrack=function(te){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},te&&Object.keys(this._shimmedLocalStreams).forEach(W=>{const de=this._shimmedLocalStreams[W].indexOf(te);de!==-1&&this._shimmedLocalStreams[W].splice(de,1),this._shimmedLocalStreams[W].length===1&&delete this._shimmedLocalStreams[W]}),c.apply(this,arguments)}}function Ce(v){if(!v.RTCPeerConnection)return;const j=Y(v);if(v.RTCPeerConnection.prototype.addTrack&&j.version>=65)return Ee(v);const X=v.RTCPeerConnection.prototype.getLocalStreams;v.RTCPeerConnection.prototype.getLocalStreams=function(){const oe=X.apply(this);return this._reverseStreams=this._reverseStreams||{},oe.map(me=>this._reverseStreams[me.id])};const U=v.RTCPeerConnection.prototype.addStream;v.RTCPeerConnection.prototype.addStream=function(oe){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},oe.getTracks().forEach(me=>{if(this.getSenders().find(qe=>qe.track===me))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[oe.id]){const me=new v.MediaStream(oe.getTracks());this._streams[oe.id]=me,this._reverseStreams[me.id]=oe,oe=me}U.apply(this,[oe])};const c=v.RTCPeerConnection.prototype.removeStream;v.RTCPeerConnection.prototype.removeStream=function(oe){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.apply(this,[this._streams[oe.id]||oe]),delete this._reverseStreams[this._streams[oe.id]?this._streams[oe.id].id:oe.id],delete this._streams[oe.id]},v.RTCPeerConnection.prototype.addTrack=function(oe,me){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const we=[].slice.call(arguments,1);if(we.length!==1||!we[0].getTracks().find(wt=>wt===oe))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(wt=>wt.track===oe))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const ot=this._streams[me.id];if(ot)ot.addTrack(oe),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const wt=new v.MediaStream([oe]);this._streams[me.id]=wt,this._reverseStreams[wt.id]=me,this.addStream(wt)}return this.getSenders().find(wt=>wt.track===oe)};function ee(ne,oe){let me=oe.sdp;return Object.keys(ne._reverseStreams||[]).forEach(we=>{const qe=ne._reverseStreams[we],ot=ne._streams[qe.id];me=me.replace(new RegExp(ot.id,"g"),qe.id)}),new RTCSessionDescription({type:oe.type,sdp:me})}function te(ne,oe){let me=oe.sdp;return Object.keys(ne._reverseStreams||[]).forEach(we=>{const qe=ne._reverseStreams[we],ot=ne._streams[qe.id];me=me.replace(new RegExp(qe.id,"g"),ot.id)}),new RTCSessionDescription({type:oe.type,sdp:me})}["createOffer","createAnswer"].forEach(function(ne){const oe=v.RTCPeerConnection.prototype[ne],me={[ne](){const we=arguments;return arguments.length&&typeof arguments[0]=="function"?oe.apply(this,[ot=>{const wt=ee(this,ot);we[0].apply(null,[wt])},ot=>{we[1]&&we[1].apply(null,ot)},arguments[2]]):oe.apply(this,arguments).then(ot=>ee(this,ot))}};v.RTCPeerConnection.prototype[ne]=me[ne]});const W=v.RTCPeerConnection.prototype.setLocalDescription;v.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?W.apply(this,arguments):(arguments[0]=te(this,arguments[0]),W.apply(this,arguments))};const de=Object.getOwnPropertyDescriptor(v.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(v.RTCPeerConnection.prototype,"localDescription",{get(){const ne=de.get.apply(this);return ne.type===""?ne:ee(this,ne)}}),v.RTCPeerConnection.prototype.removeTrack=function(oe){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!oe._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(oe._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let we;Object.keys(this._streams).forEach(qe=>{this._streams[qe].getTracks().find(wt=>oe.track===wt)&&(we=this._streams[qe])}),we&&(we.getTracks().length===1?this.removeStream(this._reverseStreams[we.id]):we.removeTrack(oe.track),this.dispatchEvent(new Event("negotiationneeded")))}}function ge(v){const j=Y(v);if(!v.RTCPeerConnection&&v.webkitRTCPeerConnection&&(v.RTCPeerConnection=v.webkitRTCPeerConnection),!v.RTCPeerConnection)return;const X=v.RTCPeerConnection.prototype.addIceCandidate.length===0;j.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){const ee=v.RTCPeerConnection.prototype[c],te={[c](){return arguments[0]=new(c==="addIceCandidate"?v.RTCIceCandidate:v.RTCSessionDescription)(arguments[0]),ee.apply(this,arguments)}};v.RTCPeerConnection.prototype[c]=te[c]});const U=v.RTCPeerConnection.prototype.addIceCandidate;v.RTCPeerConnection.prototype.addIceCandidate=function(){return!X&&!arguments[0]?(arguments[1]&&arguments[1].apply(null),Promise.resolve()):j.version<78&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():U.apply(this,arguments)}}function pe(v){const j=Y(v);ie(v,"negotiationneeded",X=>{const U=X.target;if(!((j.version<72||U.getConfiguration&&U.getConfiguration().sdpSemantics==="plan-b")&&U.signalingState!=="stable"))return X})}function Ue(v,j){let X=!1;return v=JSON.parse(JSON.stringify(v)),v.filter(U=>{if(U&&(U.urls||U.url)){var c=U.urls||U.url;U.url&&!U.urls&&B("RTCIceServer.url","RTCIceServer.urls");const ee=typeof c=="string";return ee&&(c=[c]),c=c.filter(te=>{if(te.indexOf("stun:")===0)return!1;const W=te.startsWith("turn")&&!te.startsWith("turn:[")&&te.includes("transport=udp");return W&&!X?(X=!0,!0):W&&!X}),delete U.url,U.urls=ee?c[0]:c,!!c.length}})}var _e=I(134),Fe=I.n(_e);function He(v){const j=v&&v.navigator,X=function(c){return{name:{PermissionDeniedError:"NotAllowedError"}[c.name]||c.name,message:c.message,constraint:c.constraint,toString(){return this.name}}},U=j.mediaDevices.getUserMedia.bind(j.mediaDevices);j.mediaDevices.getUserMedia=function(c){return U(c).catch(ee=>Promise.reject(X(ee)))}}function Ne(v){"getDisplayMedia"in v.navigator&&v.navigator.mediaDevices&&(v.navigator.mediaDevices&&"getDisplayMedia"in v.navigator.mediaDevices||(v.navigator.mediaDevices.getDisplayMedia=v.navigator.getDisplayMedia.bind(v.navigator)))}function je(v){const j=Y(v);if(v.RTCIceGatherer&&(v.RTCIceCandidate||(v.RTCIceCandidate=function(c){return c}),v.RTCSessionDescription||(v.RTCSessionDescription=function(c){return c}),j.version<15025)){const U=Object.getOwnPropertyDescriptor(v.MediaStreamTrack.prototype,"enabled");Object.defineProperty(v.MediaStreamTrack.prototype,"enabled",{set(c){U.set.call(this,c);const ee=new Event("enabled");ee.enabled=c,this.dispatchEvent(ee)}})}v.RTCRtpSender&&!("dtmf"in v.RTCRtpSender.prototype)&&Object.defineProperty(v.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new v.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),v.RTCDtmfSender&&!v.RTCDTMFSender&&(v.RTCDTMFSender=v.RTCDtmfSender);const X=Fe()(v,j.version);v.RTCPeerConnection=function(c){return c&&c.iceServers&&(c.iceServers=Ue(c.iceServers,j.version),R("ICE servers after filtering:",c.iceServers)),new X(c)},v.RTCPeerConnection.prototype=X.prototype}function rt(v){v.RTCRtpSender&&!("replaceTrack"in v.RTCRtpSender.prototype)&&(v.RTCRtpSender.prototype.replaceTrack=v.RTCRtpSender.prototype.setTrack)}function Pe(v){const j=Y(v),X=v&&v.navigator,U=v&&v.MediaStreamTrack;if(X.getUserMedia=function(c,ee,te){B("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),X.mediaDevices.getUserMedia(c).then(ee,te)},!(j.version>55&&"autoGainControl"in X.mediaDevices.getSupportedConstraints())){const c=function(te,W,de){W in te&&!(de in te)&&(te[de]=te[W],delete te[W])},ee=X.mediaDevices.getUserMedia.bind(X.mediaDevices);if(X.mediaDevices.getUserMedia=function(te){return typeof te=="object"&&typeof te.audio=="object"&&(te=JSON.parse(JSON.stringify(te)),c(te.audio,"autoGainControl","mozAutoGainControl"),c(te.audio,"noiseSuppression","mozNoiseSuppression")),ee(te)},U&&U.prototype.getSettings){const te=U.prototype.getSettings;U.prototype.getSettings=function(){const W=te.apply(this,arguments);return c(W,"mozAutoGainControl","autoGainControl"),c(W,"mozNoiseSuppression","noiseSuppression"),W}}if(U&&U.prototype.applyConstraints){const te=U.prototype.applyConstraints;U.prototype.applyConstraints=function(W){return this.kind==="audio"&&typeof W=="object"&&(W=JSON.parse(JSON.stringify(W)),c(W,"autoGainControl","mozAutoGainControl"),c(W,"noiseSuppression","mozNoiseSuppression")),te.apply(this,[W])}}}}function ht(v,j){v.navigator.mediaDevices&&"getDisplayMedia"in v.navigator.mediaDevices||v.navigator.mediaDevices&&(v.navigator.mediaDevices.getDisplayMedia=function(U){if(!(U&&U.video)){const c=new DOMException("getDisplayMedia without video constraints is undefined");return c.name="NotFoundError",c.code=8,Promise.reject(c)}return U.video===!0?U.video={mediaSource:j}:U.video.mediaSource=j,v.navigator.mediaDevices.getUserMedia(U)})}function ct(v){typeof v=="object"&&v.RTCTrackEvent&&"receiver"in v.RTCTrackEvent.prototype&&!("transceiver"in v.RTCTrackEvent.prototype)&&Object.defineProperty(v.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ve(v){const j=Y(v);if(typeof v!="object"||!(v.RTCPeerConnection||v.mozRTCPeerConnection))return;if(!v.RTCPeerConnection&&v.mozRTCPeerConnection&&(v.RTCPeerConnection=v.mozRTCPeerConnection),j.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(c){const ee=v.RTCPeerConnection.prototype[c],te={[c](){return arguments[0]=new(c==="addIceCandidate"?v.RTCIceCandidate:v.RTCSessionDescription)(arguments[0]),ee.apply(this,arguments)}};v.RTCPeerConnection.prototype[c]=te[c]}),j.version<68){const c=v.RTCPeerConnection.prototype.addIceCandidate;v.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&arguments[0].candidate===""?Promise.resolve():c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}const X={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},U=v.RTCPeerConnection.prototype.getStats;v.RTCPeerConnection.prototype.getStats=function(){const[ee,te,W]=arguments;return U.apply(this,[ee||null]).then(de=>{if(j.version<53&&!te)try{de.forEach(ne=>{ne.type=X[ne.type]||ne.type})}catch(ne){if(ne.name!=="TypeError")throw ne;de.forEach((oe,me)=>{de.set(me,Object.assign({},oe,{type:X[oe.type]||oe.type}))})}return de}).then(te,W)}}function Xe(v){if(!(typeof v=="object"&&v.RTCPeerConnection&&v.RTCRtpSender)||v.RTCRtpSender&&"getStats"in v.RTCRtpSender.prototype)return;const j=v.RTCPeerConnection.prototype.getSenders;j&&(v.RTCPeerConnection.prototype.getSenders=function(){const c=j.apply(this,[]);return c.forEach(ee=>ee._pc=this),c});const X=v.RTCPeerConnection.prototype.addTrack;X&&(v.RTCPeerConnection.prototype.addTrack=function(){const c=X.apply(this,arguments);return c._pc=this,c}),v.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function St(v){if(!(typeof v=="object"&&v.RTCPeerConnection&&v.RTCRtpSender)||v.RTCRtpSender&&"getStats"in v.RTCRtpReceiver.prototype)return;const j=v.RTCPeerConnection.prototype.getReceivers;j&&(v.RTCPeerConnection.prototype.getReceivers=function(){const U=j.apply(this,[]);return U.forEach(c=>c._pc=this),U}),ie(v,"track",X=>(X.receiver._pc=X.srcElement,X)),v.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function lt(v){!v.RTCPeerConnection||"removeStream"in v.RTCPeerConnection.prototype||(v.RTCPeerConnection.prototype.removeStream=function(X){B("removeStream","removeTrack"),this.getSenders().forEach(U=>{U.track&&X.getTracks().includes(U.track)&&this.removeTrack(U)})})}function We(v){v.DataChannel&&!v.RTCDataChannel&&(v.RTCDataChannel=v.DataChannel)}function Ye(v){if(!(typeof v=="object"&&v.RTCPeerConnection))return;const j=v.RTCPeerConnection.prototype.addTransceiver;j&&(v.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const U=arguments[1],c=U&&"sendEncodings"in U;c&&U.sendEncodings.forEach(te=>{if("rid"in te&&!/^[a-z0-9]{0,16}$/i.test(te.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in te&&!(parseFloat(te.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in te&&!(parseFloat(te.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const ee=j.apply(this,arguments);if(c){const{sender:te}=ee,W=te.getParameters();"encodings"in W||(W.encodings=U.sendEncodings,te.sendEncodings=U.sendEncodings,this.setParametersPromises.push(te.setParameters(W).then(()=>{delete te.sendEncodings}).catch(()=>{delete te.sendEncodings})))}return ee})}function ze(v){if(!(typeof v=="object"&&v.RTCRtpSender))return;const j=v.RTCRtpSender.prototype.getParameters;j&&(v.RTCRtpSender.prototype.getParameters=function(){var U=j.apply(this,arguments);return"sendEncodings"in this?Object.assign({},{encodings:this.sendEncodings},U):U})}function qt(v){if(!(typeof v=="object"&&v.RTCPeerConnection))return;const j=v.RTCPeerConnection.prototype.createOffer;v.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>j.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):j.apply(this,arguments)}}function Ft(v){if(!(typeof v=="object"&&v.RTCPeerConnection))return;const j=v.RTCPeerConnection.prototype.createAnswer;v.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>j.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):j.apply(this,arguments)}}function ri(v){if(!(typeof v!="object"||!v.RTCPeerConnection)){if("getLocalStreams"in v.RTCPeerConnection.prototype||(v.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in v.RTCPeerConnection.prototype)){const j=v.RTCPeerConnection.prototype.addTrack;v.RTCPeerConnection.prototype.addStream=function(U){this._localStreams||(this._localStreams=[]),this._localStreams.includes(U)||this._localStreams.push(U),U.getAudioTracks().forEach(c=>j.call(this,c,U)),U.getVideoTracks().forEach(c=>j.call(this,c,U))},v.RTCPeerConnection.prototype.addTrack=function(U,...c){return c&&c.forEach(ee=>{this._localStreams?this._localStreams.includes(ee)||this._localStreams.push(ee):this._localStreams=[ee]}),j.apply(this,arguments)}}"removeStream"in v.RTCPeerConnection.prototype||(v.RTCPeerConnection.prototype.removeStream=function(X){this._localStreams||(this._localStreams=[]);const U=this._localStreams.indexOf(X);if(U===-1)return;this._localStreams.splice(U,1);const c=X.getTracks();this.getSenders().forEach(ee=>{c.includes(ee.track)&&this.removeTrack(ee)})})}}function Mi(v){if(!(typeof v!="object"||!v.RTCPeerConnection)&&("getRemoteStreams"in v.RTCPeerConnection.prototype||(v.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in v.RTCPeerConnection.prototype))){Object.defineProperty(v.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(X){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=X),this.addEventListener("track",this._onaddstreampoly=U=>{U.streams.forEach(c=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(c))return;this._remoteStreams.push(c);const ee=new Event("addstream");ee.stream=c,this.dispatchEvent(ee)})})}});const j=v.RTCPeerConnection.prototype.setRemoteDescription;v.RTCPeerConnection.prototype.setRemoteDescription=function(){const U=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(c){c.streams.forEach(ee=>{if(U._remoteStreams||(U._remoteStreams=[]),U._remoteStreams.indexOf(ee)>=0)return;U._remoteStreams.push(ee);const te=new Event("addstream");te.stream=ee,U.dispatchEvent(te)})}),j.apply(U,arguments)}}}function Jt(v){if(typeof v!="object"||!v.RTCPeerConnection)return;const j=v.RTCPeerConnection.prototype,X=j.createOffer,U=j.createAnswer,c=j.setLocalDescription,ee=j.setRemoteDescription,te=j.addIceCandidate;j.createOffer=function(ne,oe){const me=arguments.length>=2?arguments[2]:arguments[0],we=X.apply(this,[me]);return oe?(we.then(ne,oe),Promise.resolve()):we},j.createAnswer=function(ne,oe){const me=arguments.length>=2?arguments[2]:arguments[0],we=U.apply(this,[me]);return oe?(we.then(ne,oe),Promise.resolve()):we};let W=function(de,ne,oe){const me=c.apply(this,[de]);return oe?(me.then(ne,oe),Promise.resolve()):me};j.setLocalDescription=W,W=function(de,ne,oe){const me=ee.apply(this,[de]);return oe?(me.then(ne,oe),Promise.resolve()):me},j.setRemoteDescription=W,W=function(de,ne,oe){const me=te.apply(this,[de]);return oe?(me.then(ne,oe),Promise.resolve()):me},j.addIceCandidate=W}function Qt(v){const j=v&&v.navigator;if(j.mediaDevices&&j.mediaDevices.getUserMedia){const X=j.mediaDevices,U=X.getUserMedia.bind(X);j.mediaDevices.getUserMedia=c=>U(Ut(c))}!j.getUserMedia&&j.mediaDevices&&j.mediaDevices.getUserMedia&&(j.getUserMedia=(function(U,c,ee){j.mediaDevices.getUserMedia(U).then(c,ee)}).bind(j))}function Ut(v){return v&&v.video!==void 0?Object.assign({},v,{video:ve(v.video)}):v}function Li(v){if(!v.RTCPeerConnection)return;const j=v.RTCPeerConnection;v.RTCPeerConnection=function(U,c){if(U&&U.iceServers){const ee=[];for(let te=0;te<U.iceServers.length;te++){let W=U.iceServers[te];!W.hasOwnProperty("urls")&&W.hasOwnProperty("url")?(B("RTCIceServer.url","RTCIceServer.urls"),W=JSON.parse(JSON.stringify(W)),W.urls=W.url,delete W.url,ee.push(W)):ee.push(U.iceServers[te])}U.iceServers=ee}return new j(U,c)},v.RTCPeerConnection.prototype=j.prototype,"generateCertificate"in j&&Object.defineProperty(v.RTCPeerConnection,"generateCertificate",{get(){return j.generateCertificate}})}function en(v){typeof v=="object"&&v.RTCTrackEvent&&"receiver"in v.RTCTrackEvent.prototype&&!("transceiver"in v.RTCTrackEvent.prototype)&&Object.defineProperty(v.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ut(v){const j=v.RTCPeerConnection.prototype.createOffer;v.RTCPeerConnection.prototype.createOffer=function(U){if(U){typeof U.offerToReceiveAudio<"u"&&(U.offerToReceiveAudio=!!U.offerToReceiveAudio);const c=this.getTransceivers().find(te=>te.receiver.track.kind==="audio");U.offerToReceiveAudio===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):U.offerToReceiveAudio===!0&&!c&&this.addTransceiver("audio"),typeof U.offerToReceiveVideo<"u"&&(U.offerToReceiveVideo=!!U.offerToReceiveVideo);const ee=this.getTransceivers().find(te=>te.receiver.track.kind==="video");U.offerToReceiveVideo===!1&&ee?ee.direction==="sendrecv"?ee.setDirection?ee.setDirection("sendonly"):ee.direction="sendonly":ee.direction==="recvonly"&&(ee.setDirection?ee.setDirection("inactive"):ee.direction="inactive"):U.offerToReceiveVideo===!0&&!ee&&this.addTransceiver("video")}return j.apply(this,arguments)}}function Ni(v){typeof v!="object"||v.AudioContext||(v.AudioContext=v.webkitAudioContext)}var Sn=I(985),tn=I.n(Sn);function wi(v){if(!v.RTCIceCandidate||v.RTCIceCandidate&&"foundation"in v.RTCIceCandidate.prototype)return;const j=v.RTCIceCandidate;v.RTCIceCandidate=function(U){if(typeof U=="object"&&U.candidate&&U.candidate.indexOf("a=")===0&&(U=JSON.parse(JSON.stringify(U)),U.candidate=U.candidate.substr(2)),U.candidate&&U.candidate.length){const c=new j(U),ee=tn().parseCandidate(U.candidate),te=Object.assign(c,ee);return te.toJSON=function(){return{candidate:te.candidate,sdpMid:te.sdpMid,sdpMLineIndex:te.sdpMLineIndex,usernameFragment:te.usernameFragment}},te}return new j(U)},v.RTCIceCandidate.prototype=j.prototype,ie(v,"icecandidate",X=>(X.candidate&&Object.defineProperty(X,"candidate",{value:new v.RTCIceCandidate(X.candidate),writable:"false"}),X))}function xi(v){if(!v.RTCPeerConnection)return;const j=Y(v);"sctp"in v.RTCPeerConnection.prototype||Object.defineProperty(v.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const X=function(W){if(!W||!W.sdp)return!1;const de=tn().splitSections(W.sdp);return de.shift(),de.some(ne=>{const oe=tn().parseMLine(ne);return oe&&oe.kind==="application"&&oe.protocol.indexOf("SCTP")!==-1})},U=function(W){const de=W.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(de===null||de.length<2)return-1;const ne=parseInt(de[1],10);return ne!==ne?-1:ne},c=function(W){let de=65536;return j.browser==="firefox"&&(j.version<57?W===-1?de=16384:de=2147483637:j.version<60?de=j.version===57?65535:65536:de=2147483637),de},ee=function(W,de){let ne=65536;j.browser==="firefox"&&j.version===57&&(ne=65535);const oe=tn().matchPrefix(W.sdp,"a=max-message-size:");return oe.length>0?ne=parseInt(oe[0].substr(19),10):j.browser==="firefox"&&de!==-1&&(ne=2147483637),ne},te=v.RTCPeerConnection.prototype.setRemoteDescription;v.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,j.browser==="chrome"&&j.version>=76){const{sdpSemantics:de}=this.getConfiguration();de==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(X(arguments[0])){const de=U(arguments[0]),ne=c(de),oe=ee(arguments[0],de);let me;ne===0&&oe===0?me=Number.POSITIVE_INFINITY:ne===0||oe===0?me=Math.max(ne,oe):me=Math.min(ne,oe);const we={};Object.defineProperty(we,"maxMessageSize",{get(){return me}}),this._sctp=we}return te.apply(this,arguments)}}function jt(v){if(!(v.RTCPeerConnection&&"createDataChannel"in v.RTCPeerConnection.prototype))return;function j(U,c){const ee=U.send;U.send=function(){const W=arguments[0],de=W.length||W.size||W.byteLength;if(U.readyState==="open"&&c.sctp&&de>c.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+c.sctp.maxMessageSize+" bytes)");return ee.apply(U,arguments)}}const X=v.RTCPeerConnection.prototype.createDataChannel;v.RTCPeerConnection.prototype.createDataChannel=function(){const c=X.apply(this,arguments);return j(c,this),c},ie(v,"datachannel",U=>(j(U.channel,U.target),U))}function Yt(v){if(!v.RTCPeerConnection||"connectionState"in v.RTCPeerConnection.prototype)return;const j=v.RTCPeerConnection.prototype;Object.defineProperty(j,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(j,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(X){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),X&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=X)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(X=>{const U=j[X];j[X]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=c=>{const ee=c.target;if(ee._lastConnectionState!==ee.connectionState){ee._lastConnectionState=ee.connectionState;const te=new Event("connectionstatechange",c);ee.dispatchEvent(te)}return c},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),U.apply(this,arguments)}})}function Xt(v){if(!v.RTCPeerConnection)return;const j=Y(v);if(j.browser==="chrome"&&j.version>=71||j.browser==="safari"&&j.version>=605)return;const X=v.RTCPeerConnection.prototype.setRemoteDescription;v.RTCPeerConnection.prototype.setRemoteDescription=function(c){return c&&c.sdp&&c.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1&&(c.sdp=c.sdp.split(`
`).filter(ee=>ee.trim()!=="a=extmap-allow-mixed").join(`
`)),X.apply(this,arguments)}}function Ci({window:v}={},j={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const X=R,U=Y(v),c={browserDetails:U,commonShim:A,extractVersion:V,disableLog:x,disableWarnings:F};switch(U.browser){case"chrome":if(!C||!ge||!j.shimChrome)return X("Chrome shim is not included in this adapter release."),c;if(U.version===null)return X("Chrome shim can not determine version, not shimming."),c;X("adapter.js shimming chrome."),c.browserShim=C,T(v),K(v),ge(v),$(v),Ce(v),ae(v),Se(v),ue(v),pe(v),wi(v),Yt(v),xi(v),jt(v),Xt(v);break;case"firefox":if(!S||!Ve||!j.shimFirefox)return X("Firefox shim is not included in this adapter release."),c;X("adapter.js shimming firefox."),c.browserShim=S,Pe(v),Ve(v),ct(v),lt(v),Xe(v),St(v),We(v),Ye(v),ze(v),qt(v),Ft(v),wi(v),Yt(v),xi(v),jt(v);break;case"edge":if(!w||!je||!j.shimEdge)return X("MS edge shim is not included in this adapter release."),c;X("adapter.js shimming edge."),c.browserShim=w,He(v),Ne(v),je(v),rt(v),xi(v),jt(v);break;case"safari":if(!m||!j.shimSafari)return X("Safari shim is not included in this adapter release."),c;X("adapter.js shimming safari."),c.browserShim=m,Li(v),ut(v),Jt(v),ri(v),Mi(v),en(v),Qt(v),Ni(v),wi(v),xi(v),jt(v),Xt(v);break;default:X("Unsupported browser!");break}return c}Ci({window}),I(853);var Zt=Ragnarok.GridApp,fi=Ragnarok.ChooseStreamingSettings,pi=Ragnarok.ChooseStreamingResolution,Lr=Ragnarok.InitializeUtils,yn=Ragnarok.GetSupportedAudioChannelCount,$n=Ragnarok.GetDeviceCapabilities,si=Ragnarok.getSupportedCodecs,ei=Ragnarok.VirtualButton,_i=Ragnarok.VirtualGamepadHandler,vi=Ragnarok.ConfigureRagnarokSettings,nn=Ragnarok.CHANGELIST,rn=Ragnarok.AddPlatformTelemetry,Fi=Ragnarok.registerLogCallback,Ui=Ragnarok.DeviceOS,ji=Ragnarok.DeviceType,Gi=Ragnarok.DeviceModel,Bi=Ragnarok.DeviceVendor,bn=Ragnarok.IsFeatureSupported,sn=Ragnarok.CalculateMaxBitrateKbps,qn=Ragnarok.CalculateDataUsage,En=Ragnarok.AuthType,Jn=Ragnarok.LogImpl,on=Ragnarok.performHttpRequest,an=Ragnarok.PayloadOSType,Qn=Ragnarok.PayloadBrowserType,dn=Ragnarok.PayloadDeviceType,Nr=Ragnarok.ClientHeaderOSType,Gt=Ragnarok.ClientHeaderBrowserType,Yn=Ragnarok.ClientHeaderDeviceType,wn=Ragnarok.SdrHdrMode,Xn=Ragnarok.BitDepth,Zn=Ragnarok.NetworkType,Cn=Ragnarok.PlatformName,er=Ragnarok.BrowserName,oi=Ragnarok.translatePlatformDetailsForPayload,Vi=Ragnarok.translatePlatformDetailsForClientHeader,tr=Ragnarok.EVENTS,ir=Ragnarok.HotkeyModifier,In=Ragnarok.defaultInputConfigFlags,nr=Ragnarok.StreamingProfilePreset,cn=Ragnarok.TrackType,rr=Ragnarok.STREAMING_STATE,sr=Ragnarok.RNotificationCode,Tn=Ragnarok.ClientType,Hi=Ragnarok.SessionState,Rn=Ragnarok.SessionProgressState,or=Ragnarok.AppLaunchMode,b=Ragnarok.createSessionControl,P=Ragnarok.Usage,k=Ragnarok.Protocol,q=Ragnarok.AppLevelProtocol,re=Ragnarok.AdState,he=Ragnarok.AdAction,Te=Ragnarok.updateSessionParameters,Le=Ragnarok.isResumableSessionState,De=Ragnarok.getResumableSession,$e=Ragnarok.isCancelCode,Bt=Ragnarok.ScErrorCode,Wi=Ragnarok.configureSessionControlSettings,ai=Ragnarok.GsErrorCode,ti=Ragnarok.GridServerSettings,Ii=Ragnarok.ConfigureGridServerSettings,zi=Ragnarok.getPlatformDetails,xr=Ragnarok.LogLevel,gi=Ragnarok.CLIENT_VERSION,fs=Ragnarok.CLIENT_IDENTIFICATION,Ko=Ragnarok.SESSIONMODIFY_ACTION,ar=Ragnarok.AudioFormat,ps=Ragnarok.ClientStreamer,$o=Ragnarok.GS_EVENTS,qo=Ragnarok.GridServer,Jo=Ragnarok.PassThruServer,Qo=Ragnarok.RErrorCode,ii=Ragnarok.VsyncType,mi=Ragnarok.getDeviceCapabilities,vs=Ragnarok.serializeDeviceCapabilities,dr=Ragnarok.prefetchDeviceCapabilities,st=Ragnarok.registerDeviceCapabilitiesChanged,Ti=Ragnarok.unregisterDeviceCapabilitiesChanged,di=Ragnarok.decodeWsErrorCodes,cr=Ragnarok.getStreamerType,gs=Ragnarok.BrowserFeature,ms=Ragnarok.isFeatureSupported,As=Ragnarok.shouldDefaultEnableMic,Ss=Ragnarok.getRecommendedBitrate,ys=Ragnarok.getStreamStartParameters,Yo=Ragnarok.estimateDataUsage,Xo=Ragnarok.createNskStreamClient,kn=Ragnarok.configureStreamKitSettings,bs=Ragnarok.getNetworkTypeDetector,_r=Ragnarok.HidType,Es=Ragnarok.InputType,Zo=Ragnarok.VideoCodecType,Fr=Ragnarok.MicState,ws=Ragnarok.DynamicStreamingMode,ea=Ragnarok.MediaTrackKind,Ur=Ragnarok.StreamStopReason,ta=Ragnarok.StreamWarningType,lr=Ragnarok.CursorType,Cs=Ragnarok.StreamingState})(),f.exports=M})()})(Pc);var O=Pc.exports;class An{static browser(){return this._clientDetails.browser||"Unknown"}static browserVersion(){return this._clientDetails.browserFullVer}static os(){return this._clientDetails.os||"Unknown"}static osVersion(){return this._clientDetails.osVersion}static platformType(){var a;return(a=this._clientDetails.platformType)==null?void 0:a.toLowerCase()}static async platformDetails(){if(!this._clientDetails){const a=await O.getPlatformDetails();this._clientDetails=a,Object.freeze(this._clientDetails)}return this._clientDetails}}ke(An,"_clientDetails");function fv(f){return f>>>0}function pv(f){return f=fv(f),"0x"+("00000000"+f.toString(16).toUpperCase()).slice(-8)}function vv(f){const a=f.split(".");if(a.length!==4)return!1;for(const g of a){const I=parseInt(g);if(isNaN(I))return!1}return!0}function Yc(f){const a=f.split(".");if(a.length!==4)return!1;for(const g of a){const I=parseInt(g);if(isNaN(I)||I<0||I>255)return!1}return!0}function gv(f){return f.os===ft.IPADOS}function mv(f){return f.os===ft.IOS}function Av(f){return mv(f)||gv(f)}function Sv(f){if(f){const a=Number.parseInt(f);if(!Number.isNaN(a))return a}}function yv(f){let a=new TextEncoder().encode(f),g=new ArrayBuffer(a.byteLength),I=new DataView(g);for(let M=0;M<a.byteLength;M++)I.setUint8(M,a[M]);return g}class Xc{static map(a){switch(a){case O.RErrorCode.AuthProviderError:return"Error happened during request to auth provider.";case O.RErrorCode.NoNetwork:return"No internet connection.";case O.RErrorCode.NetworkError:return"A network error occurred.";case O.RErrorCode.GetActiveSessionServerError:return"Error occurred due to GetActiveSessionServerError.";case O.RErrorCode.ExceptionHappened:return"Unexpected exception happened.";case O.RErrorCode.AuthTokenNotUpdated:return"Error occurred due to AuthTokenNotUpdated.";case O.RErrorCode.SessionFinishedState:return"Unexpected session state while polling.";case O.RErrorCode.ResponseParseFailure:return"Failed to parse server response.";case O.RErrorCode.StreamerVideoPlayError:return"Video play failure.";case O.RErrorCode.GridAppNotInitialized:return"Grid app instance was not initialized.";case O.RErrorCode.SessionLimitExceeded:return"Session Limit Exceeded.";case O.RErrorCode.StreamErrorGeneric:return"Some generic error happened in streamer.";case O.RErrorCode.StreamerSignInFailure:return"Error occurred during sign-in request to signaling server.";case O.RErrorCode.StreamerHangingGetFailure:return"Error occurred in hanging get request of peer connection.";case O.RErrorCode.StreamerIceConnectionFailed:return"Could not find valid ice candidate pair.";case O.RErrorCode.StreamerGetRemotePeerTimedOut:return"Streaming stopped due to no remote peer.";case O.RErrorCode.StreamInputChannelError:return"Streaming stopped due to input channel error.";case O.RErrorCode.StreamCursorChannelError:return"Streaming stopped due to cursor channel error.";case O.RErrorCode.StreamControlChannelError:return"Streaming stopped due to control channel error.";case O.RErrorCode.StreamerIceReConnectionFailed:return"Reconnect attempt failed after network problem, or remote peer not alive.";case O.RErrorCode.StreamerNoVideoPacketsReceivedEver:return"Streaming stopped as NoVideoPacketsReceivedEver.";case O.RErrorCode.StreamerNoVideoFramesLossyNetwork:return"Streaming stopped as NoVideoFramesLossyNetwork.";case O.RErrorCode.StreamDisconnectedFromServer:return"Stream disconnected from server, unknown reason.";case O.RErrorCode.ServerDisconnectedNoResponse:return"Stream disconnected from server, NoResponse.";case O.RErrorCode.ServerDisconnectedRemoteInputError:return"Stream disconnected from server, RemoteInputError.";case O.RErrorCode.ServerDisconnectedFrameGrabFailed:return"Stream disconnected from server, FrameGrabFailed.";case O.RErrorCode.ServerDisconnectedConfigUnAvailable:return"Stream disconnected from server, ConfigUnAvailable.";case O.RErrorCode.ServerDisconnectedInvalidCommand:return"Stream disconnected from server, InvalidCommand.";case O.RErrorCode.ServerDisconnectedInvalidMouseState:return"Stream disconnected from server, InvalidMouseState.";case O.RErrorCode.ServerDisconnectedNetworkError:return"Stream disconnected from server, NetworkError.";case O.RErrorCode.ServerDisconnectedGameLaunchFailed:return"Stream disconnected from server, GameLaunchFailed.";case O.RErrorCode.ServerDisconnectedVideoFirstFrameSendFailed:return"Stream disconnected from server, VideoFirstFrameSendFailed.";case O.RErrorCode.ServerDisconnectedVideoNextFrameSendFailed:return"Stream disconnected from server, VideoNextFrameSendFailed.";case O.RErrorCode.ServerDisconnectedFrameGrabTimedOut:return"Stream disconnected from server, FrameGrabTimedOut.";case O.RErrorCode.ServerDisconnectedFrameEncodeTimedOut:return"Stream disconnected from server, FrameEncodeTimedOut.";case O.RErrorCode.ServerDisconnectedFrameSendTimedOut:return"Stream disconnected from server, FrameSendTimedOut.";case O.RErrorCode.ServerDisconnectedIntended:return"Stream disconnected from server as user quit the game.";case O.RErrorCode.ServerDisconnectedUserLoggedInDifferentAccount:return"Stream disconnected from server, userLoggedInDifferentAccount.";case O.RErrorCode.ServerDisconnectedWindowedMode:return"Stream disconnected from server, WindowedMode.";case O.RErrorCode.ServerDisconnectedUserIdle:return"Stream disconnected from server, UserIdle.";case O.RErrorCode.ServerDisconnectedUnAuthorizedProcessDetected:return"Stream disconnected from server, UnAuthorizedProcessDetected.";case O.RErrorCode.ServerDisconnectedMaliciousProcessDetected:return"Stream disconnected from server, MaliciousProcessDetected.";case O.RErrorCode.ServerDisconnectedUnKnownProcessDetected:return"Stream disconnected from server, UnKnownProcessDetected.";case O.RErrorCode.ServerDisconnectedMinerProcessDetected:return"Stream disconnected from server, MinerProcessDetected.";case O.RErrorCode.ServerDisconnectedStreamingUnsupported:return"Stream disconnected from server, StreamingUnsupported.";case O.RErrorCode.ServerDisconnectedAnotherClient:return"Stream disconnected from server, AnotherClient.";case O.RErrorCode.ServerDisconnectedUnknownFromPm:return"Stream disconnected from server, UnknownFromPm.";case O.RErrorCode.ServerDisconnectedUserEntitledMinutesExceeded:return"Stream disconnected from server, UserEntitledMinutesExceeded.";case O.RErrorCode.ServerDisconnectedClientReconnectTimeLimitExceeded:return"Stream disconnected from server, ClientReconnectTimeLimitExceeded.";case O.RErrorCode.ServerDisconnectedOperatorCommandedTermination:return"Stream disconnected from server, OperatorCommandedTermination.";case O.RErrorCode.ServerDisconnectedConcurrentSessionLimitExceeded:return"Stream disconnected from server, ConcurrentSessionLimitExceeded.";case O.RErrorCode.ServerDisconnectedMaxSessionTimeLimitExceeded:return"Stream disconnected from server, MaxSessionTimeLimitExceeded.";case O.RErrorCode.ServerDisconnectedBifrostInitiatedSessionPause:return"Stream disconnected from server, BifrostInitiatedSessionPause.";case O.RErrorCode.ServerDisconnectedSystemCommandTermination:return"Stream disconnected from server, SystemCommandTermination.";case O.RErrorCode.ServerDisconnectedMultipleLogin:return"Stream disconnected from server, MultipleLogin.";case O.RErrorCode.ServerInternalError:return"Session setup failed on server.";case O.RErrorCode.RequestLimitExceeded:return"You have tried to play too many games in a short period of time. Please wait a few minutes and try again.";case O.RErrorCode.EntitlementFailure:return"You are not entitled to play this game. Please check you entitlement.";case O.RErrorCode.AppPatching:return"Game is currently in patching state, please try again later.";case O.RErrorCode.GameNotFound:return"Requested game is not available in the zone. Please try another zone.";case O.RErrorCode.AppMaintenanceStatus:return"Requested game is under maintenance.";case O.RErrorCode.RequiredSeatInstanceTypeNotSupported:return"Required instance type for the game is not available in current zone. Please try different zone.";case O.RErrorCode.ServerSessionQueueLengthExceeded:return"We have reached our limit for the number of gamers who can wait for the next available rig. Please try again later.";case O.RErrorCode.SessionTerminatedByAnotherClient:return"Session setup request was terminated by another client.";case O.RErrorCode.ServerDisconnectedGameNotOwnedByUser:return"Your session ended as you do not own the requested game.";case O.RErrorCode.SystemSleepDuringStreaming:return"Your session ended as device went to sleep during streaming.";case O.RErrorCode.SessionInQueueAbandoned:return"Session abandoned during polling.";case O.RErrorCode.NoInternetDuringSessionSetup:case O.RErrorCode.NoInternetDuringStreaming:return"Cannot connect to server.";case O.RErrorCode.SessionLimitPerDeviceReached:return"There is an active session for this device belonging to another user. Please try again after sometime";case O.RErrorCode.SessionSetupCancelled:case O.RErrorCode.SessionSetupCancelledDuringQueuing:return"Session setup was cancelled, please reconfigure your session.";case O.RErrorCode.StreamerSignInTimeout:return"Sign in request timed out.";case O.RErrorCode.StreamerSignInWorkerFailure:return"Sign in request failed due to worker failure.";case O.RErrorCode.InvalidOperation:return"The operation is invalid.";case O.RErrorCode.InvalidServerResponse:return"The server response is invalid.";case O.RErrorCode.PutOrPostInProgress:return"A PUT or POST operation is already in progress.";case O.RErrorCode.GridServerNotInitialized:return"The grid server is not initialized.";case O.RErrorCode.DOMExceptionInGridServer:return"A DOM exception occurred in the grid server.";case O.RErrorCode.InvalidAdStateTransition:return"Invalid advertisement state transition.";case O.RErrorCode.RequestForbidden:return"The request is forbidden.";case O.RErrorCode.ServerInternalTimeout:return"The server encountered an internal timeout.";case O.RErrorCode.ServerInvalidRequest:return"The server received an invalid request.";case O.RErrorCode.ServerInvalidRequestVersion:return"The request version is invalid.";case O.RErrorCode.SessionListLimitExceeded:return"The session list limit has been exceeded.";case O.RErrorCode.InvalidRequestDataMalformed:return"The request data is malformed.";case O.RErrorCode.InvalidRequestDataMissing:return"The request data is missing.";case O.RErrorCode.InvalidRequestVersionOutOfDate:return"The request version is out of date.";case O.RErrorCode.SessionEntitledTimeExceeded:return"The entitled session time has been exceeded.";case O.RErrorCode.AuthFailure:return"Authentication failed.";case O.RErrorCode.InvalidAuthenticationMalformed:return"The authentication token is malformed.";case O.RErrorCode.InvalidAuthenticationExpired:return"The authentication token has expired.";case O.RErrorCode.InvalidAuthenticationNotFound:return"The authentication token was not found.";case O.RErrorCode.EulaUnAccepted:return"The EULA has not been accepted.";case O.RErrorCode.MaintenanceStatus:return"The system is under maintenance.";case O.RErrorCode.ServiceUnAvailable:return"The service is unavailable.";case O.RErrorCode.SteamGuardRequired:return"Steam Guard is required.";case O.RErrorCode.SteamLoginRequired:return"Steam login is required.";case O.RErrorCode.SteamGuardInvalid:return"The Steam Guard token is invalid.";case O.RErrorCode.SteamProfilePrivate:return"The Steam profile is private.";case O.RErrorCode.InvalidCountryCode:return"The country code is invalid.";case O.RErrorCode.InvalidLanguageCode:return"The language code is invalid.";case O.RErrorCode.MissingCountryCode:return"The country code is missing.";case O.RErrorCode.MissingLanguageCode:return"The language code is missing.";case O.RErrorCode.SessionNotPaused:return"The session is not paused.";case O.RErrorCode.EmailNotVerified:return"The email address is not verified.";case O.RErrorCode.InvalidAuthenticationUnsupportedProtocol:return"The authentication protocol is unsupported.";case O.RErrorCode.InvalidAuthenticationUnknownToken:return"The authentication token is unknown.";case O.RErrorCode.InvalidAuthenticationCredentials:return"The authentication credentials are invalid.";case O.RErrorCode.SessionNotPlaying:return"The session is not in a playing state.";case O.RErrorCode.InvalidServiceResponse:return"The service response is invalid.";case O.RErrorCode.NotEnoughCredits:return"There are not enough credits.";case O.RErrorCode.InvitationOnlyRegistration:return"Registration is by invitation only.";case O.RErrorCode.RegionNotSupportedForRegistration:return"The region is not supported for registration.";case O.RErrorCode.DeviceIdAlreadyUsed:return"The device ID is already in use.";case O.RErrorCode.ServiceNotExist:return"The requested service does not exist.";case O.RErrorCode.SessionExpired:return"The session has expired.";case O.RErrorCode.ForwardingZoneOutOfCapacity:return"The forwarding zone is out of capacity.";case O.RErrorCode.RegionNotSupportedIndefinitely:return"The region is not supported indefinitely.";case O.RErrorCode.RegionBanned:return"The region is banned.";case O.RErrorCode.RegionOnHoldForFree:return"The region is on hold for free users.";case O.RErrorCode.RegionOnHoldForPaid:return"The region is on hold for paid users.";case O.RErrorCode.ResourcePoolNotConfigured:return"The resource pool is not configured.";case O.RErrorCode.InsufficientVmCapacity:return"There is insufficient VM capacity.";case O.RErrorCode.InsufficientRouteCapacity:return"There is insufficient route capacity.";case O.RErrorCode.InsufficientScratchSpaceCapacity:return"There is insufficient scratch space capacity.";case O.RErrorCode.RegionNotSupportedForStreaming:return"The region is not supported for streaming.";case O.RErrorCode.SessionForwardRequestAllocationTimeExpired:return"The session forward request allocation time has expired.";case O.RErrorCode.SessionForwardGameBinariesNotAvailable:return"The game binaries are not available for session forwarding.";case O.RErrorCode.GameBinariesNotAvailableInRegion:return"The game binaries are not available in the region.";case O.RErrorCode.UekRetrievalFailed:return"UEK retrieval failed.";case O.RErrorCode.EntitlementFailureForResource:return"Entitlement failure for the requested resource.";case O.RErrorCode.SessionRemovedFromQueueMaintenance:return"The session was removed from the queue due to maintenance.";case O.RErrorCode.ZoneMaintenanceStatus:return"The zone is under maintenance.";case O.RErrorCode.GuestModeCampaignDisabled:return"Guest mode campaign is disabled.";case O.RErrorCode.RegionNotSupportedAnonymousAccess:return"The region does not support anonymous access.";case O.RErrorCode.InstanceTypeNotSupportedInSingleRegion:return"The instance type is not supported in the single region.";case O.RErrorCode.InvalidZoneForQueuedSession:return"The zone is invalid for the queued session.";case O.RErrorCode.SessionWaitingAdsTimeExpired:return"The session waiting ads time has expired.";case O.RErrorCode.UserCancelledWatchingAds:return"The user cancelled watching ads.";case O.RErrorCode.StreamingNotAllowedInLimitedMode:return"Streaming is not allowed in limited mode.";case O.RErrorCode.ForwardRequestJPMFailed:return"The forward request to JPM failed.";case O.RErrorCode.MaxSessionNumberLimitExceeded:return"The maximum session number limit has been exceeded.";case O.RErrorCode.GuestModePartnerCapacityDisabled:return"Guest mode partner capacity is disabled.";case O.RErrorCode.SessionRejectedNoCapacity:return"The session was rejected due to no capacity.";case O.RErrorCode.SessionInsufficientPlayabilityLevel:return"The session has insufficient playability level.";case O.RErrorCode.StreamerDataChannelClosing:return"The streamer data channel is closing.";case O.RErrorCode.WebPageClosed:return"The web page was closed.";case O.RErrorCode.ClientDisconnectedUserIdle:return"The client was disconnected due to user inactivity.";case O.RErrorCode.UnhandledException:return"An unhandled exception occurred.";case O.RErrorCode.StreamerNoPeerInfo:return"No peer info found.";default:return""}}static defaultMessage(a){return`No displayable error message found for error code ${pv(a)}.`}}var ye=(f=>(f.unknown="unknown",f.active="active",f.configure="configure",f.connect="connect",f.get="get",f.newSession="newSession",f.start="start",f.stop="stop",f.stream="stream",f.terminate="terminate",f.update="update",f.message="message",f.authUser="authUser",f.clipboardCopy="clipboardCopy",f.clipboardPaste="clipboardPaste",f))(ye||{}),Ae=(f=>(f.unknown="unknown",f.inProgress="inProgress",f.success="success",f.canceled="canceled",f.error="error",f.warning="warning",f.waiting="waiting",f))(Ae||{}),Ei=(f=>(f.sessionProgressUpdateEvent="SessionProgressUpdateEvent",f.streamingEvent="StreamingEvent",f.streamUpdateEvent="StreamUpdateEvent",f.startSessionResultEvent="StartSessionResultEvent",f.stopSessionResultEvent="StopSessionResultEvent",f.streamingTerminatedEvent="StreamingTerminatedEvent",f.activeSessionResultEvent="ActiveSessionResultEvent",f.getSessionResult="GetSessionResult",f.logEvent="LogEvent",f))(Ei||{});class it{static convert(a,g){return g==="SessionProgressUpdateEvent"?it.fromSessionProgressUpdateEvent(a):g==="ActiveSessionResultEvent"?it.fromActiveSessionResultEvent(a):g==="StreamingEvent"?it.fromStreamingEvent(a):g==="StreamUpdateEvent"?it.fromStreamUpdateEvent(a):g==="GetSessionResult"?it.fromGetSessionResult(a):g==="StreamingTerminatedEvent"?it.fromStreamingTerminatedEvent(a):g==="StartSessionResultEvent"?it.fromStartSessionResultEvent(a):g==="StopSessionResultEvent"?it.fromStopSessionResultEvent(a):g==="LogEvent"?it.fromLogEvent(a):{action:"unknown",status:"unknown",info:"An unknown event has occurred."}}static fromSessionProgressUpdateEvent(a){const g=a.state===O.SessionProgressState.STARTING_STREAMER?"start":a.state===O.SessionProgressState.CONFIGURING?"configure":a.state===O.SessionProgressState.CONNECTING?"connect":"unknown";return{action:g,status:"inProgress",info:`${g}ing`,sessionId:a.sessionId,subSessionId:a.subSessionId,queuePosition:a.queuePosition,eta:a.eta}}static fromStartSessionResultEvent(a){return{action:"start",status:a!=null&&a.error?"error":"success",info:a!=null&&a.error?it.parseErrorMessage(a):"Session started successfully",sessionId:a.sessionId,subSessionId:a.subSessionId}}static fromStopSessionResultEvent(a){return{action:"stop",status:a!=null&&a.error?"error":"success",info:a!=null&&a.error?it.parseErrorMessage(a):"Session stopped successfully",sessionId:a.sessionId,subSessionId:a.subSessionId}}static fromStreamingEvent(a){return{action:"stream",status:"unknown",info:"streaming"}}static fromStreamUpdateEvent(a){return{action:"update",status:"success",info:"stat-update",stats:{codec:a.codec,fps:a.fps,rtd:a.rtd,avgDecodeTime:a.avgDecodeTime,frameLoss:a.frameLoss,packetLoss:a.packetLoss,totalBandwidth:a.totalBandwidth,currentBitrate:a.currentBitrateMbps,utilizedBandwidth:a.utilizedBandwidth,streamingResolutionHeight:a.streamingResolution.height,streamingResolutionWidth:a.streamingResolution.width}}}static fromStreamingTerminatedEvent(a){return{action:"terminate",status:a!=null&&a.error?"error":"success",info:a!=null&&a.error?it.parseErrorMessage(a):"terminating",sessionId:a.sessionId,subSessionId:a.subSessionId}}static fromActiveSessionResultEvent(a){return{action:"active",status:"unknown",info:"active"}}static fromGetSessionResult(a){return{action:"get",status:"unknown",info:"streaming",sessionId:a.sessionId,subSessionId:a.subSessionId}}static fromLogEvent(a){return{action:"message",status:"unknown",info:a.logstr,sessionId:a.sessionId,subSessionId:void 0}}static toStreamSDKLog(a){return{type:a.status==="error"?"error":a.status==="warning"?"warning":"info",title:a.status,status:a.status==="success"?200:a.status==="error"?500:100,detail:a.info.toString(),request:a.action,sessionId:a.sessionId||null,requestId:null,timestamp:new Date().toISOString(),browser:An.browser(),browserVersion:An.browserVersion(),os:An.os(),osVersion:An.osVersion(),platformType:An.platformType()}}static parseErrorMessage(a){var g,I,M;return((g=a==null?void 0:a.error)==null?void 0:g.description)||Xc.map((I=a==null?void 0:a.error)==null?void 0:I.code)||Xc.defaultMessage((M=a==null?void 0:a.error)==null?void 0:M.code)}}var Uo=(f=>(f[f.DEBUG=0]="DEBUG",f[f.INFO=1]="INFO",f[f.WARN=2]="WARN",f[f.WARNING=2]="WARNING",f[f.ERROR=3]="ERROR",f))(Uo||{});const Et=class Et{static setLogLevel(a){Et.LOG_LEVEL=Uo[a]}static setLogFormat(a){Et.LOG_FORMAT=a}static event(a,g){var C;Kf(a)&&(a=it.convert(a,Ei.logEvent));const I=it.toStreamSDKLog(a),M=Uo[(C=I.type)==null?void 0:C.toUpperCase()];if(M>=Et.LOG_LEVEL)switch(g&&M>0&&g.log(Wn(I,Et.LOG_FORMAT)),M){case 0:console.debug(Wn(I,Et.LOG_FORMAT));break;case 1:console.log(Wn(I,Et.LOG_FORMAT));break;case 2:console.warn(Wn(I,Et.LOG_FORMAT));break;case 3:console.error(Wn(I,Et.LOG_FORMAT));break;default:console.error(`Unsupported log level: ${Wn(I,Et.LOG_FORMAT)}`);break}}static info(a,g){Et.event({action:ye.unknown,status:Ae.success,info:a},g)}static debug(a,g){Et.event({action:ye.unknown,status:Ae.success,info:a},g)}static warn(a,g){Et.event({action:ye.unknown,status:Ae.warning,info:a},g)}static error(a,g){Et.event({action:ye.unknown,status:Ae.error,info:a},g)}};ke(Et,"LOG_LEVEL",2),ke(Et,"LOG_FORMAT",Ir.JSON);let Ie=Et;const Mr=class Mr{constructor(a,g){ke(this,"buffer");ke(this,"maxLength");ke(this,"encoder",new TextEncoder);ke(this,"logIndex",0);ke(this,"full",!1);ke(this,"logfile");this.buffer=new Uint8Array(a+Mr.FULL_MESSAGE.length),this.maxLength=a,this.logfile=g}clear(){this.encoder=new TextEncoder,this.logIndex=0,this.full=!1}log(a){if(this.full)return;let g=this.encoder.encode(a+`
`);this.logIndex+g.byteLength>this.maxLength&&(this.full=!0,g=this.encoder.encode(Mr.FULL_MESSAGE)),this.buffer.set(g,this.logIndex),this.logIndex+=g.byteLength}download(){const a=document.createElement("a");a.style.display="none";const g=new Blob([new DataView(this.buffer.buffer,0,this.logIndex)],{type:"text/plain"}),I=URL.createObjectURL(g);a.href=I,this.logfile?a.download=this.logfile:a.download=`omniverse-streaming-${new Date().toISOString()}.log`,document.body.appendChild(a),a.click(),URL.revokeObjectURL(I),document.body.removeChild(a)}};ke(Mr,"FULL_MESSAGE",`Log is full
`);let jo=Mr;var $t=(f=>(f.WINDOWS="Windows",f.LINUX="Linux",f.MACOS="MacOSX",f.BROWSER="browser",f))($t||{});class bv{constructor(a){ke(this,"sessionStartParams");ke(this,"_sessionId");ke(this,"sessionsToDelete");ke(this,"gridApp");ke(this,"startResult");ke(this,"tracksMap",new Map);ke(this,"totalTracks",0);ke(this,"hasPlatformBeenSimulated",!1);ke(this,"hasAppLaunchBeenSimulated",!1);ke(this,"sessionStartRetryLeft",0);ke(this,"useTelemetry");ke(this,"nativeTouchEvents");ke(this,"videoElement");ke(this,"audioElement");ke(this,"platformDetails");ke(this,"logBuffer");ke(this,"authProvider");ke(this,"queryParams");ke(this,"connectivityTimeout");ke(this,"enableAV1Support");ke(this,"codecList");ke(this,"_onProgressUpdate");ke(this,"_onSessionStartResult");ke(this,"_onStreamStopped");ke(this,"_onActiveSessionResult");ke(this,"_onStreamingEvent");ke(this,"_onGetSessionResult");ke(this,"_onISSOUpdate");ke(this,"_onCustomEvent");ke(this,"_hasFocus",!1);this.sessionStartParams={},this._sessionId="",this.sessionsToDelete=0,this.sessionStartRetryLeft=a.maxSessionStartRetry,this.logBuffer=a.logBuffer,this.authProvider=a.authProvider,this.codecList=a.codecList,this.useTelemetry=a.useTelemetry,this.nativeTouchEvents=a.nativeTouchEvents,this.connectivityTimeout=a.connectivityTimeout,this.enableAV1Support=a.enableAV1Support,this.platformDetails=a.platformDetails,Ie.debug(`Platform details: ${JSON.stringify(this.platformDetails)}`),this.instantiateGridApp(),this.setupHTMLElements(a.videoElementId,a.audioElementId),this.queryParams=new URLSearchParams(a.urlLocation.search),this.setCallbackListeners({onSessionStartResult:a.onSessionStartResult,onStreamStopped:a.onStreamStopped,onActiveSessionResult:a.onActiveSessionResult,onProgressUpdate:a.onProgressUpdate,onStreamingEvent:a.onStreamingEvent,onGetSessionResult:a.onGetSessionResult,onISSOUpdate:a.onISSOUpdate,onCustomEvent:a.onCustomEvent})}connect(a){return this.setCallbackListeners(a)}sessionId(){return this._sessionId}setupHTMLElements(a,g){this.videoElement=document.getElementById(a),this.audioElement=document.getElementById(g),this.audioElement&&(this.audioElement.muted=!0),this.videoElement.muted=!0,this.videoElement.playsInline=!0,this.videoElement.autoplay=!0,this.videoElement.tabIndex=-1,this.videoElement.parentElement.tabIndex=-1,this.videoElement.parentElement.style.outline="none",this.videoElement.parentElement.addEventListener("contextmenu",function(I){I.preventDefault()}),this.videoElement.parentElement.addEventListener("keydown",this.keyUpDownEventHandler.bind(this)),this.videoElement.parentElement.addEventListener("keyup",this.keyUpDownEventHandler.bind(this)),document.addEventListener("focusin",this.focusinEventHandler.bind(this)),document.addEventListener("focusout",this.focusoutEventHandler.bind(this)),this.videoElement.parentElement.addEventListener("pointerdown",this.videoElementClickedEventHandler.bind(this)),this._hasFocus=this.videoElement.parentElement.tabIndex===-1,Ie.debug(`Viewport has focus: ${this._hasFocus}`)}videoElementClickedEventHandler(a){this.videoElement.parentElement.focus()}focusoutEventHandler(a){!a.relatedTarget&&this._hasFocus!==!0&&(Ie.debug("Viewport getting focus"),this._hasFocus=!0,this.tracksMap.size>0&&this.gridApp.toggleUserInput(!0,O.InputType.All))}focusinEventHandler(a){document.activeElement===this.videoElement.parentElement?this._hasFocus!==!0&&(Ie.debug("Viewport getting focus"),this._hasFocus=!0,this.tracksMap.size>0&&this.gridApp.toggleUserInput(!0,O.InputType.All)):this._hasFocus===!0&&(Ie.debug("Viewport losing focus"),this._hasFocus=!1,this.tracksMap.size>0&&this.gridApp.toggleUserInput(!1,O.InputType.Keyboard|O.InputType.Gamepad|O.InputType.Touch))}keyUpDownEventHandler(a){!(a.keyCode==73&&a.ctrlKey&&a.shiftKey)&&!(a.keyCode==67&&a.shiftKey&&a.metaKey)&&!(a.keyCode==68&&a.ctrlKey&&a.shiftKey)&&!(a.code=="Tab"&&a.altKey)&&a.code!="ZoomToggle"&&a.code!="SelectTask"&&a.code!="BrightnessDown"&&a.code!="BrightnessUp"&&a.code!="AudioVolumeMute"&&a.code!="AudioVolumeDown"&&a.code!="AudioVolumeUp"&&!(a.keyCode>=48&&a.keyCode<=57)&&a.code!="Backspace"&&a.preventDefault(),a.keyCode==86&&a.ctrlKey&&this.onPasteClipboardText()}onPasteClipboardText(){navigator.clipboard&&window.isSecureContext?navigator.clipboard.readText().then(a=>{a&&(Ie.event({action:ye.clipboardCopy,status:Ae.success,info:"Clipboard text sent to the server.",sessionId:this.sessionId()||null}),this.gridApp.sendTextInput(yv(a)))}).catch(a=>{Ie.event({action:ye.clipboardCopy,status:Ae.error,info:`Failed to read clipboard contents: ${a}`,sessionId:this.sessionId()||null})}):Ie.event({action:ye.clipboardCopy,status:Ae.error,info:"Cannot read from clipboard because in insecure context.",sessionId:this.sessionId()||null})}onCopyTextToClipboard(a){navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(a).then(()=>{Ie.event({action:ye.clipboardCopy,status:Ae.success,info:`Clipboard text copied from the server: ${a}`,sessionId:this.sessionId()||null})}).catch(g=>{Ie.event({action:ye.clipboardCopy,status:Ae.error,info:`Failed to write to clipboard: ${g}`,sessionId:this.sessionId()||null})}):Ie.event({action:ye.clipboardCopy,status:Ae.error,info:"Cannot write to clipboard because in insecure context.",sessionId:this.sessionId()||null})}getQueryParam(a){return this.queryParams.get(a)}onLogEvent(a){a.sessionId=a.sessionId||this.sessionId()||null,Ie.event(a,this.logBuffer)}updateEventDataElements(){var a;(a=this.gridApp)==null||a.updateEventDataElements({commonData:{clientId:"78589530426925203",clientVer:"2.0.45.34",clientVariant:"Release",eventSchemaVer:"23.0",eventSysVer:"0.12.2",deviceId:this.authProvider.getDeviceId(),userId:this.authProvider.getUserId(),externalUserId:this.authProvider.getExternalUserId(),idpId:this.authProvider.getIdpId(),integrationId:"undefined",sessionId:"92774af7-fbc1-488f-a090-ba49cfd13da2",deviceOS:Wf(this.platformDetails.os),deviceOSVersion:this.platformDetails.osVer,deviceType:Vf(this.platformDetails.deviceType),deviceMake:"APPLE",deviceModel:"undefined",clientType:"Browser",browserType:Hf(this.platformDetails.browser),platform:"Web",eventProtocol:"1.4",deviceGdprFuncOptIn:"Full",deviceGdprTechOptIn:"None",deviceGdprBehOptIn:"None",gdprFuncOptIn:"Full",gdprTechOptIn:"Full",gdprBehOptIn:"Full"},experiments:[{id:"6376d3bf-3f62-419d-989c-2955c25f2b4e",group:"ENABLE"},{id:"feb30a68-ee9a-44a0-a717-da2d28c81e97",group:"ENABLE"},{id:"ea128779-32c7-45c1-94c8-c9374d64219d",group:"ENABLE"},{id:"ac00061b-eb8d-4d6c-978a-f3ac96f8e91a",group:"ENABLE"},{id:"21f7e7af-b5ae-4c76-b269-3cc4351671d2",group:"ENABLE"},{id:"b205ded0-6c08-4436-b818-f0bde4633f08",group:"ENABLE"},{id:"d639ef8f-c6c5-4931-8e75-451e9e075c62",group:"ENABLE"},{id:"cdce276d-d611-4ef9-ba6f-a90c3e7040d4",group:"ENABLE"},{id:"4c57b739-c860-4c5e-b3e4-9d89ff91b561",group:"ENABLE"},{id:"86bf4cf1-b717-4f72-8414-0f40d6a32656",group:"ENABLE"}],config:{server:"https://events.gfestage.nvidia.com",version:"v1.0"},telemetryEventIds:{streamingProfileGuid:"testClientStreamingProfileGuid",systemInfoGuid:"testClientSystemInfoGuid"}})}setCallbackListeners(a){return this.gridApp?(this._onProgressUpdate=a.onProgressUpdate,this._onSessionStartResult=a.onSessionStartResult,this._onStreamStopped=a.onStreamStopped,this._onActiveSessionResult=a.onActiveSessionResult,this._onStreamingEvent=a.onStreamingEvent,this._onGetSessionResult=a.onGetSessionResult,this._onISSOUpdate=a.onISSOUpdate,this._onCustomEvent=a.onCustomEvent,this.gridApp.addListener(O.EVENTS.SESSION_START_RESULT,this.onSessionStartResult.bind(this)),this.gridApp.addListener(O.EVENTS.SESSION_STOP_RESULT,this.onSessionStopResult.bind(this)),this.gridApp.addListener(O.EVENTS.ACTIVE_SESSIONS_RESULT,this.onActiveSessionResult.bind(this)),this.gridApp.addListener(O.EVENTS.PROGRESS_UPDATE,this.onProgressUpdate.bind(this)),this.gridApp.addListener(O.EVENTS.STREAM_STOPPED,this.onStreamStopped.bind(this)),this.gridApp.addListener(O.EVENTS.STREAMING_EVENT,this.onStreamingEvent.bind(this)),this.gridApp.addListener(O.EVENTS.GET_SESSION_RESULT,this.onGetSessionResult.bind(this)),this.gridApp.addListener(O.EVENTS.CUSTOM_MESSAGE,this.onCustomMessage.bind(this)),this.gridApp.addListener(O.EVENTS.STREAM_STATS_UPDATE,this.onISSOUpdate.bind(this)),this.gridApp.addListener(O.EVENTS.LOG_EVENT,this.onLogEvent.bind(this)),!0):!1}instantiateGridApp(){this.gridApp||(Ie.debug("Instantiating grid app."),this.gridApp=new O.GridApp(this.platformDetails))}handleActiveSessions(a){for(let g=0;g<a.length;g++)if(this.sessionStartParams.appId==a[g].appId&&(a[g].state==O.SessionState.READY_FOR_CONNECTION||a[g].state==O.SessionState.STREAMING||a[g].state==O.SessionState.PAUSED)){Ie.debug("Existing session found with the appid "+a[g].appId+" and SessionState "+a[g].state),this.sessionStartParams.appLaunchMode==O.AppLaunchMode.TouchFriendly&&a[g].appLaunchMode!=O.AppLaunchMode.TouchFriendly&&(this.sessionStartParams.appLaunchMode=O.AppLaunchMode.Default,Ie.warn("session "+a[g].sessionId+" was not launched in touch friendly mode, ignoring touch input mode.")),this.gridApp.resumeSession(this.sessionStartParams,a[g].sessionId);return}this.sessionsToDelete=a.length;for(let g=0;g<a.length;g++)this.gridApp.stopSession(a[g].sessionId)}resetTrackInfo(){this.totalTracks=0,this.tracksMap.clear()}playTrack(a,g){const I=g.play(),M=C=>{var S;const w=((S=g.srcObject)==null?void 0:S.getTracks())||[];w.length===0&&Ie.event({action:ye.start,status:Ae.error,info:`No tracks found for ${a}`,sessionId:this.sessionId()||null});for(const m of w)this.tracksMap.set(m.id,C)};if(I){const C=this._hasFocus;I.then(()=>{Ie.debug(`${a} play succeeded.`),g instanceof HTMLVideoElement&&(C?this.gridApp.toggleUserInput(!0,O.InputType.All):this.gridApp.toggleUserInput(!0,O.InputType.Mouse)),M(!0)}).catch(w=>{Ie.event({action:ye.start,status:Ae.error,info:`Play failed: ${w==null?void 0:w.name} , ${w==null?void 0:w.message}`,sessionId:this.sessionId()||null}),M(!1),this.gridApp.stopSession(this.sessionId())})}else g instanceof HTMLVideoElement&&(this._hasFocus?this.gridApp.toggleUserInput(!0,O.InputType.All):this.gridApp.toggleUserInput(!0,O.InputType.Mouse)),M(!0)}playMedia(){for(let a of this.startResult.streams)for(let g of a.tracks)g.kind===O.TrackType.VIDEO&&this.videoElement.srcObject?this.playTrack(g.trackId,this.videoElement):g.kind===O.TrackType.AUDIO&&this.audioElement.srcObject&&this.playTrack(g.trackId,this.audioElement)}onSessionStartResult(a){let g=!1;if(a.error)g=a.error.code!==O.RErrorCode.SessionLimitExceeded&&a.error.code!==O.RErrorCode.SessionLimitPerDeviceReached&&a.error.code!==O.RErrorCode.SessionSetupCancelled&&a.error.code!==O.RErrorCode.SessionSetupCancelledDuringQueuing&&this.sessionStartRetryLeft>0,a.error.code==O.RErrorCode.SessionLimitExceeded?a.sessionList?(Ie.event({action:ye.start,status:Ae.error,info:`Session limit reached. Number of active sessions: ${a.sessionList.length}`,sessionId:this.sessionId()||null}),a.sessionList.length&&this.handleActiveSessions(a.sessionList)):(Ie.debug("Checking for existing sessions.."),this.gridApp.getActiveSessions()):g&&window.setTimeout(()=>{this.sessionStartRetryLeft-=1,this.startButtonClick()},5e3);else{Ie.debug("client: successfully set up session: "+a.sessionId),Ie.debug("Should enable mic: "+this.getGridApp().shouldDefaultEnableMic()),this._sessionId=a.sessionId,this.startResult=a,Ie.debug("streams: "+JSON.stringify(this.startResult.streams));for(let C of this.startResult.streams)this.totalTracks+=C.tracks.length;this.playMedia()}const I=it.convert(a,Ei.startSessionResultEvent),M=g?this.sessionStartRetryLeft:0;I.info=`${I.info} ${M} retries left.`,M>0&&(I.status=Ae.warning),Ie.event(I),this._onSessionStartResult&&this._onSessionStartResult(I)}onSessionStopResult(a){this.sessionId()==a.sessionId?(this._sessionId="",a.framesDecoded==0&&Ie.event({action:ye.stop,status:Ae.warning,info:"Zero frame decoded.",sessionId:this.sessionId()||null})):this.sessionsToDelete>0&&(this.sessionsToDelete--,this.sessionsToDelete===0&&this.begin());const g=it.convert(a,Ei.stopSessionResultEvent);Ie.event(g),this._onStreamStopped&&this._onStreamStopped(g)}onProgressUpdate(a){const g=it.convert(a,Ei.sessionProgressUpdateEvent);Ie.event(g),this._onProgressUpdate&&this._onProgressUpdate(g)}onStreamStopped(a){this.resetTrackInfo(),a.error&&this.getQueryParam("resume")&&a.isResumable&&(Ie.event({action:ye.stop,status:Ae.inProgress,info:"Will resuming 15 secs after stopping.",sessionId:this.sessionId()||null}),window.setTimeout(()=>this.gridApp.getActiveSessions(),15e3));const g=it.convert(a,Ei.streamingTerminatedEvent);Ie.event(g),this._onStreamStopped&&this._onStreamStopped(g)}onActiveSessionResult(a){a.error||(Ie.event({action:ye.active,status:Ae.success,info:"Active session request succeeded. Number of active sessions: "+a.sessionList.length,sessionId:this.sessionId()||null}),a.sessionList.length?this.handleActiveSessions(a.sessionList):this.begin());const g=it.convert(a,Ei.activeSessionResultEvent);Ie.event(g),this._onActiveSessionResult&&this._onActiveSessionResult(g)}onStreamingEvent(a){if(a.streamingState&&a.streamingState.state===O.STREAMING_STATE.RECONNECTING){const g=it.convert(a,Ei.streamingEvent);Ie.event(g),this._onStreamingEvent&&this._onStreamingEvent(g)}}onGetSessionResult(a){a.error||(a.state==O.SessionState.INITIALIZING||a.state==O.SessionState.RESUMING?window.setTimeout(()=>this.gridApp.getSession(a.sessionId),1e3):a.state==O.SessionState.READY_FOR_CONNECTION&&this.gridApp.resumeSession(this.sessionStartParams,a.sessionId));const g=it.convert(a,Ei.getSessionResult);Ie.event(g),this._onGetSessionResult&&this._onGetSessionResult(g)}sendCustomMessage(a){Ie.event({action:ye.message,status:Ae.inProgress,info:`Custom message being sent to the stream: ${JSON.stringify(a)}`,sessionId:this.sessionId()||null}),this.gridApp.sendCustomMessage(a)}onCustomMessage(a){if("clipboard_set"in a){this.onCopyTextToClipboard(String(a.clipboard_set));return}Ie.event({action:ye.message,status:Ae.success,info:"Custom message successfully recieved from stream.",sessionId:this.sessionId()||null}),this._onCustomEvent?this._onCustomEvent(a):Ie.event({action:ye.message,status:Ae.warning,info:"Stream sent a custom message, but client has not provided an onCustomEvent handler method.",sessionId:this.sessionId()||null})}onISSOUpdate(a){this._onISSOUpdate&&this._onISSOUpdate(it.convert(a,Ei.streamUpdateEvent))}downloadLogs(){this.logBuffer.download()}downloadAudioRecordings(){var a;(a=this.gridApp)==null||a.downloadAudio()}getPlatformOverride(a,g,I,M,C){return"clientplatformname="+a+"&clienttype="+g+"&deviceos="+I+"&devicetype="+M+"&clientstreamer="+C}getPlatformAndAppLaunchOverrides(a,g){let I=this.queryParams.toString(),M="";switch(a){case 0:this.hasPlatformBeenSimulated&&this.getPlatformOverride("","","","","");break;case 1:M=this.getPlatformOverride($t.WINDOWS,O.ClientType.NATIVE,ft.WINDOWS,At.DESKTOP,O.ClientStreamer.CLASSIC);break;case 2:M=this.getPlatformOverride($t.MACOS,O.ClientType.NATIVE,ft.MAC,At.DESKTOP,O.ClientStreamer.CLASSIC);break;case 3:M=this.getPlatformOverride($t.LINUX,O.ClientType.NATIVE,ft.ANDROID,At.TABLET,O.ClientStreamer.CLASSIC);break;case 4:M=this.getPlatformOverride($t.BROWSER,O.ClientType.BROWSER,ft.IOS,At.PHONE,O.ClientStreamer.WEBRTC);break;case 5:M=this.getPlatformOverride($t.BROWSER,O.ClientType.BROWSER,ft.IPADOS,At.TABLET,O.ClientStreamer.WEBRTC);break;case 6:M=this.getPlatformOverride($t.BROWSER,O.ClientType.BROWSER,ft.CHROME_OS,At.DESKTOP,O.ClientStreamer.WEBRTC);break;case 7:M=this.getPlatformOverride($t.BROWSER,O.ClientType.BROWSER,ft.WINDOWS,At.DESKTOP,O.ClientStreamer.WEBRTC);break;case 8:M=this.getPlatformOverride($t.BROWSER,O.ClientType.BROWSER,ft.MAC,At.DESKTOP,O.ClientStreamer.WEBRTC);break;case 9:M=this.getPlatformOverride($t.BROWSER,O.ClientType.BROWSER,ft.LINUX,At.DESKTOP,O.ClientStreamer.WEBRTC);break;case 10:M=this.getPlatformOverride($t.BROWSER,O.ClientType.BROWSER,ft.WEBOS,At.TV,O.ClientStreamer.WEBRTC);break;case 11:M=this.getPlatformOverride($t.BROWSER,O.ClientType.BROWSER,ft.TIZEN,At.TV,O.ClientStreamer.WEBRTC);break;case 12:M=this.getPlatformOverride($t.BROWSER,O.ClientType.BROWSER,ft.XBOX,At.CONSOLE,O.ClientStreamer.WEBRTC);break}M&&(this.hasPlatformBeenSimulated=!0,I+=M+"&");let C;switch(g){case 0:this.hasAppLaunchBeenSimulated&&(C=O.AppLaunchMode.Default);break;case 1:C=O.AppLaunchMode.Default;break;case 2:C=O.AppLaunchMode.TouchFriendly;break;case 3:C=O.AppLaunchMode.GamepadFriendly;break}return C!==void 0&&(this.hasAppLaunchBeenSimulated=!0,I+="applaunchmode="+C+"&"),I.endsWith("&")||(I+="&"),I+"webrtcstreamer=enable"}configureGridApp(a){return new Promise((g,I)=>{this.useTelemetry&&this.updateEventDataElements();const C={serverAddress:a,authTokenCallback:this.authProvider.getTokenCallback(),deviceHashId:"",clientShutDownCallback:void 0};let w;switch(this.getQueryParam("cursor")){case"hw":w=O.CursorType.HARDWARE;break;case"free":w=O.CursorType.FREE;break;case"sw":w=O.CursorType.SOFTWARE;break;default:w=O.CursorType.FREE}const S={cursorType:w,allowUnconfined:this.getQueryParam("allowunconfined")!==null};if(Ie.debug("initializing gridApp with server: "+C.serverAddress),!this.gridApp.initialize(C,S)){I();return}this.authProvider.getAuthInfo().then(m=>{this.gridApp.setAuthInfo(m),g()}).catch(()=>{I()})})}getGridApp(){return this.gridApp}begin(){this.gridApp.startSession(this.sessionStartParams)}async startButtonClick(){var S;let I=this.getPlatformAndAppLaunchOverrides(0,0);const M={connectivityCheckTimeout:this.connectivityTimeout,sleepErrorsStreaming:["0xC0F2230F"]};(S=this.codecList)!=null&&S.length&&(M.codecList=this.codecList),typeof this.enableAV1Support=="boolean"&&(M.enableAv1Support=this.enableAV1Support);const C={remoteConfigData:{ragnarok:JSON.stringify(M)},gxtOverrideData:JSON.stringify({params:[{name:"ragnarok",value:{enableCpm:!1}}]}),overrideData:I};O.ConfigureRagnarokSettings(C);let w=this.getQueryParam("server");try{let m=this.getQueryParam("resolution").split(":"),A=Sv(this.getQueryParam("fps"));const H="0";let _="en-US";this.configureGridApp(w).then(()=>{Ie.debug("grid app setup completed");const V=this.nativeTouchEvents&&Av(this.platformDetails);this.sessionStartParams={streamParams:[],appLaunchMode:V?O.AppLaunchMode.TouchFriendly:O.AppLaunchMode.Default,keyboardLayout:_,shortName:"Omniverse App Streaming",accountLinked:!1};let ie=parseInt(m[0]),x=parseInt(m[1]),F=A;const R=parseInt(H);if(!ie||!x){const J=[{resolution:{width:3840,height:2160},frameRate:60},{resolution:{width:3440,height:1440},frameRate:60},{resolution:{width:2560,height:1600},frameRate:120},{resolution:{width:2560,height:1600},frameRate:60},{resolution:{width:2560,height:1440},frameRate:120},{resolution:{width:2560,height:1440},frameRate:60},{resolution:{width:1920,height:1200},frameRate:60},{resolution:{width:1920,height:1080},frameRate:60},{resolution:{width:1920,height:1080},frameRate:30},{resolution:{width:1920,height:1080},frameRate:120},{resolution:{width:1680,height:1050},frameRate:60},{resolution:{width:1600,height:900},frameRate:60},{resolution:{width:1280,height:1024},frameRate:60},{resolution:{width:1440,height:900},frameRate:60},{resolution:{width:1366,height:768},frameRate:60},{resolution:{width:1280,height:800},frameRate:60},{resolution:{width:1280,height:720},frameRate:60},{resolution:{width:1600,height:1200},frameRate:60},{resolution:{width:1112,height:834},frameRate:60},{resolution:{width:1024,height:768},frameRate:60},{resolution:{width:960,height:540},frameRate:60}],fe=O.ChooseStreamingSettings(O.StreamingProfilePreset.BALANCED,J,this.platformDetails);ie=fe.resolution.width,x=fe.resolution.height,Ie.debug("Recommended stream settings: "+ie+"x"+x+"@"+fe.frameRate),Ie.debug("Capable stream settings: "+JSON.stringify(J))}this.sessionStartParams.streamParams.push({width:ie,height:x,fps:F,maxBitrateKbps:R,drc:!1,videoTagId:this.videoElement.id,audioTagId:this.audioElement.id});const B=this.getQueryParam("signalingserver");let Y=[];if(B){const J=parseInt(this.getQueryParam("signalingport")),fe=this.getQueryParam("signalingpath"),le=Yc(B)?O.AppLevelProtocol.HTTP:O.AppLevelProtocol.HTTPS;Y.push({ip:B,port:J,resourcePath:fe,usage:O.Usage.SIGNALING,appLevelProtocol:le,protocol:O.Protocol.TCP}),Ie.debug("initializing signaling connection: "+JSON.stringify({signalingserver:B,signalingport:J,signalingpath:fe}))}const se=this.getQueryParam("mediaserver");if(se)if(vv(se)&&!Yc(se))Ie.event({action:ye.start,status:Ae.error,info:`mediaserver query parameter is not a valid IP. value: ${se}`,sessionId:this.sessionId()||null});else{const J=parseInt(this.getQueryParam("mediaport"));Y.push({ip:se,port:J,usage:O.Usage.VIDEO,appLevelProtocol:O.AppLevelProtocol.UNKNOWN,protocol:O.Protocol.UDP})}const ve=this.getQueryParam("signalingquery");if(ve&&(this.sessionStartParams.signalingUrlQueryParameters=decodeURIComponent(ve)),w)this.sessionStartParams.connectionInfo=void 0,this.sessionStartParams.sessionId=void 0;else{if(Y.length)this.sessionStartParams.connectionInfo=Y;else{const fe={action:ye.start,status:Ae.error,info:"Signaling server info is required in pass-thru use case. Please add signalingserver=<> to the query parameters"};Ie.event(fe),this._onSessionStartResult&&this._onSessionStartResult(fe);return}const J=this.getQueryParam("sessionid");J&&(this.sessionStartParams.sessionId=J)}this.getQueryParam("accessToken")&&(this.sessionStartParams.sessionId+="-Authorization.Bearer-"+this.getQueryParam("accessToken")),this.begin()}).catch(V=>{Ie.event({action:ye.start,status:Ae.error,info:`Something unexpected happened: ${V==null?void 0:V.name} ${V==null?void 0:V.message}`,sessionId:this.sessionId()||null})})}catch(m){Ie.event({action:ye.start,status:Ae.error,info:`Exception in start button click: ${m}`,sessionId:this.sessionId()||null})}}stopButtonClick(a=!1,g=!1){this.resetTrackInfo(),this.sessionId()&&(a?this.gridApp.pauseSession(this.sessionId()):this.gridApp.stopSession(this.sessionId()))}}const Zc={accessToken:null,autoLaunch:!0,cursor:"free",fps:60,height:1080,mediaPort:null,mediaServer:null,mic:!1,nucleus:null,server:null,sessionId:null,signalingPort:48322,signalingServer:null,signalingPath:null,signalingQuery:null,width:1920};class el{static query(a){const g=Object.keys(a).reduce((C,w)=>{if(Zc[w]!==void 0&&a[w]!==void 0&&a[w]!==null&&w!=="width"&&w!=="height"){const m=["accessToken"].includes(w)?w:w.toLowerCase();C.push([m,a[w]])}return C},[["resolution",`${a.width}x${a.height}`]]);return new URLSearchParams(g).toString()}}const Ev=500*1024,wv={videoElementId:"remote-video",audioElementId:"remote-audio",authenticate:!1,maxReconnects:5,nativeTouchEvents:!1,backendUrl:"",connectivityTimeout:2e3,newSession:!1,onUpdate:null,onStart:null,onStop:null,onTerminate:null,onStreamStats:null,onCustomEvent:null,...Zc};class tl{constructor(){ke(this,"_ragnarokApp");ke(this,"_backendURL");ke(this,"_accessToken");ke(this,"_sessionID");ke(this,"_nucleus");this._ragnarokApp=null,this._backendURL="",this._accessToken=null,this._nucleus=null,this._sessionID=null}async connect(a){return this._backendURL=a.backendUrl,this._accessToken=a.accessToken,this._nucleus=a.nucleus,this._sessionID=a.sessionId,a.newSession?(a.onStart&&a.onStart({action:ye.newSession,status:Ae.inProgress,info:"Requesting new session."}),this.newSession().then(g=>(a.sessionId=g.sessionId,a.onStart&&a.onStart(g),this._connect(a))).catch(g=>{throw a.onStart&&a.onStart(g),g})):this._connect(a)}async _connect(a){if(a={...wv,...a},a.maxReconnects<0)throw{action:ye.start,status:Ae.error,info:`Invalid prop DirectConfig.maxReconnects: ${a.maxReconnects}. Must be >= 0.`};const g=this.getURLLocation(a);try{this._backendURL=a.backendUrl,this._accessToken=a.accessToken,this._nucleus=a.nucleus,this._sessionID=a.sessionId;const M=await An.platformDetails();a.authenticate||(g.search=g.search.replace("accessToken","accessTokenUnused"));const C={onSessionStartResult:a.onStart||null,onProgressUpdate:a.onUpdate||null,onStreamStopped:a.onStop||null,onActiveSessionResult:null,onStreamingEvent:null,onGetSessionResult:null,onISSOUpdate:a.onStreamStats||null,onCustomEvent:a.onCustomEvent||null};if(this._ragnarokApp){if(!this._ragnarokApp.connect(C))throw{action:ye.start,status:Ae.error,info:"Failed to connect to current stream"};return{action:ye.start,status:Ae.success,info:"Stream already connected"}}else this._ragnarokApp=new bv({maxSessionStartRetry:a.maxReconnects,platformDetails:M,videoElementId:a.videoElementId,audioElementId:a.audioElementId,urlLocation:g,authProvider:new zf,logBuffer:new jo(Ev),...C,useTelemetry:!1,nativeTouchEvents:a.nativeTouchEvents,connectivityTimeout:a.connectivityTimeout,enableAV1Support:a.enableAV1Support,codecList:a.codecList}),a.autoLaunch&&await this._ragnarokApp.startButtonClick()}catch(M){const C={action:ye.start,status:Ae.error,info:M};throw Ie.event(C),C}const I={action:ye.start,status:Ae.inProgress,info:"Starting stream."};return Ie.event(I),I}getURLLocation(a){return{search:el.query(a)}}sendMessage(a){const g={messageType:"json",messageRecipient:"kit",data:a};this._ragnarokApp.sendCustomMessage(g)}async stop(){try{return this._ragnarokApp.stopButtonClick(),{action:ye.stop,status:Ae.inProgress,info:"Stopping stream."}}catch{return{action:ye.stop,status:Ae.error,info:"Stopping stream."}}}async start(){try{return await this._ragnarokApp.startButtonClick(),{action:ye.start,status:Ae.inProgress,info:"Starting stream."}}catch(a){return{action:ye.start,status:Ae.error,info:a}}}backendUrl(){return this._backendURL}async newSession(){return new Promise((a,g)=>{g({action:ye.newSession,status:Ae.error,info:`New session request not supported for ${this.constructor.name}.`})})}_terminateStream(){this._ragnarokApp&&this._ragnarokApp.stopButtonClick(!1,!0),this._ragnarokApp=null,this._backendURL="",this._accessToken=null,this._nucleus=null,this._sessionID=null}async terminate(a){const g=this.sessionId();if(a){if(confirm("Terminating the session will destroy all associated resources and is not recoverable. All unsaved changes will be lost. Are you sure you would like to terminate the session?")){const M=this._accessToken;this._nucleus;const C=this._sessionID,w=this._backendURL;this._terminateStream();const S="DELETE";if(w){let A=null;{const H=`https://${w}/stream`;A=await fetch(H,{method:S,headers:{Authorization:`Bearer ${M}`,accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({session_id:`${C}`})})}if((A==null?void 0:A.status)!==200){let H=null,_=null;try{H=await A.setHeader("Strict-Transport-Security","max-age=63072000; includeSubDomains").json(),_=`${A.status}: ${H.message}`}catch{_=`${A.status}: ${A.statusText} ${A.url}`}const V={action:ye.terminate,status:Ae.error,sessionId:g,info:_};return Ie.event(V),V}}const m={action:ye.terminate,status:Ae.success,sessionId:g,info:"Session has terminated"};return Ie.event(m),m}}else return this._terminateStream(),{action:ye.terminate,status:Ae.success,sessionId:g,info:"Session has terminated"};const I={action:ye.terminate,status:Ae.canceled,sessionId:g,info:"Termination has been cancelled"};return Ie.event(I),I}resize(a,g){const M={messageType:"json",messageRecipient:"stream",data:JSON.stringify({type:"resize",value:{height:g,width:a}})};this._ragnarokApp.sendCustomMessage(M)}sessionId(){var a;return((a=this._ragnarokApp)==null?void 0:a.sessionId())??""}}const Cv={GFN:null,catalogClientId:null,clientId:null,cmsId:null,nonce:null,partnerId:null,muteAudio:!0,onUpdate:null,onStart:null,onCustomEvent:null};class Iv{constructor(){ke(this,"_GFN");ke(this,"_catalogClientId");ke(this,"_clientId");ke(this,"_cmsId");ke(this,"_nonce");ke(this,"_partnerId");ke(this,"_muteAudio");this._GFN=null,this._catalogClientId="",this._clientId="",this._cmsId=-9999,this._nonce="",this._partnerId="",this._muteAudio=!0}async connect(a){if(!a)throw{action:ye.start,status:Ae.error,info:"Invalid GFNConfig props provided. Please refer to usage documentation."};return a={...Cv,...a},this._GFN=a.GFN,this._catalogClientId=a.catalogClientId,this._clientId=a.clientId,this._cmsId=a.cmsId,this._muteAudio=a.muteAudio,this._nonce=a.nonce,this._partnerId=a.partnerId,this._initialize().then(async()=>{var I,M;await this._login();const g=await this._GFN.server.getServerInfo();a.onUpdate({action:ye.authUser,status:Ae.success,info:(I=this._GFN.currentUser)==null?void 0:I.displayName}),await this._stream((M=g==null?void 0:g.defaultZone)==null?void 0:M.address),console.debug("Started streaming"),this._GFN.streamer.on("started",()=>{a.onStart({action:ye.start,status:Ae.success,info:"streamready"})}),this._GFN.streamer.on("message",C=>{console.debug(`Received message from GFN app: ${C}`);const w=JSON.parse(C);w.event_type&&w.payload?a.onCustomEvent(w):Object.keys(w).forEach(S=>{a.onUpdate({action:ye.update,status:Ae.success,info:JSON.stringify({key:S,value:w[S]})})})})}).catch(g=>{throw{action:ye.start,status:Ae.error,info:g}}),{action:ye.start,status:Ae.inProgress,info:"Starting stream."}}async start(){throw new Error("GFNStreamer::start is not defined.")}async stop(){throw new Error("GFNStreamer::stop is not defined.")}async terminate(){throw new Error("GFNStreamer::terminate is not defined.")}sendMessage(a){try{this._GFN.streamer.sendMessage(a)}catch(g){console.error("Error sending message: "+g)}}async _initialize(){console.debug("initialize");const a=new this._GFN.Settings({clientId:this._clientId,catalogClientId:this._catalogClientId,partnerId:this._partnerId});try{if(await this._GFN.initialize(a),console.debug("gfn init finished"),!this._GFN.settings.vpcId){const g=await this._GFN.server.getServerInfo();this._GFN.settings.vpcId=g.vpcId}}catch(g){console.error(`GFN Initialization Failed: ${g.message}`)}}async _login(){this._nonce?await this._loginWithNonce(this._nonce,this._cmsId):await this._gfnLogin()}async _loginWithNonce(a,g){console.debug("_loginWithNonce");try{await this._GFN.auth.loginWithNonce(a,g.toString())}catch(I){throw console.error(`GFN Authorization Failed: ${I.message}`),I}}async _gfnLogin(){console.debug("gfn login");const a=this._GFN.auth.createLoginUrl();console.debug(`login ${a}`);try{await this._GFN.auth.loginWithBrowserPopup(a),console.debug("GFN Authorization Successful!"),console.debug(`GFN Logged in username: ${this._GFN.currentUser.displayName}`)}catch(g){throw console.error(`GFN Authorization Failed: ${g.message}`),g}}async _stream(a){const g=this._cmsId,I=this._GFN.streamer.detectStreamingResolution(),M={server:a,appId:g,streamParams:{width:I.width,height:I.height,fps:60},authTokenCallback:async()=>this._GFN.currentUser.authInfo.idToken.value,windowElementId:"view",enableMutedAutoPlay:this._muteAudio};return this._GFN.streamer.start(M).then(()=>{console.debug("streamer is starting...")}).catch(C=>{console.debug(`error while starting stream. ${C}`)})}resize(a,g){const I={type:"resize",value:{height:g,width:a}};this.sendMessage(JSON.stringify(I))}}class Tv extends tl{async connect(a){return a.backendUrl||(a.backendUrl=this.genDefaultBackendUrl(a)),super.connect(a)}getURLLocation(a){const g={search:el.query(a)};return g.search=`${g.search}&disableworkerws=true`,g}async newSession(){if(!this.backendUrl())throw{action:ye.newSession,status:Ae.error,info:"Backend URL must be set before requesting a new session."};const a=await fetch(this.backendUrl(),{method:"POST"});if(!a.ok){const I=await a.text();throw{action:ye.newSession,status:Ae.error,info:I}}const g=a.headers.get("nvcf-request-id");if(!g)throw{action:ye.newSession,status:Ae.error,info:"No session ID found in response."};return{action:ye.newSession,status:Ae.success,sessionId:g,info:"New session request successful."}}async terminate(a){if(a){const g=this.sessionId();if(!this.backendUrl())throw{action:ye.terminate,status:Ae.error,sessionId:g,info:"Backend URL must be set before requesting a session termination."};const I=await fetch(this.backendUrl(),{method:"DELETE"});if(!I.ok){const M=await I.text();throw{action:ye.terminate,status:Ae.error,sessionId:g,info:`${I.status}: ${I.statusText}: ${M}`}}}return super.terminate(!1)}genDefaultBackendUrl(a){var I;if(!a.signalingServer||!a.signalingPort||!a.signalingPath)throw{action:ye.newSession,status:Ae.error,info:"backenURL or signalingServer, signalingPort, and signalingPath must be set before requesting a new session."};return`${a.signalingPort===443?"https:":"http:"}//${a.signalingServer}:${a.signalingPort}${a.signalingPath}/sign_in?${((I=a.signalingQuery)==null?void 0:I.toString())??""}`}}var il={exports:{}};(function(f,a){(function(g,I){f.exports=I()})(kc,function(){var g=typeof Promise=="function",I=typeof self=="object"?self:kc,M=typeof Symbol<"u",C=typeof Map<"u",w=typeof Set<"u",S=typeof WeakMap<"u",m=typeof WeakSet<"u",A=typeof DataView<"u",H=M&&typeof Symbol.iterator<"u",_=M&&typeof Symbol.toStringTag<"u",V=w&&typeof Set.prototype.entries=="function",ie=C&&typeof Map.prototype.entries=="function",x=V&&Object.getPrototypeOf(new Set().entries()),F=ie&&Object.getPrototypeOf(new Map().entries()),R=H&&typeof Array.prototype[Symbol.iterator]=="function",B=R&&Object.getPrototypeOf([][Symbol.iterator]()),Y=H&&typeof String.prototype[Symbol.iterator]=="function",se=Y&&Object.getPrototypeOf(""[Symbol.iterator]()),ve=8,J=-1;function fe(le){var T=typeof le;if(T!=="object")return T;if(le===null)return"null";if(le===I)return"global";if(Array.isArray(le)&&(_===!1||!(Symbol.toStringTag in le)))return"Array";if(typeof window=="object"&&window!==null){if(typeof window.location=="object"&&le===window.location)return"Location";if(typeof window.document=="object"&&le===window.document)return"Document";if(typeof window.navigator=="object"){if(typeof window.navigator.mimeTypes=="object"&&le===window.navigator.mimeTypes)return"MimeTypeArray";if(typeof window.navigator.plugins=="object"&&le===window.navigator.plugins)return"PluginArray"}if((typeof window.HTMLElement=="function"||typeof window.HTMLElement=="object")&&le instanceof window.HTMLElement){if(le.tagName==="BLOCKQUOTE")return"HTMLQuoteElement";if(le.tagName==="TD")return"HTMLTableDataCellElement";if(le.tagName==="TH")return"HTMLTableHeaderCellElement"}}var L=_&&le[Symbol.toStringTag];if(typeof L=="string")return L;var K=Object.getPrototypeOf(le);return K===RegExp.prototype?"RegExp":K===Date.prototype?"Date":g&&K===Promise.prototype?"Promise":w&&K===Set.prototype?"Set":C&&K===Map.prototype?"Map":m&&K===WeakSet.prototype?"WeakSet":S&&K===WeakMap.prototype?"WeakMap":A&&K===DataView.prototype?"DataView":C&&K===F?"Map Iterator":w&&K===x?"Set Iterator":R&&K===B?"Array Iterator":Y&&K===se?"String Iterator":K===null?"Object":Object.prototype.toString.call(le).slice(ve,J)}return fe})})(il);var Rv=il.exports;const kv=$f(Rv),Go=typeof Buffer<"u",Pv=Go&&typeof Buffer.from<"u",Ov=Go?function(a){return Buffer.isBuffer(a)}:function(){return!1},Dv=Pv?function(a){return Buffer.from(a)}:Go?function(a){return new Buffer(a)}:function(a){return a};function Kn(f){return Ov(f)?"Buffer":kv(f)}const Mv=new Set(["Arguments","Array","Map","Object","Set"]);function Lv(f,a,g=null){switch(g||Kn(f)){case"Arguments":case"Array":case"Object":return f[a];case"Map":return f.get(a);case"Set":return a}}function Bo(f){return Mv.has(f)}function nl(f,a,g,I=null){switch(I||Kn(f)){case"Arguments":case"Array":case"Object":f[a]=g;break;case"Map":f.set(a,g);break;case"Set":f.add(g);break}return f}const Nv=typeof globalThis<"u"&&globalThis!==null&&globalThis.Object===Object&&globalThis,xv=typeof global<"u"&&global!==null&&global.Object===Object&&global,_v=typeof self<"u"&&self!==null&&self.Object===Object&&self,Vo=Nv||xv||_v||Function("return this")();function Fv(f){return f.slice(0)}function Uv(f){return new Boolean(f.valueOf())}function jv(f){return new DataView(f.buffer)}function Gv(f){return Dv(f)}function Bv(f){return new Date(f.getTime())}function Vv(f){return new Number(f)}function Hv(f){return new RegExp(f.source,f.flags)}function Wv(f){return new String(f)}function Di(f,a){return Vo[a].from?Vo[a].from(f):new Vo[a](f)}function Ot(f){return f}function rl(){return[]}function zv(){return new Map}function Kv(){return{}}function $v(){return new Set}const qv=new Map([["ArrayBuffer",Fv],["Boolean",Uv],["Buffer",Gv],["DataView",jv],["Date",Bv],["Number",Vv],["RegExp",Hv],["String",Wv],["Float32Array",Di],["Float64Array",Di],["Int16Array",Di],["Int32Array",Di],["Int8Array",Di],["Uint16Array",Di],["Uint32Array",Di],["Uint8Array",Di],["Uint8ClampedArray",Di],["Array Iterator",Ot],["Map Iterator",Ot],["Promise",Ot],["Set Iterator",Ot],["String Iterator",Ot],["function",Ot],["global",Ot],["WeakMap",Ot],["WeakSet",Ot],["boolean",Ot],["null",Ot],["number",Ot],["string",Ot],["symbol",Ot],["undefined",Ot],["Arguments",rl],["Array",rl],["Map",zv],["Object",Kv],["Set",$v]]);function Jv(){}function Ho(f,a=null,g=Jv){arguments.length===2&&typeof a=="function"&&(g=a,a=null);const I=a||Kn(f),M=qv.get(I);if(I==="Object"){const C=g(f,I);if(C!==void 0)return C}return M?M(f,I):f}function Qv(f,a={}){typeof a=="function"&&(a={customizer:a});const{customizer:g}=a,I=Kn(f);if(!Bo(I))return Wo(f,null,null,null);const M=Ho(f,I,g),C=new WeakMap([[f,M]]),w=new WeakSet([f]);return Wo(f,M,C,w)}function Wo(f,a,g,I,M){const C=Kn(f),w=Ho(f,C);if(!Bo(C))return w;let S;switch(C){case"Arguments":case"Array":S=Object.keys(f);break;case"Object":S=Object.keys(f),S.push(...Object.getOwnPropertySymbols(f));break;case"Map":case"Set":S=f.keys();break}for(let m of S){const A=Lv(f,m,C);if(I.has(A))nl(a,m,g.get(A),C);else{const H=Kn(A),_=Ho(A,H);Bo(H)&&(g.set(A,_),I.add(A)),nl(a,m,Wo(A,_,g,I),C)}}return a}var sl=(f=>(f.DIRECT="direct",f.GFN="gfn",f.NVCF="nvcf",f))(sl||{});const Ze=class Ze{static async connect(a){const g=a.streamSource;try{if(Ie.setLogLevel(a.logLevel||Pt.INFO),Ie.setLogFormat(a.logFormat||Ir.JSON),g==="gfn")return Ze._stream=Ze._stream||new Iv,Ze._stream.connect(a.streamConfig);if(g==="direct"||g==="nvcf"){const I=M=>{M.status===Ae.error&&Ze.terminate()};if(a.streamConfig.onStart){const M=Qv(a),C=a.streamConfig.onStart,w=S=>{I(S),C(S)};M.streamConfig.onStart=w,a=M}else a.streamConfig.onStart=I;return g==="nvcf"?(Ze._stream=Ze._stream||new Tv,Ze._stream.connect(a.streamConfig)):(Ze._stream=Ze._stream||new tl,Ze._stream.connect(a.streamConfig))}}catch(I){throw{action:ye.start,status:Ae.error,info:I}}throw console.error(`Stream:init: ${g} is an invalid source`),{action:ye.start,status:Ae.error,info:TypeError(`Stream:init: '${g}' is an invalid source`)}}static async sendMessage(a){try{if(Ze._stream)return Ze._stream.sendMessage(a),console.debug(`Sent message to GFN app: ${a}`),{action:ye.message,status:Ae.success,info:"Message was successfully sent."};{const g="There is no stream controller. Please call the setup method.";throw console.error(`Error sending message: ${g}`),{action:ye.message,status:Ae.error,info:g}}}catch(g){throw console.error("Error sending message: "+g),{action:ye.message,status:Ae.error,info:g}}}static async start(){if(Ze._stream)return Ze._stream.start();throw{action:ye.start,status:Ae.error,info:"There is no stream controller. Please call the setup method."}}static async stop(){if(Ze._stream)return Ze._stream.stop().then(a=>a);throw{action:ye.stop,status:Ae.error,info:"There is no stream controller. Please call the setup method."}}static async terminate(a=!1,g=!1){if(Ze._stream)return Ze._stream.terminate(a).then(I=>((I==null?void 0:I.status)==="success"&&(Ze._stream=null),I));throw{action:ye.terminate,status:Ae.error,info:"There is no stream controller. Please call the setup method."}}static async resize(a,g){try{if(Ze._stream)return Ze._stream.resize(a,g),{action:ye.update,status:Ae.success,info:"The stream resolution has been updated."};throw{action:ye.update,status:Ae.error,info:"There is no stream controller. Please call the setup method."}}catch(I){throw console.error("Error resizing: "+I),{action:ye.update,status:Ae.error,info:I}}}};ke(Ze,"_stream");let zo=Ze;bt.AppStreamer=zo,bt.LogFormat=Ir,bt.LogLevel=Pt,bt.StreamType=sl,bt.eAction=ye,bt.eStatus=Ae,Object.defineProperty(bt,Symbol.toStringTag,{value:"Module"})});
