var y0=Object.defineProperty,b0=(e,t,n)=>t in e?y0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Re=(e,t,n)=>b0(e,"symbol"!=typeof t?t+"":t,n),mf=(e=>(e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e))(mf||{});const Vt={CHROME_OS:"ChromeOS",WINDOWS:"Windows",MAC:"macOS",LINUX:"Linux",IOS:"iOS",IPADOS:"iPadOS",WEBOS:"WebOS",TIZEN:"Tizen",ANDROID:"Android",XBOX:"Xbox"},E0={JWT_GFN:1},St={DESKTOP:"DESKTOP",LAPTOP:"LAPTOP",TV:"TV",PHONE:"PHONE",TABLET:"TABLET",CONSOLE:"CONSOLE"},ei={UNKNOWN:"Unknown",CHROME:"Chrome",SAFARI:"Safari",YANDEX:"Yandex",EDGE:"Edge",EDGE_LEGACY:"Edge_Legacy",FIREFOX:"Firefox",SAMSUNG:"Samsung",CHROMIUM:"Chromium",OPERA:"Opera",BRAVE:"Brave",SILK:"Silk",REACT:"ReactNative"};function w0(e){let t="undefined";return e===St.CONSOLE?t="Console":e===St.TABLET?t="Tablet":e===St.PHONE?t="Phone":e===St.TV?t="TV":e===St.LAPTOP?t="Laptop":e===St.DESKTOP&&(t="Desktop"),t}function C0(e){switch(e){case ei.CHROME:return"Chrome";case ei.SAFARI:return"Safari";case ei.YANDEX:return"Yandex";case ei.EDGE:return"Edge";case ei.EDGE_LEGACY:return"Edge_legacy";case ei.FIREFOX:return"Firefox";case ei.SAMSUNG:return"Samsung";case ei.CHROMIUM:return"Chromium";case ei.OPERA:return"Opera";case ei.BRAVE:return"Brave";case ei.SILK:return"Silk";default:return"undefined"}}function I0(e){switch(e.toLowerCase()){case"windows":return"Windows";case"macosx":case"macos":return"MacOS";case"chromeos":case"chrome os":return"ChromeOS";case"linux":return"Linux";case"ios":return"iOS";case"ipados":return"iPadOS";case"tizen":return"Tizen";case"webos":return"WebOS";case"xbox":return"Xbox";default:return"undefined"}}class T0{setDataForLoginType(e){console.log("initializing dummy auth")}getLoginUrl(){return"error"}getUserName(){return"Local"}getUserId(){return"Local"}getExternalUserId(){return"Local"}getDeviceId(){return"Local"}getIdpId(){return"Local"}checkTokenValidity(){return Promise.resolve()}respondToRedirect(e){return Promise.resolve()}getTokenCallback(){return()=>Promise.resolve("dummy")}getAuthInfo(){return Promise.resolve({type:E0.JWT_GFN,token:"dummy"})}logout(){console.log("logging out of dummy auth")}startOffDeviceLogin(){return Promise.resolve({verification_uri:"",user_code:"",device_code:"",expires_in:0,interval:0})}pollOffDeviceLogin(e){return Promise.resolve()}}function R0(e){return"object"==typeof e&&null!==e&&"string"==typeof e.logLevel&&"string"==typeof e.logModule&&"string"==typeof e.logtag&&"string"==typeof e.logstr}var uo=(e=>(e.JSON="json",e.TEXT="text",e))(uo||{});function yr(e,t){return t===uo.JSON?JSON.stringify(e):`${e.timestamp} (${e.sessionId}): ${e.detail}`}var of=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function k0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function P0(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var i=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,i.get?i:{enumerable:!0,get:function(){return e[t]}})})),n}var af,Af={exports:{}},Jd={exports:{}};function O0(){return af||(af=1,(()=>{var e={673:(e,t,n)=>{n.r(t),n.d(t,{DiagConsoleLogger:()=>k,DiagLogLevel:()=>p,INVALID_SPANID:()=>ee,INVALID_SPAN_CONTEXT:()=>ne,INVALID_TRACEID:()=>te,ProxyTracer:()=>Ee,ProxyTracerProvider:()=>Ce,ROOT_CONTEXT:()=>T,SamplingDecision:()=>me,SpanKind:()=>Ae,SpanStatusCode:()=>be,TraceFlags:()=>K,ValueType:()=>C,baggageEntryMetadataFromString:()=>w,context:()=>Le,createContextKey:()=>E,createNoopMeter:()=>z,createTraceState:()=>De,default:()=>Je,defaultTextMapGetter:()=>$,defaultTextMapSetter:()=>J,diag:()=>xe,isSpanContextValid:()=>ve,isValidSpanId:()=>fe,isValidTraceId:()=>pe,metrics:()=>_e,propagation:()=>ze,trace:()=>$e});var i="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof n.g?n.g:{},s="1.4.1",r=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,o=function(e){var t=new Set([e]),n=new Set,i=e.match(r);if(!i)return function(){return!1};var s=+i[1],o=+i[2],a=+i[3];if(null!=i[4])return function(t){return t===e};function c(e){return n.add(e),!1}function d(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var i=e.match(r);if(!i)return c(e);var l=+i[1],u=+i[2],h=+i[3];return null!=i[4]||s!==l?c(e):0===s?o===u&&a<=h?d(e):c(e):o<=u?d(e):c(e)}}(s),a=s.split(".")[0],c=Symbol.for("opentelemetry.js.api."+a),d=i;function l(e,t,n,i){var r;void 0===i&&(i=!1);var o=d[c]=null!==(r=d[c])&&void 0!==r?r:{version:s};if(!i&&o[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}return o.version!==s?(a=new Error("@opentelemetry/api: Registration of version v"+o.version+" for "+e+" does not match previously registered API v"+s),n.error(a.stack||a.message),!1):(o[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+s+"."),!0)}function u(e){var t,n,i=null===(t=d[c])||void 0===t?void 0:t.version;if(i&&o(i))return null===(n=d[c])||void 0===n?void 0:n[e]}function h(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+s+".");var n=d[c];n&&delete n[e]}var p,f,v=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return g("verbose",this._namespace,e)},e}();function g(e,t,n){var i=u("diag");if(i)return n.unshift(t),i[e].apply(i,function(e,t,n){if(2===arguments.length)for(var i,s=0,r=t.length;s<r;s++)!i&&s in t||(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}([],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}(n),!1))}(f=p||(p={}))[f.NONE=0]="NONE",f[f.ERROR=30]="ERROR",f[f.WARN=50]="WARN",f[f.INFO=60]="INFO",f[f.DEBUG=70]="DEBUG",f[f.VERBOSE=80]="VERBOSE",f[f.ALL=9999]="ALL";var m=function(){function e(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=u("diag");if(i)return i[e].apply(i,function(e,t,n){if(2===arguments.length)for(var i,s=0,r=t.length;s<r;s++)!i&&s in t||(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}([],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}(t),!1))}}var t=this;t.setLogger=function(e,n){var i,s,r;if(void 0===n&&(n={logLevel:p.INFO}),e===t){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(i=o.stack)&&void 0!==i?i:o.message),!1}"number"==typeof n&&(n={logLevel:n});var a=u("diag"),c=function(e,t){function n(n,i){var s=t[n];return"function"==typeof s&&e>=i?s.bind(t):function(){}}return e<p.NONE?e=p.NONE:e>p.ALL&&(e=p.ALL),t=t||{},{error:n("error",p.ERROR),warn:n("warn",p.WARN),info:n("info",p.INFO),debug:n("debug",p.DEBUG),verbose:n("verbose",p.VERBOSE)}}(null!==(s=n.logLevel)&&void 0!==s?s:p.INFO,e);if(a&&!n.suppressOverrideMessage){var d=null!==(r=(new Error).stack)&&void 0!==r?r:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+d),c.warn("Current logger will overwrite one already registered from "+d)}return l("diag",c,t,!0)},t.disable=function(){h("diag",t)},t.createComponentLogger=function(e){return new v(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),A=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){var t=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}(e,2);return[t[0],t[1]]}))},e.prototype.setEntry=function(t,n){var i=new e(this._entries);return i._entries.set(t,n),i},e.prototype.removeEntry=function(t){var n=new e(this._entries);return n._entries.delete(t),n},e.prototype.removeEntries=function(){for(var t,n,i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var r=new e(this._entries);try{for(var o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),a=o.next();!a.done;a=o.next()){var c=a.value;r._entries.delete(c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},e.prototype.clear=function(){return new e},e}(),b=Symbol("BaggageEntryMetadata"),S=m.instance();function y(e){return void 0===e&&(e={}),new A(new Map(Object.entries(e)))}function w(e){return"string"!=typeof e&&(S.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:b,toString:function(){return e}}}function E(e){return Symbol.for(e)}var I,C,T=new function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(e){return n._currentContext.get(e)},n.setValue=function(t,i){var s=new e(n._currentContext);return s._currentContext.set(t,i),s},n.deleteValue=function(t){var i=new e(n._currentContext);return i._currentContext.delete(t),i}},R=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],k=function(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(console){var i=console[e];if("function"!=typeof i&&(i=console.log),"function"==typeof i)return i.apply(console,t)}}}for(var t=0;t<R.length;t++)this[R[t].n]=e(R[t].c)},O=(I=function(e,t){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}I(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),P=function(){function e(){}return e.prototype.createHistogram=function(e,t){return B},e.prototype.createCounter=function(e,t){return G},e.prototype.createUpDownCounter=function(e,t){return V},e.prototype.createObservableGauge=function(e,t){return W},e.prototype.createObservableCounter=function(e,t){return H},e.prototype.createObservableUpDownCounter=function(e,t){return q},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),D=function(){},L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t.prototype.add=function(e,t){},t}(D),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t.prototype.add=function(e,t){},t}(D),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t.prototype.record=function(e,t){},t}(D),N=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t}(N),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t}(N),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t}(N),j=new P,G=new L,B=new M,V=new x,H=new _,W=new F,q=new U;function z(){return j}!function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(C||(C={}));var K,$={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},J={set:function(e,t,n){null!=e&&(e[t]=n)}},Q=function(){function e(){}return e.prototype.active=function(){return T},e.prototype.with=function(e,t,n){for(var i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return t.call.apply(t,function(e,t,n){if(2===arguments.length)for(var i,s=0,r=t.length;s<r;s++)!i&&s in t||(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}([n],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}(i),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),Y="context",X=new Q,Z=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return l(Y,e,m.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,n){for(var i,s=[],r=3;r<arguments.length;r++)s[r-3]=arguments[r];return(i=this._getContextManager()).with.apply(i,function(e,t,n){if(2===arguments.length)for(var i,s=0,r=t.length;s<r;s++)!i&&s in t||(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}([e,t,n],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}(s),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return u(Y)||X},e.prototype.disable=function(){this._getContextManager().disable(),h(Y,m.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(K||(K={}));var ee="0000000000000000",te="00000000000000000000000000000000",ne={traceId:te,spanId:ee,traceFlags:K.NONE},ie=function(){function e(e){void 0===e&&(e=ne),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),se=E("OpenTelemetry Context Key SPAN");function re(e){return e.getValue(se)||void 0}function oe(){return re(Z.getInstance().active())}function ae(e,t){return e.setValue(se,t)}function ce(e){return e.deleteValue(se)}function de(e,t){return ae(e,new ie(t))}function le(e){var t;return null===(t=re(e))||void 0===t?void 0:t.spanContext()}var ue=/^([0-9a-f]{32})$/i,he=/^[0-9a-f]{16}$/i;function pe(e){return ue.test(e)&&e!==te}function fe(e){return he.test(e)&&e!==ee}function ve(e){return pe(e.traceId)&&fe(e.spanId)}function ge(e){return new ie(e)}var me,Ae,be,Se=Z.getInstance(),ye=function(){function e(){}return e.prototype.startSpan=function(e,t,n){if(void 0===n&&(n=Se.active()),null!=t&&t.root)return new ie;var i,s=n&&le(n);return"object"==typeof(i=s)&&"string"==typeof i.spanId&&"string"==typeof i.traceId&&"number"==typeof i.traceFlags&&ve(s)?new ie(s):new ie},e.prototype.startActiveSpan=function(e,t,n,i){var s,r,o;if(!(arguments.length<2)){2===arguments.length?o=t:3===arguments.length?(s=t,o=n):(s=t,r=n,o=i);var a=r??Se.active(),c=this.startSpan(e,s,a),d=ae(a,c);return Se.with(d,o,void 0,c)}},e}(),we=new ye,Ee=function(){function e(e,t,n,i){this._provider=e,this.name=t,this.version=n,this.options=i}return e.prototype.startSpan=function(e,t,n){return this._getTracer().startSpan(e,t,n)},e.prototype.startActiveSpan=function(e,t,n,i){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):we},e}(),Ie=new(function(){function e(){}return e.prototype.getTracer=function(e,t,n){return new ye},e}()),Ce=function(){function e(){}return e.prototype.getTracer=function(e,t,n){var i;return null!==(i=this.getDelegateTracer(e,t,n))&&void 0!==i?i:new Ee(this,e,t,n)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:Ie},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,n){var i;return null===(i=this._delegate)||void 0===i?void 0:i.getTracer(e,t,n)},e}();(function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(me||(me={})),function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(Ae||(Ae={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(be||(be={}));var Te="[_0-9a-z-*/]",Re=new RegExp("^(?:[a-z]"+Te+"{0,255}|[a-z0-9]"+Te+"{0,240}@[a-z]"+Te+"{0,13})$"),ke=/^[ -~]{0,255}[!-~]$/,Oe=/,|=/,Pe=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,n){return t.push(n+"="+e.get(n)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var n,i=t.trim(),s=i.indexOf("=");if(-1!==s){var r=i.slice(0,s),o=i.slice(s+1,t.length);n=r,Re.test(n)&&function(e){return ke.test(e)&&!Oe.test(e)}(o)&&e.set(r,o)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}();function De(e){return new Pe(e)}var Le=Z.getInstance(),xe=m.instance(),Me=new(function(){function e(){}return e.prototype.getMeter=function(e,t,n){return j},e}()),Ne="metrics",_e=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return l(Ne,e,m.instance())},e.prototype.getMeterProvider=function(){return u(Ne)||Me},e.prototype.getMeter=function(e,t,n){return this.getMeterProvider().getMeter(e,t,n)},e.prototype.disable=function(){h(Ne,m.instance())},e}().getInstance(),Fe=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),Ue=E("OpenTelemetry Baggage Key");function je(e){return e.getValue(Ue)||void 0}function Ge(){return je(Z.getInstance().active())}function Be(e,t){return e.setValue(Ue,t)}function Ve(e){return e.deleteValue(Ue)}var He="propagation",We=new Fe,qe=function(){function e(){this.createBaggage=y,this.getBaggage=je,this.getActiveBaggage=Ge,this.setBaggage=Be,this.deleteBaggage=Ve}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return l(He,e,m.instance())},e.prototype.inject=function(e,t,n){return void 0===n&&(n=J),this._getGlobalPropagator().inject(e,t,n)},e.prototype.extract=function(e,t,n){return void 0===n&&(n=$),this._getGlobalPropagator().extract(e,t,n)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){h(He,m.instance())},e.prototype._getGlobalPropagator=function(){return u(He)||We},e}(),ze=qe.getInstance(),Ke="trace",$e=function(){function e(){this._proxyTracerProvider=new Ce,this.wrapSpanContext=ge,this.isSpanContextValid=ve,this.deleteSpan=ce,this.getSpan=re,this.getActiveSpan=oe,this.getSpanContext=le,this.setSpan=ae,this.setSpanContext=de}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=l(Ke,this._proxyTracerProvider,m.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return u(Ke)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){h(Ke,m.instance()),this._proxyTracerProvider=new Ce},e}().getInstance();const Je={context:Le,diag:xe,metrics:_e,propagation:ze,trace:$e}},379:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CancellableWait=void 0,t.CancellableWait=class{constructor(e,t){var n;this.timerId=0,this.timedOut=!1,this.aborted=!1,this.promise=new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t})),null!=t&&t.aborted?(this.aborted=!0,this.promiseReject()):(this.abortSignal=t,this.onAbortFunc=this.onAbort.bind(this),null===(n=this.abortSignal)||void 0===n||n.addEventListener("abort",this.onAbortFunc),this.timerId=window.setTimeout(this.onTimeout.bind(this),e))}cancel(){var e;null===(e=this.abortSignal)||void 0===e||e.removeEventListener("abort",this.onAbortFunc),this.timerId&&(window.clearTimeout(this.timerId),this.timerId=0),this.abortSignal=void 0}getPromise(){return this.promise}isTimedOut(){return this.timedOut}isAborted(){return this.aborted}onAbort(){this.aborted=!0,this.promiseReject(),this.cancel()}onTimeout(){this.timedOut=!0,this.promiseResolve(),this.timerId=0,this.cancel()}}},921:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CLIENT_ID=void 0,t.CLIENT_ID="62677554106929725"},121:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performHttpRequest=t.DefaultHttpRequestOptions=void 0;const i=n(673),s=n(614),r=n(367),o=n(379),a="httprequest";t.DefaultHttpRequestOptions={method:"GET",headers:{},body:"",retryCount:0,timeout:0,keepalive:!1},t.performHttpRequest=function(e,n=t.DefaultHttpRequestOptions,c,d){var l;const u=null!==(l=n.method)&&void 0!==l?l:"GET";return r.TracingManager.getInstance().createSpan(u,(()=>(function(e,t,n){const o=i.trace.getActiveSpan();if(!o)return;let c=new Map([["component",r.TracingComponent.name],["component.version",r.TracingComponent.version],["http.method",e],["http.url",t],["type",""],["http.hostname",""],["http.path",""]]);try{const e=new URL(t);c.set("type",e.protocol),c.set("http.hostname",e.hostname),c.set("http.path",e.pathname)}catch{s.Log.e(a,"Failed to extract http request attributes")}for(const[e,t]of c)o.setAttribute(e,t);o.setAttributes(n)}(u,e,n.headers),function(e,n=t.DefaultHttpRequestOptions,r,c){var d,l;let u=void 0===n.retryCount?1:n.retryCount+1;const h=u,p=null!==(d=n.backOffDelay)&&void 0!==d?d:500;let f=p;const v=null!==(l=n.method)&&void 0!==l?l:"GET";let g=new Headers;const m=c??new AbortController;return(e=>{if(e)switch(e.type){case 1:e.token&&g.set("authorization","GFNJWT "+e.token);break;case 2:e.token&&g.set("authorization","GFNPartnerJWT auth="+e.token)}void 0!==n.headers&&Object.keys(n.headers).forEach((e=>{g.set(e,n.headers[e])}));const t={};i.propagation.inject(i.context.active(),t);for(const[e,n]of Object.entries(t))g.set(e,n)})(r),new Promise(((t,r)=>{const c=e=>{(function(){const e=i.trace.getActiveSpan();e&&e.setAttribute("error","true")})(),r(e)},d=()=>{if(navigator.onLine){let r,l={method:v,headers:g,mode:"cors",keepalive:n.keepalive,signal:m.signal,cache:"no-store"};"GET"!==v&&"HEAD"!==v&&(l.body=n.body);const A=0,b=[A,DOMException.NETWORK_ERR,DOMException.TIMEOUT_ERR,503],S=n.timeout?new o.CancellableWait(n.timeout):void 0,y=[];y.push(fetch(e,l)),S&&y.push(S.getPromise()),Promise.race(y).then((t=>{if(null!=S&&S.isTimedOut())throw s.Log.w(a,`Timeout while performing HTTP request for Url: ${e}`),{code:DOMException.TIMEOUT_ERR,message:"Timeout while performing HTTP request"};if(t instanceof globalThis.Response)return r=t.status,t.text()})).then((e=>{if(!e&&b.includes(r)){if(u>1)throw{code:r,message:"Internal server error."};s.Log.w(a,`Failing with ${r} even after ${h} retries`)}(e=>{(function(e){const t=i.trace.getActiveSpan();t&&(t.setAttribute("error","false"),t.setAttribute("http.status_code",e.toString()))})(e.status),t(e)})({status:r,data:e??"",retries:h-u})})).catch((e=>{const t=e=>[A,DOMException.NETWORK_ERR,DOMException.TIMEOUT_ERR].includes(e)?(s.Log.d(a,"Fetch failing with NetworkError"),3237089282):e==DOMException.ABORT_ERR?(s.Log.d(a,"Fetch failing since user aborted"),15867905):(s.Log.w(a,`Unhandled Fetch error: ${e}`),3237089284);e instanceof Error?s.Log.d(a,`Error in Fetch: ${e.message}`):s.Log.d(a,`Error in Fetch: ${JSON.stringify(e)}, ${e}`);const i=(e=>{let t=A;return null!=e&&e.code?t=null==e?void 0:e.code:null!=e&&e.name&&("AbortError"===e.name?t=DOMException.ABORT_ERR:"NetworkError"===e.name?t=DOMException.NETWORK_ERR:"TimeoutError"===e.name&&(t=DOMException.TIMEOUT_ERR)),t})(e);i==A&&n.keepalive&&(n.keepalive=!1),b.includes(i)?(e=>{if(u>1){u--,s.Log.d(a,`Failing with ${e}, retries left ${u}`);const t=new o.CancellableWait(f,m.signal);return t.getPromise().then(d).catch((e=>{t.isAborted()?c({code:15867905,retries:h-u}):(s.Log.w(a,`Unhandled exception caught: ${JSON.stringify(e)}`),c({code:3237089284,retries:h-u}))})),f+=p,!0}return!1})(i)||(s.Log.w(a,`Fetch failing even after ${h} retries. Error: ${i}`),c({code:t(i),retries:h-u})):c({code:t(i),retries:h-u})})).finally((()=>{null==S||S.cancel()}))}else c({code:3237089281,description:"No network",retries:h-u})};d()}))}(e,n,c,d))))}},386:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedDb=void 0;const i=n(614),s="indexdb";function r(e,t,n){return{code:e,description:t,error:null!==n?n:void 0}}t.IndexedDb=class{constructor(e,t){this.indexedDb=window.indexedDB,this.version=2,this.isDbClosing=!1,this.didDbCloseUnexpectedly=!1,this.name=e,this.storeDetails=t}open(){return new Promise(((e,t)=>{try{if(this.indexedDb){let n=this.indexedDb.open(this.name,this.version);n.onerror=e=>{t(r(18,`${this.name} db opening failed`,n.error))},n.onsuccess=t=>{this.createDbInstance(n.result),e()},n.onupgradeneeded=e=>{i.Log.i(s,`Upgrading from version ${e.oldVersion} to ${e.newVersion}`),this.createDbInstance(n.result);const t=e=>{var t;const n=null===(t=this.dbInstance)||void 0===t?void 0:t.createObjectStore(e.storeName,e.storeOptions);e.storeOptions.keyPath&&(null==n||n.createIndex(e.storeIndexName,e.storeOptions.keyPath,{unique:!0}))};switch(e.oldVersion){case 0:t(this.storeDetails[0]);case 1:t(this.storeDetails[1])}},n.onblocked=e=>{t(r(19,`${this.name} db blocked during opening`,n.error))}}else t(r(17,"Indexdb object not found"))}catch(e){t(r(20,"Unexpected Exception in open",e))}}))}getDbStateError(){if(!this.indexedDb)return r(17,"Indexdb object not found");if(!this.dbInstance)return r(1,"Db not yet open");if(this.isDbClosing){const e="hidden"===document.visibilityState;return r(2,"Db is closing, unexpectedly: "+this.didDbCloseUnexpectedly+", visibility state hidden: "+e)}}get(e,t){const n=this.getDbStateError();return n?Promise.reject(n):new Promise(((n,o)=>{try{const a=this.dbInstance.transaction(e,"readonly"),c=a.objectStore(e);a.oncomplete=e=>{i.Log.i(s,"transaction complete in get")};const d=c.get(t);d.onsuccess=()=>{n(d.result)},d.onerror=e=>{o(r(32,"get method failed",a.error))}}catch(e){o(r(33,"Unexpected Exception happened in get",e))}}))}set(e,t){const n=this.getDbStateError();return n?Promise.reject(n):new Promise(((n,o)=>{try{const a=this.dbInstance.transaction(e,"readwrite"),c=a.objectStore(e);a.oncomplete=e=>{i.Log.i(s,"transaction complete in set")};const d=c.put(t);d.onsuccess=()=>{n()},d.onerror=e=>{o(r(48,"put method failed",a.error))}}catch(e){o(r(49,"Unexpected Exception happened in set",e))}}))}delete(e,t){const n=this.getDbStateError();return n?Promise.reject(n):new Promise(((n,o)=>{try{const a=this.dbInstance.transaction(e,"readwrite"),c=a.objectStore(e);a.oncomplete=e=>{i.Log.i(s,"transaction complete in delete")};const d=c.delete(t);d.onsuccess=()=>{n()},d.onerror=e=>{o(r(64,"delete method failed",a.error))}}catch(e){o(r(65,"Unexpected Exception in delete",e))}}))}clear(e){const t=this.getDbStateError();return t?Promise.reject(t):new Promise(((t,n)=>{try{const o=this.dbInstance.transaction(e,"readwrite"),a=o.objectStore(e);o.oncomplete=e=>{i.Log.i(s,"transaction complete in clear")};const c=a.clear();c.onsuccess=()=>{t()},c.onerror=e=>{n(r(80,"clear method failed)",o.error))}}catch(e){n(r(81,"Unexpected Exception happened in clear",e))}}))}getAll(e){const t=this.getDbStateError();return t?Promise.reject(t):new Promise(((t,n)=>{try{const o=this.dbInstance.transaction(e,"readonly"),a=o.objectStore(e);o.oncomplete=e=>{i.Log.i(s,"transaction complete in getAll")};const c=a.getAll();c.onsuccess=()=>{t(c.result)},c.onerror=e=>{n(r(96,"getAll method failed",o.error))}}catch(e){n(r(97,"Unexpected Exception in getAll",e))}}))}close(){var e;this.isDbClosing=!0,null===(e=this.dbInstance)||void 0===e||e.close()}createDbInstance(e){this.isDbClosing=!1,this.didDbCloseUnexpectedly=!1,this.dbInstance=e,this.dbInstance.onversionchange=e=>{i.Log.w(s,"closing db to unblock other tabs"),this.close(),this.dbInstance=void 0},this.dbInstance.onclose=e=>{i.Log.w(s,"Db connection unexpectedly closed"),this.isDbClosing=!0,this.didDbCloseUnexpectedly=!0}}}},596:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LogBuffer=void 0;class n{constructor(e){this.encoder=new TextEncoder,this.logIndex=0,this.full=!1,this.buffer=new Uint8Array(e+n.FULL_MESSAGE.length),this.maxLength=e}clear(){this.encoder=new TextEncoder,this.logIndex=0,this.full=!1}log(e){if(this.full)return;let t=this.encoder.encode(e+"\n");this.logIndex+t.byteLength>this.maxLength&&(this.full=!0,t=this.encoder.encode(n.FULL_MESSAGE)),this.buffer.set(t,this.logIndex),this.logIndex+=t.byteLength}getData(){return this.buffer.slice(0,this.logIndex)}}t.LogBuffer=n,n.FULL_MESSAGE="Log is full\n"},614:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LogImpl=t.Logger=t.Log=void 0;const n={NONE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4};class i{constructor(){this.queue=[],this.logMechanism=0,this.logLevel="DEBUG",this._nop=(e,t,...n)=>{},this._d=(e,t,...n)=>this.handleLog("DEBUG",e,t,n),this._i=(e,t,...n)=>this.handleLog("INFO",e,t,n),this._w=(e,t,...n)=>this.handleLog("WARN",e,t,n),this._e=(e,t,...n)=>this.handleLog("ERROR",e,t,n)}setLogMechanism(e){this.logMechanism=e}setLogLevel(e){this.logLevel=e}get d(){return n[this.logLevel]<n.DEBUG?this._nop:1===this.logMechanism?console.debug.bind(console,"%s DEBUG [%s] %s@@",this.renderDate(new Date)):this._d}get w(){return n[this.logLevel]<n.WARN?this._nop:1===this.logMechanism?console.warn.bind(console,"%s WARN  [%s] %s@@",this.renderDate(new Date)):this._w}get i(){return n[this.logLevel]<n.INFO?this._nop:1===this.logMechanism?console.info.bind(console,"%s INFO  [%s] %s@@",this.renderDate(new Date)):this._i}get e(){return n[this.logLevel]<n.ERROR?this._nop:1===this.logMechanism?console.error.bind(console,"%s ERROR [%s] %s@@",this.renderDate(new Date)):this._e}register(e){this.callback=e,this.queue.length&&window.setTimeout((()=>{this.executeLogCallback(!0)}))}isCallbackRegistered(){return!!this.callback}stringifyArgs(...e){return e.length?`##${JSON.stringify(e)}`:""}executeLogCallback(e){this.callback&&this.queue.length&&(this.callback(this.queue[0]),this.queue.shift(),e&&this.queue.length&&window.setTimeout((()=>{this.executeLogCallback(!0)})))}unregister(){this.callback=void 0}handleLog(e,t,n,s){let r=`${n}${this.stringifyArgs(...s)}`,o={timestamp:this.renderDate(new Date),level:e,tag:t,message:r};this.queue.push(o),this.callback?window.setTimeout((()=>{this.executeLogCallback(!1)})):this.queue.length>i.MAX_QUEUE_SIZE&&this.queue.shift()}renderDate(e){const t=(e,t,n)=>{const i=t-e.length;if(i>0){let t="";for(let e=0;e<i;e++)t+=n;return t+=e,t}return e};let n="";return n=t(e.getFullYear().toString(),4,"0")+"-"+(t((e.getMonth()+1).toString(),2,"0")+"-")+(e=>t(e.getDate().toString(),2,"0"))(e)+" "+(e=>t(e.getHours().toString(),2,"0"))(e)+":"+(e=>t(e.getMinutes().toString(),2,"0"))(e)+":"+(e=>t(e.getSeconds().toString(),2,"0"))(e)+"."+(e=>t(e.getMilliseconds().toString(),3,"0"))(e),n}}i.MAX_QUEUE_SIZE=50;const s=new i;t.Log=s,t.Logger=s;class r{constructor(e,t){this.module=e,this.enabled=!0,this.shouldLogToConsole=!1,this.queue=[],t&&(void 0!==t.enable&&(this.enabled=t.enable),void 0!==t.enableConsoleLogging&&(this.shouldLogToConsole=t.enableConsoleLogging)),this._nop=(e,t,...n)=>{},this._d=(e,t,...n)=>this.handleLog("DEBUG",e,t,n),this._i=(e,t,...n)=>this.handleLog("INFO",e,t,n),this._w=(e,t,...n)=>this.handleLog("WARN",e,t,n),this._e=(e,t,...n)=>this.handleLog("ERROR",e,t,n)}get d(){return this.enabled?this.shouldLogToConsole?console.debug.bind(console,"%s DEBUG [%s] %s@@",this.renderDate(new Date)):this._d:this._nop}get w(){return this.enabled?this.shouldLogToConsole?console.warn.bind(console,"%s WARN  [%s] %s@@",this.renderDate(new Date)):this._w:this._nop}get i(){return this.enabled?this.shouldLogToConsole?console.info.bind(console,"%s INFO  [%s] %s@@",this.renderDate(new Date)):this._i:this._nop}get e(){return this.shouldLogToConsole?console.error.bind(console,"%s ERROR [%s] %s@@",this.renderDate(new Date)):this._e}setLogCallback(e){this.callback=e,this.callback&&this.queue.length&&window.setTimeout((()=>{this.executeLogCallback(!0)}))}isCallbackRegistered(){return!!this.callback}stringifyArgs(...e){return e.length?`##${JSON.stringify(e)}`:""}executeLogCallback(e){this.callback&&this.queue.length&&(this.callback(this.queue[0]),this.queue.shift(),e&&this.queue.length&&window.setTimeout((()=>{this.executeLogCallback(!0)})))}handleLog(e,t,n,i){let s=`${n}${this.stringifyArgs(...i)}`,o={timestamp:this.renderDate(new Date),level:e,tag:this.module+"/"+t,message:s};this.queue.push(o),this.callback?window.setTimeout((()=>{this.executeLogCallback(!1)})):this.queue.length>r.MAX_QUEUE_SIZE&&this.queue.shift()}renderDate(e){const t=(e,t,n)=>{const i=t-e.length;if(i>0){let t="";for(let e=0;e<i;e++)t+=n;return t+=e,t}return e};let n="";return n=t(e.getFullYear().toString(),4,"0")+"-"+(t((e.getMonth()+1).toString(),2,"0")+"-")+(e=>t(e.getDate().toString(),2,"0"))(e)+" "+(e=>t(e.getHours().toString(),2,"0"))(e)+":"+(e=>t(e.getMinutes().toString(),2,"0"))(e)+":"+(e=>t(e.getSeconds().toString(),2,"0"))(e)+"."+(e=>t(e.getMilliseconds().toString(),3,"0"))(e),n}}t.LogImpl=r,r.MAX_QUEUE_SIZE=50},36:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LogUploader=void 0;const i=n(596),s=n(614),r=n(492),o="loguploader";t.LogUploader=class{constructor(e,t,n,a,c,d,l=0){this.buffer=new i.LogBuffer(512e3),this.loggingIntervalId=0,this.isUploadInProgress=!1,this.finishRequested=!1,this.uploadChunk=async(e=!1)=>{if(this.isUploadInProgress)return;this.isUploadInProgress=!0;const t=this.buffer.getData();this.buffer.clear(),await this.loggingService.sendChunk(t,e),this.isUploadInProgress=!1,this.finishRequested&&!e&&(s.Log.i(o,"Initiating final chunk upload because finish request received during pending upload"),this.finishRequested=!1,await this.uploadChunk(!0))},this.loggingService=new r.RemoteLoggingService(e,t,n,a,c,d,l)}start(e){s.Log.i(o,"Starting log upload"),this.clearInterval(),this.finishRequested=!1,this.loggingService.startUpload(e).then((e=>{e?this.loggingIntervalId=window.setInterval(this.uploadChunk,1e4):s.Log.e(o,"Failed to start log upload")}))}clearInterval(){0!==this.loggingIntervalId&&(window.clearInterval(this.loggingIntervalId),this.loggingIntervalId=0)}finish(){s.Log.i(o,"Requesting to finish log upload"),this.clearInterval(),this.isUploadInProgress?(this.finishRequested=!0,s.Log.i(o,"Upload in progress.  Will finish upload after pending upload completes")):(s.Log.i(o,"No upload in progress.  Uploading final chunk"),this.uploadChunk(!0))}log(e){this.buffer.log(e)}}},492:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteLoggingService=void 0;const i=n(921),s=n(121),r=n(614),o=n(537),a=n(185),c="https://telemetry.gfe.nvidia.com/gfc/v4.0",d="remoteloggingservice";t.RemoteLoggingService=class{constructor(e,t,n,s,r,a,d){var l,u,h,p,f,v;this.chunkOffset=0,this.url=c;const g=(0,o.translatePlatformInfoForPayload)(t);switch(void 0===t.os&&t.deviceOS&&(g.os=t.deviceOS),void 0===t.browser&&t.browserType&&(g.browser=t.browserType),void 0===t.platformType&&t.deviceType&&(g.deviceType=t.deviceType),this.headPayload={browserType:g.browser,clientId:i.CLIENT_ID,clientTs:"",clientType:n.clientType,clientVariant:n.clientVariant,clientVer:n.clientVer,deviceGdprBehOptIn:r.deviceGdprBehOptIn,deviceGdprFuncOptIn:r.deviceGdprFuncOptIn,deviceGdprTechOptIn:r.deviceGdprTechOptIn,deviceId:t.deviceId,deviceOS:g.os,deviceOSVersion:null!==(l=t.osVersion)&&void 0!==l?l:t.deviceOSVersion,deviceMake:null!==(h=null!==(u=t.make)&&void 0!==u?u:t.deviceMake)&&void 0!==h?h:"",deviceModel:null!==(f=null!==(p=t.model)&&void 0!==p?p:t.deviceModel)&&void 0!==f?f:"",deviceType:g.deviceType,feedbackId:"",feedbackName:"GS_Log_Event",feedbackProtocol:"4.4",feedbackSchemaVer:"3.2",feedbackSysVer:"v4.3",fileList:[{name:a}],gdprBehOptIn:s.gdprBehOptIn,gdprFuncOptIn:s.gdprFuncOptIn,gdprTechOptIn:s.gdprTechOptIn,parameters:{streamSessionId:"",streamSubSessionIds:[]},sentTs:"",sessionId:"",userId:null!==(v=e.userId)&&void 0!==v?v:""},d){case 0:this.url=c;break;case 1:this.url="https://telemetry.gfestage.nvidia.com/gfc/v4.0";break;default:this.url=d}}async startUpload(e){this.chunkOffset=0,this.headPayload.feedbackId=crypto.randomUUID(),this.headPayload.parameters.streamSessionId=e??"",this.headPayload.clientTs=(new Date).toISOString(),this.headPayload.sentTs=(new Date).toISOString();const t={method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(this.headPayload)},n=`${this.url}/head`,i=await(0,s.performHttpRequest)(n,t);if(200!==i.status)return r.Log.e(d,`Head request failed with ${i.status}`),!1;let o=`Initiated feedback session ${this.headPayload.feedbackId}`;return e&&(o+=` for stream session ${e}`),r.Log.i(d,o),!0}async sendChunk(e,t=!1){const n=new Blob([e]),i=new FormData;try{i.append("feedbackId",this.headPayload.feedbackId),i.append("offset",this.chunkOffset.toString()),i.append("checksum",await(0,a.computeSha256Checksum)(e)),i.append("data2",n),i.append("size",n.size.toString()),i.append("parameters",JSON.stringify(this.headPayload.parameters))}catch(e){const t=`Cannot send chunk: ${e}`;return r.Log.e(d,t),!1}t&&i.append("eob","true");const o={method:"POST",headers:{},body:i},c=`${this.url}/attachment`,l=await(0,s.performHttpRequest)(c,o);switch(l.status){case 200:return r.Log.i(d,`Feedback session ${this.headPayload.feedbackId} closed.`),this.headPayload.feedbackId="",this.chunkOffset=0,!0;case 206:return this.chunkOffset+=n.size,!0;case 462:return r.Log.e(d,"Cannot send attachment request with invalid feedback id"),!1;case 463:return r.Log.e(d,"Incorrect data offset provided in attachment request"),!1;default:return r.Log.e(d,`Attachment request failed with ${l.status}`),!1}}}},419:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryModule=t.CLIENT_STORE=t.OFFLINE_STORE=t.STORAGE_NAME=void 0;const i=n(386),s=n(185),r=n(614),o=n(121),a=n(537),c="telemetry",d="https://events.gfe.nvidia.com/v1.1/events/json";t.STORAGE_NAME="telemetry",t.OFFLINE_STORE="offline-events-cache",t.CLIENT_STORE="client-events-cache",t.TelemetryModule=new class{constructor(){this.commonDataSet=!1,this.telemetryEventIds={},this.uploadToServerTimerId=0,this.requestPending=!1,this.eventIdGenerator=0,this.exceptionHandled=new Set,this.clientEvents=new Map,this.pendingEvents=new Map,this.missingConsentEvents=[],this.dbPromises=new Map,this.dbInitialized=!1,this.serverUrl=d,this.httpConfiguration={method:"POST",headers:{"Content-Type":"application/json"},body:"",retryCount:3,timeout:15e3},this.eventSysVer="2.0",this.eventProtocol="1.5",this.maxEventsInStore=256,this.maxEventsInRequest=128,this.requestDelay=2e3,this.sessionId=(0,s.getNewGuid)(),this.idb=new i.IndexedDb(t.STORAGE_NAME,[{storeName:t.OFFLINE_STORE,storeOptions:{keyPath:["clientId"]},storeIndexName:"offline-events-index"},{storeName:t.CLIENT_STORE,storeOptions:{keyPath:["clientId"]},storeIndexName:"client-events-index"}]),this.idb.open().then((async()=>{this.dbInitialized=!0;const e=await Promise.all([this.idb.getAll(t.OFFLINE_STORE),this.idb.getAll(t.CLIENT_STORE)]);e[0].forEach((e=>{r.Log.d(c,`Process offline events from previous sessions: ${e.payloads.length}`),e.payloads.forEach((e=>this.processEventPayload(e)))})),e[1].forEach((e=>{r.Log.d(c,`Process client events from previous sessions: ${e.payloads.length}`),e.payloads.filter((e=>e.sessionId!==this.sessionId)).forEach((e=>this.processEventPayload(e))),this.clientEvents.has(e.clientId)||this.clientEvents.set(e.clientId,[])})),this.saveEvents(t.OFFLINE_STORE,this.pendingEvents),this.saveEvents(t.CLIENT_STORE,this.clientEvents)})).catch((e=>{this.handleException("dbOpen",e)}))}configure(e,n,i){var s,o,l,u,h,p,f,v,g,m,A;try{switch(typeof i){case"function":this.callback=i;break;case"number":const e=1===i;this.serverUrl=e?"https://events.gfestage.nvidia.com/v1.1/events/json":d;break;case"string":this.serverUrl=new URL(i).toString()}this.appInfo=Object.assign({},e),this.deviceInfo=Object.assign({},n),this.platformPayload=(0,a.translatePlatformInfoForPayload)(n),void 0===n.os&&n.deviceOS&&(this.platformPayload.os=n.deviceOS),void 0===n.browser&&n.browserType&&(this.platformPayload.browser=n.browserType),void 0===n.platformType&&n.deviceType&&(this.platformPayload.deviceType=n.deviceType),null!==(s=(g=this.deviceInfo).osVersion)&&void 0!==s||(g.osVersion=null!==(o=this.deviceInfo.deviceOSVersion)&&void 0!==o?o:"");const r="undefined";null!==(l=(m=this.deviceInfo).model)&&void 0!==l||(m.model=null!==(h=null===(u=this.deviceInfo)||void 0===u?void 0:u.deviceModel)&&void 0!==h?h:r),null!==(p=(A=this.deviceInfo).make)&&void 0!==p||(A.make=null!==(v=null===(f=this.deviceInfo)||void 0===f?void 0:f.deviceMake)&&void 0!==v?v:r),"function"==typeof i?(this.pendingEvents.forEach(((e,t)=>{e.forEach((e=>{i(e)})),this.pendingEvents.set(t,[])})),this.saveEvents(t.OFFLINE_STORE,this.pendingEvents)):this.cacheAndMaybeUploadTelemetry()}catch(e){return r.Log.e(c,`configure failed: ${JSON.stringify(e)}`),!1}return!0}createTelemetryProvider(e){return{processEvent:this.processEvent.bind(this,e),cacheEvent:this.cacheEvent.bind(this,e),processCachedEvent:this.processCachedEvent.bind(this),dropCachedEvent:this.dropCachedEvent.bind(this)}}updateClientCommonData(e,t,n,i){if(this.commonDataSet=!0,this.userInfo&&(this.userInfo.userId!==e.userId||this.userInfo.externalUserId!==e.externalUserId||this.userInfo.idpId!==e.idpId)&&this.sendOldUserRelatedEvents(),this.userInfo=Object.assign({},e),n){this.userConsent=Object.assign({},n);const e=JSON.stringify(n);r.Log.d(c,`User consent has been synced: ${e}`)}this.deviceConsent=Object.assign({},t);const s=JSON.stringify(t);r.Log.d(c,`Device consent has been synced: ${s}`),this.integrationId=i,r.Log.d(c,`Common data updated, sending ${this.missingConsentEvents.length} events`),this.sendMissingConsentEvents()}sendOldUserRelatedEvents(){this.clientEvents.forEach(((e,t)=>{e.forEach((e=>{0===this.hasConsented(e)&&(this.callback?this.callback(e):e.priority&&this.appInfo?this.sendBeacon(e):this.bufferEvent(this.pendingEvents,e))})),this.clientEvents.set(t,[])}));let e=0;if(this.appInfo){let t=Promise.resolve();for(;this.getPendingEventsCount();)this.sendEvents(t).forEach((t=>{e+=t.events.length,this.dropSentEvents(t.events)})),t=t.then((()=>{new Promise((e=>window.setTimeout(e,this.requestDelay)))}))}else Array.from(this.pendingEvents.keys()).forEach((e=>{this.pendingEvents.set(e,[])}));this.missingConsentEvents=[],this.saveEvents(t.OFFLINE_STORE,this.pendingEvents),this.saveEvents(t.CLIENT_STORE,this.clientEvents),r.Log.i(c,`User is switched, send ${e} events in buffer`)}sendMissingConsentEvents(){const e=this.missingConsentEvents;this.missingConsentEvents=[],e.forEach((e=>this.processEventPayload(e)))}getTelemetryEventIds(){return Object.assign({},this.telemetryEventIds)}setTelemetryEventIds(e){e.networkSessionId&&(this.telemetryEventIds.networkSessionId=e.networkSessionId),e.streamingProfileGuid&&(this.telemetryEventIds.streamingProfileGuid=e.streamingProfileGuid),e.systemInfoGuid&&(this.telemetryEventIds.systemInfoGuid=e.systemInfoGuid)}processEvent(e,t){var n,i,s,r;if(this.callback)this.callback(t);else try{const o={name:t.name,eventId:++this.eventIdGenerator,parameters:JSON.parse(JSON.stringify(t.parameters)),gdprLevel:t.gdprLevel,ts:t.ts,sessionId:this.sessionId,userId:null!==(r=null!==(i=null===(n=this.userInfo)||void 0===n?void 0:n.userId)&&void 0!==i?i:null===(s=this.userInfo)||void 0===s?void 0:s.externalUserId)&&void 0!==r?r:"",priority:t.priority,config:Object.assign({},e)};this.processEventPayload(o)}catch(n){const i=`JSON error occurred on processing event: ${t.name}`;this.handleClientException(e,n,i)}}hasConsented(e){if(!this.commonDataSet)return 2;const t=e=>{var t,n;return null!==(t=this.userInfo)&&void 0!==t&&t.userId||null!==(n=this.userInfo)&&void 0!==n&&n.externalUserId?"Full"===e?0:1:"Temp"===e?0:1};let n=1;switch(e.gdprLevel){case"functional":this.userConsent?n=t(this.userConsent.gdprFuncOptIn):this.deviceConsent&&(n="Full"===(i=this.deviceConsent.deviceGdprFuncOptIn)||"Temp"===i?0:1);break;case"technical":this.userConsent&&(n=t(this.userConsent.gdprTechOptIn));break;case"behavioral":this.userConsent&&(n=t(this.userConsent.gdprBehOptIn))}var i;return n}getDebugEventName(e){return`${e.name} ${this.sessionId===e.sessionId?"":"from previous session"}`}processEventPayload(e){switch(this.hasConsented(e)){case 0:this.appInfo?e.priority?this.sendBeacon(e):(this.bufferEvent(this.pendingEvents,e),this.cacheAndMaybeUploadTelemetry()):(r.Log.d(c,`No config, buffer event: ${this.getDebugEventName(e)}`),this.bufferEvent(this.pendingEvents,e));break;case 2:this.dropOldestEventIfNeeded(),r.Log.d(c,`Missing consent event: ${this.getDebugEventName(e)}`),this.missingConsentEvents.push(e);break;case 1:r.Log.d(c,`Drop event: ${this.getDebugEventName(e)}`)}}sendBeacon(e){const t=this.createTelemetryRequestData([e]),n=new Blob([t],{type:"text/plain"}),i=navigator.sendBeacon(this.serverUrl,n);r.Log.i(c,`telemetry upload sendBeacon result : ${i} event: ${this.getDebugEventName(e)}`)}cacheAndMaybeUploadTelemetry(){this.appInfo&&!this.uploadToServerTimerId&&(this.uploadToServerTimerId=window.setInterval((async()=>{if(0===this.getPendingEventsCount())return window.clearInterval(this.uploadToServerTimerId),void(this.uploadToServerTimerId=0);if(this.saveEvents(t.OFFLINE_STORE,this.pendingEvents),!this.requestPending){this.requestPending=!0;const e=this.sendEvents();(await Promise.all(e.map((e=>e.retry)))).forEach(((t,n)=>{t||this.dropSentEvents(e[n].events)})),this.saveEvents(t.OFFLINE_STORE,this.pendingEvents),this.requestPending=!1}}),this.requestDelay))}makeRequestBatches(){const e=[];return this.pendingEvents.forEach((t=>{if(t.length>0){const n=t[0],i=t.filter((e=>e.sessionId===n.sessionId&&e.config.eventSchemaVer===n.config.eventSchemaVer));e.push(i)}})),e}dropSentEvents(e){let t=this.pendingEvents.get(e[0].config.clientId);const n=new Set(e.map((e=>`${e.sessionId}|${e.eventId}`)));t&&(t=t.filter((e=>!n.has(`${e.sessionId}|${e.eventId}`))),this.pendingEvents.set(e[0].config.clientId,t))}sendEvents(e){const t=e??Promise.resolve(),n=[];return this.makeRequestBatches().forEach((e=>{const i=e.splice(0,this.maxEventsInRequest);n.push({events:i,retry:t.then((()=>this.sendHttp(i)))})})),n}async sendHttp(e){if(0===e.length)return!1;let t=!1;const n=this.createTelemetryRequestData(e),i=e[0].config.clientId;try{const s=await(0,o.performHttpRequest)(this.serverUrl,{...this.httpConfiguration,body:n}),a=[408,500,503],d=`Telemetry http request status: ${i} ${s.status} ${s.data}`;a.includes(s.status)?(r.Log.e(c,`${d} Retry ${e.length} events.`),t=!0):s.status>=200&&s.status<300?r.Log.i(c,`${d} Uploaded ${e.length} events.`):r.Log.e(c,`${d} Drop ${e.length} events.`)}catch(e){r.Log.e(c,`Client ${i} telemetry http request failed. Error: ${e}`)}return t}cacheEvent(e,n,i){var s,r,o;try{if(i){const t=this.clientEvents.get(e.clientId);if(t){const s=t.findIndex((e=>e.eventId===i));if(-1!==s){const i=t.splice(s,1),r={eventId:i[0].eventId,sessionId:i[0].sessionId,userId:i[0].userId,config:Object.assign({},e),name:n.name,gdprLevel:n.gdprLevel,priority:n.priority,ts:n.ts,parameters:JSON.parse(JSON.stringify(n.parameters))};t.push(r)}}}else{i=++this.eventIdGenerator;const t={name:n.name,eventId:i,parameters:JSON.parse(JSON.stringify(n.parameters)),gdprLevel:n.gdprLevel,ts:n.ts,sessionId:this.sessionId,userId:null!==(r=null===(s=this.userInfo)||void 0===s?void 0:s.userId)&&void 0!==r?r:"",priority:null!==(o=n.priority)&&void 0!==o&&o,config:Object.assign({},e)};this.bufferEvent(this.clientEvents,t)}this.saveEvents(t.CLIENT_STORE,this.clientEvents)}catch(t){const i=`JSON error occurred on caching event: ${n.name}`;this.handleClientException(e,t,i)}return i??0}processCachedEvent(e){this.removeEventHelper(e,!0)}dropCachedEvent(e){this.removeEventHelper(e,!1)}removeEventHelper(e,n){for(let i of this.clientEvents){const s=i[1].findIndex((t=>t.eventId===e));if(-1!==s){const e=i[1].splice(s,1);this.saveEvents(t.CLIENT_STORE,this.clientEvents),n&&(this.callback?this.callback({name:e[0].name,gdprLevel:e[0].gdprLevel,priority:e[0].priority,ts:e[0].ts,parameters:e[0].parameters}):this.processEventPayload(e[0]));break}}}createTelemetryRequestData(e){var t,n,i,s,r,o,a,c,d,l,u,h,p,f,v,g,m,A,b,S,y,w,E,I,C,T,R,k,O,P,D,L,x,M,N,_;const F="undefined",U={clientId:(null===(t=e[0])||void 0===t?void 0:t.config.clientId)||F,clientVer:(null===(n=this.appInfo)||void 0===n?void 0:n.clientVer)||F,eventSchemaVer:(null===(i=e[0])||void 0===i?void 0:i.config.eventSchemaVer)||F,eventSysVer:this.eventSysVer,eventProtocol:this.eventProtocol,deviceId:(null===(s=this.deviceInfo)||void 0===s?void 0:s.deviceId)||F,userId:(null===(r=this.userInfo)||void 0===r?void 0:r.userId)||F,externalUserId:null===(o=this.userInfo)||void 0===o?void 0:o.externalUserId,idpId:null===(a=this.userInfo)||void 0===a?void 0:a.idpId,sessionId:(null===(c=e[0])||void 0===c?void 0:c.sessionId)||F,events:[],gdprFuncOptIn:null!==(l=null===(d=this.userConsent)||void 0===d?void 0:d.gdprFuncOptIn)&&void 0!==l?l:F,gdprTechOptIn:null!==(h=null===(u=this.userConsent)||void 0===u?void 0:u.gdprTechOptIn)&&void 0!==h?h:F,gdprBehOptIn:null!==(f=null===(p=this.userConsent)||void 0===p?void 0:p.gdprBehOptIn)&&void 0!==f?f:F,deviceGdprFuncOptIn:null!==(g=null===(v=this.deviceConsent)||void 0===v?void 0:v.deviceGdprFuncOptIn)&&void 0!==g?g:F,deviceGdprTechOptIn:null!==(A=null===(m=this.deviceConsent)||void 0===m?void 0:m.deviceGdprTechOptIn)&&void 0!==A?A:F,deviceGdprBehOptIn:null!==(S=null===(b=this.deviceConsent)||void 0===b?void 0:b.deviceGdprBehOptIn)&&void 0!==S?S:F,deviceOS:null!==(w=null===(y=this.platformPayload)||void 0===y?void 0:y.os)&&void 0!==w?w:F,deviceOSVersion:(null===(E=this.deviceInfo)||void 0===E?void 0:E.osVersion)||F,deviceType:null!==(C=null===(I=this.platformPayload)||void 0===I?void 0:I.deviceType)&&void 0!==C?C:F,deviceModel:(null===(T=this.deviceInfo)||void 0===T?void 0:T.model)||F,deviceMake:(null===(R=this.deviceInfo)||void 0===R?void 0:R.make)||F,clientType:null!==(O=null===(k=this.appInfo)||void 0===k?void 0:k.clientType)&&void 0!==O?O:F,clientVariant:null!==(D=null===(P=this.appInfo)||void 0===P?void 0:P.clientVariant)&&void 0!==D?D:F,integrationId:this.integrationId||F,browserType:null!==(x=null===(L=this.platformPayload)||void 0===L?void 0:L.browser)&&void 0!==x?x:F,productName:null===(M=this.appInfo)||void 0===M?void 0:M.productName,productVersion:null===(N=this.appInfo)||void 0===N?void 0:N.productVersion,sentTs:""};U.sentTs=(new Date).toISOString();for(const t of e){const e={name:t.name,ts:t.ts,parameters:t.parameters};null===(_=U.events)||void 0===_||_.push(e)}return JSON.stringify(U)}getPendingEventsCount(){let e=0;return this.pendingEvents.forEach((t=>e+=t.length)),e}dropOldestEventIfNeeded(){if(this.getPendingEventsCount()+this.missingConsentEvents.length<this.maxEventsInStore)return;let e="";if(this.missingConsentEvents.length)e=this.missingConsentEvents.splice(0,1)[0].name;else{let t,n="";this.pendingEvents.forEach(((e,i)=>{t?e[0].ts<t.ts&&(n=i,t=e[0]):(n=i,t=e[0])}));const i=this.pendingEvents.get(n);i&&(e=i.splice(0,1)[0].name)}r.Log.i(c,`Too many events under pending, drop ${e}`)}bufferEvent(e,t){var n;e===this.pendingEvents&&this.dropOldestEventIfNeeded();const i=t.config.clientId;e.has(i)?null===(n=e.get(i))||void 0===n||n.push(t):e.set(i,[t])}saveEvents(e,t){this.dbInitialized&&t.forEach(((t,n)=>{var i;const s={clientId:n,payloads:t},r=`${e}|${n}`;let o=null!==(i=this.dbPromises.get(r))&&void 0!==i?i:Promise.resolve();o=o.then((()=>this.idb.set(e,s))).catch((t=>{this.handleException(`saveEvents(${e})`,t)})),this.dbPromises.set(r,o)}))}handleException(e,t){var n,i,o;const a=null!==(o=null!==(i=null===(n=t.error)||void 0===n?void 0:n.message)&&void 0!==i?i:t.description)&&void 0!==o?o:`Exception in ${e}`;r.Log.e(c,`${e} failed: ${(0,s.GetHexString)(t.code)} ${a}`),this.exceptionHandled.has(e)||this.exceptionHandled.add(e)}handleClientException(e,t,n){r.Log.e(c,n),e.exceptionHandler&&e.exceptionHandler({error:t,description:n})}}},367:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TracingManager=t.TracingComponent=void 0;const i=n(673);t.TracingComponent={name:"@gamestream/utils",version:"1.0"};class s{constructor(){this.tracer=i.trace.getTracer("gfn-web-gamestream","2.0")}static getInstance(){return s.instance||(s.instance=new s),s.instance}createSpan(e,t){const n=this.tracer.startSpan(e);return i.context.with(i.trace.setSpan(i.context.active(),n),(async()=>{try{const e=t();return e instanceof Promise?await e:e}finally{n.end()}}))}}t.TracingManager=s},537:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.translatePlatformInfoForClientHeader=t.translatePlatformInfoForPayload=void 0;class n{static getMappedDeviceType(e){switch(e){case"CONSOLE":return"Console";case"TABLET":return"Tablet";case"PHONE":return"Phone";case"TV":return"TV";case"LAPTOP":return"Laptop";case"DESKTOP":return"Desktop";case"HMD":return"HMD";default:return"undefined"}}static getMappedBrowserName(e){switch(e){case"Chrome":return"Chrome";case"Safari":return"Safari";case"Yandex":return"Yandex";case"Edge":return"Edge";case"Edge_Legacy":return"Edge_legacy";case"Firefox":return"Firefox";case"Samsung":return"Samsung";case"Chromium":return"Chromium";case"Opera":return"Opera";case"Brave":return"Brave";case"Silk":return"Silk";default:return"undefined"}}static getMappedDeviceOS(e){switch(e){case"Windows":return"Windows";case"macOS":return"MacOS";case"ChromeOS":return"ChromeOS";case"Linux":return"Linux";case"iOS":return"iOS";case"iPadOS":return"iPadOS";case"Tizen":return"Tizen";case"WebOS":return"WebOS";case"Xbox":return"Xbox";case"Android":return"Android";case"SteamOS":return"SteamOS";case"visionOS":return"visionOS";default:return"undefined"}}constructor(e){this._platformInfo=e,this._gxtDetails=this.translateForPayload(),this._lcarsDetails=this.translateForClientHeaders()}translateForPayload(){var e;const t=this._platformInfo,i=n.getMappedDeviceType(t.platformType),s=n.getMappedBrowserName(t.browser);return{os:n.getMappedDeviceOS(null!==(e=t.os)&&void 0!==e?e:"Unknown"),browser:s,deviceType:i}}translateForClientHeaders(){var e;const t=this._platformInfo,i=n.extractDeviceTypeForBrowserClient(n.getMappedDeviceType(t.platformType)),s=n.extractBrowserTypeForBrowserClient(n.getMappedBrowserName(t.browser));return{os:n.mapOSPlatformNameToSupportedDeviceOs(n.getMappedDeviceOS(null!==(e=t.os)&&void 0!==e?e:"Unknown")),browser:s,deviceType:i}}get gxtDetails(){return this._gxtDetails}get lcarsDetails(){return this._lcarsDetails}get info(){return this._platformInfo}}let i;n.mapOSPlatformNameToSupportedDeviceOs=e=>{switch(e){case"Windows":return"WINDOWS";case"MacOS":return"MACOS";case"Linux":return"LINUX";case"ChromeOS":return"CHROMEOS";case"iOS":return"IOS";case"iPadOS":return"IPADOS";case"WebOS":return"WEBOS";case"Tizen":return"TIZEN";case"Xbox":return"XBOX";case"Android":return"ANDROID";case"SteamOS":return"STEAMOS";case"Shield":return"SHIELD";case"visionOS":return"VISIONOS";default:return"UNKNOWN"}},n.extractDeviceTypeForBrowserClient=e=>{switch(e){case"Desktop":default:return"DESKTOP";case"Laptop":return"LAPTOP";case"TV":return"TV";case"Phone":return"PHONE";case"Tablet":return"TABLET";case"Console":return"CONSOLE";case"HMD":return"HMD"}},n.extractBrowserTypeForBrowserClient=e=>{switch(e){case"Chrome":return"CHROME";case"Safari":return"SAFARI";case"Yandex":return"YANDEX";case"Edge":return"EDGE";case"Edge_legacy":return"EDGE_LEGACY";case"Firefox":return"FIREFOX";case"Samsung":return"SAMSUNG";case"Chromium":return"CHROMIUM";case"Opera":return"OPERA";case"Brave":return"BRAVE";case"Silk":return"SILK";default:return"UNKNOWN"}},t.translatePlatformInfoForPayload=function(e){return(null==i?void 0:i.info)!=e&&(i=new n(e)),i.gxtDetails},t.translatePlatformInfoForClientHeader=function(e){return(null==i?void 0:i.info)!=e&&(i=new n(e)),i.lcarsDetails}},185:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.computeSha256Checksum=t.GetHexString=t.convertToUnsignedInt=t.getNewGuid=void 0;const i=n(614),s="utils";function r(e){return e>>>0}t.getNewGuid=function(){let e=new Uint8Array(36);window.crypto.getRandomValues(e);let t="";for(let n=0;n<36;n++){let i=e[n]%16;8==n||13==n||18==n||23==n?t+="-":14==n?t+="4":(19==n&&(i=3&i|8),t+=i.toString(16))}return i.Log.i(s,"new guid "+t),t},t.convertToUnsignedInt=r,t.GetHexString=function(e){return"0x"+("00000000"+(e=r(e)).toString(16).toUpperCase()).slice(-8)},t.computeSha256Checksum=async function(e){var t;if(null===(t=crypto.subtle)||void 0===t||!t.digest){const e="Crypto.subtle.digest is not available";throw i.Log.e(s,e),new Error(e)}const n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch{if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.translatePlatformInfoForClientHeader=e.translatePlatformInfoForPayload=e.TracingManager=e.LogUploader=e.LogImpl=e.Logger=e.Log=e.LogBuffer=e.DefaultHttpRequestOptions=e.performHttpRequest=e.CancellableWait=e.TelemetryModule=void 0;var t=n(419);Object.defineProperty(e,"TelemetryModule",{enumerable:!0,get:function(){return t.TelemetryModule}});var s=n(379);Object.defineProperty(e,"CancellableWait",{enumerable:!0,get:function(){return s.CancellableWait}});var r=n(121);Object.defineProperty(e,"performHttpRequest",{enumerable:!0,get:function(){return r.performHttpRequest}}),Object.defineProperty(e,"DefaultHttpRequestOptions",{enumerable:!0,get:function(){return r.DefaultHttpRequestOptions}});var o=n(596);Object.defineProperty(e,"LogBuffer",{enumerable:!0,get:function(){return o.LogBuffer}});var a=n(614);Object.defineProperty(e,"Log",{enumerable:!0,get:function(){return a.Log}}),Object.defineProperty(e,"Logger",{enumerable:!0,get:function(){return a.Logger}}),Object.defineProperty(e,"LogImpl",{enumerable:!0,get:function(){return a.LogImpl}});var c=n(36);Object.defineProperty(e,"LogUploader",{enumerable:!0,get:function(){return c.LogUploader}});var d=n(367);Object.defineProperty(e,"TracingManager",{enumerable:!0,get:function(){return d.TracingManager}});var l=n(537);Object.defineProperty(e,"translatePlatformInfoForPayload",{enumerable:!0,get:function(){return l.translatePlatformInfoForPayload}}),Object.defineProperty(e,"translatePlatformInfoForClientHeader",{enumerable:!0,get:function(){return l.translatePlatformInfoForClientHeader}})})(),Jd.exports=i})()),Jd.exports}var D0="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Gn="1.4.1",df=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function M0(e){var t=new Set([e]),n=new Set,i=e.match(df);if(!i)return function(){return!1};var s=+i[1],r=+i[2],o=+i[3];if(null!=i[4])return function(t){return t===e};function a(e){return n.add(e),!1}function c(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var i=e.match(df);if(!i)return a(e);var d=+i[1],l=+i[2],u=+i[3];return null!=i[4]||s!==d?a(e):0===s?r===l&&o<=u?c(e):a(e):r<=l?c(e):a(e)}}var L0=M0(Gn),N0=Gn.split(".")[0],rs=Symbol.for("opentelemetry.js.api."+N0),ss=D0;function os(e,t,n,i){var s;void 0===i&&(i=!1);var r=ss[rs]=null!==(s=ss[rs])&&void 0!==s?s:{version:Gn};if(!i&&r[e]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(o.stack||o.message),!1}if(r.version!==Gn){o=new Error("@opentelemetry/api: Registration of version v"+r.version+" for "+e+" does not match previously registered API v"+Gn);return n.error(o.stack||o.message),!1}return r[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+Gn+"."),!0}function Bn(e){var t,n,i=null===(t=ss[rs])||void 0===t?void 0:t.version;if(i&&L0(i))return null===(n=ss[rs])||void 0===n?void 0:n[e]}function as(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Gn+".");var n=ss[rs];n&&delete n[e]}var Ht,x0=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o},_0=function(e,t,n){if(n||2===arguments.length)for(var i,s=0,r=t.length;s<r;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))},F0=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ts("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ts("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ts("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ts("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ts("verbose",this._namespace,e)},e}();function ts(e,t,n){var i=Bn("diag");if(i)return n.unshift(t),i[e].apply(i,_0([],x0(n),!1))}function U0(e,t){function n(n,i){var s=t[n];return"function"==typeof s&&e>=i?s.bind(t):function(){}}return e<Ht.NONE?e=Ht.NONE:e>Ht.ALL&&(e=Ht.ALL),t=t||{},{error:n("error",Ht.ERROR),warn:n("warn",Ht.WARN),info:n("info",Ht.INFO),debug:n("debug",Ht.DEBUG),verbose:n("verbose",Ht.VERBOSE)}}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(Ht||(Ht={}));var j0=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o},G0=function(e,t,n){if(n||2===arguments.length)for(var i,s=0,r=t.length;s<r;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))},B0="diag",ki=function(){function e(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=Bn("diag");if(i)return i[e].apply(i,G0([],j0(t),!1))}}var t=this;t.setLogger=function(e,n){var i,s,r;if(void 0===n&&(n={logLevel:Ht.INFO}),e===t){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(i=o.stack)&&void 0!==i?i:o.message),!1}"number"==typeof n&&(n={logLevel:n});var a=Bn("diag"),c=U0(null!==(s=n.logLevel)&&void 0!==s?s:Ht.INFO,e);if(a&&!n.suppressOverrideMessage){var d=null!==(r=(new Error).stack)&&void 0!==r?r:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+d),c.warn("Current logger will overwrite one already registered from "+d)}return os("diag",c,t,!0)},t.disable=function(){as(B0,t)},t.createComponentLogger=function(e){return new F0(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),V0=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o},H0=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},W0=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){var t=V0(e,2);return[t[0],t[1]]}))},e.prototype.setEntry=function(t,n){var i=new e(this._entries);return i._entries.set(t,n),i},e.prototype.removeEntry=function(t){var n=new e(this._entries);return n._entries.delete(t),n},e.prototype.removeEntries=function(){for(var t,n,i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var r=new e(this._entries);try{for(var o=H0(i),a=o.next();!a.done;a=o.next()){var c=a.value;r._entries.delete(c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},e.prototype.clear=function(){return new e},e}(),z0=Symbol("BaggageEntryMetadata"),K0=ki.instance();function $0(e){return void 0===e&&(e={}),new W0(new Map(Object.entries(e)))}function q0(e){return"string"!=typeof e&&(K0.error("Cannot create baggage metadata from unknown type: "+typeof e),e=""),{__TYPE__:z0,toString:function(){return e}}}function pc(e){return Symbol.for(e)}var nc,J0=function(){return function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(e){return n._currentContext.get(e)},n.setValue=function(t,i){var s=new e(n._currentContext);return s._currentContext.set(t,i),s},n.deleteValue=function(t){var i=new e(n._currentContext);return i._currentContext.delete(t),i}}}(),Sf=new J0,Qd=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],Q0=function(){return function(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(console){var i=console[e];if("function"!=typeof i&&(i=console.log),"function"==typeof i)return i.apply(console,t)}}}for(var t=0;t<Qd.length;t++)this[Qd[t].n]=e(Qd[t].c)}}(),Er=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Y0=function(){function e(){}return e.prototype.createHistogram=function(e,t){return sm},e.prototype.createCounter=function(e,t){return rm},e.prototype.createUpDownCounter=function(e,t){return om},e.prototype.createObservableGauge=function(e,t){return dm},e.prototype.createObservableCounter=function(e,t){return am},e.prototype.createObservableUpDownCounter=function(e,t){return cm},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),vc=function(){return function(){}}(),X0=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Er(t,e),t.prototype.add=function(e,t){},t}(vc),Z0=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Er(t,e),t.prototype.add=function(e,t){},t}(vc),em=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Er(t,e),t.prototype.record=function(e,t){},t}(vc),gc=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),tm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Er(t,e),t}(gc),im=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Er(t,e),t}(gc),nm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Er(t,e),t}(gc),yf=new Y0,rm=new X0,sm=new em,om=new Z0,am=new tm,dm=new im,cm=new nm;function lm(){return yf}!function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(nc||(nc={}));var lo,bf={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},Ef={set:function(e,t,n){null!=e&&(e[t]=n)}},um=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o},hm=function(e,t,n){if(n||2===arguments.length)for(var i,s=0,r=t.length;s<r;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))},fm=function(){function e(){}return e.prototype.active=function(){return Sf},e.prototype.with=function(e,t,n){for(var i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return t.call.apply(t,hm([n],um(i),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),pm=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o},vm=function(e,t,n){if(n||2===arguments.length)for(var i,s=0,r=t.length;s<r;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))},Yd="context",gm=new fm,ho=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return os(Yd,e,ki.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,n){for(var i,s=[],r=3;r<arguments.length;r++)s[r-3]=arguments[r];return(i=this._getContextManager()).with.apply(i,vm([e,t,n],pm(s),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return Bn(Yd)||gm},e.prototype.disable=function(){this._getContextManager().disable(),as(Yd,ki.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(lo||(lo={}));var mc="0000000000000000",Ac="00000000000000000000000000000000",wf={traceId:Ac,spanId:mc,traceFlags:lo.NONE},is=function(){function e(e){void 0===e&&(e=wf),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),Sc=pc("OpenTelemetry Context Key SPAN");function yc(e){return e.getValue(Sc)||void 0}function mm(){return yc(ho.getInstance().active())}function bc(e,t){return e.setValue(Sc,t)}function Am(e){return e.deleteValue(Sc)}function Sm(e,t){return bc(e,new is(t))}function Cf(e){var t;return null===(t=yc(e))||void 0===t?void 0:t.spanContext()}var ym=/^([0-9a-f]{32})$/i,bm=/^[0-9a-f]{16}$/i;function If(e){return ym.test(e)&&e!==Ac}function Tf(e){return bm.test(e)&&e!==mc}function Ec(e){return If(e.traceId)&&Tf(e.spanId)}function Em(e){return new is(e)}var Xd=ho.getInstance(),Rf=function(){function e(){}return e.prototype.startSpan=function(e,t,n){if(void 0===n&&(n=Xd.active()),!(null==t||!t.root))return new is;var i=n&&Cf(n);return wm(i)&&Ec(i)?new is(i):new is},e.prototype.startActiveSpan=function(e,t,n,i){var s,r,o;if(!(arguments.length<2)){2===arguments.length?o=t:3===arguments.length?(s=t,o=n):(s=t,r=n,o=i);var a=r??Xd.active(),c=this.startSpan(e,s,a),d=bc(a,c);return Xd.with(d,o,void 0,c)}},e}();function wm(e){return"object"==typeof e&&"string"==typeof e.spanId&&"string"==typeof e.traceId&&"number"==typeof e.traceFlags}var sc,oc,ac,Cm=new Rf,kf=function(){function e(e,t,n,i){this._provider=e,this.name=t,this.version=n,this.options=i}return e.prototype.startSpan=function(e,t,n){return this._getTracer().startSpan(e,t,n)},e.prototype.startActiveSpan=function(e,t,n,i){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):Cm},e}(),Im=function(){function e(){}return e.prototype.getTracer=function(e,t,n){return new Rf},e}(),Tm=new Im,rc=function(){function e(){}return e.prototype.getTracer=function(e,t,n){var i;return null!==(i=this.getDelegateTracer(e,t,n))&&void 0!==i?i:new kf(this,e,t,n)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:Tm},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,n){var i;return null===(i=this._delegate)||void 0===i?void 0:i.getTracer(e,t,n)},e}();!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(sc||(sc={})),function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(oc||(oc={})),function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(ac||(ac={}));var dc="[_0-9a-z-*/]",Rm="[a-z]"+dc+"{0,255}",km="[a-z0-9]"+dc+"{0,240}@[a-z]"+dc+"{0,13}",Pm=new RegExp("^(?:"+Rm+"|"+km+")$"),Om=/^[ -~]{0,255}[!-~]$/,Dm=/,|=/;function Mm(e){return Pm.test(e)}function Lm(e){return Om.test(e)&&!Dm.test(e)}var cf=32,Nm=512,lf=",",uf="=",xm=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,n){return t.push(n+uf+e.get(n)),t}),[]).join(lf)},e.prototype._parse=function(e){e.length>Nm||(this._internalState=e.split(lf).reverse().reduce((function(e,t){var n=t.trim(),i=n.indexOf(uf);if(-1!==i){var s=n.slice(0,i),r=n.slice(i+1,t.length);Mm(s)&&Lm(r)&&e.set(s,r)}return e}),new Map),this._internalState.size>cf&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,cf))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}();function _m(e){return new xm(e)}var Pf=ho.getInstance(),Of=ki.instance(),Fm=function(){function e(){}return e.prototype.getMeter=function(e,t,n){return yf},e}(),Um=new Fm,Zd="metrics",jm=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return os(Zd,e,ki.instance())},e.prototype.getMeterProvider=function(){return Bn(Zd)||Um},e.prototype.getMeter=function(e,t,n){return this.getMeterProvider().getMeter(e,t,n)},e.prototype.disable=function(){as(Zd,ki.instance())},e}(),Df=jm.getInstance(),Gm=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),wc=pc("OpenTelemetry Baggage Key");function Mf(e){return e.getValue(wc)||void 0}function Bm(){return Mf(ho.getInstance().active())}function Vm(e,t){return e.setValue(wc,t)}function Hm(e){return e.deleteValue(wc)}var ec="propagation",Wm=new Gm,zm=function(){function e(){this.createBaggage=$0,this.getBaggage=Mf,this.getActiveBaggage=Bm,this.setBaggage=Vm,this.deleteBaggage=Hm}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return os(ec,e,ki.instance())},e.prototype.inject=function(e,t,n){return void 0===n&&(n=Ef),this._getGlobalPropagator().inject(e,t,n)},e.prototype.extract=function(e,t,n){return void 0===n&&(n=bf),this._getGlobalPropagator().extract(e,t,n)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){as(ec,ki.instance())},e.prototype._getGlobalPropagator=function(){return Bn(ec)||Wm},e}(),Lf=zm.getInstance(),tc="trace",Km=function(){function e(){this._proxyTracerProvider=new rc,this.wrapSpanContext=Em,this.isSpanContextValid=Ec,this.deleteSpan=Am,this.getSpan=yc,this.getActiveSpan=mm,this.getSpanContext=Cf,this.setSpan=bc,this.setSpanContext=Sm}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=os(tc,this._proxyTracerProvider,ki.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return Bn(tc)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){as(tc,ki.instance()),this._proxyTracerProvider=new rc},e}(),Nf=Km.getInstance();const $m={context:Pf,diag:Of,metrics:Df,propagation:Lf,trace:Nf},qm=Object.freeze(Object.defineProperty({__proto__:null,DiagConsoleLogger:Q0,get DiagLogLevel(){return Ht},INVALID_SPANID:mc,INVALID_SPAN_CONTEXT:wf,INVALID_TRACEID:Ac,ProxyTracer:kf,ProxyTracerProvider:rc,ROOT_CONTEXT:Sf,get SamplingDecision(){return sc},get SpanKind(){return oc},get SpanStatusCode(){return ac},get TraceFlags(){return lo},get ValueType(){return nc},baggageEntryMetadataFromString:q0,context:Pf,createContextKey:pc,createNoopMeter:lm,createTraceState:_m,default:$m,defaultTextMapGetter:bf,defaultTextMapSetter:Ef,diag:Of,isSpanContextValid:Ec,isValidSpanId:Tf,isValidTraceId:If,metrics:Df,propagation:Lf,trace:Nf},Symbol.toStringTag,{value:"Module"})),Jm=P0(qm);!function(e){(()=>{var t={853:
/*!********************************************!*\
          !*** ../../ragnarok-core/dist/ragnarok.js ***!
          \********************************************/(e,t,n)=>{var i=n(
/*! @opentelemetry/api */
754),s=n(
/*! @gamestream/utils */
771);function r(e){return"Xbox"===e.os&&"Edge"===e.browser}function o(e){return"iOS"===e.os||"iPadOS"===e.os||a(e)}function a(e){return"VISIONPRO"===(e.model||e.deviceModel)}function c(e){var t,n;return null!==(n=null===(t=e.model||e.deviceModel)||void 0===t?void 0:t.toUpperCase().startsWith("QUEST"))&&void 0!==n&&n}function d(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}function l(e){return"0x"+("00000000"+(e>>>0).toString(16).toUpperCase()).slice(-8)}function u(e){return"Safari"===e.browser}function h(e){return e?"iOS"===e.os:/iPhone|iPod/.test(navigator.userAgent)}function p(e){return"WebOS"===e.os}function f(e){return"ChromeOS"===e.os}function v(e){return"Windows"===e.os}function g(e){return"macOS"===e.os}function m(e){return"Tizen"===e.os}function A(){var e,t;return null===(t=null===(e=window.matchMedia)||void 0===e?void 0:e.call(window,"(pointer:coarse)"))||void 0===t?void 0:t.matches}function b(){var e,t;return!!window.TouchEvent&&(null===(t=null===(e=window.matchMedia)||void 0===e?void 0:e.call(window,"(any-pointer:coarse)"))||void 0===t?void 0:t.matches)}function S(e){return"Tizen"===e.os||"WebOS"===e.os}function y(){let e=new Uint8Array(36);window.crypto.getRandomValues(e);let t="";for(let n=0;36>n;n++){let i=e[n]%16;8==n||13==n||18==n||23==n?t+="-":14==n?t+="4":(19==n&&(i=3&i|8),t+=i.toString(16))}return s.Log.i("{d988e7f}","{534eaf4}",t),t}function w(e,t){for(let n=0;n<t.length&&n<e.length;++n){const i=e[n],s=t[n];if(i>s)return!0;if(i<s)return!1}if(e.length<t.length)for(e=e.length;e<t.length;++e)if(0<t[e])return!1;return!0}function E(e){return"Chrome"==e.browser}function I(e,t,n,i,r){if("Chrome"!=e.browser)return!1;t=[t,n??0,i??0,r??0];try{return w(e.browserBestVer.split(".").map((e=>Number.parseInt(e))),t)}catch{s.Log.w("{d988e7f}","{bcd8f94}")}return!0}function C(e,t,n,i){var r;if(!o(e))return!1;try{return T(null!==(r=e.osVersion)&&void 0!==r?r:e.osVer,t,n,i)}catch{s.Log.w("{d988e7f}","{cf4149f}")}return!t}function T(e,t,n,i){e=e.replace(/[^0-9.]/,"").split(".").map((e=>Number.parseInt(e)));const s=[n,i??0];return 1===e.length&&e.push(0),t?e.every(((e,t)=>e===s[t])):w(e,s)}function R(e,t,n){return{code:e,description:t,error:null!==n?n:void 0}}function k(e){switch(e){case"ETHERNET":return"ETHERNET";case"WIFI":case"WIFI_2_4":return"WIFI_2_4";case"WIFI_5_0":return"WIFI_5_0";case"MOBILE":return"MOBILE";case"MOBILE_2G":return"MOBILE_2G";case"MOBILE_3G":return"MOBILE_3G";case"MOBILE_4G":return"MOBILE_4G";case"MOBILE_5G":return"MOBILE_5G";case"OTHER":case"BLUETOOTH":case"WIMAX":return"OTHER";default:return"UNKNOWN"}}function O(e){return e.replace(/(partnerCustomData" *: *")((\\"|[^"])*)(?=")/g,"$1***")}var P=!0,D=!1;function L(e){if(e)switch(e){case"enable":case"on":case"1":case"true":return!0;case"disable":case"off":case"0":case"false":return!1}}var x=class{constructor(e){this.D=new Map,this.ta=e}addListener(e,t){var n=this.D.get(e);void 0!==n?n.add(t):((n=new Set).add(t),this.D.set(e,n))}removeListener(e,t){null==(e=this.D.get(e))||e.delete(t)}removeAllListenersOfEvent(e){this.D.delete(e)}removeAllListeners(){this.D.clear()}hasListener(e){return void 0!==(e=this.D.get(e))&&0<e.size}emit(e,...t){try{let n=this.D.get(e);if(n)for(const e of n)this.ta?e(...t):window.setTimeout(e,0,...t)}catch(e){console.log("Exception in emit: "+e)}}};function M(e,t){var n=B,i=V;let s=[];var r=e;let o=[];do{o.push(r),r=Object.getPrototypeOf(r)}while(""!=r.name);o.reverse();for(let e of o)s.push(e.toString().replace(/(extends )[^ {]*\.([^ ]*[ {])/,"$1$2"));return s.push(`${n.toString()}`),t?(s.push(`${t.toString()}`),s.push(`onconnect = (event) => { ${t.name}(${e.name}, event, ${n.name}); };`)):s.push(`onmessage = (event) => { ${n.name}(${e.name}, event); };`),s.push(`${i.toString()}`),s.push(`onerror = (event) => { ${i.name}(event); };`),URL.createObjectURL(new Blob(s,{type:"text/javascript"}))}function N(e,t,n){if(!e.prototype.lb)throw Error("Invalid Worker class provided");e=M(e);const i=new Worker(e);URL.revokeObjectURL(e),j(i,t,n)}function _(e,t,n){var i=window;if(typeof i.SharedWorker>"u")throw Error("SharedWorker not supported");if(!e.prototype.lb)throw Error("Invalid Worker class provided");return e=M(e,G),i=new i.SharedWorker(e),URL.revokeObjectURL(e),j(i,t,n),i}P||s.Logger.setLogLevel("ERROR"),D&&s.Logger.setLogMechanism(1);const F=new Map;function U(e){if(!F.has(e)){e.postMessage.bind(e)({Tb:2,data:null});var t=window.setTimeout((()=>{const t=F.get(e);t&&(clearTimeout(t),F.delete(e)),e instanceof Worker?e.terminate():e instanceof MessagePort&&e.close()}),150);F.set(e,t)}}function j(e,t,n){const i="port"in e?e.port:e,r=i.postMessage.bind(i);let o=!1;const a=e=>{o||(o=!0,s.Log.e("{10ca8e2}","{03baf25}",e,typeof e),U(i),n(e))};i.onmessage=e=>{let n=(e=e.data).data;switch(e.Tb){case 1:r({Tb:3,data:null});break;case 4:t(n),U(i);break;case 5:a(n)}},"onmessageerror"in i&&(i.onmessageerror=a),e.onerror=a,r({Tb:0,data:null})}function G(e,t,n){const i=globalThis;i.port=t.ports[0],i.port.onmessage=n.bind(self,e)}function B(e,t){var n;const i=globalThis;i.Hd=null!==(n=i.Hd)&&void 0!==n?n:{},t=(n=t.data).Tb,n=n.data;let s="port"in i?i.port:self;switch(t){case 0:var r=new e;i.Hd[e.name]=r,s.postMessage({Tb:1,data:null});break;case 2:null===(r=null==self?void 0:self.close)||void 0===r||r.call(self);break;case 3:Promise.resolve(i.Hd[e.name].lb()).then((e=>{s.postMessage({Tb:4,data:e})}));break;default:throw Error(`Unknown message: ${t}:${n}`)}}function V(e){const t=globalThis;("port"in t?t.port:self).postMessage({Tb:5,data:e})}function H(e){return e.start=performance.now(),new Promise((t=>{e.$f?t(e.u):async function(e){var t=Promise,n=t.all,i=function(e){return new Promise((t=>{let n=!1;const i=i=>{if(e.ea)clearTimeout(e.ea),e.ea=0;else if(n)return s.Log.w("{3c72abb}","{c1bb269}"),void K(e,"GL",e.Jc-performance.now());if(!e.Bb){var r=i.Lf;if(r.startsWith("ANGLE")){var o=r.split(",");1<(null==o?void 0:o.length)&&(e.gpuDetail=o[1].trim())}else e.gpuDetail=r;o=r.toLowerCase(),r.includes("SraKmd")?(e.I=!0,r.includes("SraKmd_arden")&&(e.va=!0),(r=/D3D11-(\d{2,}\.\d{1,}\.\d{5,}\.\d{4,})/.exec(r))&&1<r.length&&(e.osVersion=r[1])):r.includes("AMD")&&o.includes("vangogh")&&(e.ab=!0),e.Kc=i.Bf,e.Bb=!0}t()};let r=!1,o=!1;const a=t=>{"string"==typeof t?$(e,"GL",t):"data"in t?J(e,"GL",t):Q(e,"GL",t),o=!0,s.Log.e("{3c72abb}","{9e45306}",t)};let c=0;try{self.OffscreenCanvas&&(r=!0,N(he,i,a),c=150)}catch(t){o=!0,Y(e,"GL",t),s.Log.w("{3c72abb}","{caf8cd7}",t)}window.setTimeout((()=>{e.Bb||(e.ea=window.setTimeout((()=>{e.ea=0,e.Jc=performance.now(),o?s.Log.w("{3c72abb}","{fbe663c}"):r?(s.Log.w("{3c72abb}","{2577061}"),X(e,"GL")):(s.Log.i("{3c72abb}","{95c252e}"),Z(e,"GL"));const t=(new he).lb();i(t),n=!0}),c))}),0)}))}(e),r=function(e){return new Promise((t=>{if(navigator.userAgentData){var n=t=>{var n;if(!e.ag){var i=t.model,s=t.platform,r=t.platformVersion,o=t.uaFullVersion,a=t.bitness;""==i&&""==s&&""==r&&""==o?e.$a&&e.N||e.wa||null==a||e.N&&!e.T||(e.v=!0):""==a&&"Android"!=s&&(e.v=!0),i&&("Xbox"===i?e.V=!0:i.startsWith("AFT")?(e.lf=!0,e.K=!0):i.includes("BRAVIA")?(e.K=!0,e.Ye=!0):"Chromecast"===i?(e.K=!0,e.cf=!0,e.deviceName="CHROMECAST"):"SHIELD Android TV"===i?(e.K=!0,e.sf=!0,e.deviceName="SHIELDTV"):i.startsWith("MiTV")?(e.K=!0,e.nf=!0,e.deviceName="MITV"):i.startsWith("TVision")?(e.K=!0,e.wf=!0,e.deviceName="TVISION"):i.startsWith("Quest")&&(e.Ue=!0,e.qf=!0,e.C=i,e.deviceName="QUEST")),"Windows"===s?e.M=!0:"macOS"===s?e.J=!0:"Chrome OS"===s||"ChromeOS"===s?e.L=!0:"Chromium OS"===s?e.Z=!0:"Android"===s?e.W=!0:"Linux"===s&&(""==r?(e.W=!0,e.xf=!0):e.fa=!0),i=e=>{if(e&&"string"==typeof e)return e.replace(/[-._,:;|#@]/g,".")};var c=t=>{if(!t||!e.ja||95>+e.ja)return t;switch(t.split(".").map((e=>Number.parseInt(e)))[0]){case 0:return"8-";case 1:return"10.0.10240";case 2:return"10.0.10586";case 3:return"10.0.14393";case 4:return"10.0.15063";case 5:return"10.0.16299";case 6:return"10.0.17134";case 7:return"10.0.17763";case 8:return"10.0.18362+";case 9:return"10.0.9";case 10:return"10.0.19041+";case 11:return"10.0.11";case 12:return"10.0.12";case 13:return"11.0.0";case 14:return"11.0.22000.0";case 15:return"11.0.22621.0";default:return"11.0.22621.0+"}};s=t=>e.M&&!e.V?c(t):t,t.brands&&0<t.brands.length&&function(e,t){var n;e.ma=!0,t.mobile&&(e.bb=!0);var i=t.brands||[];t=0;for(const s of i){i=s.brand;const r=s.version;"Google Chrome"===i?(e.oa=!0,e.m=r):"Microsoft Edge"===i?(e.Ua=!0,e.m=r):"Opera"===i?(e.pa=!0,e.m=r):"Yandex"===i?(e.Wa=!0,e.m=r):"Chromium"===i?(e.S=!0,e.m=null!==(n=e.m)&&void 0!==n?n:r,e.ja=r):"Android WebView"===i?(e.Mc=!0,e.m=r):t++}2<t&&(e.Lc=!0)}(e,t),e.browserFullVer=i(o),e.tg=r,e.osVersion=null!==(n=e.osVersion)&&void 0!==n?n:s(i(r)),e.ag=!0}},i=i=>{i&&(e.na&&(clearTimeout(e.na),e.na=0),n(i),t())},r=!1,o=!1,a=t=>{"string"==typeof t?$(e,"HE",t):"data"in t?J(e,"HE",t):Q(e,"HE",t),o=!0,s.Log.e("{3c72abb}","{217e106}",t)},c=0;try{if(self.SharedWorker){r=!0;var d=_(pe,i,a);c=300}}catch(t){o=!0,s.Log.w("{3c72abb}","{a583546}",t),Y(e,"HE",t)}e.na=window.setTimeout((()=>{d&&U("port"in d?d.port:d),o?s.Log.w("{3c72abb}","{dbf4b42}"):r?(s.Log.w("{3c72abb}","{0bf7a38}"),X(e,"HE"),e.tf=!0):(s.Log.i("{3c72abb}","{7a82b59}"),Z(e,"HE")),(new pe).lb().then((e=>{i(e)}))}),c)}else t()}))}(e),o=async function(e){e.Nb=!!window.chrome&&await async function(){if(!window.createImageBitmap)return!1;const e=await fetch("data:image/avif;base64,AAAAGGZ0eXBhdmlmAAAAAGF2aWZtaWYxAAADm21ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAAAAAAAAAAAAAAAAAAAAADnBpdG0AAAAAAAEAAAAiaWxvYwAAAABEQAABAAEAAAAAA7sAAQAAAAAAAAAjAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAYXYwMQAAAAMbaXBycAAAAvxpcGNvAAACrGNvbHJwcm9mAAACoGxjbXMEMAAAbW50clJHQiBYWVogB+UACAAJAAsAEAAFYWNzcE1TRlQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1sY21zAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANZGVzYwAAASAAAABAY3BydAAAAWAAAAA2d3RwdAAAAZgAAAAUY2hhZAAAAawAAAAsclhZWgAAAdgAAAAUYlhZWgAAAewAAAAUZ1hZWgAAAgAAAAAUclRSQwAAAhQAAAAgZ1RSQwAAAhQAAAAgYlRSQwAAAhQAAAAgY2hybQAAAjQAAAAkZG1uZAAAAlgAAAAkZG1kZAAAAnwAAAAkbWx1YwAAAAAAAAABAAAADGVuVVMAAAAkAAAAHABHAEkATQBQACAAYgB1AGkAbAB0AC0AaQBuACAAcwBSAEcAQm1sdWMAAAAAAAAAAQAAAAxlblVTAAAAGgAAABwAUAB1AGIAbABpAGMAIABEAG8AbQBhAGkAbgAAWFlaIAAAAAAAAPbWAAEAAAAA0y1zZjMyAAAAAAABDEIAAAXe///zJQAAB5MAAP2Q///7of///aIAAAPcAADAblhZWiAAAAAAAABvoAAAOPUAAAOQWFlaIAAAAAAAACSfAAAPhAAAtsRYWVogAAAAAAAAYpcAALeHAAAY2XBhcmEAAAAAAAMAAAACZmYAAPKnAAANWQAAE9AAAApbY2hybQAAAAAAAwAAAACj1wAAVHwAAEzNAACZmgAAJmcAAA9cbWx1YwAAAAAAAAABAAAADGVuVVMAAAAIAAAAHABHAEkATQBQbWx1YwAAAAAAAAABAAAADGVuVVMAAAAIAAAAHABzAFIARwBCAAAADGF2MUOBDQwAAAAAFGlzcGUAAAAAAAAAEAAAABAAAAAoY2xhcAAAAAEAAAABAAAAAQAAAAH////xAAAAAv////EAAAACAAAAF2lwbWEAAAAAAAAAAQABBIGCA4QAAAArbWRhdBIACgkfzP/IIEBA0oAyFGW+OwPr0bIHHHHBATZPtaQ3RWTA").then((e=>e.blob()));return createImageBitmap(e).then((()=>!0),(()=>!1))}()}(e),a=function(e){const t=window.speechSynthesis;if(t){const n=t.getVoices;let i=(null==n?void 0:n.call(t))||[];return new Promise((s=>{if(!n||i.length)W(e,i),s();else{let r=0;const o=()=>{i=n.call(t);const a=performance.now();0==i.length&&(0==r||600>a-r)?(e.O&&clearTimeout(e.O),e.O=window.setTimeout(o,150)):(e.O&&(clearTimeout(e.O),e.O=0),W(e,i),s())};void 0!==t.onvoiceschanged&&(t.onvoiceschanged=o),window.setTimeout((()=>{i=n.call(t),i.length?o():(e.O=window.setTimeout(o,150),r=performance.now())}),0)}}))}return new Promise((e=>{e()}))}(e),c=function(e){return new Promise((t=>{var n=navigator.userAgent;n&&(n=n.match(e.Hc))&&(e.rg=null==n?void 0:n[1],e.qg=null==n?void 0:n[2]),t()}))}(e),d=function(e){var t,n,i,s,r,o,a,c,d,l;const u=window,h=u.hasOwnProperty,p=u.navigator,f=u.Intl,v=u.CSS,g=null==v?void 0:v.supports,m=u.Promise;h.call(u,"MSMediaKeys")?e.Nc=!0:h.call(u,"_firefoxTV_cachedScrollPosition")?e.Fc=!0:void 0!==u.__edgeActiveElement||u.__edgeTrackingPreventionStatistics?e.Ya=!0:u.safari?e.Oe=!0:u.opr?e.Be=!0:u.oprt?e.Fe=!0:p.brave?e.qa=!0:void 0!==u.OperaTouch||u.ethereum?(e.$a=!0,e.N=!0):u.yandex?e.ta=!0:u.QuickAccess?e.sa=!0:u.chrome?e.T=!0:u.netscape?e.ra=!0:u.__firefox__?e.Za=!0:u.__gCrWeb?e.Xa=!0:u.ReactNativeWebView&&(e.Ie=!0),void 0!==u.contacts||void 0!==u.ContactsManager?e.N=!0:h.call(u,"onwebOSAccessibilityAlertDone")||u.webOSSystem||h.call(u,"onwebosaccessibilityalertdone")?e.Ff=!0:u.tizen||u.TizenTVApiInfo||u.addEdgeEffectONSCROLLTizenUIF||u.tizentvwasm?e.wa=!0:u.HardkeyEvent&&(e.Df=!0),!(null===(t=p.mediaCapabilities)||void 0===t)&&t.decodingInfo&&(e.qe=!0),u.BigInt&&(e.ee=!0,u.BigInt64Array&&(e.fe=!0)),u.PerformanceNavigationTiming&&(e.Ae=!0),u.WebAssembly&&u.WebAssembly.Exception&&(e.af=!0),u.BroadcastChannel&&(e.ge=!0),u.GPUBuffer&&(e.ue=!0),u.SharedWorker&&(e.Me=!0),u.MediaRecorder&&(e.ye=!0),u.CSSCounterStyleRule&&(e.ie=!0),t=null===(n=u.ArrayBuffer)||void 0===n?void 0:n.prototype,null!=t&&t.hasOwnProperty("transfer")&&(e.be=!0),h.call(u,"ondevicelight")&&(e.re=!0),!(null===(i=u.AbortSignal)||void 0===i)&&i.abort&&(e.dg=!0),h.call(u,"onbeforeinput")&&(e.de=!0),f&&(f.DisplayNames&&(e.za=!0),e.ve="pinyin"==(null===(s=new f.Collator("zh",{collation:"pinyin"}).resolvedOptions())||void 0===s?void 0:s.collation)),u.Credential&&(e.pe=!0),u.LargestContentfulPaint&&(e.xe=!0),null!=v&&v.registerProperty&&(e.me=!0),n=null===(r=u.HTMLElement)||void 0===r?void 0:r.prototype,null!=n&&n.hasOwnProperty("autofocus")&&(e.te=!0),p.contacts&&(e.oe=!0),u.TrustedHTML&&(e.Pe=!0),u.WakeLock&&(e.Ve=!0),null!=m&&m.any&&(e.ae=!0),u.FileSystemHandle&&(e.se=!0),!(null===(o=u.Atomics)||void 0===o)&&o.waitAsync&&(e.ce=!0),null!=g&&g.call(v,"aspect-ratio: auto")&&(e.le=!0),u.ReadableStreamBYOBReader&&(e.Ge=!0),null!=g&&g.call(v,"overflow: clip")&&(e.ze=!0),null!=g&&g.call(v,"content-visibility: auto")&&(e.he=!0),u.CSSStartingStyleRule&&(e.ke=!0),null!=m&&m.withResolvers&&(e.Ce=!0),r=null===(a=u.CanvasRenderingContext2D)||void 0===a?void 0:a.prototype,null!=r&&r.hasOwnProperty("reset")&&(e.ne=!0),(null===(c=u.Set)||void 0===c?void 0:c.prototype).hasOwnProperty("difference")&&(e.Je=!0),null!=g&&g.call(v,"selector(:user-valid)")&&(e.je=!0),a=null===(d=u.InputEvent)||void 0===d?void 0:d.prototype,null!=a&&a.hasOwnProperty("isComposing")&&(e.we=!0),u.VRDisplay&&(e.Ba=!0),d=null===(l=u.HTMLVideoElement)||void 0===l?void 0:l.prototype,e.Ob=null==d?void 0:d.hasOwnProperty("webkitSupportsPresentationMode")}(e),l=function(e){var t,n,i,r;const o=window.RequestCrowNativeApi;if(o){let a=0;const c=new Promise(((e,t)=>{a=window.setTimeout((()=>{t("timeout")}),100)})),d=window.zoneless,l=null!==(n=null===(t=null==d?void 0:d.windowAddEventListener)||void 0===t?void 0:t.bind(window))&&void 0!==n?n:window.addEventListener.bind(window),u=null!==(r=null===(i=null==d?void 0:d.windowRemoveEventListener)||void 0===i?void 0:i.bind(window))&&void 0!==r?r:window.removeEventListener.bind(window);let h;return t=new Promise((e=>{h=t=>{e(t.detail)},l("CrowNativeApiEvent",h),o(JSON.stringify({Lg:"RequestBrowserVersion"}))})).then((t=>{var n;(t=null===(n=t.browserVersion)||void 0===n?void 0:n.match(e.Hc))&&(e.browserFullVer=null==t?void 0:t[1],e.m=null==t?void 0:t[2])})),Promise.race([t,c]).catch((()=>{s.Log.d("{3c72abb}","{841bf6f}")})).finally((()=>{window.clearTimeout(a),u("CrowNativeApiEvent",h)}))}return Promise.resolve()}(e),u=function(e){return new Promise((t=>{let n=!1;const i=i=>{if(e.ha)clearTimeout(e.ha),e.ha=0;else if(n)return s.Log.w("{3c72abb}","{b02109c}"),void K(e,"Plat",e.cg-performance.now());e.Cb||("MacIntel"===(i=i.platform)?e.ba=!0:"iPhone"===i?e.xa=!0:"Win32"===i?e.da=!0:"iPad"===i?e.cb=!0:"FreeBSD amd64"===i?e.ga=!0:"Windows"===i&&(e.da=!0,e.U=!0),i.startsWith("Linux")&&(e.aa=!0),e.Cb=!0),t()};let r=!1,o=!1;const a=t=>{"string"==typeof t?$(e,"Plat",t):"data"in t?J(e,"Plat",t):Q(e,"Plat",t),o=!0,s.Log.e("{3c72abb}","{6350135}",t)};let c=0;try{r=!0,N(ve,i,a),c=150}catch(t){o=!0,Y(e,"Plat",t),s.Log.w("{3c72abb}","{79668e5}",t)}window.setTimeout((()=>{e.Cb||(e.ha=window.setTimeout((()=>{e.ha=0,e.cg=performance.now(),o?s.Log.w("{3c72abb}","{d9e1e01}"):r?(s.Log.w("{3c72abb}","{a8d68cb}"),X(e,"Plat")):(s.Log.i("{3c72abb}","{53e2225}"),Z(e,"Plat"));const t=(new ve).lb();i(t),n=!0}),c))}),0)}))}(e),h=function(e){const t=window;t.ApplePaySession&&t.ApplePaySession.canMakePayments&&(e.Db=!0)}(e),p=function(e){var t=navigator.plugins;for(const n of t)"Native Client"!==(t=n.name)&&(t.startsWith("Microsoft Edge PDF")?e.Zf=!0:t.startsWith("Chrome PDF")?e.Mf=!0:t.startsWith("Chromium PDF")?e.Yf=!0:t.startsWith("PPAPI SAMSUNGHEALTH")&&(e.wa=!0))}(e);navigator.maxTouchPoints&&0<navigator.maxTouchPoints&&(e.$=!0),await n.call(t,[i,r,o,a,c,d,l,u,h,p,void 0,q(e),z(e)]).then((()=>{var t,n,i,r,o,a,c,d,l,u,h,p,f,v,g,m,A,b,S,y,w;if(e.ma&&((e.ba!=e.J||e.da!=e.M)&&(e.v=!0),(e.L||e.Z||e.W||e.fa)&&!e.aa&&(e.v=!0),e.m&&e.browserFullVer&&!ee(e.m,e.browserFullVer)&&(e.pa?e.ja&&!ee(e.ja,e.browserFullVer)&&(e.v=!0):e.v=!0),(e.L&&!e.oa||e.Z&&!e.S)&&(e.v=!0),e.Ka?(e.P&&!e.M||e.G&&!e.J)&&(e.v=!0):e.La?e.L||(e.v=!0):e.Pa?e.v=!0:e.P||!e.G||e.J||(e.v=!0),e.s=e.ma&&!e.v,e.R=e.ma&&e.v),!e.Kc&&e.T)e.g="Unknown",e.h="Unknown",e.U=!0,e.l=3,e.osVersion="0",e.m="0",e.browserFullVer="0",s.Log.d("{3c72abb}","{049d298}");else if(e.La)e.g="ChromeOS",te(e);else if(e.Ka)te(e),e.P?e.g="Windows":e.G?(e.g="macOS",e.j="APPLE"):e.s?e.M?e.g="Windows":e.J?(e.g="macOS",e.j="APPLE"):e.L||e.Z?(e.g="ChromeOS",e.U=!0,e.l=7):e.fa&&(e.g=ne(e)):e.da?e.g="Windows":e.ba?(e.g="macOS",e.j="APPLE"):e.aa?e.g=ne(e):e.ga?e.g="FreeBSD":(e.g="Unknown",e.l=5,s.Log.d("{3c72abb}","{101497c}"));else if(e.Pa)ie(e),e.P?e.g="Windows":e.G?(e.g="macOS",e.j="APPLE"):e.pf?(e.g="Android",se(e)):e.aa?e.g=ne(e):e.ga?e.g="FreeBSD":(e.g="Unknown",e.l=5,s.Log.d("{3c72abb}","{49fcccb}"));else if(e.mf)e.h="Edge",e.Pb?e.s&&e.V||e.I?(e.g="Xbox",e.j="MICROSOFT",e.va?e.C="XBOXSERIES":e.I&&(e.C="XBOXONE")):e.g="Windows":e.G?(e.g="macOS",e.j="APPLE"):e.Ea?(e.g="Android",se(e)):e.s?e.V?(e.g="Xbox",e.j="MICROSOFT",e.va?e.C="XBOXSERIES":e.I&&(e.C="XBOXONE")):e.M?e.g="Windows":e.J?(e.g="macOS",e.j="APPLE"):e.L||e.Z?(e.g="ChromeOS",e.U=!0,e.l=7):e.W?(e.g="Android",se(e)):e.fa&&(e.g=ne(e)):e.da?e.g="Windows":e.ba?(e.g="macOS",e.j="APPLE"):e.N?(e.g="Android",se(e)):e.aa?e.g=ne(e):e.ga?e.g="FreeBSD":(e.g="Unknown",e.l=5);else if(e.P)e.Pb?re(e):(re(e),e.U=!0,e.l=5);else if(e.G)oe(e);else if(e.Ea)ae(e);else if(e.s&&(e.V||e.M)||e.da||e.I)re(e);else if(e.s&&e.J||e.cb||e.xa||e.ba)oe(e);else if(e.s&&(e.L||e.Z))e.g="ChromeOS",te(e);else if(e.Df)e.g="ccOS",e.j="HKMC",e.h="Chromium";else if(e.s&&e.W||e.N)ae(e);else if(e.s&&e.fa)e.g=ne(e),e.bb||e.$?(e.h="Unknown",e.l=3):ce(e)||(e.h="Unknown",e.l=5,s.Log.d("{3c72abb}","{54c6569}"));else if(e.Ff)e.g="WebOS",e.j="LG",e.h="Chromium",e.browserFullVer=null!==(S=e.browserFullVer)&&void 0!==S?S:e.rg,e.m=null!==(y=e.m)&&void 0!==y?y:e.qg,e.R=!1;else if(e.wa){if(e.g="Tizen",e.h="Samsung",null!==(w=window.webapis)&&void 0!==w&&w.productinfo)try{e.osVersion=window.webapis.productinfo.getFirmware(),e.deviceName=window.webapis.productinfo.getRealModel(),e.Ta=window.webapis.productinfo.getLicensedVendor()}catch{s.Log.e("{3c72abb}","{bc7dd9b}")}else s.Log.e("{3c72abb}","{844af47}"),e.osVersion="0",e.deviceName="";e.j="Samsung"!==e.Ta&&e.Ta?"TIZENLICENSED":"SAMSUNG",S=/(([0-9]+\.)*[0-9]+)\/(([0-9]+\.)*[0-9]+)/,(y=navigator.userAgent)&&(S=y.match(S),e.browserFullVer=null==S?void 0:S[0],(S=null==S?void 0:S[1])&&(S=S.split("."),e.m=null==S?void 0:S[0]))}else e.aa?e.Fc?(e.g="Android",e.j="AMAZON",ie(e),e.D="TV"):e.sa?(e.g="Android",e.j="SAMSUNG",e.h="Samsung",se(e)):ce(e)?e.R?e.g=ne(e):!e.Yf||e.Mf||e.Zf?e.Ba?(e.g="Android",e.h="Pico",se(e)):e.g="Linux":(e.g=ne(e),e.h="Chromium",e.l=7):(e.g="Unknown",e.h="Unknown",e.l=0,s.Log.d("{3c72abb}","{be86380}")):e.ga?(e.g="FreeBSD",e.T?e.h="Chrome":e.ra?ie(e):(e.h="Unknown",e.l=3,s.Log.d("{3c72abb}","{a2c16e4}"))):e.Xa||e.Za||e.Ya?(e.xa=!0,oe(e),e.l=7):e.sa?(ae(e),e.l=7):(e.g="Unknown",e.h="Unknown",e.l=0,s.Log.d("{3c72abb}","{f2eecc9}"));switch(e.R&&(e.osVersion="0",e.m="0",e.browserFullVer="0"),e.Gc=performance.now(),e.u.os=null!==(t=e.g)&&void 0!==t?t:"Unknown",e.u.browser=null!==(n=e.h)&&void 0!==n?n:"Unknown",e.u.osRawVer=null!==(i=e.tg)&&void 0!==i?i:"0",e.u.osVersion=null!==(r=e.osVersion)&&void 0!==r?r:"0",e.u.osVer=e.u.osVersion,e.u.browserVer=null!==(o=e.m)&&void 0!==o?o:"0",t=null!==(a=e.browserFullVer)&&void 0!==a?a:void 0,e.u.browserFullVer=t??"0",e.u.browserBestVer=null!==(c=t??e.u.browserVer)&&void 0!==c?c:"0",e.u.confidence=null!==(p=null!==(h=null!==(u=null!==(l=null!==(d=e.l)&&void 0!==d?d:"Unknown"===e.g?0:void 0)&&void 0!==l?l:"Unknown"===e.h?5:void 0)&&void 0!==u?u:e.tf?6:void 0)&&void 0!==h?h:e.R?8:void 0)&&void 0!==p?p:10,e.u.forging=null!==(f=e.U)&&void 0!==f&&f,e.u.spoofing=null!==(v=e.R)&&void 0!==v&&v,e.u.make=null!==(g=e.j)&&void 0!==g?g:"",e.u.vendor=e.u.make,e.u.vendorFull=null!==(m=e.Ta)&&void 0!==m?m:e.u.make,a=void 0,e.u.os){case"ChromeOS":a="CHROMEOS";break;case"Windows":a="WINDOWS";break;case"macOS":a="MACOS";break;case"Linux":a="LINUX";break;case"iOS":a="IOS";break;case"iPadOS":a="IPADOS";break;case"Tizen":a="TIZEN";break;case"WebOS":a="WEBOS";break;case"Android":a="ANDROID";break;case"Xbox":a="XBOX";break;case"SteamOS":a="STEAMOS";break;case"ccOS":a="CCOS";break;case"visionOS":a="VISIONOS"}e.u.deviceOS=a,"visionOS"===e.u.os?e.u.model="VISIONPRO":e.ab?e.u.model="STEAMDECK":e.qf?e.u.model=null!==(A=e.C)&&void 0!==A?A:"QUEST":e.C&&(e.u.model=e.C),e.u.deviceModel=e.u.model,A=null!==(b=e.D)&&void 0!==b?b:function(e,t){if("STEAMDECK"===t)return"CONSOLE";switch(e){case"iOS":return"PHONE";case"iPadOS":return"TABLET";case"Xbox":return"CONSOLE";case"WebOS":case"Tizen":return"TV";case"visionOS":return"HMD";default:return"DESKTOP"}}(e.u.os,e.u.model),e.u.platformType=A,e.u.deviceType=A,e.u.totalTime=e.Gc-e.start,e.u.gpuDetail=e.gpuDetail}))}(e).then((()=>{e.$f=!0,t(e.u)}))}))}function W(e,t){if(!e.bg){for(const n of t)(t=n.voiceURI||"").startsWith("Chrome OS")?e.La=!0:t.startsWith("Google")?e.Ka=!0:t.includes("moz-tts")?(t.includes("android")&&(e.pf=!0,e.N=!0),e.Pa=!0):"English United States"==t&&(e.Ea=!0),t.includes("Microsoft")?(e.P=!0,t.includes("Online")?e.mf=!0:e.Pb=!0):t.includes("com.apple")?(e.G=!0,t.includes("Ellen")&&(e.df=!0)):"Zuzana"==t&&(e.G=!0);e.rf=e.G||e.P||e.Ka||e.La||e.Pa||e.Ea,e.bg=!0}}function q(e){const t=window;e.kb=t.matchMedia("(hover: hover)").matches,e.Ab=t.matchMedia("(hover: none)").matches,e.ib=t.matchMedia("(pointer: coarse)").matches,e.jb=t.matchMedia("(pointer: fine)").matches}function z(e){return new Promise((t=>{const n=n=>{e.ya&&(clearTimeout(e.ya),e.ya=0),n.Bd&&(e.Af=n.Bd,e.pg=n.md,e.og=n.Gd),t()};let i=!1,r=!1;const o=t=>{"string"==typeof t?$(e,"TV",t):"data"in t?J(e,"TV",t):Q(e,"TV",t),r=!0,s.Log.e("{3c72abb}","{f49e1b4}",t)};let a,c=0;try{self.SharedWorker&&(i=!0,a=_(fe,n,o),c=150)}catch(t){r=!0,s.Log.w("{3c72abb}","{2066dd6}",t),Y(e,"TV",t)}e.ya=window.setTimeout((()=>{a&&U("port"in a?a.port:a),r?s.Log.w("{3c72abb}","{cdb3848}"):i?(s.Log.w("{3c72abb}","{f01188c}"),X(e,"TV")):(s.Log.i("{3c72abb}","{db9e3f4}"),Z(e,"TV")),(new fe).lb().then((e=>{n(e)}))}),c)}))}function K(e,t,n){e.o?nl(e.o,"WorkerOverlongDelay",t,n.toString()):e.F.push({type:"WorkerOverlongDelay",name:t,data:n})}function $(e,t,n){e.o?nl(e.o,"WebWorkerProblem",t,n):e.F.push({type:"ErrorString",name:t,data:n})}function J(e,t,n){e.o?nl(e.o,"WorkerMessageProblem",JSON.stringify(n)):e.F.push({type:"MessageEvent",name:t,data:n})}function Q(e,t,n){e.o?nl(e.o,"WorkerProblem",t,`${n.message} in ${n.filename}@${n.lineno}:${n.colno}`,JSON.stringify(n.error)):e.F.push({type:"ErrorEvent",name:t,data:n})}function Y(e,t,n){var i;e.o?nl(e.o,"WorkerCreateFailure",t,null!==(i=null==n?void 0:n.stack)&&void 0!==i?i:"",JSON.stringify(n)):e.F.push({type:"WorkerCreateFailure",name:t,data:n})}function X(e,t){e.o?nl(e.o,"WorkerTimeout",t):e.F.push({type:"WorkerTimeout",name:t})}function Z(e,t){e.o?nl(e.o,"WorkerUnused",t):e.F.push({type:"WorkerUnused",name:t})}function ee(e,t){if(e==t)return!1;let n=/^(\d+)[.]?(.*)/;if(e=n.exec(e),t=n.exec(t),null==e){if(null==t)return!0}else if(null!=t&&e[1]==t[1]&&""==e[2])return!0;return!1}function te(e){e.h="Chrome",!e.m&&e.xe&&(e.m=e.me?e.te?e.oe?e.za?e.Pe?e.Ve?e.ae?e.se?e.ce?e.le?e.Ge?e.ze?"90+":"89":"88":"87":"86":"85":"84":"83":"81":"80":"79":"78":"77")}function ne(e){return e.ab?"SteamOS":"Linux"}function ie(e){e.h="Firefox",e.m=e.ve?e.za?e.de?e.dg?e.re?"88":"89+":"87":"86":"85":"84-"}function se(e){var t,n,i,s;e.s&&e.K?e.D="TV":e.s&&e.Ue||e.Ba?e.D="HMD":e.bb||e.$||!e.Af?(!e.kb||e.jb)&&(e.W?e.xf?e.Ab&&e.ib||(e.D="DESKTOP"):e.kb&&e.jb&&(e.D="DESKTOP"):e.Ab&&e.ib||(e.D="DESKTOP")):(e.D="TV",e.j=null!==(n=null!==(t=e.j)&&void 0!==t?t:e.pg)&&void 0!==n?n:"",e.deviceName=null!==(s=null!==(i=e.deviceName)&&void 0!==i?i:e.og)&&void 0!==s?s:"UNKNOWN",e.l=7),e.D||(e.D=600<=(screen.width<screen.height?screen.width:screen.height)?"TABLET":"PHONE")}function re(e){e.g="Windows",ce(e)||(e.h="Unknown",e.l=5,s.Log.d("{3c72abb}","{44ce1e0}"))}function oe(e){e.j="APPLE",e.s&&e.J?(e.g="macOS",ce(e)||(e.h="Unknown",e.l=5,s.Log.d("{3c72abb}","{b80b712}"))):e.ba?e.$?(e.g=e.Ob?"iPadOS":"visionOS",le(e)):(e.g="macOS",ce(e)||(e.h="Unknown",e.l=5,s.Log.d("{3c72abb}","{0f3296f}")),"Safari"==e.h&&(e.m=e.he?"18+":e.ke?"17.5+":e.Ce?"17.4":e.ne?"17.2+":e.Je?"17+":e.je?"16.5+":e.we?"16.4":"16.3-")):e.xa?(e.g="iOS",le(e)):e.cb?(e.g=e.Ob?"iPadOS":"visionOS",le(e)):(e.U=!0,e.l=5,e.$?(e.g="iOS",le(e),s.Log.d("{3c72abb}","{cf1c572}")):(e.g="macOS",e.h="Unknown",s.Log.d("{3c72abb}","{1eb1815}")))}function ae(e){e.g="Android",e.ra?ie(e):e.sa?(e.h="Samsung",e.j="SAMSUNG"):e.qa?e.h="Brave":e.ta?e.h="Yandex":e.$a?e.h="Opera":e.s?e.Ua?e.h="Edge":e.pa?e.h="Opera":e.Wa?e.h="Yandex":e.oa||e.Mc?(te(e),de(e)):e.S&&(e.h="Chromium",de(e)):e.T?e.Nb?e.Ba?e.h="Pico":te(e):e.h=e.$?"Edge":"Silk":(te(e),e.l=7),se(e)}function ce(e){var t;if(e.ra)ie(e);else if(e.Be)e.h="Opera";else if(e.qa)e.h="Brave";else if(e.ta)e.h="Yandex";else if(e.T)e.I?(e.g="Xbox",e.j="MICROSOFT",e.h="Edge",e.va?e.C="XBOXSERIES":e.I&&(e.C="XBOXONE")):e.s?e.V?(e.g="Xbox",e.j="MICROSOFT",e.h="Edge"):e.Ua?e.h="Edge":e.pa?e.h="Opera":e.Wa?e.h="Yandex":e.oa?te(e):e.S&&!e.Lc&&(e.h="Chromium"):e.Nb?e.s&&e.S?(e.h="Chromium",e.l=9):e.rf?e.h="Chromium":(e.h="Chromium",e.l=7):(e.h="Edge",e.g=null!==(t=e.g)&&void 0!==t?t:"Unknown",e.l=7);else if(e.Oe||e.Db)e.h="Safari";else{if(!e.Nc)return!1;e.I&&(e.g="Xbox",e.j="MICROSOFT"),e.h="Edge_Legacy"}return!0}function de(e){e.lf?(e.j="AMAZON",e.S&&(e.h="Silk")):e.Ye?e.j="SONY":e.cf?e.j="GOOGLE":e.sf?e.j="NVIDIA":e.nf?e.j="XIAOMI":e.wf&&(e.j="TVISION")}function le(e){e.osVersion=e.ee?e.za?e.fe?e.ie?e.be?"17.4+":"17+":e.Me?"16+":e.ue?e.df?"15.6+":"15.5+":e.ge?"15.4+":e.af?"15.2+":e.Ae?"15.1+":"15+":"14.5+":e.ye?"14.3+":"14+":e.qe?"13+":"12-";var t=e.osVersion;t=!e.pe&&!(t.startsWith("12")||t.startsWith("13")),e.Za?e.h="Firefox":e.Fe?e.h="Opera":e.qa?e.h="Brave":e.ta?e.h="Yandex":e.Ya?e.h="Edge":e.Xa?e.h="Chrome":e.Db&&!t?e.h="Safari":e.Ie?e.h="ReactNative":t?(e.h="Unknown",e.l=7,s.Log.d("{3c72abb}","{5a39f60}")):(e.h="Unknown",e.l=5,s.Log.d("{3c72abb}","{147d6b4}"))}function ue(e){var t,n=ge;null===(t=n.o)||void 0===t||nl(t,"TelemetryHandlerChanged"),n.o=e;for(const i of n.F)switch(e=i.name,t=i.data,i.type){case"ErrorEvent":Q(n,e,t);break;case"MessageEvent":J(n,e,t);break;case"WorkerUnused":Z(n,e);break;case"WorkerTimeout":X(n,e);break;case"WorkerCreateFailure":Y(n,e,t);break;case"ErrorString":$(n,e,t);break;case"WorkerOverlongDelay":K(n,e,t)}n.F=[]}class he{lb(){const e=(self.OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")).getContext("webgl"),t=e&&e.getExtension("WEBGL_debug_renderer_info");return t?{md:e&&e.getParameter(t.UNMASKED_VENDOR_WEBGL),Lf:e&&e.getParameter(t.UNMASKED_RENDERER_WEBGL),Bf:!0}:{md:"",Lf:"",Bf:!1}}}class pe{lb(){const e=navigator.userAgentData;return e?e.getHighEntropyValues("platform architecture uaFullVersion platformVersion model bitness".split(" ")).then((t=>(t||(t={}),t.brands||(t.brands=e.brands),t.mobile||(t.mobile=e.mobile),t))):Promise.resolve(void 0)}}class fe{lb(){let e={Bd:!1,Gd:"",md:""};if(navigator.userAgent){var t=navigator.userAgent.toUpperCase();const n="BRAVIA TIZEN PHILIPSTV GOOGLETV CRKEY CHROMECAST SHIELDTV".split(" "),i="SONY SAMSUNG PHILIPS GOOGLE GOOGLE GOOGLE NVIDIA".split(" ");if(RegExp("BRAVIA|SMARTTV|SMART-TV|PHILIPSTV|GOOGLETV|CRKEY|CHROMECAST|SHIELD Android TV","i").test(t)&&(e.Bd=!0,t=t.match(n.join("|"))))for(let s=0;s<n.length;s++)t[0]==n[s]&&(e.Gd=n[s],e.md=i[s],"CRKEY"==t[0]&&(e.Gd="CHROMECAST"))}return Promise.resolve(e)}}class ve{lb(){return{platform:navigator.platform}}}const ge=new class{constructor(){this.Gc=this.start=0,this.Pb=this.mf=this.G=this.P=this.Ea=this.pf=this.Pa=this.Ka=this.La=!1,this.df=!0,this.Cb=this.ag=this.Bb=this.bg=this.$f=this.tf=this.R=this.s=this.v=this.ma=this.Kc=this.jb=this.ib=this.Ab=this.kb=this.Ba=this.we=this.je=this.Je=this.ne=this.Ce=this.ke=this.he=this.Ob=this.ze=this.Ge=this.le=this.ce=this.se=this.ae=this.Ve=this.Pe=this.oe=this.te=this.me=this.xe=this.be=this.ie=this.Me=this.pe=this.Db=this.ve=this.za=this.de=this.dg=this.re=this.ye=this.ue=this.ge=this.af=this.Ae=this.qe=this.fe=this.ee=this.Nb=this.Af=this.Ue=this.K=this.xf=this.fa=this.W=this.Z=this.L=this.J=this.M=this.qf=this.wf=this.nf=this.sf=this.cf=this.Ye=this.lf=this.V=this.ab=this.va=this.I=this.$=this.bb=this.Lc=this.Mc=this.S=this.Wa=this.pa=this.Ua=this.oa=this.Zf=this.Yf=this.Mf=this.Df=this.wa=this.Ff=this.N=this.ga=this.aa=this.cb=this.da=this.xa=this.ba=this.Ie=this.sa=this.ta=this.qa=this.$a=this.Fe=this.Be=this.Fc=this.Za=this.ra=this.Xa=this.T=this.Oe=this.Ya=this.Nc=this.rf=!1,this.cg=this.Jc=this.ha=this.ya=this.na=this.ea=this.O=0,this.gpuDetail="",this.u={os:"Unknown",osRawVer:"0",osVer:"0",osVersion:"0",browser:"Unknown",browserVer:"0",browserFullVer:"0",browserBestVer:"0",forging:!0,spoofing:!0,confidence:0,totalTime:0,vendor:"",make:"",gpuDetail:""},this.F=[],this.Hc=/Chrome\/(([0-9]+)\.[0-9]+\.[0-9]+\.[0-9]+)/}};function me(){performance.mark("platformBegin");var e=ge;return e.Ic||(e.Ic=H(e)),e.Ic}var Ae=class extends x{constructor(e){super(e),this.W=[]}aa(e){e={logModule:"R",timeStamp:e.timestamp,logLevel:e.level,logtag:e.tag,logstr:e.message},this.hasListener("Log")?this.emit("Log",e):this.W.push(e)}addListener(e,t){if(super.addListener(e,t),"Log"==e&&0<this.W.length){for(const e of this.W)this.emit("Log",e);this.W=[]}}};function be(e){e.splice(0,e.length)}var Se=class extends Array{constructor(){super(),this.push=this.h}h(...e){return e=Array.prototype.push.apply(this,e),this.g&&this.g(),e}},ye=class{constructor(e){this.name="",this.gdprLevel="behavioral",this.priority=!1,this.parameters=e,this.ts=(new Date).toISOString()}},we=class extends ye{constructor(e){super(e),this.name="GS_DebugInfo",this.gdprLevel="technical"}},Ee=class extends ye{constructor(e){super(e),this.name="GS_ExceptionInfo",this.gdprLevel="technical"}},Ie=class extends ye{constructor(e){super(e),this.name="GS_ClientMetricEvent",this.gdprLevel="functional"}},Ce=class extends ye{constructor(e){super(e),this.name="GS_Sleep_Event",this.gdprLevel="technical"}},Te=class extends ye{constructor(e){super(e),this.name="GS_WsCallResult",this.gdprLevel="functional"}},Re=class extends ye{constructor(e){super(e),this.name="GS_HttpCallResult",this.gdprLevel="functional"}};function ke(e,t){s.Log.d("{0f7a7d0}","{1d02c0d}"),function(e){e.o&&(window.clearTimeout(e.o),e.o=0)}(e),t?e.o=window.setTimeout((()=>{e.g&&(window.clearInterval(e.g),e.g=0)}),e.v):e.g&&(window.clearInterval(e.g),e.g=0)}function Oe(e){ke(e,!1),e.C=(new Date).getTime(),e.m=0,e.h=0,e.l=0,e.v=2*e.j+500,e.Ja="",e.s=!1,s.Log.d("{0f7a7d0}","{456f7b1}"),e.g=window.setInterval((()=>{const t=(new Date).getTime();Pe(e,t),De(e,"p"),e.s||(e.s=Le(e)),e.C=t}),e.j)}function Pe(e,t){const n=Math.max(0,t-e.C-e.j);n>e.F&&(e.h=t,e.m=n,De(e,"s"),xe(e))}function De(e,t){e.Ja.endsWith(t)||(4<=e.Ja.length&&(e.Ja=e.Ja.substring(1)),e.Ja+=t)}function Le(e){let t=!1,n=!1,i=!1;for(let t=0;t<e.Ja.length;t++)"s"===e.Ja.charAt(t)?n=!0:"e"===e.Ja.charAt(t)&&(i=!0);return n&&i&&Math.min(Math.abs(e.l-e.h),Math.abs(e.l-e.h+e.m))<e.v&&(t=!0,e.D.Qf({Se:e.l,Rf:e.h,duration:e.m,Ja:e.Ja})),t}function xe(e){let t="n/a";e.h&&(t=new Date(e.h).toISOString()),s.Log.i("{0f7a7d0}","{e4526ad}",e.m,t)}function Me(e){if(e.g){var t=(new Date).getTime();e.l=t,Pe(e,t),De(e,"e"),e.s=Le(e),xe(e)}}function Ne(e,t){e.v=t??2*e.j+500}var _e=class{constructor(e,t,n){this.g=this.l=this.h=this.m=this.C=0,this.Ja="",this.o=0,this.s=!1,this.D=e,this.j=t??1e4,this.F=n??1e4,this.v=2*this.j+500}};function Fe(e,t,n){return{kc:"online"===e,description:n?`${e}(${n.name}: ${n.message})`:t?`${e}(${t})`:e}}async function Ue(e){if(e.g)return Fe("online");const t=performance.now();try{const n=new AbortController;window.setTimeout((()=>n.abort()),e.timeout);const i=await fetch(e.url,{method:"OPTIONS",signal:n.signal}),r=i.status,o=200<=i.status&&300>i.status||403==i.status?"online":"offline_wrong_status";return s.Log.i("{0ce6b17}","{b7012d7}",o,Math.round(performance.now()-t)),Fe(o,r)}catch(e){return Fe("AbortError"===e.name?"timeout":"offline",void 0,e)}}var je=class{constructor(e,t=1500,n=!1){this.timeout=t,this.g=n,this.url=("http:"===window.location.protocol?"http://":"https://")+e,s.Log.i("{0ce6b17}","{dda0527}",this.url,this.timeout)}};window.RtcUtils=window.RtcUtils||{};var Ge=s.CancellableWait,Be=s.DefaultHttpRequestOptions,Ve=s.Log,He=s.Logger,We=s.LogLevel,qe=s.performHttpRequest,ze=s.TelemetryModule,Ke=s.TracingManager,$e={Va:{},Xb:{type:"UNKNOWN",version:""},Fd:!0,Ke:!1,$d:!0,Zd:!1};function Je(e){var t,n,i,s;if(Ve.i("{11b33a0}","{e65e133}",JSON.stringify(e)),function(e){var t,n;if(e.overrideData){const i=new URLSearchParams(e.overrideData.toLowerCase());"lean"===i.get("mode")&&(P=!1),D=(P=null!==(t=(e=e=>L(e=i.get(e)))("log"))&&void 0!==t?t:P)&&(null!==(n=e("console"))&&void 0!==n?n:D)}}(e),e.gxtOverrideData){const t=JSON.parse(e.gxtOverrideData);if(t.params)for(const e of t.params)"pmCommunication"===e.name&&($e.Va.pmCommunication=e.value,$e.Xb={type:"GXT",version:e.version})}if(e.overrideData){const r=new URLSearchParams(e.overrideData.toLowerCase());e=e=>L(e=r.get(e)),$e.Fd=null!==(t=e("log"))&&void 0!==t?t:$e.Fd,$e.Ke=$e.Fd&&(null!==(n=e("console"))&&void 0!==n?n:$e.Ke),$e.$d=null!==(i=e("websocketsignaling"))&&void 0!==i?i:$e.$d,$e.Zd=null!==(s=e("webrtcstreamer"))&&void 0!==s?s:$e.Zd}}var Qe=class extends ye{constructor(e){super(e),this.name="GridServer_GameLaunch_Request",this.gdprLevel="functional"}};const Ye={fg:"GFN_GridServer",clientId:"93289439828086895",eventSchemaVer:"2.1"};function Xe(e,t,n,i){var s,r,o;const a=ze.getTelemetryEventIds();return{requestedZoneAddress:t,zoneName:"",networkSessionId:null!==(s=a.networkSessionId)&&void 0!==s?s:"",sessionId:i??"",subSessionId:"",resumeType:n?"MANUAL":"NONE",overrideConfigType:$e.Xb.type,overrideConfigVersion:$e.Xb.version,result:"",codec:"UNKNOWN",ipVersion:"UNKNOWN",launchDuration:0,networkType:e.networkType,streamingProfileGuid:null!==(r=a.streamingProfileGuid)&&void 0!==r?r:"",systemInfoGuid:null!==(o=a.systemInfoGuid)&&void 0!==o?o:"",cmsId:e.cmsId}}function Ze(e,t){t=new Re({callDuration:t.callDuration,verb:t.verb,sessionId:t.sessionId,subSessionId:t.subSessionId,serverId:t.serverId,url:t.url,overrideConfigType:$e.Xb.type,overrideConfigVersion:$e.Xb.version,requestStatusCode:t.requestStatusCode,requestId:t.requestId,networkType:e.networkType,statusCode:t.statusCode,cmsId:e.cmsId,moduleName:"GRID_SERVER",response:t.response}),e.processEvent(t)}function et(e,t){var n,i,s;t.launchDuration=Math.round(t.launchDuration),(t=new Qe(t)).parameters.sessionId||(t.parameters.sessionId=e.sessionId),t.parameters.subSessionId||(t.parameters.subSessionId=e.subSessionId);const r=ze.getTelemetryEventIds();t.parameters.networkSessionId=null!==(n=r.networkSessionId)&&void 0!==n?n:"",t.parameters.systemInfoGuid=null!==(i=r.systemInfoGuid)&&void 0!==i?i:"",t.parameters.streamingProfileGuid=null!==(s=r.streamingProfileGuid)&&void 0!==s?s:"",e.processEvent(t)}function tt(e,t,n,i){var s,r;if(50<=e.h)var o=!1;else{var a=null!==(o=e.g.get(n))&&void 0!==o?o:0;10<=a?o=!1:(e.h++,e.g.set(n,a+1),o=!0)}o&&(!s&&t&&(s=t.name+": "+t.message),t=new Ee({filename:i,lineno:0,stacktrace:null!==(r=null==t?void 0:t.stack)&&void 0!==r?r:"",colno:0,handled:"TRUE",category:s??"",message:n,moduleName:"GRID_SERVER",sessionId:e.sessionId,subSessionId:e.subSessionId}),e.processEvent(t))}function nt(e,t){e.subSessionId=t,e.g.clear(),e.h=0}function it(e){switch(e){case 15867905:case 15867906:case 15867907:return!0;default:return!1}}function st(e){switch(e){case"ready_for_connection":case"streaming":case"paused":return!0;default:return!1}}function rt(e){switch(e){case 1:return"initializing";case 2:return"ready_for_connection";case 3:return"streaming";case 4:case 5:return"paused";case 6:return"resuming";case 7:return"finished";default:return"unknown"}}function ot(e){switch(e){case 3237085186:return"invalid operation";case 15859712:return"success";case 3237093379:case 3237093381:return"Invalid server response";case 3237093384:return"Exception";case 15867907:case 15867905:case 15867906:return"cancelled";case 15868417:return"no network";case 3237089282:return"network error";default:return"server error"}}function at(e){const t=i.trace.getActiveSpan();if(t)for(const[n,i]of e.C)t.setAttribute(n,i)}function ct(e,t,n,i,s){e.O=!1,Oe(e.s);const r=y();return new Promise(((o,a)=>{const c=!!s;var d=()=>{var n;const i={code:3237085186,subSessionId:r};lt(i.code);const a=Xe(e.h,null!==(n=t.serverAddress)&&void 0!==n?n:"",c,s);a.result=l(i.code),a.subSessionId=r,et(e.h,a),o(i)};if(dt(e))if(e.J())Ve.e("{1daeef1}","{3753849}"),d();else{e.h.cmsId=t.appId,nt(e.h,r),d=mt(e,t,s);var u=new URL(d).hostname;u=Xe(e.h,u,c),e.g={resolve:o,reject:a,sessionId:s,subSessionId:r,Pf:i,Cd:Number.MAX_VALUE,Zc:!1,Qc:n,Dd:u,startTime:performance.now()},a=At(e,t,c,r),ht(e,c?1:0,d,a,n).then((t=>{!c&&15859712===t.result&&t.session&&Ve.i("{1daeef1}","{7c01bce}",t.session.sessionId),e.N(t)})).catch((t=>{e.M(t)}))}else Ve.e("{1daeef1}","{3781843}"),d()})).catch((t=>(e.m.clear(),be(e.j),e.g=void 0,pt(e,t,"startOrResumeSession"),lt(3237093384),{code:3237093384,subSessionId:r})))}function dt(e){return-1===e.F.type||!!e.F.token}function lt(e,t){const n=i.trace.getActiveSpan();n&&(it(e)?(n.setAttribute("error",!1),n.setAttribute("error.description",ot(e))):15859712==e?n.setAttribute("error",!1):(n.setAttribute("error",!0),n.setAttribute("error.description",t??ot(e))))}function ut(e,t){let n=e.protocol;return t&&e.D.has(t)?void 0!==(e=e.D.get(t))&&(n+=e.server,0!=e.port&&(n+=":"+e.port)):n+=e.serverAddress,n+"/v2/session/"+t}function ht(e,t,n,s,r,o){var a;const c=e=>!it(e)&&(15859712!==e||3!==t);let d={method:(()=>{switch(t){case 0:return"POST";case 2:return"DELETE";case 1:case 4:return"PUT";default:return"GET"}})(),headers:e.v.headers,body:s,retryCount:e.v.retryCount,timeout:e.v.timeout};(2===t||4===t)&&(d.keepalive=!0,e.u&&E(e.u)&&!I(e.u,81)&&(d.keepalive=!1));const u=performance.now();let h=function(e,t,n,i){return{url:t,verb:n,statusCode:"0",requestStatusCode:"",sessionId:i??"",subSessionId:e.subSessionId,requestId:"",serverId:"",callDuration:0,response:"None"}}(e.h,n,null!==(a=d.method)&&void 0!==a?a:"",o);h.statusCode="0";let p="";return qe(n,d,e.F,r).then((n=>{p=n.data;var s=performance.now();if(h.statusCode=n.status.toString(),h.callDuration=Math.round(s-u),!n.data)throw Ve.e("{1daeef1}","{ea40865}"),new SyntaxError("The response from server does not contain any data");try{var r=JSON.parse(n.data)}catch(e){throw h.response=n.data,e}if(!r.requestStatus)throw Ve.e("{1daeef1}","{862f264}",yt(n.data)),new SyntaxError("RequestStatus missing in response");n=r.requestStatus.serverId.toUpperCase(),h.requestId=r.requestStatus.requestId,h.serverId=n,h.requestStatusCode=r.requestStatus.statusDescription;var o,a,d,f=3237093632;if(void 0!==(s=r.requestStatus).statusCode){var v=s.statusCode;1==v?f=15859712:0<v&&255>v&&(f=3237093632+v),3237093636!=f&&3237093672!=f||!s.unifiedErrorCode||(f=s.unifiedErrorCode)}if(s.unifiedErrorCode&&Ve.i("{1daeef1}","{d2c9cc8}",l(s.unifiedErrorCode)),n={result:f,ed:r,serverId:n},s=r.requestStatus,f=i.trace.getActiveSpan()){v=new Map([["host.dc",null!==(o=s.serverId)&&void 0!==o?o:""],["request.id",null!==(a=s.requestId)&&void 0!==a?a:""],["request.status",null!==(d=s.statusDescription)&&void 0!==d?d:""]]);for(const[e,t]of v)f.setAttribute(e,t)}if(5===t)(r=r.sessions)&&(n.activeSessions=vt(e,r));else if(2!==t){var g;if(o=r.session)n.session=ft(e,o),null==(a=i.trace.getActiveSpan())||a.setAttribute("session.status",null!==(g=o.status)&&void 0!==g?g:""),h.sessionId=n.session.sessionId;(r=r.otherUserSessions)&&(n.activeSessions=vt(e,r),n.activeSessions.length&&Ve.d("{1daeef1}","{ba4be1c}",n.activeSessions.length))}return h&&c(n.result)&&(Ze(e.h,h),h=void 0),n})).catch((t=>{let i={result:3237089282};const s=performance.now();if(t.code){var r=3237093384;3237089281===(t=t.code)?r=15868417:3237089282===t?r=3237089282:3237093379===t?r=3237093379:3237089283===t?r=3237089283:15867905==t&&(r=15867907),i.result=r}else r=!1,(t instanceof SyntaxError||t instanceof TypeError&&t.message&&t.message.includes("Cannot read property"))&&(r=!0,Ve.e("{1daeef1}","{d8979bb}",t.name,t.message)),r?(i.result=3237093379,Ve.e("{1daeef1}","{04bcd6f}",yt(p))):(i.result=3237093384,Ve.e("{1daeef1}","{94d55bb}",t,t.stack),tt(e.h,t,"performSessionRequest","sessioncontrolimpl.ts"));return h&&c(i.result)&&(h.callDuration=Math.round(s-u),Ze(e.h,h)),Ve.e("{1daeef1}","{9c647aa}",d.method,n),Ve.e("{1daeef1}","{200d7ba}",i.result,ot(i.result)),i}))}function pt(e,t,n){Ve.e("{1daeef1}","{32f1296}",n,t.message),Ve.e("{1daeef1}","{94d55bb}",t,t.stack),tt(e.h,t,n,"sessioncontrolimpl.ts")}function ft(e,t){var n;let i={sessionId:t.sessionId,subSessionId:"",appId:0,appLaunchMode:0,state:rt(t.status),zoneAddress:"",zoneName:"",deviceId:"",gpuType:"",monitorSettings:[],connectionInfo:[],finalizedStreamingFeatures:t.finalizedStreamingFeatures};if(i.appId=t.sessionRequestData?t.sessionRequestData.appId:0,t.connectionInfo){var s=t.connectionInfo;if("browser"===e.clientPlatformName){let e=!1;for(var r of s)if(2===r.usage){e=!0,i.connectionInfo.push(r);const n={ip:"",port:49100,appLevelProtocol:5,protocol:1,usage:14};r=r.ip.split("."),n.ip=r[0]+"-"+r[1]+"-"+r[2]+"-"+r[3],n.ip+=t.sessionControlInfo.ip.substring(t.sessionControlInfo.ip.indexOf(".")),Ve.d("{1daeef1}","{cf7d7ea}",n.ip),i.connectionInfo.push(n);break}e||(i.connectionInfo=s)}else i.connectionInfo=s}switch(t.monitorSettings&&(i.monitorSettings=t.monitorSettings),t.gpuType&&(i.gpuType=t.gpuType),null===(n=t.sessionRequestData)||void 0===n?void 0:n.appLaunchMode){case 3:i.appLaunchMode=2;break;case 2:i.appLaunchMode=1}return t.sessionControlInfo&&(n=t.sessionControlInfo.ip,t=t.sessionControlInfo.port,n&&t&&(e.D.has(i.sessionId)&&((null==(s=e.D.get(i.sessionId))?void 0:s.server)===n&&(null==s?void 0:s.port)===t||Ve.i("{1daeef1}","{f09f5be}",i.sessionId,null==s?void 0:s.server,null==s?void 0:s.port,n,t)),e.D.set(i.sessionId,{server:n,port:t})),n&&(i.zoneAddress=n,i.zoneName=n.split(".")[0].toUpperCase())),i}function vt(e,t){return t.map((t=>ft(e,t)))}function gt(e,t,n,i,s,r,o){const a=()=>{at(e);let r=ut(e,t),o={action:6,adUpdates:Array.from(e.j)};Ve.d("{1daeef1}","{dbca4b1}",JSON.stringify(o)),be(e.j),ht(e,4,r,JSON.stringify(o),n,t).then((e=>{i(e)})).catch((e=>s(e)))};for(var c=e.j.length-1,d=0;1<=c;)3===e.j[c].adAction&&2===e.j[c-1].adAction?(e.j.splice(c-1,2),d++,c-=2):3===e.j[c-1].adAction?c--:c-=2;d&&Ve.d("{1daeef1}","{98a2816}",d),d=!1,c=1e3*e.o.adsWaitTimeoutS;const l=e.j.length;if(l&&(4===e.j[l-1].adAction&&1<e.m.size||2===e.j[l-1].adAction?c=e.o.adsThrottleIntervalMS:d=!0),d)Ke.getInstance().createSpan("AdUpdateRequest",a);else{d=new Promise((t=>{e.j.g=t}));const u=new Ge(c,n.signal);Promise.race([u.getPromise(),d]).then((()=>{e.j.g=void 0,u.cancel(),e.j.length?e.j.length==l?Ke.getInstance().createSpan("AdUpdateRequest",a):gt(e,t,n,i,s,r,o):(Ve.w("{1daeef1}","{5e1dfd0}"),o())})).catch((t=>{e.j.g=void 0,u.isAborted()?(Ve.i("{1daeef1}","{d7114d7}"),r()):s(t)}))}}function mt(e,t,n){var i,s,r;return n?e=ut(e,n):(n=null!==(i=t.serverAddress)&&void 0!==i?i:e.serverAddress,e=e.protocol+n+"/v2/session"),(e+="?keyboardLayout="+(null!==(s=t.keyboardLayout)&&void 0!==s?s:"en_US"))+"&languageCode="+(null!==(r=t.clientLocale)&&void 0!==r?r:"en_US")}function At(e,t,n,i){var s,r,o,a,c,d,l,u;let h;switch(t.appLaunchMode){case 2:Ve.d("{1daeef1}","{6d5cf87}"),h=3;break;case 1:h=2;break;default:h=1}const p=null!==(r=null===(s=t.monitorSettings[0])||void 0===s?void 0:s.sdrHdrMode)&&void 0!==r?r:0;s={audioMode:2,remoteControllersBitmap:null!==(o=t.remoteControllersBitmap)&&void 0!==o?o:0,sdrHdrMode:p,networkTestSessionId:null,availableSupportedControllers:[],clientVersion:"29.0",deviceHashId:e.deviceId,internalTitle:null,clientPlatformName:e.clientPlatformName,metaData:[{key:"SubSessionId",value:i},{key:"wssignaling",value:$e.$d?"1":"0"}],surroundAudioInfo:0,clientTimezoneOffset:null!==(a=t.clientTimeZoneOffset)&&void 0!==a?a:-6e4*(new Date).getTimezoneOffset(),clientIdentification:"GFN-PC",parentSessionId:null,appId:t.appId,streamerVersion:1,clientRequestMonitorSettings:t.monitorSettings,appLaunchMode:h,sdkVersion:"1.0",enhancedStreamMode:1,useOps:!0,clientDisplayHdrCapabilities:null,accountLinked:null!==(c=t.accountLinked)&&void 0!==c&&c,partnerCustomData:null!==(d=t.partnerCustomData)&&void 0!==d?d:"",enablePersistingInGameSettings:null!==(l=t.enablePersistingInGameSettings)&&void 0!==l&&l,secureRTSPSupported:!1,userAge:null!==(u=t.userAge)&&void 0!==u?u:0,requestedStreamingFeatures:t.streamingFeatures},$e.Zd||"browser"===e.clientPlatformName?s.metaData.push({key:"GSStreamerType",value:"WebRTC"}):s.secureRTSPSupported=!0;for(const e in t.metaData)s.metaData.push({key:e,value:t.metaData[e]});return e=JSON.stringify(n?{action:2,data:"RESUME",sessionRequestData:s,metaData:[]}:{sessionRequestData:s}),Ve.i("{1daeef1}","{c6c3ed4}",n?"PUT":"POST",O(e)),e}async function bt(e,t,n,i){var r,o,a;if(e.S=t,e.g)try{if(Me(e.s),e.O){var c=t;switch(t){case 3237093701:case 3237093654:c=15867909}c!==t&&s.Log.i("{fda9cda}","{49e2182}",l(t),l(c)),t=c,ke(e.s,!1)}else ke(e.s,!0);if(3237089282===t&&!(await Ue(new je(e.serverAddress))).kc){if(3237089282===(c=t,t))c=15868417;c!==t&&s.Log.i("{fda9cda}","{b84d4c8}",l(t),l(c)),t=c}const d={code:t,subSessionId:null!==(r=e.g.subSessionId)&&void 0!==r?r:"",session:e.g.lg,zoneName:n,activeSessions:i},u=e.g.Dd;u.result=l(t),u.zoneName=n??"",u.sessionId=null!==(o=e.g.sessionId)&&void 0!==o?o:"",u.launchDuration+=performance.now()-e.g.startTime,et(e.h,e.g.Dd),lt(t),Ve.d("{1daeef1}","{c4902fa}",l(t),null!==(a=e.g.sessionId)&&void 0!==a?a:""),e.g.resolve(d),e.g=void 0,e.m.clear(),be(e.j)}catch(t){e.g&&(e.g.reject(t),e.g=void 0)}}var St=class{constructor(){var e,t,n,i,s,r,o,a,c,d,u,h,p,f,v,g,m,A,b,S,y,w;let E;this.D=new Map,this.v={...Be},this.F={type:1},this.C=new Map,this.protocol="https://",this.j=new Se,this.m=new Map,this.serverAddress="",this.O=!1,this.clientPlatformName=this.deviceId="",E=0+(null!==(t=null===(e=$e.Va.pmCommunication)||void 0===e?void 0:e.httpConnectionTimeout)&&void 0!==t?t:0),E+=null!==(i=null===(n=$e.Va.pmCommunication)||void 0===n?void 0:n.httpDataReceiveTimeout)&&void 0!==i?i:0,this.v.timeout=E?1e3*E:13e3,this.v.retryCount=null!==(r=null===(s=$e.Va.pmCommunication)||void 0===s?void 0:s.httpRetryCount)&&void 0!==r?r:3,this.v.backOffDelay=null!==(a=null===(o=$e.Va.pmCommunication)||void 0===o?void 0:o.httpBackOffDelay)&&void 0!==a?a:500,this.o={ng:null!==(d=null===(c=$e.Va.pmCommunication)||void 0===c?void 0:c.pollingIntervalMin)&&void 0!==d?d:1e3,mg:null!==(h=null===(u=$e.Va.pmCommunication)||void 0===u?void 0:u.pollingIntervalMax)&&void 0!==h?h:1e4,step:null!==(f=null===(p=$e.Va.pmCommunication)||void 0===p?void 0:p.pollingIntervalStep)&&void 0!==f?f:1e3,Ef:null!==(g=null===(v=$e.Va.pmCommunication)||void 0===v?void 0:v.pollingQueueSizePerStep)&&void 0!==g?g:50,adsPollingIntervalMinMS:null!==(A=null===(m=$e.Va.pmCommunication)||void 0===m?void 0:m.adsPollingIntervalMinMS)&&void 0!==A?A:3e3,adsThrottleIntervalMS:null!==(S=null===(b=$e.Va.pmCommunication)||void 0===b?void 0:b.adsThrottleIntervalMS)&&void 0!==S?S:2e3,adsWaitTimeoutS:null!==(w=null===(y=$e.Va.pmCommunication)||void 0===y?void 0:y.adsWaitTimeoutS)&&void 0!==w?w:600},this.h=new class{constructor(){this.networkType="UNKNOWN",this.subSessionId=this.sessionId=this.cmsId="",this.g=new Map,this.h=0,this.j=ze.createTelemetryProvider(Ye)}setNetworkType(e){this.networkType=k(e)}processEvent(e){this.Ga?this.Ga({name:e.name,parameters:e.parameters,gdprLevel:e.gdprLevel,ts:e.ts,clientConfig:Ye}):this.j.processEvent(e)}},this.s=new _e({Qf:e=>{var t,n=this.h,i=l(null!==(t=this.S)&&void 0!==t?t:0);e=new Ce({eventSequence:e.Ja,sleepTime:Math.round(e.duration/1e3),error:i,timeToSleep:Math.round((e.Se-e.Rf)/1e3),moduleName:"GRID_SERVER",cmsId:n.cmsId,sessionId:n.sessionId,subSessionId:n.subSessionId}),n.processEvent(e),this.O=!0,ke(this.s,!1)}})}init(e){var t,n;return function(e,t){const n=(0,s.translatePlatformInfoForClientHeader)({os:t.deviceOs,osVersion:t.deviceOsVer,platformType:t.deviceType,model:t.deviceModel,make:t.deviceMake,browser:t.browserType});if(e["content-type"]="application/json",e["nv-client-type"]=t.clientType,e["x-device-id"]=t.deviceId,e["nv-browser-type"]=n.browser,e["nv-client-streamer"]=t.clientStreamer,"UNKNOWN"===n.os?t.deviceOs&&(e["nv-device-os"]=t.deviceOs):e["nv-device-os"]=n.os,void 0!==n.deviceType&&(e["nv-device-type"]=n.deviceType),void 0!==t.deviceMake&&(e["nv-device-make"]=t.deviceMake),void 0!==t.deviceModel&&(e["nv-device-model"]=t.deviceModel),void 0!==t.clientAppVersion&&(e["nv-client-version"]=t.clientAppVersion),void 0!==t.clientId&&(e["nv-client-id"]=t.clientId),t.clientHeaders)for(const[n,i]of t.clientHeaders)"x-nv-client-identity"!==(t=n).toLowerCase()&&(e[t.toLowerCase()]=i)}(this.v.headers,e),this.C.set("component","sessioncontrol"),this.C.set("component.version","2.0"),this.C.set("client.name","GFN-PC"),this.C.set("client.version","29.0"),this.C.set("client.os",null!==(t=e.deviceOs)&&void 0!==t?t:""),this.C.set("client.os.version",null!==(n=e.deviceOsVer)&&void 0!==n?n:""),this.setDefaultServerAddress(e.serverAddress),this.clientPlatformName=e.clientPlatformName,this.deviceId=e.deviceId,this.u||"browser"!==this.clientPlatformName||me().then((e=>{this.u=e})),!0}setAuthInfo(e){this.F=e}setNetworkType(e){this.h.setNetworkType(e)}setDefaultServerAddress(e){this.serverAddress!=e&&(this.serverAddress=e,this.serverAddress.startsWith("mockpm://")||"mockpm.com"===this.serverAddress.toLocaleLowerCase())&&(this.serverAddress=this.serverAddress.replace("mockpm://",""),this.protocol="http://")}async startSession(e,t,n){return await Ke.getInstance().createSpan("StartSession",(()=>(at(this),ct(this,e,t,n))))}async resumeSession(e,t,n,i){return await Ke.getInstance().createSpan("ResumeSession",(()=>(at(this),ct(this,t,n,i,e))))}async deleteSession(e,t){return await Ke.getInstance().createSpan("DeleteSession",(()=>{if(at(this),!dt(this))return Ve.e("{1daeef1}","{4fed44a}"),lt(3237085186),Promise.resolve(3237085186);return ht(this,2,ut(this,e),"",t,e).then((t=>(15859712==t.result?(this.D.delete(e),Ve.d("{1daeef1}","{6206c13}",e)):Ve.e("{1daeef1}","{4de47e3}",e,l(t.result)),lt(t.result),t.result))).catch((e=>(pt(this,e,"deleteSession"),lt(3237093384),3237093384)))}))}async getActiveSessions(e){return await Ke.getInstance().createSpan("GetSessionList",(()=>(at(this),dt(this)?ht(this,5,this.protocol+this.serverAddress+"/v2/session","",e).then((e=>(lt((e={code:e.result,activeSessions:e.activeSessions,zoneName:e.serverId}).code),15859712!==e.code?Ve.e("{1daeef1}","{9d2bb75}",l(e.code)):Ve.d("{1daeef1}","{081857f}"),e))).catch((e=>(pt(this,e,"getActiveSessions"),lt((e={code:3237093384}).code),e))):(Ve.e("{1daeef1}","{dc27839}"),lt(3237085186),Promise.resolve({code:3237085186})))))}async getSessionInfo(e,t){return await Ke.getInstance().createSpan("GetSession",(()=>{if(!dt(this))return Ve.e("{1daeef1}","{603fbab}"),lt(3237085186),Promise.resolve({code:3237085186});return ht(this,3,ut(this,e),"",t,e).then((e=>(15859712!==(e={code:e.result,session:e.session,zoneName:e.serverId}).code?Ve.e("{1daeef1}","{021d0f4}",l(e.code)):Ve.d("{1daeef1}","{fa53c7c}"),e))).catch((e=>(pt(this,e,"getSessionInfo"),lt((e={code:3237093384}).code),e)))}))}J(){return!!this.g}updateAdState(e){if(!this.J())return Ve.e("{1daeef1}","{20d9281}"),3237085186;const t=this.m.get(e.adId);if(!t)return Ve.e("{1daeef1}","{74daa9c}",e.adId),3237093386;const n=function(e){switch(e){case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5;case 5:return 6;default:return 0}}(e.adAction);if(!function(e,t){switch(t){case 2:return 1==e||0==e;case 3:case 5:return 2==e||4==e;case 4:return 3==e;case 6:return 5!=e;default:return!1}}(t.$c,n))return Ve.e("{1daeef1}","{09d8184}",e.adAction,e.adId,t.$c),3237093386;if(this.j.length){const t=this.j[this.j.length-1].adId;if(t!==e.adId){const e=this.j[this.j.length-1].adAction;if(4!=e&&5!=e)return Ve.e("{1daeef1}","{c161587}",t),3237093386}}return e.clientTimestamp||(e.clientTimestamp=Math.round(Date.now()/1e3)),this.j.push(e),t.$c=n,this.m.set(e.adId,t),15859712}L(){var e,t;this.g&&ht(this,3,ut(this,null!==(e=this.g.sessionId)&&void 0!==e?e:""),"",this.g.Qc,null!==(t=this.g.sessionId)&&void 0!==t?t:"").then((e=>{this.N(e)})).catch((e=>{this.M(e)}))}M(e){Ve.e("{1daeef1}","{e3be7ea}",e.message),tt(this.h,e,"processSessionSetupException","sessioncontrolimpl.ts"),bt(this,3237093384)}N(e){var t,n,i;if(this.g){var s=()=>{bt(this,r.Zc?15867906:15867905)},r=this.g;if(e.session&&(e.session.subSessionId=this.g.subSessionId,this.g.lg=e.session,this.g.sessionId=e.session.sessionId,r.Zc=1==e.ed.session.seatSetupInfo.seatSetupStep),15859712===e.result&&e.session){const o=e.session;"ready_for_connection"===o.state||"streaming"===o.state?("streaming"==o.state&&function(e){const t=new we({key1:"InvalidSessionStateTransition",key2:"Streaming",key3:"",key4:"",key5:"",moduleName:"GRID_SERVER",networkType:e.networkType,overrideConfigType:$e.Xb.type,overrideConfigVersion:$e.Xb.version,cmsId:e.cmsId,sessionId:e.sessionId,subSessionId:e.subSessionId});e.processEvent(t)}(this.h),Ve.i("{1daeef1}","{30d6f44}",null!==(t=this.g.sessionId)&&void 0!==t?t:""),bt(this,15859712,e.serverId)):"initializing"==o.state||"resuming"==o.state?(t=function(e,t,n,i){var s,r,o,a,c,d,l="Configuring",u=0;if(t.seatSetupInfo)switch(t.seatSetupInfo.seatSetupStep){case 0:l="Connecting";break;case 1:l="InQueue",u=t.seatSetupInfo.queuePosition<n?t.seatSetupInfo.queuePosition:n;break;case 5:l="PreviousSessionCleanup";break;default:u=0}if(n={sessionId:t.sessionId,subSessionId:i,queuePosition:u,eta:null!==(r=null===(s=t.seatSetupInfo)||void 0===s?void 0:s.seatSetupEta)&&void 0!==r?r:0,progressState:l,isAdsRequired:t.sessionAdsRequired,ads:[]},s=new Map(e.m),e.m.clear(),t.sessionAds)for(r=t.sessionAds.length,l=0;l<r;l++){if(5==(i=t.sessionAds[l]).adState||6==i.adState)continue;u=i.adId,e.m.set(u,{Mg:i.adState,$c:null!==(a=null===(o=s.get(u))||void 0===o?void 0:o.$c)&&void 0!==a?a:0}),u={adId:u,adState:i.adState,adUrl:i.adUrl,adLengthInSeconds:i.adLengthInSeconds,adMediaFiles:[]};const r=null!==(d=null===(c=i.adMediaFiles)||void 0===c?void 0:c.length)&&void 0!==d?d:0;for(let e=0;e<r;e++){const t=i.adMediaFiles[e];u.adMediaFiles.push({mediaFileUrl:t.mediaFileUrl,encodingProfile:t.encodingProfile})}n.ads.push(u)}return n}(this,e.ed.session,this.g.Cd,this.g.subSessionId),this.g.Pf(t),r.Zc&&(this.g.Cd=t.queuePosition),t.ads.length?(Ne(this.s,1e3*t.ads[0].adLengthInSeconds),gt(this,null!==(n=r.sessionId)&&void 0!==n?n:"",r.Qc,this.N.bind(this),this.M.bind(this),s,this.L.bind(this))):(Ne(this.s),new Ge(function(e,t){let n=e.o.ng;return 1===t.seatSetupInfo.seatSetupStep&&0!=e.o.Ef&&(n+=Math.floor(t.seatSetupInfo.queuePosition/e.o.Ef)*e.o.step),t.sessionAdsRequired&&(n=Math.max(n,e.o.adsPollingIntervalMinMS)),Math.min(n,e.o.mg)}(this,e.ed.session),null===(i=this.g.Qc)||void 0===i?void 0:i.signal).getPromise().then(this.L.bind(this)).catch(s))):(Ve.e("{1daeef1}","{ce47cd1}",yt(JSON.stringify(e.ed))),bt(this,3237093378,e.serverId))}else 15867907===e.result?s():bt(this,e.result,e.serverId,e.activeSessions)}}};function yt(e){return O(e).replace(/("clientIp" *: *")(\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b)(?=")/g,"$1***")}var wt={Success:15859712,InvalidOperation:3237085186,NetworkError:3237089282,GetActiveSessionServerError:3237089283,AuthTokenNotUpdated:3237093377,SessionFinishedState:3237093378,ResponseParseFailure:3237093379,InvalidServerResponse:3237093381,PutOrPostInProgress:3237093382,GridServerNotInitialized:3237093383,DOMExceptionInSessionControl:3237093384,InvalidAdStateTransition:3237093386,SessionServerErrorBegin:3237093632,RequestForbidden:3237093634,ServerInternalTimeout:3237093635,ServerInternalError:3237093636,ServerInvalidRequest:3237093637,ServerInvalidRequestVersion:3237093638,SessionListLimitExceeded:3237093639,InvalidRequestDataMalformed:3237093640,InvalidRequestDataMissing:3237093641,RequestLimitExceeded:3237093642,SessionLimitExceeded:3237093643,InvalidRequestVersionOutOfDate:3237093644,SessionEntitledTimeExceeded:3237093645,AuthFailure:3237093646,InvalidAuthenticationMalformed:3237093647,InvalidAuthenticationExpired:3237093648,InvalidAuthenticationNotFound:3237093649,EntitlementFailure:3237093650,InvalidAppIdNotAvailable:3237093651,InvalidAppIdNotFound:3237093652,InvalidSessionIdMalformed:3237093653,InvalidSessionIdNotFound:3237093654,EulaUnAccepted:3237093655,MaintenanceStatus:3237093656,ServiceUnAvailable:3237093657,SteamGuardRequired:3237093658,SteamLoginRequired:3237093659,SteamGuardInvalid:3237093660,SteamProfilePrivate:3237093661,InvalidCountryCode:3237093662,InvalidLanguageCode:3237093663,MissingCountryCode:3237093664,MissingLanguageCode:3237093665,SessionNotPaused:3237093666,EmailNotVerified:3237093667,InvalidAuthenticationUnsupportedProtocol:3237093668,InvalidAuthenticationUnknownToken:3237093669,InvalidAuthenticationCredentials:3237093670,SessionNotPlaying:3237093671,InvalidServiceResponse:3237093672,AppPatching:3237093673,GameNotFound:3237093674,NotEnoughCredits:3237093675,InvitationOnlyRegistration:3237093676,RegionNotSupportedForRegistration:3237093677,SessionTerminatedByAnotherClient:3237093678,DeviceIdAlreadyUsed:3237093679,ServiceNotExist:3237093680,SessionExpired:3237093681,SessionLimitPerDeviceReached:3237093682,ForwardingZoneOutOfCapacity:3237093683,RegionNotSupportedIndefinitely:3237093684,RegionBanned:3237093685,RegionOnHoldForFree:3237093686,RegionOnHoldForPaid:3237093687,AppMaintenanceStatus:3237093688,ResourcePoolNotConfigured:3237093689,InsufficientVmCapacity:3237093690,InsufficientRouteCapacity:3237093691,InsufficientScratchSpaceCapacity:3237093692,RequiredSeatInstanceTypeNotSupported:3237093693,ServerSessionQueueLengthExceeded:3237093694,RegionNotSupportedForStreaming:3237093695,SessionForwardRequestAllocationTimeExpired:3237093696,SessionForwardGameBinariesNotAvailable:3237093697,GameBinariesNotAvailableInRegion:3237093698,UekRetrievalFailed:3237093699,EntitlementFailureForResource:3237093700,SessionInQueueAbandoned:3237093701,MemberTerminated:3237093702,SessionRemovedFromQueueMaintenance:3237093703,ZoneMaintenanceStatus:3237093704,GuestModeCampaignDisabled:3237093705,RegionNotSupportedAnonymousAccess:3237093706,InstanceTypeNotSupportedInSingleRegion:3237093707,InvalidZoneForQueuedSession:3237093710,SessionWaitingAdsTimeExpired:3237093711,UserCancelledWatchingAds:3237093712,StreamingNotAllowedInLimitedMode:3237093713,ForwardRequestJPMFailed:3237093714,MaxSessionNumberLimitExceeded:3237093715,GuestModePartnerCapacityDisabled:3237093716,SessionRejectedNoCapacity:3237093717,SessionInsufficientPlayabilityLevel:3237093718,SessionServerErrorEnd:3237093887,SessionSetupCancelled:15867905,SessionSetupCancelledDuringQueuing:15867906,RequestCancelled:15867907,SystemSleepDuringSessionSetup:15867909,NoInternetDuringSessionSetup:15868417};function Et(e){var t={ip:"",port:0,protocol:""};for(const n of e.connectionInfo)if(14===n.usage){t.ip=n.ip,t.port=n.port,t.protocol=5===n.appLevelProtocol?"https":"http",t.resourcePath=n.resourcePath;break}t={signalConnectionInfo:t,mediaConnectionInfo:e.connectionInfo,streamInfo:[],clientLocale:"",...e};for(const n of e.monitorSettings)t.streamInfo.push({width:n.widthInPixels,height:n.heightInPixels,fps:n.framesPerSecond,sdrHdrMode:n.sdrHdrMode});return t}function It(e){let t=[];if(e)for(const n of e)t.push({sessionId:n.sessionId,appId:n.appId,state:n.state,appLaunchMode:n.appLaunchMode});return t}function Ct(e,t,n=""){Ve.d("{6bae601}","{1e04fe6}",n,t),e.subSessionId=t,e.h.sessionId=n,nt(e.h,t);const i=e.P.get(t);void 0===i||""===i?e.P.set(t,n):Ve.w("{6bae601}","{7dd264b}",n)}function Tt(e){return lt(e.code,e.description),Promise.reject(e)}function Rt(e,t){e.zoneAddress=t.zoneAddress||e.zoneAddress,e.zoneName=t.zoneName||e.zoneName,e.gpuType=t.gpuType||e.gpuType}var kt=class extends St{constructor(e,t){super(),this.subSessionId="",this.P=new Map,this.R=!1,this.K=new Map,this.U=e=>{this.l.emit("TelemetryEvent",e)},this.T=e=>{this.l.emit("SessionUpdate",e),this.l.emit("ProgressUpdate",{sessionId:e.sessionId,subSessionId:e.subSessionId,queuePosition:e.queuePosition,eta:e.eta,state:e.progressState})},this.u=e,this.l=new Ae(t),He.isCallbackRegistered()||(this.R=!0,He.register(this.l.aa.bind(this.l))),this.h.Ga=this.U}initialize(e){var t;Ve.i("{6bae601}","{6802390}","Local");const n={deviceId:null!==(t=e.deviceHashId)&&void 0!==t?t:"",...e,clientStreamer:e.clientStreamer.toString()};super.init(n),(e=this.h).sessionId="",e.subSessionId="",e.cmsId="",Ve.d("{6bae601}","{5af3344}")}uninitialize(){this.cancelSessionSetup(),this.R&&He.unregister(),this.l.removeAllListeners()}addListener(e,t){this.l.addListener(e,t)}removeListener(e,t){this.l.removeListener(e,t)}updateTelemetryEventIds(e){ze.setTelemetryEventIds(e)}getAllActiveSessions(){Ke.getInstance().createSpan("GetSessionList",(()=>(at(this),async function(e){Ve.d("{6bae601}","{1aef200}"),e.serverAddress?(await ht(e,5,e.protocol+e.serverAddress+"/v2/session","").then((t=>{let n={sessionList:It(t.activeSessions)};if(15859712!=t.result){let e={code:t.result,description:ot(t.result)};n.error=e,Ve.e("{6bae601}","{9d2bb75}",l(e.code))}else Ve.d("{6bae601}","{081857f}");lt(t.result),e.l.emit("ActiveSessionsResult",n)})).catch((t=>{Ve.e("{6bae601}","{63f9b57}",t.message),Ve.e("{6bae601}","{94d55bb}",t,t.stack),tt(e.h,t,"getAllActiveSessions","gridserver.ts"),t={sessionList:[],error:{code:3237093384,description:ot(3237093384)}},lt(3237093384),e.l.emit("ActiveSessionsResult",t)})),Ve.d("{6bae601}","{a9e5439}")):(e.l.emit("ActiveSessionsResult",{sessionList:[],error:{code:3237093383,description:"GridServer not initialized"}}),lt(3237093383))}(this))))}getSessionId(){var e;return null!==(e=this.P.get(this.subSessionId))&&void 0!==e?e:""}getSubSessionId(){return this.subSessionId}putOrPostSession(e,t,n){return Ke.getInstance().createSpan(n?"PutSession":"PostSession",(()=>(at(this),function(e,t,n){var i;const s=!!n;if(Ct(e,y(),n),!e.serverAddress)return Tt({code:3237093383,description:"GridServer not initialized"});if(e.G)return Tt({code:3237093382,description:"Previous PutOrPost call is still in progress"});e.h.cmsId=t.appId,e.zoneName=void 0,e.zoneAddress=void 0,e.gpuType=void 0;const r=Xe(e.h,e.serverAddress,s,n);r.networkSessionId=null!==(i=t.networkSessionId)&&void 0!==i?i:"",t=function(e){var t;const n={monitorSettings:[],...e};if(0===n.monitorSettings.length)for(const i of null!==(t=e.streamParams)&&void 0!==t?t:[])n.monitorSettings.push({heightInPixels:i.height,framesPerSecond:i.fps,widthInPixels:i.width});return n}(t);let o=mt(e,t,n),a=At(e,t,s,e.subSessionId),c=performance.now();return new Promise(((t,i)=>{const d=new AbortController;e.G=d,ht(e,s?1:0,o,a,d,n).then((s=>{var o,a,u,h,p;let f;r.launchDuration=Math.round(performance.now()-c),!(null===(o=s.session)||void 0===o)&&o.sessionId&&(r.sessionId=null===(a=s.session)||void 0===a?void 0:a.sessionId,n=null===(u=s.session)||void 0===u?void 0:u.sessionId),e.zoneName=s.serverId||e.zoneName,s.session&&(f=Et(s.session),f.subSessionId=e.subSessionId,Rt(e,f)),r.zoneName=null!==(h=e.zoneName)&&void 0!==h?h:"",d.signal.aborted&&!it(s.result)&&(s.result=15867905,Ve.d("{6bae601}","{3ec0e11}")),15859712==s.result?(Ve.d("{6bae601}","{30536f4}",n),Ct(e,e.getSubSessionId(),n),"ready_for_connection"==(null===(p=s.session)||void 0===p?void 0:p.state)?(r.result=l(15859712),et(e.h,r)):e.K.set(r.sessionId,r),lt(s.result),t(f)):(15867907===s.result&&(s.result=15867905),s={code:s.result,sessionId:n,description:ot(s.result),sessionList:It(s.activeSessions)},Ve.e("{6bae601}","{17f93f3}",l(s.code)),r.result=l(s.code),et(e.h,r),lt(s.code),i(s))})).catch((t=>{let s={code:3237093384,sessionId:n,description:ot(3237093384)};Ve.e("{6bae601}","{4318505}",t.message),Ve.e("{6bae601}","{94d55bb}",t,t.stack),tt(e.h,t,"putOrPostSession","gridserver.ts"),r.result=l(s.code),et(e.h,r),lt(s.code),i(s)}))})).finally((()=>{e.G=void 0}))}(this,e,n))))}getSession(e,t){return Ke.getInstance().createSpan("GetSession",(()=>(at(this),function(e,t,n){return e.serverAddress?n?new Promise(((n,i)=>{var s=ut(e,t),r=new URL(s).hostname;(s=e.K.get(t))?e.K.delete(t):(Ve.e("{6bae601}","{bb9b2e3}",t),s=Xe(e.h,r,!1,t)),r=new AbortController,e.I=r,e.g={resolve:n,reject:i,sessionId:t,subSessionId:e.subSessionId,Pf:e.T,Cd:Number.MAX_VALUE,Zc:!1,Qc:r,startTime:performance.now(),Dd:s},e.L()})).then((t=>{let n;if(t.session&&(n=Et(t.session),Rt(e,n)),15859712===t.code&&n)return n;throw{code:t.code,description:ot(t.code)}})).finally((()=>{e.m.clear(),be(e.j),e.g=void 0})):(n=ut(e,t),ht(e,3,n,"",void 0,t).then((e=>{if(lt(e.result),15859712===e.result&&e.session)return Et(e.session);throw{code:e.result,description:ot(e.result)}}))):Tt({code:3237093383,description:"GridServer not initialized"})}(this,e,t))))}sendDeleteRequest(e){return Ke.getInstance().createSpan("DeleteSession",(()=>(at(this),function(e,t){if(!e.serverAddress)return Tt({code:3237093383,description:"Gridserver not initialized"});let n=ut(e,t);return new Promise(((i,s)=>{Ve.d("{6bae601}","{bbad3ce}",t),ht(e,2,n,"",void 0,t).then((e=>{if(15859712==e.result)Ve.d("{6bae601}","{6206c13}",t),i();else{let n={code:e.result,description:ot(e.result),sessionId:t};Ve.e("{6bae601}","{4de47e3}",t,l(e.result)),s(n)}lt(e.result)})).catch((t=>{const n={code:3237093384,description:ot(3237093384)};Ve.e("{6bae601}","{c4f620c}",t.message),Ve.e("{6bae601}","{94d55bb}",t,t.stack),tt(e.h,t,"sendDeleteRequestImpl","gridserver.ts"),s(n)}))}))}(this,e))))}cancelSessionSetup(){var e,t;Ve.i("{6bae601}","{c73e640}"),null===(e=this.G)||void 0===e||e.abort(),null===(t=this.I)||void 0===t||t.abort(),this.I=this.G=void 0}getZoneName(){var e;return null!==(e=this.zoneName)&&void 0!==e?e:""}getZoneAddress(){var e;return null!==(e=this.zoneAddress)&&void 0!==e?e:""}getGpuType(){var e;return null!==(e=this.gpuType)&&void 0!==e?e:""}J(){return!!this.I}},Ot=class extends kt{constructor(){super()}getAllActiveSessions(){window.setTimeout((()=>{Ve.d("{6bae601}","{b575263}"),this.l.emit("ActiveSessionsResult",{sessionList:[]})}),1)}putOrPostSession(e){var t;return Ve.d("{6bae601}","{71c010f}"),Ct(this,y(),null!==(t=e.sessionId)&&void 0!==t?t:"PassThruSessionId"),new Promise((t=>{window.setTimeout((()=>{var n;let i={sessionId:this.getSessionId(),subSessionId:this.getSubSessionId(),appId:parseInt(e.appId),state:"ready_for_connection",signalConnectionInfo:{ip:"",port:49100,protocol:"http"},mediaConnectionInfo:[],streamInfo:[],appLaunchMode:e.appLaunchMode?e.appLaunchMode:0,zoneName:this.getZoneName(),zoneAddress:this.getZoneAddress(),gpuType:this.getGpuType(),clientLocale:"",finalizedStreamingFeatures:null!==(n=e.streamingFeatures)&&void 0!==n?n:{}};if(this.serverAddress&&(i.signalConnectionInfo.ip=this.serverAddress),e.connectionInfo){i.mediaConnectionInfo=e.connectionInfo;for(const e of i.mediaConnectionInfo)14===e.usage&&(i.signalConnectionInfo.ip=e.ip,i.signalConnectionInfo.port=e.port,i.signalConnectionInfo.protocol=5===e.appLevelProtocol?"https":"http",i.signalConnectionInfo.resourcePath=e.resourcePath,Ve.d("{6bae601}","{c6b8e0f}",e.ip,e.port))}if(i.signalConnectionInfo.ip||Ve.e("{6bae601}","{a43f57e}"),e.monitorSettings)for(const t of e.monitorSettings)i.streamInfo.push({width:t.widthInPixels,height:t.heightInPixels,fps:t.framesPerSecond,sdrHdrMode:t.sdrHdrMode});else for(const t of e.streamParams)i.streamInfo.push({width:t.width,height:t.height,fps:t.fps});Ve.d("{6bae601}","{07dc276}",i.sessionId),t(i)}),1)}))}getSession(){return new Promise(((e,t)=>{t({code:-1,description:"PassthruPollingNotSupported"})}))}sendDeleteRequest(){return new Promise((e=>{e()}))}updateAdState(){return-1}},Pt=s.Log,Dt=s.Logger,Lt=s.performHttpRequest,xt=s.TelemetryModule,Mt={fg:"Ragnarok",clientId:"62677554106929725",eventSchemaVer:"3.2"},Nt=class extends ye{constructor(e){super(e),this.name="Streamer_Start",this.gdprLevel="functional"}},_t=class extends ye{constructor(e){super(e),this.name="Streamer_Exit",this.gdprLevel="functional",this.priority=!0}},Ft=class extends ye{constructor(e){super(e),this.name="Streamer_InputDevice",this.gdprLevel="functional"}},Ut={VIDEO:"video",AUDIO:"audio"},jt={Unknown:0,ApproachingEntitlementTimeout:1,ApproachingIdleTimeout:2,ApproachingSessionMaxTimeLimit:3,ClearUserIdleTimeOut:4},Gt={allowUnconfined:!1,preventNavigation:!1};function Bt(e){if(!((15868672^e)>>8))return 256;let t=32769;switch(e){case 15859712:case 15867908:case 15868418:t=0;break;case 3237093894:case 3237093899:t=32776;break;case 3237093898:t=32772;break;case 3237093900:t=32773;break;case 3237093901:t=32770;break;case 15867910:t=1;break;default:Pt.d("{c00be32}","{233ad08}",l(e))}return t}function Vt(e){if(e.stopData){var t=function(e){if(2>e.length)return null;const t=atob(e);let n=0;const i=()=>{const e=256*t.charCodeAt(n)+t.charCodeAt(n+1);return n+=2,e};return 0==i()?e.length<n+2?null:i():null}(e.stopData);if(t||0===t)return Pt.d("{c00be32}","{921626d}",t),Ht(t)}if(e.nvstResult){switch(Pt.d("{c00be32}","{f30bc33}",e.nvstResult),t=15868672,e=e.nvstResult){case 2147680256:case 2147680291:t=15868704;break;case 2147680257:t=15868705;break;case 2147680258:t=3237093635;break;case 2147680259:t=3237094152;break;case 2147680260:t=15868706;break;case 2147680262:t=15868707;break;case 2147680263:t=15868708;break;case 2147680264:t=15868736;break;case 2147680265:t=15868737;break;case 2147680266:t=15868738;break;case 2147680267:t=15868739;break;case 2147680268:t=15868741;break;case 2147680269:t=15868740;break;case 2147680270:t=15868742;break;case 2147680271:t=3237094147;break;case 2147680275:t=15868743;break;case 2147680277:t=15868709;break;case 2147680278:t=15868744;break;case 2147680279:t=15868710;break;case 2147680280:t=15868711;break;case 2147680281:t=15868712;break;case 2147680283:t=3237094155;break;case 2147680284:t=3237094156;break;case 2147680285:t=3237094157;break;case 2147680286:t=3237093678;break;case 2147680287:t=15868715;break;case 2147680288:t=15868716;break;case 2147680289:t=15868719;break;case 2147680300:t=15868688;break;case 2147745794:case 2147745797:case 2147745803:t=3237093892;break;case 2147745796:t=3237094158;break;case 2147745804:t=3237094146;break;case 2147745805:t=3237094148;break;case 2147745806:t=3237094149;break;case 2147745807:t=3237094150;break;case 2148438786:t=15868718;break;default:Pt.d("{c00be32}","{094c45e}",l(e))}return t}return e.code?(Pt.d("{c00be32}","{6210ab0}",e.code),Ht(e.code)):15868672}function Ht(e){let t=15868672;switch(e){case 256:t=15868704;break;case 257:t=15868705;break;case 258:t=15868706;break;case 259:t=15868707;break;case 260:t=15868708;break;case 261:t=15868709;break;case 262:t=15868710;break;case 263:t=15868711;break;case 264:t=15868712;break;case 265:t=15868713;break;case 266:t=15868714;break;case 267:t=15868715;break;case 268:t=15868716;break;case 269:t=15868719;break;case 270:t=15868688;break;case 512:t=15868736;break;case 513:t=15868737;break;case 514:t=15868738;break;case 515:t=15868739;break;case 516:t=15868740;break;case 517:t=15868741;break;case 518:t=15868742;break;case 519:t=15868743;break;case 520:t=15868744;break;case 521:t=15868745;break;case 33025:t=3237094145;break;case 33026:t=3237094146;break;case 33027:t=3237094147;break;case 33028:t=3237094148;break;case 33029:t=3237094149;break;case 33030:t=3237094150;break;case 33031:t=3237094151;break;case 33032:t=3237094152;break;case 33034:t=3237094153;break;case 33035:t=3237094154;break;case 33040:t=3237094155;break;case 33041:t=3237094156;break;case 33042:t=3237094157;break;case 37634:t=15868718;break;case 32768:t=3237094158;break;case 768:t=15868717;break;case 0:t=15868752;break;default:Pt.d("{c00be32}","{1be40ed}",l(e))}return t}function Wt(){return zt||(zt=new xn),zt}function qt(e){"white"===e.h?e.g&&(e.g.clearColor(1,0,0,1),e.g.clear(e.g.COLOR_BUFFER_BIT),e.h="red"):e.g&&(e.g.clearColor(1,1,1,1),e.g.clear(e.g.COLOR_BUFFER_BIT),e.h="white")}var zt,Kt,$t,Jt,Qt,Yt,Xt,Zt,en,tn,nn,sn,rn,on,an,cn,dn,ln,un,hn,pn,fn,vn,gn,mn,An,bn,Sn,yn,wn,En,In,Cn,Tn,Rn,kn,On,Pn,Dn,Ln,xn=class{constructor(){this.g=null,this.h=""}initialize(e,t){this.u=t,t="streamkit-latency-indicator";var n=document.getElementById(t);if(n&&n instanceof HTMLCanvasElement&&n.parentElement===e.parentElement)e=n;else{if(n)do{t="streamkit-latency-indicator"+Math.round(1e4*Math.random()),n=document.getElementById(t)}while(n);(n=document.createElement("canvas")).id=t,n.style.position="fixed",o(this.u)?(n.style.bottom="env(safe-area-inset-bottom, 0)",n.style.right="max(24px, env(safe-area-inset-right, 0))"):(n.style.bottom="0",n.style.right="0"),n.style.width="40px",n.style.height="40px",n.style.zIndex="300",n.style.pointerEvents="none",e.insertAdjacentElement("afterend",n),e=n}this.j=e,this.j.style.display="block",this.g=this.j.getContext("webgl"),qt(this)}},Mn={},Nn="",_n={type:"UNKNOWN",version:""},Fn=!1,Un=!0,jn=!1,Gn=!0,Bn=!0,Vn=!0,Hn=0,Wn=0,qn=0,zn=!1,Kn=!0,$n=!1,Jn=!0,Qn=!1,Yn=!1,Xn=!1,Zn=!1,ei=!0,ti=!1,ni=!0,ii=!0,si=!0,ri=!0,oi=!0,ai=0,ci=!0,di=!0,li=!1,ui={};function hi(e){if(e&&(e=Number.parseInt(e),!Number.isNaN(e)))return e}function pi(e){var t,n,i,s,r,o,a,c,d,l,u,h,p,f,v,g,m,A,b,S,y,w,E,I,C,T,R,k,O,P,D,L,x,M,N,_,F,U,j,G,B,V,H,W,q,z,K,$,J,Q,Y,X,Z,ee,te,ne,ie,se,re;if(Pt.i("{a112b01}","{02b2a8b}",JSON.stringify(e)),e.clientConfigOverride&&(Nn=e.clientConfigOverride),e.gxtOverrideData){var oe=JSON.parse(e.gxtOverrideData);if(oe.params)for(var ae of oe.params)"ragnarok"===ae.name&&(Mn=ae.value,_n={type:"GXT",version:ae.version})}else e.remoteConfigData&&e.remoteConfigData.ragnarok&&(Mn=JSON.parse(e.remoteConfigData.ragnarok),_n={type:"RCONFIG",version:null!==(oe=e.remoteConfigData.version)&&void 0!==oe?oe:""});if(e.isInternalUser&&(Kt=e.isInternalUser),e.overrideData){ae=new URLSearchParams(e.overrideData);let ce=new URLSearchParams;for(const[e,t]of ae.entries())ce.append(e.toLowerCase(),t);if("lean"===(null===(t=ce.get("mode"))||void 0===t?void 0:t.toLowerCase())?(Fn=!0,$t=Vn=Bn=Gn=Un=!1,Kt=Jt=!0):"dev"===(null===(n=ce.get("mode"))||void 0===n?void 0:n.toLowerCase())&&(Kt=Jt=!0),t=e=>{e:{if(e=ce.get(e))switch(e.toLowerCase()){case"enable":case"on":case"1":case"true":e=!0;break e;case"disable":case"off":case"0":case"false":e=!1;break e}e=void 0}return e},oe=e=>hi(e=ce.get(e)),n=e=>((e=ce.get(e))&&(e=Number.parseFloat(e),!Number.isNaN(e))||(e=void 0),e),ae=(e,t)=>null===(e=ce.get(e))?t:e||void 0,jn=(Un=null!==(i=t("log"))&&void 0!==i?i:Un)&&(null!==(s=t("console"))&&void 0!==s?s:jn),Gn=null!==(r=t("gamepad"))&&void 0!==r?r:Gn,Bn=null!==(o=t("webrtcstats"))&&void 0!==o?o:Bn,Vn=null!==(a=t("statsupload"))&&void 0!==a?a:Vn,$t=null!==(c=t("mic"))&&void 0!==c?c:$t,Qt=null!==(d=t("mousefilter"))&&void 0!==d?d:Qt,Yt=null!==(l=t("unadjustedmovement"))&&void 0!==l?l:Yt,0<(Hn=null!==(u=oe("bitrate"))&&void 0!==u?u:Hn)&&100>=Hn&&(Hn*=1e3),Zn=null!==(h=t("gamepadtest"))&&void 0!==h?h:Zn,(i=ce.get("resolution"))&&(2==(r=i.toLowerCase().split("x")).length?(s=parseInt(r[0]),r=parseInt(r[1]),s&&r?(Wn=s,qn=r):Pt.e("{a112b01}","{c87835d}",i)):Pt.e("{a112b01}","{c87835d}",i)),ai=null!==(p=oe("fps"))&&void 0!==p?p:ai,zn=null!==(f=t("gamepadraf"))&&void 0!==f?f:zn,Xt=null!==(v=oe("gamepadpoll"))&&void 0!==v?v:Xt,Kn=null!==(g=t("advancedgestures"))&&void 0!==g?g:Kn,$n=null!==(m=t("forcetouchdevice"))&&void 0!==m?m:$n,void 0!==(p=t("touch"))&&(Zt=p?2:0,$n=p),Qn=null!==(A=t("storetouch"))&&void 0!==A?A:Qn,Yn=null!==(b=t("storetouchgesture"))&&void 0!==b?b:Yn,Jn=null!==(S=t("touchwarp"))&&void 0!==S?S:Jn,Xn=null!==(y=t("latency"))&&void 0!==y?y:Xn,en=ae("deviceos",en),tn=ae("devicetype",tn),nn=ae("clientstreamer",nn),sn=ae("clienttype",sn),rn=ae("clientplatformname",rn),on=ae("clientid",on),null!==(A=ce.get("applaunchmode"))&&(Zt=hi(A)),ei=null!==(w=t("rsdmm"))&&void 0!==w?w:ei,ti=null!==(E=t("rsdmmtoggle"))&&void 0!==E?E:ti,null===(I=t("ioswars"))||void 0===I||I||(oi=ri=ni=si=ii=!1),ii=null!==(C=t("audioreset"))&&void 0!==C?C:ii,ni=null!==(T=t("sourcereset"))&&void 0!==T?T:ni,si=null!==(R=t("autoplaychange"))&&void 0!==R?R:si,an=null!==(k=n("bitsperpixel"))&&void 0!==k?k:an,cn=null!==(O=n("bitsperpixel1440p"))&&void 0!==O?O:cn,dn=null!==(P=t("1440p"))&&void 0!==P?P:dn,Jt=null!==(D=t("stutter"))&&void 0!==D?D:Jt,ce.has("meta")){ln={};for(const e of ce.getAll("meta"))2===(w=e.split("~")).length&&(ln[w[0]]=w[1])}un=null!==(L=t("haptics"))&&void 0!==L?L:un,hn=null!==(x=t("av1"))&&void 0!==x?x:hn,pn=null!==(M=t("h265"))&&void 0!==M?M:pn,fn=null!==(re="codeclist",N=re=(re=ce.get(re))?re.split(","):void 0)&&void 0!==N?N:fn,Kt=null!==(_=t("internaluser"))&&void 0!==_?_:Kt,vn=null!==(F=t("hdr"))&&void 0!==F?F:vn,gn=null!==(U=ce.get("hdr10gparams"))&&void 0!==U?U:gn,mn=null!==(j=t("sdr10"))&&void 0!==j?j:mn,ci=null!==(G=t("hotkeys"))&&void 0!==G?G:ci,An=null!==(B=t("forcehotkeys"))&&void 0!==B?B:An,bn=null!==(V=t("synthesizegamepadhid"))&&void 0!==V?V:bn,Sn=null!==(H=t("synthesizedds4disabled"))&&void 0!==H?H:Sn,yn=null!==(W=t("synthesizedds5disabled"))&&void 0!==W?W:yn,wn=null!==(q=t("synthesizedds4fromds5disabled"))&&void 0!==q?q:wn,En=null!==(z=t("synthesizedds5fromds4disabled"))&&void 0!==z?z:En,In=null!==(K=t("synthesizedds4fromgenericenabled"))&&void 0!==K?K:In,Cn=null!==($=t("synthesizedds5fromgenericenabled"))&&void 0!==$?$:Cn,Tn=null!==(J=t("synthesizedds4allgamesenabled"))&&void 0!==J?J:Tn,Rn=null!==(Q=t("synthesizedds5allgamesenabled"))&&void 0!==Q?Q:Rn,kn=null!==(Y=t("forceserverds4"))&&void 0!==Y?Y:kn,On=null!==(X=t("forceserverds5"))&&void 0!==X?X:On,Pn=null!==(Z=ce.get("cursor"))&&void 0!==Z?Z:Pn,Dn=null!==(ee=t("pointerlockescape"))&&void 0!==ee?ee:Dn,di=null!==(te=t("computepressure"))&&void 0!==te?te:di,Ln=null!==(ne=t("disableworkerws"))&&void 0!==ne?ne:Ln,Mn.useTelemetryV2=null!==(ie=t("usetelemetryv2"))&&void 0!==ie?ie:Mn.useTelemetryV2,li=null!==(se=t("rirecorder"))&&void 0!==se?se:li}Je(e)}function fi(){const e=Li();if(e){const t=e.destination.maxChannelCount;return e.close(),Pt.i("{d988e7f}","{fa78e0a}",t),t}return Pt.w("{d988e7f}","{d018fac}"),2}function vi(e){return e[0]<e[1]?[e[1],e[0]]:e}function gi(e,t,n){var i=screen.width,s=screen.height,r=!!(1&n);const o=!!(2&n);var a=!!(4&n);if((a||8&n)&&(i=3840,s=2160),t&&0<t.length){[i,s]=vi([i,s]),o&&1366<=i&&0===e&&(i=1600,s=1200);const n=i/s,r=i*s;return(i=t.filter((e=>120>e.frameRate))).length&&(t=i),t.sort(((t,i)=>{var s=t.resolution,o=i.resolution,a=Math.abs(s.width/s.height-n)-Math.abs(o.width/o.height-n);if(.05<Math.abs(a))return a;a=0===e?-1:1;const c=(1===e?1:-1)*(t.frameRate-i.frameRate),d=(s=s.width*s.height)-(o=o.width*o.height);return s<=r?o<=r?t.frameRate!==i.frameRate?c:a*d:-1:o<=r?1:d||c})),t[0]}if(t={resolution:{width:1280,height:720},frameRate:60},r){let[e,n]=vi([i,s]);2<e/n&&(t.resolution={width:1376,height:640})}else o?0!=e?t.resolution={width:1024,height:768}:([i]=vi([i,s]),t.resolution=1024>=i?{width:1024,height:768}:1366>i?{width:1112,height:834}:{width:1600,height:1200}):(r=[[1920,1200],[1920,1080],[1280,1024],[1600,1200]],a&&r.unshift([3840,2160]),a=[[1280,800],[1280,720],[1280,1024],[1024,768]],i=function(e,t){if(0==t.length)return e;class n{constructor(e,t){this.w=e,this.g=t,this.a=e/t}j(e){return.05>Math.abs(e.a-this.a)?e:e.a>this.a?new n(Math.floor(this.a/e.a*e.w),e.g):new n(e.w,Math.floor(e.a/this.a*e.g))}h(){return[this.w,this.g]}}t=t.map((e=>new n(e[0],e[1])));const i=new n(e[0],e[1]);e=t[0];for(let n=1;n<t.length;n++){let s=t[n];Math.abs(i.a-s.a)<Math.abs(i.a-e.a)&&(e=s)}return(t=e.j(i)).w>e.w?e.h():t.h()}(i=[i,s],0==e?r:a),t.resolution={width:i[0],height:i[1]});return t}function mi(e){var t;let n=0;return h(e)&&(n|=1),(e?"iPadOS"===e.os:/^(?!.*chrome).*safari/i.test(navigator.userAgent)&&!h()&&A())&&(n|=2),!(null===(t=window.webapis)||void 0===t)&&t.productinfo&&window.webapis.productinfo.isUdPanelSupported()&&(n|=4),window.lge_webrtc_hevc_support&&(n|=8),n}function Ai(){return getComputedStyle(document.documentElement)?(getComputedStyle(document.documentElement).getPropertyValue("--sat")||(document.documentElement.style.setProperty("--sat","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--sar","env(safe-area-inset-right)"),document.documentElement.style.setProperty("--sab","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--sal","env(safe-area-inset-left)")),{top:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sat")),left:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sal")),bottom:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sab")),right:parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sar"))}):{top:0,left:0,bottom:0,right:0}}function bi(e,t){return 0>e?0:e>t?t:e}function Si(e){var t=Ai();t.top=Math.max(t.top,21),t.bottom=bi(t.bottom,10);let n={x:e.clientX,y:e.clientY},i=.5;return 0<t.top&&e.clientY-e.radiusY<t.top?i-=.5*(t=bi(t=(t.top-(e.clientY-Math.min(e.radiusY,21)))/e.radiusY,1))*t:0<t.bottom&&e.clientY+e.radiusY>window.innerHeight-t.bottom&&(i+=.5*(t=bi(t=(e.clientY+Math.min(e.radiusY,10)-(window.innerHeight-t.bottom))/e.radiusY,1))*t),n.y=bi(n.y-e.radiusY+2*i*e.radiusY,window.innerHeight),n}function yi(e,t){let n=e;if(!t.kc)if(Mn.offlineErrorsStreaming&&Mn.offlineErrorsStreaming.includes(l(e)))n=15868418;else if(Mn.offlineErrorsSessionSetup&&Mn.offlineErrorsSessionSetup.includes(l(e)))n=15868417;else switch(e){case 3237093906:case 3237093899:n=15868418;break;case 3237089282:n=15868417}return n!==e&&Pt.i("{d988e7f}","{b84d4c8}",l(e),l(n)),n}function wi(e,t){let n=e;if(Mn.sleepErrorsStreaming&&Mn.sleepErrorsStreaming.includes(l(e)))n=15867908;else if(Mn.sleepErrorsSessionSetup&&Mn.sleepErrorsSessionSetup.includes(l(e)))n=15867909;else switch(e){case 3237093906:(o(t)||u(t))&&(n=15867908);break;case 3237094159:n=15867908;break;case 3237093701:case 3237093654:n=15867909}return n!==e&&Pt.i("{d988e7f}","{49e2182}",l(e),l(n)),n}function Ei(e,t){let n=!1;switch(e){case 3237093896:case 3237093897:case 3237093898:case 3237093906:case 3237093899:case 3237093901:case 15868418:case 3237094159:n=!0;break;case 15867908:o(t)&&(n=!0)}return n}function Ii(e,t){if(t)return!0;switch(e){case 15868706:case 15868714:case 15868742:case 15868744:case 15867910:return!0;default:return!1}}function Ci(e,t){return 2764800<=(e*=t)&&4953600>e}function Ti(e){switch(e){case"H264":return"H264";case"H265":return"HEVC";case"AV1":return"AV1";default:return"UNKNOWN"}}function Ri(e){var t;return e=f(e)||v(e)||g(e)||"Linux"===e.os||o(e),null!==(t=Mn.enableCpm)&&void 0!==t?t:e}function ki(e){return void 0!==e?e?"TRUE":"FALSE":"UNDEFINED"}function Oi(e){return e?"MANUAL":"NONE"}function Pi(e){return`${e.width.toFixed()}x${e.height.toFixed()}`}function Di(e,t,n){try{const i=document.createElement("a");i.style.display="none";const s=URL.createObjectURL(new Blob(e,{type:n}));return i.href=s,i.download=t,document.body.appendChild(i),i.click(),URL.revokeObjectURL(s),document.body.removeChild(i),!0}catch(e){return Pt.e("{d988e7f}","{8d57ba9}",e),!1}}function Li(e){const t=window.AudioContext||window.webkitAudioContext||void 0;if(t)return e?new t({sampleRate:e}):new t;Pt.w("{d988e7f}","{b74c037}")}function xi(){var e;return!(null===(e=globalThis.PointerEvent)||void 0===e||!e.prototype)}async function Mi(e,t,n){var i;const s=new RTCPeerConnection;try{await s.setRemoteDescription({type:"offer",sdp:t}).catch((e=>{throw Error("Audio munging setRemoteDescription failed. "+e)}));const r=await s.createAnswer();await s.setLocalDescription({type:"answer",sdp:null===(i=r.sdp)||void 0===i?void 0:i.replace("opus/48000/2","multiopus/48000/"+e).replace("useinbandfec=1",n)}).catch((e=>{throw Error("Audio munging setLocalDescription failed. "+e)}));const o=s.getReceivers()[0];if(!o.getParameters)return Pt.w("{d988e7f}","{4be0bf6}"),2;const{codecs:a}=o.getParameters();if(1!==a.length||"audio/multiopus"!==a[0].mimeType||a[0].channels!==e)throw Error("Audio munging failed "+a[0]);return Pt.i("{d988e7f}","{8919816}",e,a[0]),e}catch(t){return Pt.e("{d988e7f}","{4984c00}",e,t),2}finally{s.close()}}function Ni(e){if(!e)return 8;switch(null==e?void 0:e.bitDepth){case 1:return 10;case 0:return 8;default:return Pt.w("{d988e7f}","{6f291f9}",e.bitDepth),8}}function _i(e){switch(e){case 1e3:return 3237101567;case 1001:return 3237101566;case 1002:return 3237101565;case 1003:return 3237101564;case 1005:return 3237101562;case 1006:return 3237093890;case 1007:return 3237101560;case 1008:return 3237101559;case 1009:return 3237101558;case 1010:return 3237101557;case 1011:return 3237101556;case 1012:return 3237101555;case 1013:return 3237101554;case 1014:return 3237101553;case 1015:return 3237101552;case 3e3:return 3237101551;case 3003:return 3237101550;case 3008:return 3237101549}return 4100<=e&&4999>=e?e-4e3+3237097472:3237093890}function Fi(e,t){return Ue(new je(e,Mn.connectivityCheckTimeout,!(!((3237093888^t)>>8)||3237089282===t)))}function Ui(e){return e.getTransceivers().filter((e=>{var t;return"video"===(null===(t=e.receiver.track)||void 0===t?void 0:t.kind)&&("recvonly"===e.direction||"sendrecv"===e.direction)}))}function ji(e,t=!1){return t=t?Si(e):{x:e.clientX,y:e.clientY},{identifier:e.identifier,clientX:t.x,clientY:t.y,deltaX:0,deltaY:0}}function Gi(e,t,n){let i=!1;const s=t.changedTouches,r=Tl(e.o,t.timeStamp);for(let t=0;t<s.length;t++){const o=s[t],a=e.h.findIndex((e=>e.identifier==o.identifier));-1!=a&&(i=!0,qt(Wt()),e.h.splice(a,1),0===e.h.length?(0!==e.l?(window.clearTimeout(e.l),e.l=0,n&&co(e.j,e.target,r,ji(o,!0),e.m)):(2===e.g||4===e.g)&&Kn&&so(e.j,r),e.m=0,e.g=0):5===e.g?e.g=0:6===e.g&&(Kn&&ro(e.j),e.g=0))}oo(e.j)&&i&&t.preventDefault()}function Bi(e,t){e.clientX=t.pageX-e.j.nb,e.clientY=t.pageY-e.j.vertical,e.radiusX=t.radiusX,e.radiusY=t.radiusY}function Vi(e){const t=Si(e);e.h=.01<Math.abs(t.y-e.clientY),e.clientX=t.x,e.clientY=t.y}class Hi{constructor(e,t,n){this.radiusY=this.radiusX=this.clientY=this.clientX=0,this.h=!1,this.identifier=e.identifier,this.g=t,this.j=n,Bi(this,e),Jn&&navigator.standalone?Vi(this):this.h=!1}update(e){Bi(this,e),this.h&&Vi(this)}}class Wi{constructor(e,t,n,i,s){this.h=t,this.id=e.identifier,this.s=n,this.j=e.pageX,this.l=e.pageY,this.m=e.radiusX,this.o=e.radiusY,this.g=i,this.captureTs=s}}function qi(e,t,n,i){var s,r=0;for(let f of t){if(40<r)return void Pt.e("{ec05004}","{2faaf33}",t.length-r);var o=null===(s=e.g.get(f.identifier))||void 0===s?void 0:s.g;if(void 0===o)Pt.e("{ec05004}","{960ee4f}",f.identifier);else{var a=e.m*f.clientX,c=e.o*f.clientY,d=e.m*f.radiusX,l=e.o*f.radiusY,u=65535+d,h=-l;if(l=65535+l,a<-d||a>u||c<h||c>l)switch(n){case 2:case 8:break;default:continue}a=Math.min(Math.max(a,0),65535),c=Math.min(Math.max(c,0),65535);e:{d=e.N,u=n,h=f.radiusX,l=f.radiusY;var p=i;if(40<=r){o=!1;break e}const t=18+16*r;d.j.setUint8(t,o),d.j.setUint8(t+1,u),d.j.setUint16(t+2,a,!1),d.j.setUint16(t+4,c,!1),d.j.setUint8(t+6,h),d.j.setUint8(t+7,l),Qi(p,d.j,t+8,!1,1e3),o=!0}if(!o){e.l+=t.length-r;break}r++}}0!=r&&(r>t.length?Pt.w("{ec05004}","{4e60a66}",r,t.length):(r=8+16*(t=r),(e=e.N).j.setUint16(14,r,!1),e.j.setUint16(16,t,!1),t=10,3<=e.h&&(r++,t--),r=new DataView(e.j.buffer,t,r),As(e),As(e,r)||Pt.e("{ec05004}","{56a8404}")))}function zi(e,t,n){var i=performance.now(),s=Tl(e.v,t.timeStamp);let r=!1,o=[];const a=t.changedTouches;let c=[];for(let s=0;s<a.length;s++){const d=a[s];if(d.target===e.target){let s=e.g.get(d.identifier);o.push(d.identifier),s&&(r=!0,qt(Wt()),s.update(d),c.push(s),Qn&&e.h.push(new Wi(d,s.g,n,i,t.timeStamp)))}}qi(e,c,n,s);for(const t of o)i=t,(s=(n=e).g.get(i))&&(n.g.delete(i),n.s.delete(s.g));Qn&&(e.L=0==e.g.size),oo(e.j)&&r&&t.preventDefault()}var Ki=new Map([["Escape",27],["Digit0",48],["Digit1",49],["Digit2",50],["Digit3",51],["Digit4",52],["Digit5",53],["Digit6",54],["Digit7",55],["Digit8",56],["Digit9",57],["Minus",189],["Equal",187],["Backspace",8],["Tab",9],["KeyQ",81],["KeyW",87],["KeyE",69],["KeyR",82],["KeyT",84],["KeyY",89],["KeyU",85],["KeyI",73],["KeyO",79],["KeyP",80],["BracketLeft",219],["BracketRight",221],["Enter",13],["ControlLeft",162],["KeyA",65],["KeyS",83],["KeyD",68],["KeyF",70],["KeyG",71],["KeyH",72],["KeyJ",74],["KeyK",75],["KeyL",76],["Semicolon",186],["Quote",222],["Backquote",192],["ShiftLeft",160],["Backslash",220],["KeyZ",90],["KeyX",88],["KeyC",67],["KeyV",86],["KeyB",66],["KeyN",78],["KeyM",77],["Comma",188],["Period",190],["Slash",191],["ShiftRight",161],["NumpadMultiply",106],["AltLeft",164],["Space",32],["CapsLock",20],["F1",112],["F2",113],["F3",114],["F4",115],["F5",116],["F6",117],["F7",118],["F8",119],["F9",120],["F10",121],["Pause",19],["ScrollLock",145],["Numpad7",103],["Numpad8",104],["Numpad9",105],["NumpadSubtract",109],["Numpad4",100],["Numpad5",101],["Numpad6",102],["NumpadAdd",107],["Numpad1",97],["Numpad2",98],["Numpad3",99],["Numpad0",96],["NumpadDecimal",110],["PrintScreen",42],["IntlBackslash",226],["F11",122],["F12",123],["NumpadEqual",187],["F13",124],["F14",125],["F15",126],["F16",127],["F17",128],["F18",129],["F19",130],["F20",131],["F21",132],["F22",133],["F23",134],["F24",135],["KanaMode",233],["Lang2",25],["Lang1",21],["IntlRo",194],["Convert",234],["NonConvert",235],["IntlYen",193],["NumpadComma",188],["NumpadEnter",13],["ControlRight",163],["NumpadDivide",111],["PrintScreen",42],["AltRight",165],["NumLock",144],["Pause",19],["Home",36],["ArrowUp",38],["PageUp",33],["ArrowLeft",37],["ArrowRight",39],["End",35],["ArrowDown",40],["PageDown",34],["Insert",45],["Delete",46],["MetaLeft",91],["OSLeft",91],["MetaRight",92],["OSRight",92],["Lang2",25],["Lang1",21],["NumpadClear",12],["NumpadClearEntry",12]]),$i=new Map([["HanjaMode",25],["HangulMode",21]]),Ji=new Map([["1",{vkCode:49,shift:!1}],["2",{vkCode:50,shift:!1}],["3",{vkCode:51,shift:!1}],["4",{vkCode:52,shift:!1}],["5",{vkCode:53,shift:!1}],["6",{vkCode:54,shift:!1}],["7",{vkCode:55,shift:!1}],["8",{vkCode:56,shift:!1}],["9",{vkCode:57,shift:!1}],["0",{vkCode:48,shift:!1}],["!",{vkCode:49,shift:!0}],["@",{vkCode:50,shift:!0}],["#",{vkCode:51,shift:!0}],["$",{vkCode:52,shift:!0}],["%",{vkCode:53,shift:!0}],["^",{vkCode:54,shift:!0}],["&",{vkCode:55,shift:!0}],["*",{vkCode:56,shift:!0}],["(",{vkCode:57,shift:!0}],[")",{vkCode:48,shift:!0}],["-",{vkCode:189,shift:!1}],["_",{vkCode:189,shift:!0}],["=",{vkCode:187,shift:!1}],["+",{vkCode:187,shift:!0}],[",",{vkCode:188,shift:!1}],["<",{vkCode:188,shift:!0}],[".",{vkCode:190,shift:!1}],[">",{vkCode:190,shift:!0}],[";",{vkCode:186,shift:!1}],[":",{vkCode:186,shift:!0}],["/",{vkCode:191,shift:!1}],["?",{vkCode:191,shift:!0}],["`",{vkCode:192,shift:!1}],["~",{vkCode:192,shift:!0}],["[",{vkCode:219,shift:!1}],["{",{vkCode:219,shift:!0}],["\\",{vkCode:220,shift:!1}],["|",{vkCode:220,shift:!0}],["]",{vkCode:221,shift:!1}],["}",{vkCode:221,shift:!0}],["'",{vkCode:222,shift:!1}],['"',{vkCode:222,shift:!0}],[" ",{vkCode:32,shift:!1}],["A",{vkCode:65,shift:!0}],["B",{vkCode:66,shift:!0}],["C",{vkCode:67,shift:!0}],["D",{vkCode:68,shift:!0}],["E",{vkCode:69,shift:!0}],["F",{vkCode:70,shift:!0}],["G",{vkCode:71,shift:!0}],["H",{vkCode:72,shift:!0}],["I",{vkCode:73,shift:!0}],["J",{vkCode:74,shift:!0}],["K",{vkCode:75,shift:!0}],["L",{vkCode:76,shift:!0}],["M",{vkCode:77,shift:!0}],["N",{vkCode:78,shift:!0}],["O",{vkCode:79,shift:!0}],["P",{vkCode:80,shift:!0}],["Q",{vkCode:81,shift:!0}],["R",{vkCode:82,shift:!0}],["S",{vkCode:83,shift:!0}],["T",{vkCode:84,shift:!0}],["U",{vkCode:85,shift:!0}],["V",{vkCode:86,shift:!0}],["W",{vkCode:87,shift:!0}],["X",{vkCode:88,shift:!0}],["Y",{vkCode:89,shift:!0}],["Z",{vkCode:90,shift:!0}],["a",{vkCode:65,shift:!1}],["b",{vkCode:66,shift:!1}],["c",{vkCode:67,shift:!1}],["d",{vkCode:68,shift:!1}],["e",{vkCode:69,shift:!1}],["f",{vkCode:70,shift:!1}],["g",{vkCode:71,shift:!1}],["h",{vkCode:72,shift:!1}],["i",{vkCode:73,shift:!1}],["j",{vkCode:74,shift:!1}],["k",{vkCode:75,shift:!1}],["l",{vkCode:76,shift:!1}],["m",{vkCode:77,shift:!1}],["n",{vkCode:78,shift:!1}],["o",{vkCode:79,shift:!1}],["p",{vkCode:80,shift:!1}],["q",{vkCode:81,shift:!1}],["r",{vkCode:82,shift:!1}],["s",{vkCode:83,shift:!1}],["t",{vkCode:84,shift:!1}],["u",{vkCode:85,shift:!1}],["v",{vkCode:86,shift:!1}],["w",{vkCode:87,shift:!1}],["x",{vkCode:88,shift:!1}],["y",{vkCode:89,shift:!1}],["z",{vkCode:90,shift:!1}]]);function Qi(e,t,n,i,s=1){const r=4294967295&Math.floor(e*s);e=Math.floor(e/4294967296*s),i?(t.setUint32(n,r,!0),t.setUint32(n+4,e,!0)):(t.setUint32(n,e,!1),t.setUint32(n+4,r,!1))}function Yi(e){const t=e.h.getUint8(e.g);return e.g++,t}function Xi(e,t=!1){return t=function(e,t=!1){return e.h.getUint16(e.g,t??!1)}(e,t),e.g+=2,t}function Zi(e,t=!1){return t=function(e,t=!1){return e.h.getUint32(e.g,t??!1)}(e,t),e.g+=4,t}function es(e,t=!1){return t=function(e,t=!1){var n=e.h;let i;return e=e.g,t?(t=n.getUint32(e,!0),i=n.getUint32(e+4,!0)):(i=n.getUint32(e,!1),t=n.getUint32(e+4,!1)),4294967296*i+t}(e,t),e.g+=8,t}var ts=class{constructor(e){this.g=0,this.h=e}reset(){this.g=0}done(){return this.g===this.h.byteLength}left(){return this.h.byteLength-this.g}};function ns(e){return e.h.byteLength-e.g}function is(e,t){e.h.setUint8(e.g,t),e.g+=1}function ss(e,t){e.h.setUint16(e.g,t,void 0),e.g+=2}function rs(e,t){e.h.setUint32(e.g,t,void 0),e.g+=4}function os(e,t){e.h.setInt16(e.g,t,void 0),e.g+=2}function as(e,t){Qi(t,e.h,e.g,!1,1e3),e.g+=8}var cs,ds=class{constructor(e){this.h=e,this.g=0}get j(){return this.g}reset(){this.g=0}};function ls(e,t,n){var i,s;if(e.length>t.length+23)t=e;else{e="";const r=null!==(s=null===(i=document.currentScript)||void 0===i?void 0:i.src)&&void 0!==s?s:n;r&&(-1!==(n=r.lastIndexOf("/"))&&(e+=r.substring(0,n+1))),t="importScripts('"+(e+t)+"');"}return t=URL.createObjectURL(new Blob([t],{type:"text/javascript"})),n=new Worker(t),URL.revokeObjectURL(t),n}function us(e){return 6<=e&&9>=e}const hs=null===(cs=document.currentScript)||void 0===cs?void 0:cs.src;function ps(e,t){switch(e){case 3:case 4:return 14;case 8:case 9:case 10:case 5:case 7:return 26;case 12:return 24;case 18:return 2;case 17:return e=1,us(t.id)&&(e+=9),e;default:return 0}}function fs(e,t){return t>e.j?t-e.j:0}class vs extends DataView{constructor(e,t,n,i){super(e,t,n),this.shift=0,this.setUint8=(e,t)=>super.setUint8(e+this.shift,t),this.setUint16=(e,t,n)=>super.setUint16(e+this.shift,t,n),this.setUint32=(e,t,n)=>super.setUint32(e+this.shift,t,n),this.setInt8=(e,t)=>super.setInt8(e+this.shift,t),this.setInt16=(e,t,n)=>super.setInt16(e+this.shift,t,n),this.setInt32=(e,t,n)=>super.setInt32(e+this.shift,t,n),this.setFloat32=(e,t,n)=>super.setFloat32(e+this.shift,t,n),this.setFloat64=(e,t,n)=>super.setFloat64(e+this.shift,t,n),this.shift=i??0}}class gs{constructor(e,t){this.j=new DataView(new ArrayBuffer(e)),this.g=new ds(this.j),this.o=t,this.g.reset(),(e=this.g).g+=9}get h(){return this.g}get m(){return this.o}get l(){return this.g.j-9}data(){return new DataView(this.j.buffer,9,this.l)}}function ms(e){switch(e){case 3:case 4:case 8:case 9:return 18;case 10:return 22;case 5:case 7:return 5==e?26:22;case 12:return 38;case 18:return 10;case 17:return 72;default:return 0}}function As(e,t,n=!0,i="input_channel_v1"){var s,r;if("input_channel_partially_reliable"!=i&&0<e.g.h&&(t=e.U(t)),void 0===t)return!1;if(e.G&&"input_channel_v1"==i&&null!==(s=e.P)&&void 0!==s&&s.initialized)e:{var o=new ts(t);const e=fs(s,Il(s.h));for(;!o.done();){var a=Yi(o);switch(a){case 36:es(o);break;case 33:case 34:a=33==a?Xi(o):o.left();var c=o,d=a;if(d>c.left())c=void 0;else{var l=new ts(new DataView(c.h.buffer,c.h.byteOffset+c.g,d));0<=(d=c.g+d)&&d<=c.h.byteLength&&(c.g=d),c=l}if(void 0===c){Pt.e("{5eeca93}","{8400b62}",a,o.left());break e}l=s,a=e;var u=void 0;switch(c=Zi(d=c,!0)){case 3:case 4:(u={keycode:0,flags:0,scancode:0,captureTs:0}).keycode=Xi(d),u.flags=Xi(d),u.scancode=Xi(d),u.captureTs=fs(l,es(d)/1e3);break;case 8:case 9:(u={flags:0,xpos:0,ypos:0,data1:0,data2:0,windowHandle:0,vwheel:0,hwheel:0,captureTs:0}).data1=Yi(d),u.flags=Yi(d),u.windowHandle=Zi(d),u.captureTs=fs(l,es(d)/1e3);break;case 10:(u={flags:0,xpos:0,ypos:0,data1:0,data2:0,windowHandle:0,vwheel:0,hwheel:0,captureTs:0}).hwheel=Xi(d),u.vwheel=Xi(d),u.flags=Xi(d),u.windowHandle=Zi(d),u.captureTs=fs(l,es(d)/1e3);break;case 5:case 7:u=5==c;var h={flags:0,xpos:0,ypos:0,data1:0,data2:0,windowHandle:0,vwheel:0,hwheel:0,captureTs:0};h.xpos=Xi(d),h.ypos=Xi(d),h.flags=Xi(d),u&&(h.data1=Xi(d),h.data2=Xi(d)),h.windowHandle=Zi(d),h.captureTs=fs(l,es(d)/1e3),u=h;break;case 12:const e={index:0,bitmap:0,buttons:0,trigger:0,axes:[0,0,0,0],captureTs:0};Xi(d,!0),e.index=Xi(d,!0),e.bitmap=Xi(d,!0),Xi(d,!0),e.buttons=Xi(d,!0),e.trigger=Xi(d,!0);for(let t=0;4>t;t++){u=e.axes,h=t;var p=d;const n=p.h.getInt16(p.g,!0);p.g+=2,u[h]=n}Xi(d,!0),Xi(d,!0),Xi(d,!0),e.captureTs=fs(l,es(d,!0)/1e3),u=e;break;case 13:Xi(d);break;case 18:u={id:l=Yi(d),control:d=Yi(d)};break;case 17:if(u=void 0,us(l=Yi(d))){for(u={ds4Btns:[0,0,0],triggers:[0,0],axes:[0,0,0,0]},Yi(d),Yi(d),Yi(d),h=0;4>h;h++)u.axes[h]=Yi(d);u.ds4Btns[0]=Yi(d),u.ds4Btns[1]=Yi(d),u.ds4Btns[2]=Yi(d),u.triggers[0]=Yi(d),u.triggers[1]=Yi(d),u={id:l,data:u}}}if(void 0===u?(Pt.d("{5eeca93}","{e255bfc}",c),a=void 0):a={header:{recordedTs:a,size:ps(c,u),packetId:c},data:u},void 0===(c=a))break;switch(l=a=s,d=c.header,as(l.g,d.recordedTs),rs(l.g,d.packetId),rs(l.g,d.size),c.header.packetId){case 4:case 3:l=a,d=c.data,ss(l.g,d.keycode),ss(l.g,d.flags),ss(l.g,d.scancode),as(l.g,d.captureTs);break;case 8:case 9:case 7:case 5:case 10:l=a,d=c.data,ss(l.g,d.flags),ss(l.g,d.xpos),ss(l.g,d.ypos),ss(l.g,d.data1),ss(l.g,d.data2),rs(l.g,d.windowHandle),ss(l.g,d.vwheel),ss(l.g,d.hwheel),as(l.g,d.captureTs);break;case 12:for(l=a,d=c.data,ss(l.g,d.index),ss(l.g,d.bitmap),ss(l.g,d.buttons),ss(l.g,d.trigger),u=0;4>u;u++)os(l.g,d.axes[u]);as(l.g,d.captureTs);break;case 18:l=a,d=c.data,is(l.g,d.id),is(l.g,d.control);break;case 17:if(l=a,d=c.data,is(l.g,d.id),us(d.id)){for(d=d.data,u=0;4>u;u++)is(l.g,d.axes[u]);is(l.g,d.ds4Btns[0]),is(l.g,d.ds4Btns[1]),is(l.g,d.ds4Btns[2]),is(l.g,d.triggers[0]),is(l.g,d.triggers[1])}}a.l.push(c);break;default:Pt.e("{5eeca93}","{0028fe1}",a);break e}}}if(s=window.performance.now(),(o=e.V).da?(So(o),o=!1):o=!0,!o)return!1;o=!1,2<e.h&&n&&(9>t.byteOffset?Pt.w("{57a6a4d}","{0fc6121}"):((t=new DataView(t.buffer,t.byteOffset-9,9+t.byteLength)).setUint8(0,35),Qi(Il(e.L),t,1,!1,1e3)));try{let n=performance.now();switch(i){case"input_channel_partially_reliable":null===(r=e.m)||void 0===r||r.send(t);break;case"input_channel_v1":e.D.send(t);break;default:throw Error(`Invalid input channel ${i}`)}Qc(e.W,performance.now()-n);const a=window.performance.now();e.o.fd+=1,5<(t=a-s)&&(e.o.hd+=1),10<t&&(e.o.gd+=1),o=!0}catch(t){t.stack&&!t.stack.includes("Could not send data")&&(Pt.e("{57a6a4d}","{7a6bf7c}",t),Es(e)&&e.C.Aa(t,"sendinput exception","{57a6a4d}.ts",0,0,!0))}return o}function bs(e,t,n,i){e.setUint32(0,t,!0),e.setUint8(4,n),e.setUint8(5,0),e.setUint32(6,0),Qi(i,e,10,!1,1e3)}function Ss(e,t,n){e.setUint32(0,10,!0),e.setUint16(4,0,!1),e.setUint16(6,t,!1),e.setUint16(8,0,!1),e.setUint32(10,0),Qi(n,e,14,!1,1e3)}function ys(e,t,n){const i=e.s(22);Ss(i,-t,n);try{As(e,i)}catch(t){Pt.e("{57a6a4d}","{3d81a57}",t),e.C.Aa(t,"send mousewheel exception","{57a6a4d}.ts",0,0,!0)}}function ws(e,t,n,i,s,r,o=0,a=!1){let c=7,d=e.J.Qa,l=e.J.Ma;return i&&(c=5,e.G&&!a?(s=e.T(s,e.J.Qa),r=e.T(r,e.J.Ma),d=l=65535):a&&(d=l=65535)),e=0,5==c&&(e=4),t.setUint32(n,c,!0),t.setUint16(n+4,s,!1),t.setUint16(n+6,r,!1),t.setUint16(n+8,0,!1),t.setUint32(n+10+e,0,!1),Qi(o,t,n+14+e,!1,1e3),e&&(t.setUint16(n+10,d,!1),t.setUint16(n+12,l,!1)),n+(i?26:22)}function Es(e){return"open"===e.D.readyState&&(!e.m||"open"===e.m.readyState)}function Is(e,t,n,i=0){const s=e.s(26);ws(e,s,0,!0,t,n,i);try{Es(e)&&As(e,s)}catch(t){Pt.e("{57a6a4d}","{dba1265}",t),e.C.Aa(t,"send CursorPos exception","{57a6a4d}.ts",0,0,!0)}}function Cs(e,t,n,i,s=0){e.setUint32(0,t,!0),e.setUint16(4,n,!1),e.setUint16(6,i,!1),e.setUint16(8,0,!1),Qi(s,e,10,!1,1e3)}function Ts(e,t,n,i,s=0){if(4!==t&&3!==t)Pt.e("{57a6a4d}","{66e269d}",t);else{var r=e.s(18);Cs(r,t,n,i,s),As(e,r)}}function Rs(e,t,n){0!==t.l&&(n=n??t.m,As(e,t.data(),!0,n),t.g.reset(),(e=t.g).g+=9)}function ks(e,t,n,i=!1,s){var r=n+(i?1:3)+(void 0===s?0:4);if(!(r>ns(t.g)&&(Rs(e,t),r>ns(t.g)))){var o;if(void 0!==s)r=null!==(o=e.N.get(s))&&void 0!==o?o:1,e.N.set(s,(r+1)%65536),e=r,is(t.h,38),is(t.h,s),ss(t.h,e);return i?is(t.h,34):(is(t.h,33),ss(t.h,n)),n>ns(t.g)?n=void 0:(i=new vs(t.j.buffer,t.g.j,n),(t=t.g).g+=n,n=i),n}}function Os(e,t,n,i,s,r=0,o=0){e.setUint32(0,12,!0),e.setUint16(4,26,!0),e.setUint16(6,t,!0),e.setUint16(8,o,!0),e.setUint16(10,20,!0),e.setUint16(12,n,!0),e.setUint16(14,i,!0),e.setInt16(16,s[0],!0),e.setInt16(18,s[1],!0),e.setInt16(20,s[2],!0),e.setInt16(22,s[3],!0),e.setUint16(24,0,!0),e.setUint16(26,85,!0),e.setUint16(28,0,!0),Qi(r,e,30,!0,1e3)}function Ps(e,t){return!!e.m&&((t=1<<t)&e.R)==t}function Ds(e,t,n){const i=ks(e,e.l,10,!0);i&&(i.setUint32(0,18,!0),i.setUint8(4,t),i.setUint8(5,n),i.setUint32(6,1),Rs(e,e.l))}function Ls(e,t,n,i,s){e.setUint32(0,17,!0),e.setUint8(4,t),e.setUint8(5,4),e.setUint8(6,0),t=7,e.setUint8(t,1),e.setUint8(t+1,s[0]),e.setUint8(t+2,s[1]),e.setUint8(t+3,s[2]),e.setUint8(t+4,s[3]),e.setUint8(t+5,n[0]),e.setUint8(t+6,n[1]),e.setUint8(t+7,n[2]),e.setUint8(t+8,i[0]),e.setUint8(t+9,i[1]),e.setUint16(t+10,0,!0),e.setUint8(t+12,0),e.setInt16(t+13,0,!0),e.setInt16(t+15,0,!0),e.setInt16(t+17,0,!0),e.setInt16(t+19,0,!0),e.setInt16(t+21,0,!0),e.setInt16(t+23,0,!0),e.setUint32(t+25,0,!0),e.setUint8(t+29,0),e.setUint8(t+30,11),e.setUint8(t+31,0),e.setUint8(t+32,0),e.setUint8(t+33,0),t+=34,new Uint8Array(e.buffer,e.byteOffset+t,72-t).fill(0)}function xs(e,t){var n;return!(!e.m||null===(n=e.S[t])||void 0===n)&&n}function Ms(e){return[Math.round(32767.5*(e[0]+1))-32768,Math.round(32767.5*(1-e[1]))-32768,Math.round(32767.5*(e[2]+1))-32768,Math.round(32767.5*(1-e[3]))-32768]}var Ns=class{constructor(e){this.g=e}enable(){this.g.Dc=!0}disable(){this.g.Dc=!1}updateInput(e,t,n){this.g.Dc&&(qt(Wt()),this.g.Ud=e,this.g.Vd=t,this.g.Td=n,this.g.Wd=!0)}};class _s{constructor(e){this.buttons=e.Hb(e.ca),this.axes=e.Gb(e.ca),this.triggers=e.Ib(e.ca),this.timestamp=performance.now()}}const Fs={startDelay:0,duration:0,weakMagnitude:0,strongMagnitude:0};function Us(e,t){return yr||(yr=new Sr(e,t)),yr}function js(e){var t,n,i,s,r,o,a=null!==(n=null!==(t=Xt)&&void 0!==t?t:Mn.gamepadPollInterval)&&void 0!==n?n:4;e.ea=a,a=null===(s=null!==(i=un)&&void 0!==i?i:Mn.allowHaptics)||void 0===s||s,e.allowHaptics=a,i=null===(o=null!==(r=bn)&&void 0!==r?r:Mn.synthesizeGamepadHid)||void 0===o||o,e.N=i}function Gs(e,t){var n,i;js(e),t=t??0,Tn&&(t|=1),Rn&&(t|=2),e.N&&t?(e.F=null!==(n=Tn)&&void 0!==n?n:!!(1&t),e.P=null!==(i=Rn)&&void 0!==i?i:!!(2&t),Bs(e,!0)):(e.F=!1,e.P=!1)}function Bs(e,t=!1){var n=!1;if(e.g.Dc&&!e.g.ob)e.g.ob?n=!1:(Pt.i("{515a922}","{132d93a}",e.g.Mb),e.g.ob=!0,e.s={xd:"Nvidia Virtual Gamepad",state:0,buttons:0,triggers:0,axes:[]},Vs(e,e.g.Mb,!1),n=!0);else if(!e.g.Dc&&e.g.ob)e:if(e.g.ob){Pt.i("{515a922}","{98ac7c2}",e.g.Mb),e.g.ob=!1,Ws(e);var i=e.g.Mb;for(var s of e.h)if(s&&1==s.Ca&&s.ia===i){n=!1;break e}n=qs(e,i)}else n=!1;for(s=navigator.getGamepads(),i=0;i<s.length;i++){let a=s[i];if(a)if(lr(e,a,i)){var r=e,o=a;r.h[i].ca=o,r.hapticsSupported=r.hapticsSupported||cr(o),dr(r),t&&((r=(n=e.h[i]).Ca)!==(o=Zs(e,a))&&(1===r?(qs(e,n.ia),n.Ca=o,n.ia=zs(e,o),ur(e,n)):(pr(e,n),n.Ca=o,n.ia=zs(e,o),Vs(e,i,ar(a)))),n=!0)}else rr(e,i,!0),sr(e,a,i)&&(n=!0);else rr(e,i,!0)&&(n=!0)}if(n){e.vb();for(const t of e.h)2==(null==t?void 0:t.Ca)&&ur(e,t)}e.R=!0}function Vs(e,t,n){t=e.g.ob&&t===e.g.Mb?e.g.Mb:e.h[t].ia,e.j|=4>t?1<<t:0,t=4>t?1<<t+8:0,e.j=n?e.j|t:e.j&~t}function Hs(e){const t=e.buttons,n=e.triggers;return"A:"+(4096&t?"1":"0")+"_B:"+(8192&t?"1":"0")+"_X:"+(16384&t?"1":"0")+"_Y:"+(32768&t?"1":"0")+"_LB:"+(256&t?"1":"0")+"_LSB:"+(64&t?"1":"0")+"_RB:"+(512&t?"1":"0")+"_RSB:"+(128&t?"1":"0")+"_LT:"+(255&n?"1":"0")+"_RT:"+(65280&n?"1":"0")+"_DU:"+(1&t?"1":"0")+"_DD:"+(2&t?"1":"0")+"_DL:"+(4&t?"1":"0")+"_DR:"+(8&t?"1":"0")+"_ST:"+(16&t?"1":"0")+"_BA:"+(32&t?"1":"0")+"_LS:"+(2<=(e=e.axes).length&&(2===e[0]||2===e[1])?"1":"0")+"_RS:"+(4!==e.length||2!==e[2]&&2!==e[3]?"0":"1")}function Ws(e){if(e.s){for(const t of e.v)il(t,e.s.xd,"0","0",0,!1,!0,e.s.state,Hs(e.s));e.s=void 0}}function qs(e,t){return(t!==e.g.Mb||!e.g.ob)&&(e.j&=~(4>t?1<<t:0),e.j&=~(4>t?1<<t+8:0),!0)}function zs(e,t){let n=[];for(let i of e.h)i&&i.Ca==t&&(n[i.ia]=!0);for(e=0;n[e];)e++;return e}function Ks(e,t){var n;for(let i of e.h){if(!i)continue;let s=i.ca;Qs(e,s)&&(1===i.Ca?t.Wc(s.index,i.ia,0,0,[0,0,0,0],performance.now(),e.j,s.id):null===(n=t.Tc)||void 0===n||n.call(t,s.index,i.ia,0,0,[0,0,0,0],performance.now(),e.j,s.id))}t.Vc()}function $s(e,t){if(Ks(e,t),e.l.delete(t),0==e.l.size&&(e.D=!1,js(e),dr(e),Gn)){for(const t of e.l)Ks(e,t);e.windowRemoveEventListener("gamepadconnected",e.ba),e.windowRemoveEventListener("gamepaddisconnected",e.da),or(e)}}function Js(e,t){e.l.add(t),1==e.l.size&&(e.D=!0,js(e),dr(e),Gn&&(e.windowAddEventListener("gamepadconnected",e.ba),e.windowAddEventListener("gamepaddisconnected",e.da),or(e),Bs(e,!0)))}function Qs(e,t){return!!("standard"==t.mapping||e.Z||e.W||tr(e,t)||nr(t)||ir(e,t))}function Ys(e,t,n=!1){return e.R||(t|=2),n&&(t|=1),t}function Xs(e,t,n){return{xd:n,state:e.h[t.index]?e.h[t.index].Fa.state:Ys(e,0),buttons:e.h[t.index]?e.h[t.index].Fa.buttons:0,triggers:e.h[t.index]?e.h[t.index].Fa.triggers:0,axes:e.h[t.index]?e.h[t.index].Fa.axes:[]}}function Zs(e,t){if(!e.N)return 1;if(e=e.ra&&e.F&&e.qa&&!e.aa){const n=In,i=Cn;if(!((t.id.includes("Vendor: 054c")||t.id.includes("Wireless Controller")&&t.id.includes("054c")||n||i)&&18<=t.buttons.length)||n||i)return 1;const s=t.id.includes("Product: 09cc")||t.id.includes("Product: 05c4")||t.id.includes("Product: 0ba0")||t.id.includes("Wireless Controller")&&t.id.includes("09cc");if(t=(t.id.includes("Product: 0ce6")||t.id.includes("Product: 0df2")||i)&&!wn,e&&(s||t||n))return 2}return 1}function er(e,t){const n=Zs(e,t);return{ca:t,mc:!0,Ca:n,Hb:e.U,Ib:e.V,Gb:e.T,Fa:Xs(e,t,"Standard Gamepad"),ia:zs(e,n)}}function tr(e,t){return!e.ja&&"standard"!=t.mapping&&t.id.includes("Vendor: 054c")&&t.id.includes("Product: 0ce6")}function nr(e){return"standard"!=e.mapping&&e.id.includes("Vendor: 045e")&&e.id.includes("Product: 0b13")}function ir(e,t){return e.M&&"standard"!=t.mapping&&t.id.includes("Vendor: 045e")&&t.id.includes("Product: 0b12")}function sr(e,t,n){if(Qs(e,t)){var i=function(e,t){if(e.Z)return er(e,t);if(e.W){var n=Zs(e,t);return{ca:t,mc:!0,Ca:n,Hb:e.Ea,Ib:e.V,Gb:e.Ba,Fa:Xs(e,t,"Standard Gamepad"),ia:zs(e,n)}}return e.ma?null:"standard"!=t.mapping||!t.id.includes("Vendor: 0955")||e.oa||e.na?t.id.includes("Vendor: 045e")&&(t.id.includes("Product: 0b13")||t.id.includes("Product: 0b20")||t.id.includes("Product: 0b05")||t.id.includes("Product: 02e0")||t.id.includes("Product: 02fd"))?{ca:t,mc:!0,Ca:n=Zs(e,t),Hb:e.U,Ib:e.V,Gb:e.T,Fa:Xs(e,t,"Standard Gamepad"),zg:!0,ia:zs(e,n)}:"standard"==t.mapping?er(e,t):tr(e,t)?{ca:t,mc:!1,Ca:n=Zs(e,t),Hb:e.za.bind(e),Ib:e.S.bind(e,3,4),Gb:e.ga,Fa:Xs(e,t,"Dual Sense Gamepad"),ia:zs(e,n)}:nr(t)?{ca:t,mc:!1,Ca:n=Zs(e,t),Hb:e.La.bind(e),Ib:e.S.bind(e,3,4),Gb:e.ga,Fa:Xs(e,t,"Xbox Series Gamepad"),ia:zs(e,n)}:ir(e,t)?{ca:t,mc:!1,Ca:n=Zs(e,t),Hb:e.Pa.bind(e),Ib:e.S.bind(e,2,5),Gb:e.ya,Fa:Xs(e,t,"Xbox Series Wired Gamepad"),ia:zs(e,n)}:(Pt.e("{515a922}","{be4bfd9}",t),null):{ca:t,mc:!0,Ca:n=Zs(e,t),Hb:e.U,Ib:e.Ka,Gb:e.T,Fa:Xs(e,t,"Nvidia Shield Gamepad"),ia:zs(e,n)}}(e,t);if(i){e.hapticsSupported=e.hapticsSupported||cr(i.ca),dr(e);const o=e.j;var s=e.h[n],r=e.o;const a=ar(t);return e.h[n]=i,void 0===e.C[n]&&(e.C[n]=0),s&&lr(e,t,n)?e.h[n].ia=s.ia:(0==e.o&&(e.gamepadPollInterval=e.ea,or(e)),e.o++,2===i.Ca?(ur(e,i),e.O.set(i.ia,n)):(Vs(e,n,a),e.ac.set(i.ia,n))),s=s?"Changing":"Adding",(t=o!==e.j)?Pt.i("{515a922}","{96051ae}",s,n,a,i.ca.id):r!=e.o&&Pt.i("{515a922}","{98be0dd}",s,n,i.ca.id),t}for(r of e.l)r.Rc(t);return rr(e,n)}for(i of e.l)i.Rc(t);return rr(e,n)}function rr(e,t,n=!1,i){let s=e.h[t];if(s){Pt.i("{515a922}","{1b26b8a}",t,s.ca.id);const r=s.Ca,o=e.G[t];if(o){const t=performance.now()-o.timestamp;if(3e3<=t&&o.axes.some((e=>.5<Math.abs(e)))){Pt.w("{515a922}","{fde5612}",t,o.axes.join());for(const n of e.v)nl(n,"GamepadStuck",s.ca.id,t.toString(),o.axes.join())}}if(n){const[t,n]=function(e){let t=["-1","-1"];return(e=/Vendor:[ ]+([\w\d]+).+Product:[ ]+([\w\d]+)/.exec(e))&&3<=e.length&&(t=[e[1],e[2]]),t}(s.ca.id);for(const r of e.v)il(r,s.Fa.xd,t,n,s.ca.index,!!s.ca.g&&0<s.ca.g.length,i??hr(e,s.ca.index),s.Fa.state,Hs(s.Fa))}if(delete e.h[t],delete e.C[t],delete e.G[t],e.hapticsSupported=function(e){let t=!1;for(let n of e.h)n&&(t=t||cr(n.ca));return t}(e),dr(e),e.o--,0==e.o&&(e.gamepadPollInterval=100,or(e)),2!==r)return e.ac.delete(s.ia),qs(e,s.ia);pr(e,s),e.O.delete(s.ia)}return!1}function or(e){0!=e.I&&(clearInterval(e.I),e.I=0),e.I=e.D&&!zn?window.setInterval(e.xa,e.gamepadPollInterval):0}function ar(e){return e.id.includes("Xbox")||e.id.includes("xinput")}function cr(e){var t;return"dual-rumble"==(null===(t=e.vibrationActuator)||void 0===t?void 0:t.type)}function dr(e){var t,n;e.J=e.D&&e.hapticsSupported;var i,s=e.J;if(e.ha!=s&&(e.ha=s,e.allowHaptics))for(const t of e.l)null===(i=t.yg)||void 0===i||i.call(t,s);if(!e.J){s=navigator.getGamepads();for(let i of s)i&&(e.K[i.index]=0,e.L[i.index]=0,null===(n=null===(t=i.vibrationActuator)||void 0===t?void 0:t.playEffect)||void 0===n||n.call(t,"dual-rumble",Fs))}}function lr(e,t,n){var i,s;return null!=t.id&&t.id==(null===(s=null===(i=e.h[n])||void 0===i?void 0:i.ca)||void 0===s?void 0:s.id)}function ur(e,t){var n;switch(t.Ca){case 3:Pt.e("{515a922}","{ea001a4}",t.ca.id);break;case 2:for(const i of e.l)null===(n=i.eg)||void 0===n||n.call(i,t.ia);break;default:Pt.e("{515a922}","{36eeed4}",t.ca.id)}}function hr(e,t){let n=!1;for(const i of e.h)if(i){t===i.ca.index&&(n=!0);break}return n}function pr(e,t){var n;switch(t.Ca){case 3:Pt.e("{515a922}","{2b2d286}",t.ca.id);break;case 2:for(const i of e.l)null===(n=i.Jf)||void 0===n||n.call(i,t.ia);break;default:Pt.e("{515a922}","{fafe5f9}",t.ca.id)}}function fr(e){switch(Number.parseFloat((e??0).toFixed(5))){case.71429:return 4;case-.42857:return 8;case-1:return 1;case.14286:return 2;case 1.28571:return 0;case 1:return 5;case-.71429:return 9;case.42857:return 6;case-.14286:return 10;default:return 0}}function vr(e,t){return(0>t?1:0)|(0<t?2:0)|(0>e?4:0)|(0<e?8:0)|0}function gr(e,t,n,i){e.buttons|=t,e.triggers|=n,0===e.axes.length?e.axes=[i[0],i[1],i[2],i[3]]:(e.axes[0]=2==e.axes[0]||e.axes[0]!==i[0]?2:e.axes[0],e.axes[1]=2==e.axes[1]||e.axes[1]!==i[1]?2:e.axes[1],e.axes[2]=2==e.axes[2]||e.axes[2]!==i[2]?2:e.axes[2],e.axes[3]=2==e.axes[3]||e.axes[3]!==i[3]?2:e.axes[3])}function mr(e,t){e:{for(let n=0;n<e.m.length;n++){const i=e.m[n];if(i.Eb===t.Eb&&i.Jb===t.Jb&&i.Kb===t.Kb&&i.Ga===t.Ga){t=n;break e}}t=-1}-1!==t&&e.m.splice(t,1)}function Ar(e,t,n,i){if(e.J){var s=e.h[t];if(s){let d=s.ca;if(d)if(0!=n||0!=i){var r,o,a=performance.now(),c=a-e.$[t];if(e.K[t]=n/65535,e.L[t]=i/65535,!s.zg||500<c)e.$[t]=a,null===(o=null===(r=d.vibrationActuator)||void 0===r?void 0:r.playEffect)||void 0===o||o.call(r,"dual-rumble",{startDelay:0,duration:1e3,weakMagnitude:e.L[t],strongMagnitude:e.K[t]})}else e.$[t]=performance.now(),e.K[t]=0,e.L[t]=0,null===(c=null===(a=d.vibrationActuator)||void 0===a?void 0:a.playEffect)||void 0===c||c.call(a,"dual-rumble",Fs)}}}function br(e){return js(e),Bs(e),e.j}var Sr=class{constructor(e,t){var n,i;this.l=new Set,this.v=new Set,this.I=this.o=this.j=0,this.gamepadPollInterval=100,this.ea=4,this.K=[],this.L=[],this.$=[],this.ha=this.J=this.hapticsSupported=!1,this.allowHaptics=!0,this.D=!1,this.ta=new Set,this.R=this.ja=this.na=this.oa=this.M=this.Z=this.W=this.ma=!1,this.maxSchedulingDelay=0,this.m=[],this.P=this.F=this.N=!1,this.qa=!0,this.aa=this.Ta=!1,this.ac=new Map,this.O=new Map,this.windowAddEventListener=t&&t.windowAddEventListener?t.windowAddEventListener.bind(window):window.addEventListener.bind(window),this.windowRemoveEventListener=t&&t.windowRemoveEventListener?t.windowRemoveEventListener.bind(window):window.removeEventListener.bind(window),this.gamepadPollInterval=100,this.ba=this.sa.bind(this),this.da=this.va.bind(this),this.xa=this.fa.bind(this),this.h=[],this.G=[],this.C=[],t=e.os;const s=null!==(i=null!==(n=e.osVersion)&&void 0!==n?n:e.osVer)&&void 0!==i?i:"";this.W=(e=("iOS"==t||"iPadOS"==t)&&"Safari"==e.browser)&&s.startsWith("13"),this.Z=e&&s.startsWith("14"),this.ma=e&&"12-"==s,this.M="ChromeOS"==t,this.oa="WebOS"==t,this.na="Tizen"==t,this.ja="Android"==t,this.g={Mb:0,Dc:!1,ob:!1,Ud:0,Vd:0,Td:[],Wd:!1},this.Ua=new Ns(this.g),js(this),this.ra=!Sn,Gs(this),Pt.d("{515a922}","{b0c674b}")}vb(e,t){if(e)e.vb(t??this.j);else for(const e of this.l)e.vb(t??this.j)}sa(e){sr(this,e.gamepad,e.gamepad.index)&&this.vb()}va(e){rr(this,e.gamepad.index,!0)&&this.vb()}U(e){return((e=e.buttons)[0].value?4096:0)|(e[1].value?8192:0)|(e[2].value?16384:0)|(e[3].value?32768:0)|(e[4].value?256:0)|(e[5].value?512:0)|(e[8]&&e[8].value?32:0)|(e[9]&&e[9].value?16:0)|(e[10]&&e[10].value?64:0)|(e[11]&&e[11].value?128:0)|(e[12]&&e[12].value?1:0)|(e[13]&&e[13].value?2:0)|(e[14]&&e[14].value?4:0)|(e[15]&&e[15].value?8:0)|(e[16]&&e[16].value?65536:0)|(e[17]&&e[17].value?131072:0)|0}V(e){var t,n;e=e.buttons;let i=Math.round(255*(null===(t=e[6])||void 0===t?NaN:t.value));return(255&Math.round(255*(null===(n=e[7])||void 0===n?NaN:n.value)))<<8|255&i}Ka(e){var t,n;e=e.buttons;let i=Math.round(255*(null===(t=e[7])||void 0===t?NaN:t.value));return(255&Math.round(255*(null===(n=e[6])||void 0===n?NaN:n.value)))<<8|255&i}S(e,t,n){return(255&Math.round(127.5*(n.axes[t]+1)))<<8|255&Math.round(127.5*(n.axes[e]+1))}T(e){return e.axes}Ba(e){return[e.axes[0],-e.axes[1],e.axes[2],-e.axes[3]]}ga(e){return[e.axes[0],e.axes[1],e.axes[2],e.axes[5]]}ya(e){return[e.axes[0],e.axes[1],e.axes[3],e.axes[4]]}Ea(e){var t,n,i,s,r,o;let a=e.buttons;return e=e.axes,(null!==(t=a[0])&&void 0!==t&&t.value?4096:0)|(null!==(n=a[1])&&void 0!==n&&n.value?8192:0)|(null!==(i=a[2])&&void 0!==i&&i.value?16384:0)|(null!==(s=a[3])&&void 0!==s&&s.value?32768:0)|(null!==(r=a[4])&&void 0!==r&&r.value?256:0)|(null!==(o=a[5])&&void 0!==o&&o.value?512:0)|(0<e[5]?1:0)|(0>e[5]?2:0)|(0>e[4]?4:0)|(0<e[4]?8:0)|0}za(e){var t,n,i,s,r,o,a,c,d,l;let u=e.buttons;return e=this.M?vr(e.axes[6],e.axes[7]):fr(e.axes[9]),(null!==(t=u[1])&&void 0!==t&&t.value?4096:0)|(null!==(n=u[2])&&void 0!==n&&n.value?8192:0)|(null!==(i=u[0])&&void 0!==i&&i.value?16384:0)|(null!==(s=u[3])&&void 0!==s&&s.value?32768:0)|(null!==(r=u[4])&&void 0!==r&&r.value?256:0)|(null!==(o=u[5])&&void 0!==o&&o.value?512:0)|(null!==(a=u[8])&&void 0!==a&&a.value?32:0)|(null!==(c=u[9])&&void 0!==c&&c.value?16:0)|(null!==(d=u[10])&&void 0!==d&&d.value?64:0)|(null!==(l=u[11])&&void 0!==l&&l.value?128:0)|e}La(e){var t,n,i,s,r,o,a,c,d,l;let u=e.buttons;return e=fr(e.axes[9]),(null!==(t=u[0])&&void 0!==t&&t.value?4096:0)|(null!==(n=u[1])&&void 0!==n&&n.value?8192:0)|(null!==(i=u[3])&&void 0!==i&&i.value?16384:0)|(null!==(s=u[4])&&void 0!==s&&s.value?32768:0)|(null!==(r=u[6])&&void 0!==r&&r.value?256:0)|(null!==(o=u[7])&&void 0!==o&&o.value?512:0)|(null!==(a=u[10])&&void 0!==a&&a.value?32:0)|(null!==(c=u[11])&&void 0!==c&&c.value?16:0)|(null!==(d=u[13])&&void 0!==d&&d.value?64:0)|(null!==(l=u[14])&&void 0!==l&&l.value?128:0)|e}Pa(e){var t,n,i,s,r,o,a,c,d,l;let u=e.buttons;return e=vr(e.axes[6],e.axes[7]),(null!==(t=u[0])&&void 0!==t&&t.value?4096:0)|(null!==(n=u[1])&&void 0!==n&&n.value?8192:0)|(null!==(i=u[2])&&void 0!==i&&i.value?16384:0)|(null!==(s=u[3])&&void 0!==s&&s.value?32768:0)|(null!==(r=u[4])&&void 0!==r&&r.value?256:0)|(null!==(o=u[5])&&void 0!==o&&o.value?512:0)|(null!==(a=u[6])&&void 0!==a&&a.value?32:0)|(null!==(c=u[7])&&void 0!==c&&c.value?16:0)|(null!==(d=u[9])&&void 0!==d&&d.value?64:0)|(null!==(l=u[10])&&void 0!==l&&l.value?128:0)|e}$b(){for(const e of this.l)e.$b(this.g.Ud,this.g.Vd,this.g.Mb,this.g.Td,this.j)}fa(){var e,t=performance.now();this.pa&&(this.maxSchedulingDelay=Math.max(this.maxSchedulingDelay,t-this.pa-this.gamepadPollInterval)),this.pa=t,Bs(this),t=0;for(let o of this.h){if(!o)continue;const a=o.ca.timestamp;let c=o.ca;if(!Qs(this,c))continue;if(o.ca.timestamp<=this.C[c.index]){this.wa&&5e3<=performance.now()-o.ca.timestamp&&this.wa();continue}this.C[c.index]=o.ca.timestamp;const d=this.G[c.index];var n,i=new _s(o);if((n=d)&&(n=d.buttons==i.buttons&&d.triggers==i.triggers)){e:{n=d.axes;for(var s=0;s<n.length;s++)if(.01<Math.abs(n[s]-i.axes[s])){n=!0;break e}n=!1}n=!n}if(n)continue;this.G[c.index]=i,s=o.Ib(c);let l=o.Hb(c),u=o.Gb(c);for(let e of this.m){i=void 0,n=e.Eb;var r=e.Kb;const t=(e.Jb|n)===l;r=!!(255&r)==229.5<=(255&s)&&!!(65280&r)==58752<=(65280&s);const o=0==((null!==(i=null==d?void 0:d.buttons)&&void 0!==i?i:0)&n)&&0!=(l&n);t&&r&&o&&e.Ga()}switch(o.Ca){case 1:for(const e of this.l)e.Wc(c.index,o.ia,l,s,u,a,this.j,c.id);break;case 2:for(const t of this.l)null===(e=t.Tc)||void 0===e||e.call(t,c.index,o.ia,l,s,u,o.ca.timestamp,this.j,c.id)}t++,gr(o.Fa,l,s,u)}if(t){qt(Wt());for(const e of this.l)e.Vc()}this.g.ob&&this.g.Wd&&(this.$b(),this.g.Wd=!1,this.s&&gr(this.s,this.g.Ud,this.g.Vd,this.g.Td))}getVirtualGamepadHandler(){return this.Ua}},yr=void 0;function wr(e,t,n,i){var s=[];s[0]=-.1<i[0]&&.1>i[0]?0:i[0],s[1]=-.1<i[1]&&.1>i[1]?0:i[1],s[2]=-.1<i[2]&&.1>i[2]?0:i[2],s[3]=-.1<i[3]&&.1>i[3]?0:i[3],i=s[e.Sf],s=s[e.Tf];const r=4-3*Math.min(1,Math.sqrt(i*i+s*s));e.zc=i*e.scale/r,e.Ac=s*e.scale/r,t=!!(4224&t)||58752<=(65280&n),n=229.5<=(255&n),i=e.oc,s=e.pc,e.oc=t,e.pc=n,!t&&i&&Er(e,0,!1),!n&&s&&Er(e,2,!1),t&&!i&&Er(e,0,!0),n&&!s&&Er(e,2,!0)}function Er(e,t,n){t=new MouseEvent(n?e.ud:e.Sd,{button:t,buttons:(e.oc?1:0)|(e.pc?2:0)}),e.Te.dispatchEvent(t)}function Ir(e){return{vf:"image/x-icon",scale:1,...e}}const Cr={style:"default",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAOAAAADAAAABwAAAAYAAAAOAAABDAAAAZwAAAHYAAAB4AAAAf+AAAH/AAAB/gAAAfwAAAH4AAAB8AAAAeAAAAHAAAABgAAAAQAAAAAAAAAAAAAAAAAAAA////////////////////////////////////////////5////8P///+D////h////wf//98P///OD///xh///8Af///AP///wAH//8AD///AB///wA///8Af///AP///wH///8D////B////w////8f////P////3/////////8=",Ha:2,Ia:1},Tr=[{style:"none",Na:"",Ha:0,Ia:0},Cr,{style:"text",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfvwAAAAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAfPwAAAAAAAAAAAAAAAAAA/////////////////////////////////////+BA///Agf///z////8/////P////z////8/////P////z////8/////P////z////8/////P////z////8/////P////z////8/////P////z///+BA///Agf////////////8=",Ha:8,Ia:13},{style:"wait",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/8AAAzzAAAHDgAABfoAAAb2AAADbAAAAfgAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAB+AAAA/wAAAaWAAAH/gAABWoAAA//AAAP/wAAAAAAAAAAAAA//////////////////////////////////////////+AAf//gAH//4AB//+AAf//wAP//8AD///gB///8A////gf///8P////D////w////8P////D////gf///wD///4Af//8AD///AA///gAH//4AB//+AAf//gAH///////8=",Ha:7,Ia:12},{style:"crosshair",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAABjAAABgMAAAQBAAAIAIAACACAABAAQAAAIAAAEABAAAgAgAAIAIAABgMAAAICAAABjAAAAFAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////4////5T///53P//+97///fff//333//79+//+AAP//v37//999///fff//53P///d3///5T////j////////8=",Ha:8,Ia:8},{style:"progress",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4AAAAiAAAAPgAAABwAAAYIAAAOCAAADAgAABwcAAAYNgAAOCoABDA+AAZwAAAHYAAAB4AAAAf+AAAH/AAAB/gAAAfwAAAH4AAAB8AAAAeAAAAHAAAABgAAAAQAAAAAAAAAAAAAAAAAAAA///////////////////////+A////gP///4D///+A///5wf//8OP//+Dj///h4///wcH/98OA//ODgP/xh4D/8AeA//AP///wAH//8AD///AB///wA///8Af///AP///wH///8D////B////w////8f////P////3/////////8=",Ha:2,Ia:1},{style:"nwse-resize",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP4AAAB+AAAAPgAAAB4AAABuAAAA5gAAAcIAAEOAAABnAAAAdgAAAHgAAAB8AAAAfgAAAH8AAAAAAAAAAAAAA/////////////////////////////////////////////////////////////////////////////////wA///+AP///wD///+A////gP///wD//34A//88GP//GDz//wB+//8A////Af///wH///8A////AH///wA////////8=",Ha:9,Ia:8},{style:"nesw-resize",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfwAAAH4AAAB8AAAAeAAAAHYAAABnAAAAQ4AAAAHCAAAA5gAAAG4AAAAeAAAAPgAAAH4AAAD+AAAAAAAAAAAAA////////////////////////////////////////////////////////////////////////////////wA///8Af///AP///wH///8B////AP///wB+//8YPP//PBj//34A////AP///4D///+A////AP///gD///wA///////8=",Ha:9,Ia:9},{style:"ew-resize",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAEAABgBgAA4AcAAeAHgAPv98AH7/fgA+/3wAHgB4AA4AcAAGAGAAAgBAAAAAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////+/3///P8///j/H//w/w//4P8H/8AAA/+AAAH/AAAA/4AAAf/AAAP/4P8H//D/D//4/x///P8///7/f//////8=",Ha:13,Ia:8},{style:"ns-resize",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADgAAAB8AAAA/gAAAf8AAAP/gAAAAAAAADgAAAA4AAAAOAAAADgAAAA4AAAAOAAAADgAAAA4AAAAAAAAA/+AAAH/AAAA/gAAAHwAAAA4AAAAEAAAAAAAAAAAAAA//////////////////////////////////////+/////H////g////wH///4A///8AH//+AA///AAH///g////4P///+D////g////4P///+D////g////4P///AAH//4AD///AB///4A////Af///4P////H////7////////8=",Ha:9,Ia:12},{style:"move",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABwAAAA+AAAAHAAAABwAAAAcAAAAHAAAABwAAAgACAAf3fwAP93+AB/d/AAIAAgAABwAAAAcAAAAHAAAABwAAAAcAAAAPgAAABwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////f////j////wf///4D///8Af///wf///8H///vB7//zwef/4AAD/8AAAf+AAAD/wAAB/+AAA//zwef/+8Hv///B////wf///wB///+A////wf///+P////3///////////////////////8=",Ha:13,Ia:12},Cr,{style:"pointer",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH+AAAB/gAAA/4AAAP/AAAH/wAAB/8AAA//gAAP/4AAH/+AADttgABzbYAAY2wAAANsAAADYAAAAwAAAAMAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////////+Af///AD///wA///4AP//+AB///AAf//wAH//4AA//+AAP//AAD//gAA//wAAP/8IAH//mAH///gD///4H///+H////z////////8=",Ha:8,Ia:3},{style:"help",Na:"AAABAAEAICACAAEAAQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAABgAAAAYAAAYHAAAOAYAADADAABwwwAAYMMAAODDABDAZgAZwDwAHYAAAB4AAAAf+AAAH/AAAB/gAAAfwAAAH4AAAB8AAAAeAAAAHAAAABgAAAAQAAAAAAAAAAAAAAAAAAAA/////////////+f////D////5//////////n////w///58P//8PB//+D4P//hzB//wYYf98OGH/ODhh/xh8A/8Afgf/AP8P/wAH//8AD///AB///wA///8Af///AP///wH///8D////B////w////8f////P////3/////////8=",Ha:2,Ia:1}];function Rr(e){e.preventDefault()}function kr(e){var t,n;return e.xb()&&2!=e.cursorType&&e.v.h&&(!e.g.pb||e.g.rd)&&(null===(n=null===(t=Yc(e.R))||void 0===t?void 0:t.Fb())||void 0===n||n)}function Or(e){return 1===e.m||2===e.m}function Pr(e){var t=kr(e);const n=Or(e),i=e.s&&!e.g.pb,s=e.La;if(!e.Fb||!t||n&&i===s)1!=e.m&&!t&&n&&(document.exitPointerLock?(e.m=3,document.exitPointerLock()):e.m=0);else if((t=e.H).requestPointerLock&&3>e.S){if(1===e.m){if(i===e.U)return;if(e.O)return void e.O.then((()=>{Pr(e)}));e.aa?Pt.e("{70cc40b}","{d70c0a5}"):Pt.e("{70cc40b}","{da98287}")}e.m=1,e.U=i,t=t.requestPointerLock({unadjustedMovement:i}),(e.O=t)&&(e.aa=!0,t.then((()=>{e.m=2,e.U=null,e.O=void 0,e.La=i,e.S=0})).catch((t=>{e.m=0,"NotSupportedError"===t.name&&i?(Pt.i("{70cc40b}","{08fd91e}"),e.s=!1,Pr(e)):("UnknownError"==t.name?(e.S++,Pt.w("{70cc40b}","{9f2ba9f}",e.S)):Pt.e("{70cc40b}","{4cdd98f}",t.name,t.message),Kr(e))})))}else e.m=2}function Dr(e,t){let n=new Uint8Array(t.data);switch(n[0]){case 0:case 1:t=n[1];let o=n[2],a=n[3];var i=n[4];let c=5,d=()=>{const e=n[c]+(n[c+1]<<8);return c+=2,e};var s="";0!=i&&(s=n.subarray(c,c+i),c+=i,s=new TextDecoder("utf-8").decode(s));var r="";let l,u,h;0!=(i=d())&&(r=n.subarray(c,c+i),c+=i,r=new TextDecoder("utf-8").decode(r)),c+4<=n.byteLength&&(l=d(),u=d()),c+2<=n.byteLength&&(h=d()/100),0==n[0]?Nr(e,t,l,u):function(e,t,n,i,s,r,o,a,c){if(0<r.length)n={Na:r,Ha:n,Ia:i,vf:s,scale:c||1},e.$.set(t,n);else if(n=e.$.get(t),void 0===n)return void Pt.e("{70cc40b}","{0196577}",t);Jr(e,n,o,a)}(e,t,o,a,s,r,l,u,h);break;case 10:e.Pa.allowUnconfined&&function(e,t){e.g.rd=t,Pr(e)}(e,1==n[1])}}function Lr(e){var t,n;if(0===e.cursorType){var i=e.H.getBoundingClientRect(),s=null!==(n=null===(t=e.H.parentElement)||void 0===t?void 0:t.getBoundingClientRect())&&void 0!==n?n:new DOMRect(0,0,0,0);t=i.left-s.left+e.l.la*e.l.Ra,i=i.top-s.top+e.l.la*e.l.Oa,e.j.style.position="absolute",e.j.style.left=t+"px",e.j.style.top=i+"px",e.j.style.zIndex="200"}}function xr(e){var t=e.j.getContext("2d");if(t&&(e.h.kg=t,t=window.devicePixelRatio,e.h.ub!=t)){Pt.i("{70cc40b}","{b786ba9}",t),e.h.ub=t,e.h.Xc=!0;for(const t of e.$.values())t.style=void 0;Ur(e)}}function Mr(e,t){if(e.W&&e.I!==t)switch(e.C&&Zr(e),e.I=t,e.C&&Yr(e),t){case 1:e.G=4;break;case 2:e.G=8;break;case 3:e.G=16;break;default:e.G=0}}function Nr(e,t,n,i){t>=e.Z.length?Pt.e("{70cc40b}","{de8eabe}",t):Jr(e,e.Z[t],n,i)}function _r(e){e.N&&(window.clearTimeout(e.N),e.N=0)}function Fr(e,t,n){Vr(e,t-e.l.Ra,n-e.l.Oa)}function Ur(e){e.h.Sc=!0}function jr(e,t,n){if(!e.F.has(t)){e.F.add(t);const i=(e=e.o).s(18);bs(i,8,t+1,n);try{As(e,i)}catch(t){Pt.e("{57a6a4d}","{b258856}",t),e.C.Aa(t,"send mousedown exception","{57a6a4d}.ts",0,0,!0)}}}function Gr(e,t,n){if(e.F.has(t)){e.F.delete(t);const i=(e=e.o).s(18);bs(i,9,t+1,n);try{As(e,i)}catch(t){Pt.e("{57a6a4d}","{c1ae1fc}",t),e.C.Aa(t,"send mouseup exception","{57a6a4d}.ts",0,0,!0)}}}function Br(e,t){if(t instanceof PointerEvent){if(to(t))return;t.preventDefault()}let n=performance.now();if(e.v.h&&(!kr(e)||Or(e))&&(0!==t.movementX||0!==t.movementY)){e.lc(!0);var i=1,s=0,r=e.g.pb,o=e.D.h,a=t=>{if(e.T.update(t.movementX,t.movementY,t.timeStamp)){var o=e.T.Ze(),a=e.T.$e();if(r){if(e.g.rd){var c=e.V?e.h.ub:1;Vr(e,e.g.qb+o/c,e.g.rb+a/c)}else Fr(e,t.offsetX,t.offsetY);e.h.Sc=!0,o=e.g.qb,a=e.g.rb}else e.V&&(c=e.h.ub,o+=e.g.Ld,a+=e.g.Md,e.g.Ld=o%c,e.g.Md=a%c,o/=c,a/=c);e:{if(c=e.D,t=Tl(e.K,t.timeStamp),s%i!=0&&0<c.j){const e=c.l[c.j-1];if(e.eb===r&&e.qc===n){r?(e.x=o,e.y=a):(e.x+=o,e.y+=a);break e}}c.j==c.l.length?(c.l.push({eb:r,x:o,y:a,captureTimestamp:t,gb:0,qc:n}),c.j++):((c=c.l[c.j++]).eb=r,c.x=o,c.y=a,c.captureTimestamp=t,c.gb=0,c.qc=n)}s++}};if(t instanceof PointerEvent&&e.da){const n=t.getCoalescedEvents();if(0==n.length)a(t);else{t=e.D.g.length,t=n.length>2*t?1:Math.max(t-e.D.h-4,1),n.length>t&&(i=Math.ceil(n.length/t),e.ja.Oc+=n.length);for(let e of n)a(e)}}else a(t);1<e.o.ga&&0===o&&e.D.h>o&&(e.D.l[o].gb=e.D.h-o)}}function Vr(e,t,n){e.g.qb=Math.min(Math.max(t,0),e.l.Qa),e.g.rb=Math.min(Math.max(n,0),e.l.Ma),Ur(e)}function Hr(e,t){if(e.l.Qa&&e.l.Ma){const n=t.Ma/e.l.Ma;e.g.qb*=t.Qa/e.l.Qa,e.g.rb*=n}e.l=t,Lr(e),xr(e)}function Wr(e){return 1.499<=e&&1.999>e?2:Math.max(1,Math.floor(e+.001))}function qr(e,t){const n=e.g.cursor;if(n.image){var i=e.h.ub,s=e.h.kg,r=n.image.width*t;t*=n.image.height;var o=Math.ceil(r),a=Math.ceil(t);o!==e.j.width||a!==e.j.height?(e.j.style.width=r/i+"px",e.j.style.height=t/i+"px",e.j.width=o,e.j.height=a,s.scale(1,1),s.imageSmoothingEnabled=!1):s.clearRect(0,0,e.j.width,e.j.height),s.drawImage(n.image,0,0,r,t)}else Pt.e("{70cc40b}","{bc9bdcd}")}function zr(e){e.h.jd&&(e.h.jd=!1,e.j.style.visibility="hidden")}function Kr(e){const t=e.H;!e.xb()||kr(e)&&!Or(e)||2==e.cursorType?t.style.cursor="default":t.style.cursor=0===e.cursorType?"none":e.g.style}function $r(e,t){const n=()=>{if(e.g.sc=void 0,e.g.cursor=t,e.h.Xc=!0,0===e.cursorType)Ur(e);else{if(!t.style){var n=e.h.ub,i=1,s=1;void 0!==e.Ka&&(s=(i=Wr(n/t.scale))/n),qr(e,i),n=e.j.toDataURL("image/bmp"),i=t.Ha*s,s=t.Ia*s;const r=e.h.ub,o=e.Ka;t.style=o?`${o}(url(${n}) ${r}x) ${i} ${s}, auto`:`url(${n}) ${i} ${s}, auto`}e.g.style=t.style,Kr(e)}};if(0!==e.cursorType&&t.style)n();else if("none"!==t.style)if(t.image)0!==t.image.width||0!==t.image.height?n():e.g.sc=t.image;else{const i=new Image;t.image=i,!i.decode&&i.decoding&&(i.decoding="sync"),i.src=`data:${t.vf};base64,${t.Na}`,i.decode?(e.g.sc=i,i.decode().then((()=>{e.g.sc===i&&n()})).catch((()=>{e.g.sc===i&&(e.g.sc=void 0,$r(e,e.Z[1]))}))):n()}else e.g.cursor=t,zr(e)}function Jr(e,t,n,i){const s="none"!==t.style;!e.g.pb&&s&&void 0!==n&&void 0!==i&&Vr(e,n*e.l.Qa/65535,i*e.l.Ma/65535),e.g.pb=s,s||(e.g.Ld=0,e.g.Md=0),Pr(e),$r(e,t),Kr(e)}function Qr(e){0!==e.L&&(window.clearTimeout(e.L),e.L=0)}function Yr(e){2==e.cursorType?(e.M.jc=eo(e),e.videoAddEventListener(eo(e),e.J?e.pa:e.oa)):0!==e.I?(e.M.jc="pointerrawupdate",e.videoAddEventListener("pointerrawupdate",e.za)):(e.M.jc=eo(e),e.videoAddEventListener(eo(e),e.ya))}function Xr(e){if(0<e.F.size){Pt.i("{70cc40b}","{041c67f}",e.F.size);for(const t of e.F)Gr(e,t,0)}}function Zr(e){2==e.cursorType?e.videoRemoveEventListener(eo(e),e.J?e.pa:e.oa):0!==e.I?e.videoRemoveEventListener("pointerrawupdate",e.za):e.videoRemoveEventListener(eo(e),e.ya)}function eo(e){return e.J?"pointermove":"mousemove"}function to(e){return!(e.isPrimary&&"touch"!==e.pointerType&&"pen"!==e.pointerType)}const no=[{tc:8,hc:128,ld:Mo(),Yb:27,Zb:[]},{tc:46,hc:128,ld:Mo(),Yb:27,Zb:[]}];function io(e,t,n,i){1===e.g.la&&(To(e,t,i,n),e.L.delay((()=>{jr(e.j,0,n)})))}function so(e,t){1===e.g.la&&(Oo(e.L),Gr(e.j,0,t))}function ro(e){var t=e.j;t.fa=!1,Ur(t),1.1>e.g.la&&vo(e,e.g.offsetX,e.g.offsetY,1)}function oo(e){return e.da?(So(e),!1):e.F.h}function ao(e,t){if(2===t.length){var n=e.j;n.fa=!0,Ur(n),n=t[0],t=t[1];var i=Math.hypot(n.clientX-t.clientX,n.clientY-t.clientY),s=Math.hypot(n.clientX-n.deltaX-(t.clientX-t.deltaX),n.clientY-n.deltaY-(t.clientY-t.deltaY));const r=e.l.getBoundingClientRect(),o=Co(e);i=i/s*e.g.la,i=Math.min(Math.max(i,1),3),s=(n.clientX+t.clientX)/2-r.left,s+=e.g.offsetX-o.nb-(r.width-s)/e.g.la,s=(i/e.g.la-1)*s*-1,s+=e.g.offsetX+(n.deltaX+t.deltaX)/2;let a=(n.clientY+t.clientY)/2-r.top;a+=e.g.offsetY-o.vertical-(r.height-a)/e.g.la,a=(i/e.g.la-1)*a*-1,a+=e.g.offsetY+(n.deltaY+t.deltaY)/2,vo(e,s,a,i)}}function co(e,t,n,i,s){switch(Oo(e.L),s){case 1:To(e,t,i,n),e.L.delay((()=>{Ro(e,0,n)}));break;case 2:e.na++,Kt&&0===e.J&&(e.J=window.setTimeout((()=>{2===e.na?e.o.toggleOnScreenStats():3===e.na&&e.o.toggleOnScreenStats(!0),bo(e)}),300)),Ro(e,2,n);break;case 3:e.ja++,Kt&&0===e.J&&(e.J=window.setTimeout((()=>{2===e.ja?e.o.na():3===e.ja&&Mc(e.T),bo(e)}),300)),Ro(e,1,n);break;case 4:Ro(e,3,n);break;case 5:Ro(e,4,n)}}function lo(e,t){t&&(Ao(e),Pt.i("{8bacfa5}","{f46c4da}"),Ts(e.h,3,27,0),Ts(e.h,4,27,0))}function uo(e){po(e),e.ha=window.setTimeout((()=>{e.T.send()}),350)}function ho(e,t){(e.da=t)&&15!==e.v&&(e.pa=e.v,e.toggleUserInput(!0)),t?yo(e).forEach((t=>e.documentAddEventListener(t,e.Ea))):yo(e).forEach((t=>e.documentRemoveEventListener(t,e.Ea)))}function po(e){0!==e.ha&&(window.clearTimeout(e.ha),e.ha=0)}function fo(e,t){if(!(e.oa&&20===t.keyCode||o(e.u)&&20!==t.keyCode)){var n=16;if(e.R&&e.ma||!t.getModifierState("CapsLock")||(n|=1),e.ab&&(n|=96,t.getModifierState("NumLock")&&(n|=2),t.getModifierState("ScrollLock")&&(n|=4)),n!=e.ea){e.ea=n;const i=(e=e.h).s(5);(t=i).setUint32(0,19,!0),t.setUint8(4,n);try{As(e,i),Pt.d("{57a6a4d}","{56c9613}",n.toString(2))}catch(t){Pt.e("{57a6a4d}","{cbe483c}",t),e.C.Aa(t,"LockKeys state synchronize exception","{57a6a4d}.ts",0,0,!0)}}}}function vo(e,t,n,i){e.g.la=i;let s=Co(e);s.nb-=e.g.Ra,s.vertical-=e.g.Oa;let r=Math.max(s.vertical+Math.max(0,e.g.Ma-e.g.Ec+2*e.g.Oa),0),o=Math.max(s.vertical,0);s.nb=Math.max(s.nb,0),t=Math.min(Math.max(t,-1*s.nb),s.nb),n=Math.min(Math.max(n,-1*r),o),e.l.style.transform=`translate3d(${t}px,${n}px,0px) scale3d(${i},${i},1)`,e.g.offsetX=t,e.g.offsetY=n,Hr(e.j,e.g)}function go(e,t){var n;return e.S?e.C?(e=null!==(n=t.code)&&void 0!==n&&n.length?Ki.get(t.code):Ki.get(t.key))??0:(t=t.code?Ki.get(t.code):$i.get(t.key))??0:t.keyCode}function mo(e,t){var n=0;let i;return t.ctrlKey&&!t.code.startsWith("Control")&&(n|=2),t.altKey&&!t.code.startsWith("Alt")&&(n|=4),t.metaKey&&!t.code.startsWith("Meta")&&(n|=8),o(e.u)&&1===t.key.length&&('!@#$%^&*()~_+{}|:"<>?'.includes(t.key)?i=1:"1234567890`-=[]\\;',./".includes(t.key)&&(i=0)),void 0===i&&t.shiftKey&&!t.code.startsWith("Shift")&&(i=1),n|(i??0)}function Ao(e){if(0<e.Sa.size){Pt.i("{8bacfa5}","{7998ee8}",e.Sa.size);for(const t of e.Sa)Ts(e.h,4,t,0);e.Sa.clear()}}function bo(e){window.clearTimeout(e.J),e.J=0,e.na=0,e.ja=0}function So(e){ho(e,!1),e.O.emit("StreamingEvent",{streamingWarnings:{code:4}}),void 0!==e.pa&&(e.toggleUserInput(!1,15&~e.pa),e.pa=void 0);var t=e.h;const n=t.s(4);n.setUint32(0,2,!0);try{t.D.send(n),Pt.d("{57a6a4d}","{5693344}")}catch(e){Pt.e("{57a6a4d}","{ab52f04}",e),t.C.Aa(e,"heartbeat exception","{57a6a4d}.ts",0,0,!0)}e.ib.zf()}function yo(e){return[eo(e.j),"pointerdown","touchstart"]}function wo(e,t){t=(new TextEncoder).encode(t),e.sendTextInput(t.buffer),e.textInputElement.value=""}function Eo(e){for(let t=e.length-1;0<=t;t--)if(void 0===Ji.get(e.charAt(t)))return!1;return!0}function Io(e,t){let n=!1;16&e.ea&&(n=0!=(1&e.ea));for(let s=0;s<t.length;s++){var i=Ji.get(t.charAt(s));if(!i)return void Pt.e("{8bacfa5}","{67554be}",t.charAt(s));const r=i.vkCode;i=i.shift?1:0,65<=r&&90>=r&&n&&(i=~i),i&&Ts(e.h,3,160,0,performance.now()),Ts(e.h,3,r,i,performance.now()),Ts(e.h,4,r,i,performance.now()),i&&Ts(e.h,4,160,0,performance.now())}e.textInputElement.value=""}function Co(e){return{nb:e.g.Qa*(e.g.la-1)/2,vertical:e.g.Ma*(e.g.la-1)/2}}function To(e,t,n,i){Oo(e.L);const s=t.getBoundingClientRect();t=(n.clientX-s.left)/e.g.la,n=(n.clientY-s.top)/e.g.la,e.lc(!0),Fr(e.j,t,n);const{qb:r,rb:o}=e.j.g;Is(e.h,r,o,i)}function Ro(e,t,n){jr(e.j,t,n),e.L.delay((()=>{Gr(e.j,t,n)}))}var ko=class{constructor(e,t,n,i,s,c,d,l,h,A,y,w,C,T,R,k,O,P,D,L){var x,M,N,_,F,U,j,G,B,V,H,W,q,z,K,$,J,Q,Y,X,Z,ee;this.F=T,this.G=k,this.kb=O,this.ta=!1,this.Sa=new Set,this.v=0,this.yb=!1,this.S=!0,this.M=!1,this.J=0,this.L=new Lo,this.V=!1,this.K=0,this.ma=this.sa=!1,this.ha=this.ja=this.na=0,this.ya=this.xa="off",this.$=new Map,this.Z=new Map,this.ra=!1,this.qa=0,this.Ya=()=>{Pt.d("{8bacfa5}","{9c2578a}"),uo(this)},this.Xa=()=>{this.ra=!0},this.Wa=()=>{this.ra=!1},this.u=y,this.o=e,this.l=t,this.U=s,this.ib=w,this.T=C,this.g={Qa:t.clientWidth||window.screen.width,Ma:t.clientHeight||window.screen.height,Nf:1,Ra:0,Oa:0,videoWidth:0,videoHeight:0,Ec:0,offsetX:0,offsetY:0,la:1},s=window.zoneless,this.windowAddEventListener=null!==(M=null===(x=null==s?void 0:s.windowAddEventListener)||void 0===x?void 0:x.bind(window))&&void 0!==M?M:window.addEventListener.bind(window),this.windowRemoveEventListener=null!==(_=null===(N=null==s?void 0:s.windowRemoveEventListener)||void 0===N?void 0:N.bind(window))&&void 0!==_?_:window.removeEventListener.bind(window),this.documentAddEventListener=null!==(U=null===(F=null==s?void 0:s.documentAddEventListener)||void 0===F?void 0:F.bind(document))&&void 0!==U?U:document.addEventListener.bind(document),this.documentRemoveEventListener=null!==(G=null===(j=null==s?void 0:s.documentRemoveEventListener)||void 0===j?void 0:j.bind(document))&&void 0!==G?G:document.removeEventListener.bind(document),this.videoAddEventListener=null!==(W=null!==(V=null===(B=null==s?void 0:s.videoAddEventListener)||void 0===B?void 0:B.bind(t))&&void 0!==V?V:null===(H=null==s?void 0:s.documentAddEventListener)||void 0===H?void 0:H.bind(document))&&void 0!==W?W:t.addEventListener.bind(t),this.videoRemoveEventListener=null!==($=null!==(z=null===(q=null==s?void 0:s.videoRemoveEventListener)||void 0===q?void 0:q.bind(t))&&void 0!==z?z:null===(K=null==s?void 0:s.documentRemoveEventListener)||void 0===K?void 0:K.bind(document))&&void 0!==$?$:t.removeEventListener.bind(t),this.Pa=this.La.bind(this),this.Ua=this.Ta.bind(this),this.za=this.Ba.bind(this),this.va=this.jb.bind(this),this.ga=this.fa.bind(this),this.cb=this.Pb.bind(this),this.Za=this.Cb.bind(this),this.Ea=this.Ab.bind(this),this.bb=this.Ob.bind(this),this.N=this.Nb.bind(this),this.P=h,this.preventNavigation=!!d.preventNavigation,this.Db={Eb:r(this.u)?64:128,Jb:0,Kb:255,Ga:this.Bb.bind(this)},h=new class{constructor(){this.m=!1,this.j=0,this.l=Array(36);for(let e=0;e<this.g.length;e++)this.l[e]={eb:!1,x:0,y:0,captureTimestamp:0,gb:0,qc:0}}get g(){return this.l}get h(){return this.j}},this.h=new class{constructor(e,t,n,i,s,r,o,a,c,d){if(this.h=this.M=0,this.buffer=new ArrayBuffer(1150),this.Z=new DataView(this.buffer),this.l=new gs(309,"input_channel_v1"),this.ja=new ArrayBuffer(658),this.j=new DataView(this.ja),this.ha=new ArrayBuffer(100),this.v=0,this.U=this.ea,this.s=this.$,this.I=[],this.N=new Map,this.R=0,this.S=[],this.G=!1,this.T=(e,t)=>Math.round(e/t*65535),this.L=a,this.V=e,this.g=t,this.W=s,this.J=i,this.D=r,this.D.onmessage=e=>{if(e=new DataView(e.data),0===this.h){let t=e.getUint16(0,!0);526==t?(this.O=this.ba.bind(this),this.h=e.getUint16(2,!0)):(this.O=this.K.bind(this),this.h=t),2==this.h?this.g.m=!0:2<this.h&&(this.g.m=!0,this.U=this.fa,this.s=this.aa),Pt.i("{57a6a4d}","{68c4654}",this.h)}else this.O(e,0)},this.m=c,this.C=o,this.o=n,this.O=this.K.bind(this),this.j.setUint8(9,34),this.j.setUint32(10,24,!0),this.m&&(this.N=new Map,this.F=new gs(325,"input_channel_partially_reliable"),d))for(this.R=d.Qe,e=0;64>e;e++)((t=BigInt(1)<<BigInt(e))&d.Re)==t&&(this.S[e]=!0);(this.G=li)&&(this.P=new class{constructor(e){this.h=e,this.j=0,this.buffer=new ArrayBuffer(8388608),this.g=new ds(new DataView(this.buffer)),this.initialized=!1,this.l=[],this.h=e}initialize(e){rs(this.g,1314280009),is(this.g,1),is(this.g,0),os(this.g,0),this.params=e,this.j=Il(this.h),this.initialized=!0,Pt.d("{5eeca93}","{46ee72b}")}}(this.L),this.P.initialize({gg:!0}))}ba(e,t){var n=e.getUint16(t,!0);if(267===n)this.K(e,t+2);else switch(t=255&n){case 32:case 33:case 34:case 35:case 36:case 255:if(34===(n=t))switch(n=e.getUint32(1,!0)){case 267:this.K(e,5);break;case 17:if(us(t=e.getUint8(5))){n=t-6;var i=e.getUint8(8),s=e.getUint8(9);if(5===i&&1==(1&s)){t=e.getUint8(12)<<8;const r=e.getUint8(13)<<8;for(const o of this.I){i=t,s=r;const a=(e=o).O.get(n);void 0!==a&&Ar(e,a,i,s)}}else Pt.w("{57a6a4d}","{d8b7bec}",i,s,t)}else Pt.w("{57a6a4d}","{6135ec1}",t);break;default:Pt.w("{57a6a4d}","{25be6a3}",n)}else Pt.d("{57a6a4d}","{ba4ff6a}",n);break;default:Pt.w("{57a6a4d}","{aea35b8}",n)}}K(e,t){var n=e.getUint16(t,!0);if(1==n)if(6>(n=e.getUint16(t+2,!0)))Pt.e("{57a6a4d}","{1527181}",n);else{6<n&&Pt.w("{57a6a4d}","{78db114}",n),n=e.getUint16(t+4,!0);var i=e.getUint16(t+6,!0);e=e.getUint16(t+8,!0);for(const o of this.I){var s=i,r=e;const a=(t=o).ac.get(n);void 0!==a&&Ar(t,a,s,r)}}else Pt.w("{57a6a4d}","{c7cf6da}",n)}ea(e){0!==this.v&&(window.clearTimeout(this.v),this.v=0);var t=performance.now();this.M=t;for(var n=1,i=0;i<this.g.h;){n+=2;var s=this.g.g[i].gb;if(0<s){n+=19;for(var r=0;r<s;r++)n+=1+(this.g.g[i+r].eb?26:22);i+=s}else n+=this.g.g[i].eb?26:22,i++}(n+=e?2+e.byteLength:0)>this.buffer.byteLength?(n=new DataView(new ArrayBuffer(n)),this.o.dd++):n=new DataView(this.buffer,0,n),n.setUint8(0,255);var o=1;for(i=0;i<this.g.h;){if(s=o,o+=2,0<(r=this.g.g[i]).gb){var a=n,c=i,d=t,l=this.g.g[c],u=o;o+=19;for(let e=0;e<l.gb;++e){const t=this.g.g[c+e];a.setUint8(o,t.eb?26:22),o=ws(this,a,++o,t.eb,t.x,t.y,t.captureTimestamp)}c=u,u=o-u,l=l.qc,a.setUint8(c,32),a.setUint16(c+1,u,!1),Qi(d,a,c+3,!1,1e3),Qi(l,a,c+11,!1,1e3),i+=r.gb}else o=ws(this,n,o,r.eb,r.x,r.y,r.captureTimestamp),i++;n.setUint16(s,o-s-2)}if(this.g.j=0,e)for(n.setUint16(o,e.byteLength),o+=2,t=0;t<e.byteLength;t++)n.setUint8(o+t,e.getUint8(t));return n}fa(e){var t;if(e&&e.buffer!=this.buffer)return As(this),e;0!==this.v&&(window.clearTimeout(this.v),this.v=0),this.M=performance.now();for(var n=0,i=-1,s=0;s<this.g.h;s++)0<this.g.g[s].gb?(n+=9,i=this.g.g[s].gb):0===i&&(n+=9),n+=3+(this.g.g[s].eb?26:22),i--;if(n+=null!==(t=null==e?void 0:e.byteLength)&&void 0!==t?t:0,(t=9+n)>this.buffer.byteLength){if(t=new DataView(new ArrayBuffer(t),t-n,n),this.o.dd++,e)for(n=t.byteLength-e.byteLength,i=0;i<e.byteLength;i++)t.setUint8(n+i,e.getUint8(i))}else t=new DataView(this.buffer,this.buffer.byteLength-n,n);for(e=0,n=-1,i=0;i<this.g.h;i++)0<(s=this.g.g[i]).gb?(n=s.gb,t.setUint8(e,36),Qi(s.qc,t,e+1,!1,1e3),e+=9):0===n&&(t.setUint8(e,36),Qi(0,t,e+1,!1,1e3),e+=9),t.setUint8(e,33),t.setUint16(e+1,s.eb?26:22),e=ws(this,t,e+3,s.eb,s.x,s.y,s.captureTimestamp),n--;return this.g.j=0,t}$(e){return new vs(this.ha,0,e)}aa(e){e+=1;const t=this.buffer.byteLength-e;return e=new vs(this.buffer,t,e,1),this.Z.setUint8(t,34),e}sendTextInput(e){let t=0,n=new DataView(e,0,e.byteLength),i=new ArrayBuffer(1021);for(;t<e.byteLength;){let r;if(1016>=e.byteLength-t)r=e.byteLength-t;else{r=t+1016;var s=!1;for(let e=0;4>e;e++){if(128!=(192&n.getUint8(r))){s=!0;break}r--}if(!s){Pt.e("{57a6a4d}","{938b0d3}");break}r-=t}(s=new DataView(i,0,r+5)).setUint8(0,34),s.setUint32(1,23,!0),new Uint8Array(i).set(new Uint8Array(e,t,r),5),t+=r,As(this,s,!1)}}stop(){var e,t,n,i;if(0<this.D.bufferedAmount&&Pt.w("{57a6a4d}","{5e5b9e5}",this.D.bufferedAmount),this.m&&0<this.m.bufferedAmount&&Pt.w("{57a6a4d}","{3a88bc1}",this.m.bufferedAmount),this.G&&null!==(e=this.P)&&void 0!==e)try{const r=null!==(n=null===(t=e.params)||void 0===t?void 0:t.fileName)&&void 0!==n?n:"inputrecordfile";if(Di([e.buffer.slice(0,e.g.j)],`${r}.dat`,"application/octet-stream"),null!==(i=e.params)&&void 0!==i&&i.gg){var s=e.l;for(const e of s)e.header.recordedTs=Math.floor(1e3*e.header.recordedTs),e.data.captureTs&&(e.data.captureTs=Math.floor(1e3*e.data.captureTs));Di([JSON.stringify(e.l)],`${r}-events.json`,"application/json")}}catch(e){Pt.e("{5eeca93}","{45fa32c}",e)}}get ga(){return this.h}get da(){return this.M}vb(e){const t=ks(this,this.l,38,!0);t&&(Os(t,0,0,0,Ms([0,0,0,0]),0,e),Rs(this,this.l))}Wc(e,t,n,i,s,r,o){3>this.h||!(e=Ps(this,t)&&this.F?ks(this,this.F,38,!1,t):ks(this,this.l,38))||(r=Tl(this.L,r),Os(e,t,n,i,Ms(s),r,o))}$b(e,t,n,i,s=0){const r=ks(this,this.l,38,!0);r&&(Os(r,n,e,t,Ms(i),0,s),Rs(this,this.l))}Vc(){3>this.h||(As(this),Rs(this,this.l),this.F&&Rs(this,this.F))}Rc(){}yg(e){const t=ks(this,this.l,6,!0);t&&(t.setUint32(0,13,!0),t.setUint16(4,e?1:0,!1),Rs(this,this.l))}eg(e){Ds(this,4>e?e+6:0,1)}Jf(e){Ds(this,4>e?e+6:0,3)}Tc(e,t,n,i,s){if(!(3>this.h)&&(e=xs(this,t=4>t?t+6:0)&&this.F?ks(this,this.F,72,!1,4+t):ks(this,this.l,72))){let r=0;const o=!!(4&n),a=!!(2&n),c=!!(8&n),d=!!(1&n);o||a||c||d?d?r=c?1:o?7:0:a?r=c?3:o?5:4:c?r=2:o&&(r=6):r=8,Ls(e,t,[r|(16384&n?16:0)|(4096&n?32:0)|(8192&n?64:0)|(32768&n?128:0),0|(256&n?1:0)|(512&n?2:0)|(255&i?4:0)|(65280&i?8:0)|(32&n?16:0)|(16&n?32:0)|(64&n?64:0)|(128&n?128:0),0|(65536&n?1:0)|(131072&n?2:0)],[255&i,(65280&i)>>8],[127.5*(s[0]+1),127.5*(s[1]+1),127.5*(s[2]+1),127.5*(s[3]+1)])}}}(this,h,R,this.g,this.o,n,this.U,this.G,D,P),this.s=new class{constructor(e,t){this.Bc=0,this.ug=8,this.tb=this.sb=this.Ac=this.zc=0,this.pc=this.oc=!1,this.scale=12,this.jc="mousemove",this.ud="mousedown",this.Sd="mouseup",this.Sf=2,this.Tf=3,this.u=t,this.Te=e,this.wg=this.vg.bind(this),r(this.u)&&(this.Sf=0,this.Tf=1)}Wc(e,t,n,i,s){wr(this,n,i,s)}Tc(e,t,n,i,s){wr(this,n,i,s)}vg(){this.sb=Math.sign(this.sb)!=Math.sign(this.zc)?this.zc:this.sb+this.zc,this.tb=Math.sign(this.tb)!=Math.sign(this.Ac)?this.Ac:this.tb+this.Ac;var e=0;let t=0;if((1<=this.sb||-1>=this.sb)&&(e=Math.trunc(this.sb),this.sb-=e),(1<=this.tb||-1>=this.tb)&&(t=Math.trunc(this.tb),this.tb-=t),0!=e||0!=t){let n;e={movementX:e,movementY:t,isPrimary:!0},n="pointerrawupdate"==this.jc||"pointermove"==this.jc?new PointerEvent(this.jc,e):new MouseEvent("mousemove",e),this.Te.dispatchEvent(n)}}start(){this.Bc&&this.stop(),this.Bc=window.setInterval(this.wg,this.ug)}stop(){this.Bc&&(clearInterval(this.Bc),this.Bc=0)}reset(){this.oc&&Er(this,0,!1),this.pc&&Er(this,2,!1),this.sb=this.tb=this.zc=this.Ac=0,this.oc=this.pc=!1}vb(){}Vc(){}$b(){}Rc(){}}(this.l,this.u),this.j=new class{constructor(e,t,n,i,s,r,o,a,c,d,l,h){var A,b,S,y,w,C,T,R,k,O,P,D,L,x,M,N,_,F;this.P=e,this.R=t,this.H=n,this.Pa=s,this.u=r,this.M=o,this.ja=a,this.D=c,this.o=d,this.v=l,this.K=h,this.$=new Map,this.Z=Tr.map(Ir),this.S=this.m=0,this.Fb=!1,this.F=new Set,this.aa=this.La=this.s=this.da=this.J=this.W=!1,this.G=this.I=0,this.fa=!1,this.va={passive:!1},this.ba=!0,this.C=!1,this.N=this.L=0,this.U=null,this.O=void 0,this.Xa=()=>{this.N=0,kr(this)&&!Or(this)&&(this.Fb=!0,Pr(this))},i.onmessage=e=>Dr(this,e),this.l={Qa:n.clientWidth||window.screen.width,Ma:n.clientHeight||window.screen.height,Nf:1,Ra:0,Oa:0,videoWidth:0,videoHeight:0,Ec:0,offsetX:0,offsetY:0,la:1},e=window.zoneless,this.documentAddEventListener=null!==(b=null===(A=null==e?void 0:e.documentAddEventListener)||void 0===A?void 0:A.bind(document))&&void 0!==b?b:document.addEventListener.bind(document),this.documentRemoveEventListener=null!==(y=null===(S=null==e?void 0:e.documentRemoveEventListener)||void 0===S?void 0:S.bind(document))&&void 0!==y?y:document.removeEventListener.bind(document),this.videoAddEventListener=null!==(R=null!==(C=null===(w=null==e?void 0:e.videoAddEventListener)||void 0===w?void 0:w.bind(n))&&void 0!==C?C:null===(T=null==e?void 0:e.documentAddEventListener)||void 0===T?void 0:T.bind(document))&&void 0!==R?R:n.addEventListener.bind(n),this.videoRemoveEventListener=null!==(D=null!==(O=null===(k=null==e?void 0:e.videoRemoveEventListener)||void 0===k?void 0:k.bind(n))&&void 0!==O?O:null===(P=null==e?void 0:e.documentRemoveEventListener)||void 0===P?void 0:P.bind(document))&&void 0!==D?D:n.removeEventListener.bind(n),this.ma=this.qa.bind(this),this.Ba=this.ab.bind(this),this.sa=this.ra.bind(this),this.Ea=this.ib.bind(this),this.ta=this.Ya.bind(this),this.ya=this.bb.bind(this),this.za=this.cb.bind(this),this.oa=this.na.bind(this),this.pa=this.Wa.bind(this),this.xa=this.Za.bind(this),this.wa=this.$a.bind(this),this.ga=this.Ta.bind(this),this.ha=this.Ua.bind(this),this.ea=!!s.windowedStreaming,this.cursorType=null!==(x=null!==(L=function(){switch(Pn){case"hw":return 1;case"sw":return 0;case"free":return 2}}())&&void 0!==L?L:s.cursorType)&&void 0!==x?x:this.ea?2:0,Pt.i("{70cc40b}","{3277c0e}",this.cursorType),this.g={pb:!1,rd:0===this.cursorType&&!s.allowUnconfined,qb:0,rb:0,Ld:0,Md:0,style:"",cursor:this.Z[0]},this.h={ub:1,Sc:!1,Xc:!1,jd:!1},this.Ka=["image-set","-webkit-image-set"].find((e=>CSS.supports("cursor",`${e}(url(image.bmp) 2x) 0 0, auto`))),0===this.cursorType?(this.j=function(e){let t="canvasId1";var n=document.getElementById(t);if(n&&n instanceof HTMLCanvasElement&&n.parentElement===e.parentElement)return n;if(n)do{t="canvasId"+Math.round(1e4*Math.random()),n=document.getElementById(t)}while(n);return(n=document.createElement("canvas")).id=t,n.style.touchAction="none",n.style.pointerEvents="none",n.style.willChange="transform",e.insertAdjacentElement("afterend",n),n}(this.H),this.j.style.visibility="hidden",this.j.style.display="none"):this.j=document.createElement("canvas"),Lr(this),xr(this),this.W="onpointerrawupdate"in this.H,this.da=(this.J=xi())&&"getCoalescedEvents"in PointerEvent.prototype&&"Firefox"!==r.browser,Pt.i("{70cc40b}","{f30b8ee}",this.da?"supported":"not supported"),this.W&&(n=function(){const e=Mn.mouseCoalesceInterval;if(void 0!==e)return new Map([[0,0],[4,1],[8,2],[16,3]]).get(e)}(),void 0!==n?Mr(this,n):f(r)?Mr(this,3):Mr(this,1),Pt.i("{70cc40b}","{20be0c0}",this.G,void 0!==n?" (overridden)":"")),this.s=null!==(M=s.unadjustedMovement)&&void 0!==M?M:v(this.u)?!this.ea&&I(this.u,84,0,4147,78):f(this.u)||g(this.u)?I(this.u,86,0,4240,198):!!u(this.u),s=f(r)&&I(this.u,84,0,4147,94)&&!I(this.u,88,0,4324,139),s=v(this.u)||!s||!I(this.u,84,0,4147,94),(null!==(N=Qt)&&void 0!==N?N:s)?this.T=new class{constructor(){this.l=this.j=this.o=this.m=this.D=this.C=this.s=this.h=this.g=0,this.v=!1}Ze(){return this.g}$e(){return this.h}update(e,t,n){if(0===e&&0===t)return this.v?this.l=this.j=0:this.v=!0,!1;if(this.v=!1,0===this.j&&0===this.l){if(n<this.s)return this.j=e,this.l=t,!1}else e+=this.j,t+=this.l,this.l=this.j=0;var i=e*this.g+t*this.h,s=e*e+t*t,r=this.g*this.g+this.h*this.h,o=!0;if(.95>n-this.s&&0>i&&0!==r&&i*i>.81*s*r&&(i=Math.sqrt(s)/Math.sqrt(r),.5<(i=Math.abs(i-Math.trunc(i)))&&(i=1-i),.1>i&&(o=!1)),i=e-this.g,s=t-this.h,o&&(o=2*(r=1+.1*Math.max(1,Math.min(16,n-this.s)))*Math.abs(this.C),r=2*r*Math.abs(this.D),!(o=i*i+s*s<(r=Math.max(8100,o*o+r*r)))&&(this.m||this.o))){o=e-this.m;const n=t-this.o;o=o*o+n*n<r}return o?(this.C=.4*this.C+.6*i,this.D=.4*this.D+.6*s,this.g=e,this.h=t,this.s=n,this.o=this.m=0,!0):(this.m=e,this.o=t,!1)}}:this.T=new class{constructor(){this.y=this.x=0}Ze(){return this.x}$e(){return this.y}update(e,t){return this.x=e,this.y=t,!0}},["pointerlockchange","mozpointerlockchange"].forEach((e=>this.documentAddEventListener(e,this.xa))),["pointerlockerror","mozpointerlockerror"].forEach((e=>this.documentAddEventListener(e,this.wa))),Nc(this.v,0,this.ga),Nc(this.v,2,this.ha),p(this.u)||m(this.u)?this.V=!0:!E(r)||I(r,99,0,4844,44)||g(r)?this.V=!1:this.V=!0,1===this.cursorType&&Nr(this,1),this.jb=1===this.cursorType&&(null===(F=null!==(_=Dn)&&void 0!==_?_:Mn.pointerLockEscape)||void 0===F||F),this.kb=1===this.cursorType&&u(r),Pt.d("{70cc40b}","{ec7c4c5}")}uninitialize(){["pointerlockerror","mozpointerlockerror"].forEach((e=>this.documentRemoveEventListener(e,this.wa))),["pointerlockchange","mozpointerlockchange"].forEach((e=>this.documentRemoveEventListener(e,this.xa))),_c(this.v,0,this.ga),_c(this.v,2,this.ha),_r(this)}ab(e){to(e)||(e.preventDefault(),this.qa(e),2===this.cursorType&&this.H.setPointerCapture(e.pointerId))}qa(e){var t;null===(t=this.R.T)||void 0===t||2==t.g&&(Pt.i("{4c846ba}","{89b1a9f}"),bl(t),Al(t),Sl(t)),Fc(this.v,!0),this.Fb=!0,t=Tl(this.K,e.timeStamp),kr(this)&&!Or(this)?(Pr(this),this.g.pb&&(Fr(this,e.offsetX,e.offsetY),Ur(this),Is(this.o,this.g.qb,this.g.rb,t))):(this.kb&&this.g.pb&&(_r(this),this.N=window.setTimeout(this.Xa,500)),qt(Wt()),jr(this,e.button,t))}ib(e){to(e)||(e.preventDefault(),this.ra(e))}ra(e){qt(Wt()),Gr(this,e.button,Tl(this.K,e.timeStamp))}Ya(e){this.ea&&e.target!==this.H||(ys(this.o,e.deltaY,Tl(this.K,e.timeStamp)),e.preventDefault())}Wa(e){if(!to(e)){if(e.preventDefault(),-1!==e.button){let t;switch(e.button){case 1:t=2;break;case 2:t=1;break;default:t=e.button}const n=Tl(this.K,e.timeStamp);e.buttons&1<<t?jr(this,e.button,n):Gr(this,e.button,n)}this.na(e)}}na(e){Fr(this,e.offsetX,e.offsetY),Is(this.o,this.g.qb,this.g.rb,Tl(this.K,e.timeStamp))}bb(e){Br(this,e)}cb(e){const t=0<this.o.g.h;Br(this,e),!t&&0<this.o.g.h&&((e=performance.now()-this.o.da)>=this.G?As(this.o):function(e,t){e.v=window.setTimeout((()=>{e.v=0,As(e)}),t)}(this.o,this.G-e))}Ua(e){this.Fb=e,Pr(this),Kr(this)}Za(){if(document.pointerLockElement instanceof HTMLElement)this.U=null,this.O=void 0,this.m=2;else{var e=2===this.m;this.m=0,Qr(this);var t=()=>{Pt.i("{70cc40b}","{d4b3de3}"),this.Fb=!1,Kr(this)},n=this.P.Sa.has(27);this.jb&&e&&!n?this.L=window.setTimeout((()=>{t(),0!==this.L&&(Qr(this),lo(this.P,!0))}),50):(e&&t(),lo(this.P,!1))}}$a(){this.aa||(this.m=0,this.s?(this.s=!1,Pt.e("{70cc40b}","{7599808}"),Pr(this)):(Pt.e("{70cc40b}","{d633cd1}"),Kr(this)))}xb(){return this.C}Ta(e){e?(this.v.j&&(this.Fb=!0,Pr(this)),xr(this)):(Pr(this),0!==this.L&&(Qr(this),lo(this.P,!1)))}lc(e){this.ba!=e&&(Ur(this),this.ba=e)}}(this,e,t,i,d,y,this.s,R,h,this.h,this.F,this.G),l?$n||b()?(this.D=new class{constructor(e,t,n,i,s,r){this.target=e,this.videoAddEventListener=t,this.videoRemoveEventListener=n,this.N=i,this.j=s,this.v=r,this.o=this.m=0,this.F={nb:1,vertical:1},this.g=new Map,this.s=new Set,this.l=0,this.h=[],this.C=0,this.L=!0,this.K=e=>{const t=performance.now(),n=Tl(this.v,e.timeStamp);let i=!1;this.j.lc(!1);const s=e.changedTouches;let r=[];for(let n=0;n<s.length;n++){const a=s[n];if(a.target===this.target){i=!0,qt(Wt());var o=a;let n=0;for(;this.s.has(n);)n++;let s=new Hi(o,n,this.F);this.g.set(o.identifier,s),this.s.add(n),o=s,r.push(o),Qn&&this.h.push(new Wi(a,o.g,1,t,e.timeStamp))}}qi(this,r,1,n),Qn&&Yn&&8==this.g.size&&this.L&&(this.D(),this.M()),oo(this.j)&&i&&e.preventDefault()},this.J=e=>{const t=performance.now(),n=Tl(this.v,e.timeStamp);let i=!1;const s=e.changedTouches;let r=[];for(let n=0;n<s.length;n++){const o=s[n];if(o.target===this.target){let n=this.g.get(o.identifier);n&&(i=!0,n.update(o),r.push(n),Qn&&this.h.push(new Wi(o,n.g,4,t,e.timeStamp)))}}qi(this,r,4,n),oo(this.j)&&i&&e.preventDefault()},this.G=e=>{zi(this,e,8)},this.I=e=>{zi(this,e,2)},this.D=this.P.bind(this),this.M=this.O.bind(this)}P(){const e=this.h.length;if(e){var t=this.h[e-1].g-3e4,n=-1;for(let i=0;i<e&&this.h[i].g<t;i++)n=i;this.h.splice(0,n+1)}}O(){for(let e of this.h)Pt.d("{ec05004}","{3c6a946}",e.captureTs.toFixed(2),e.g.toFixed(2),e.id,e.h,e.s,e.j.toFixed(2),e.l.toFixed(2),e.m.toFixed(0),e.o.toFixed(0));this.h=[]}start(){this.l=0;const e={passive:!1};this.videoAddEventListener("touchstart",this.K,e),this.videoAddEventListener("touchmove",this.J,e),this.videoAddEventListener("touchcancel",this.G,e),this.videoAddEventListener("touchend",this.I,e),Qn&&(Pt.d("{ec05004}","{72764d2}",performance.now()),this.h=[],this.C=window.setInterval(this.D,6e4)),this.j.lc(!1)}stop(){Qn&&(this.C&&clearTimeout(this.C),this.D(),this.M()),this.g.size&&(qi(this,Array.from(this.g.values()),8,performance.now()),this.g.clear(),this.s.clear()),this.l&&Pt.w("{ec05004}","{10858ae}",this.l);const e={passive:!1};this.videoRemoveEventListener("touchstart",this.K,e),this.videoRemoveEventListener("touchmove",this.J,e),this.videoRemoveEventListener("touchcancel",this.G,e),this.videoRemoveEventListener("touchend",this.I,e)}}(this.l,this.videoAddEventListener,this.videoRemoveEventListener,this.h,this,this.G),Pt.i("{8bacfa5}","{60f3637}")):Pt.w("{8bacfa5}","{32104d3}"):Pt.i("{8bacfa5}","{6be89bf}"),!$n&&!b()||S(this.u)||(this.I=new class{constructor(e,t,n,i,s){this.target=e,this.videoAddEventListener=t,this.videoRemoveEventListener=n,this.j=i,this.o=s,this.h=[],this.g=this.m=this.l=0,this.D=e=>{let t=!1;const n=e.changedTouches,i=Tl(this.o,e.timeStamp);for(let e=0;e<n.length;e++){const s=n[e];s.target===this.target&&(t=!0,qt(Wt()),0===this.h.length?(this.g=1,this.l=window.setTimeout((()=>{this.l=0,1===this.m&&(this.g=2,Kn&&io(this.j,this.target,i,ji(s)))}),500)):1!==this.g&&(2===this.g||4===this.g?Kn&&so(this.j,i):6===this.g&&Kn&&ro(this.j),this.g=0),this.h.push(ji(s)),this.h.length>this.m&&(this.m=this.h.length))}oo(this.j)&&t&&e.preventDefault()},this.C=e=>{let t=!1;for(var n of this.h)n.deltaX=0,n.deltaY=0;n=e.changedTouches;const i=Tl(this.o,e.timeStamp);let s=[];for(let e=0;e<n.length;e++){const i=n[e],a=this.h.findIndex((e=>e.identifier==i.identifier));if(-1!=a){t=!0;var r=this.h[a],o=i.clientX-r.clientX;r=i.clientY-r.clientY;let e=!1;0!==this.l?(10<Math.abs(o)||10<Math.abs(r))&&(window.clearTimeout(this.l),this.l=0,e=!0):e=!0,e&&(o={identifier:i.identifier,clientX:i.clientX,clientY:i.clientY,deltaX:o,deltaY:r},s.push(a),this.h[a]=o)}}0<s.length&&0===this.l&&0!==this.g&&(1===this.h.length?(1===this.g?this.g=3:2===this.g&&(this.g=4),Kn&&function(e,t,n,i){1!==e.g.la||e.yb||void 0!==e.D?vo(e,e.g.offsetX+i.deltaX,e.g.offsetY+i.deltaY,e.g.la):To(e,t,i,n)}(this.j,this.target,i,this.h[0])):2===this.h.length?5===this.g?Kn&&this.j.scroll(this.target,i,this.h):6===this.g?Kn&&ao(this.j,this.h):1===this.g&&(0<this.h[0].deltaY*this.h[1].deltaY&&(Math.sign(this.h[0].deltaX)===Math.sign(this.h[1].deltaX)||10>Math.abs(this.h[0].deltaX)&&10>Math.abs(this.h[1].deltaX))?(this.g=5,Kn&&this.j.scroll(this.target,i,this.h)):(this.g=6,Kn&&ao(this.j,this.h))):this.g=0),oo(this.j)&&t&&e.preventDefault()},this.s=e=>{Gi(this,e,!1)},this.v=e=>{Gi(this,e,!0)}}start(){const e={passive:!Kn};this.videoAddEventListener("touchstart",this.D,e),this.videoAddEventListener("touchmove",this.C,e),this.videoAddEventListener("touchcancel",this.s,e),this.videoAddEventListener("touchend",this.v,e)}stop(){if(this.videoRemoveEventListener("touchstart",this.D),this.videoRemoveEventListener("touchmove",this.C),this.videoRemoveEventListener("touchcancel",this.s),this.videoRemoveEventListener("touchend",this.v),this.h=[],0!==this.l&&(window.clearTimeout(this.l),this.l=0),this.m=0,Kn)switch(this.g){case 6:ro(this.j);break;case 2:case 4:so(this.j,performance.now())}this.g=0}}(this.l,this.videoAddEventListener,this.videoRemoveEventListener,this,this.G)),this.O=c,this.ea=0,this.ab=v(this.u),this.oa=f(this.u),this.R=g(this.u),this.C="Android"===this.u.os,this.wa=a(this.u),e=u(this.u),t=!!d.windowedStreaming,Pt.i("{8bacfa5}","{fa2e72c}",t?"on":"off"),this.ab?(Pt.d("{8bacfa5}","{da5ae1d}"),this.aa=[20,144,145]):this.oa||"Linux"===this.u.os?(Pt.d("{8bacfa5}","{b7becf9}"),this.aa=[]):(Pt.d("{8bacfa5}","{098ce9c}"),this.aa=[20]),this.W=this.da=!1,PerformanceObserver?this.perf=new PerformanceObserver((e=>function(e,t){t.getEntriesByType("longtask").forEach((t=>{let n=Math.round(t.duration);var i,s,r=e.kb;r.h&&r.g&&(t={duration:{timestamp:t.startTime-(null!==(i=r.l.g)&&void 0!==i?i:0),duration:n},instanceId:r.instanceId},r.g.postMessage(t)),null===(s=e.o.h)||void 0===s||((r=s.g).K=Math.max(n,r.K)),Pt.i("{8bacfa5}","{7071359}",n)}))}(this,e))):this.perf=null,Nc(this.F,2,this.za),Pt.d("{8bacfa5}","{cc9c05b}"),window.ResizeObserver?(this.$a=new ResizeObserver((()=>{this.fa()})),this.$a.observe(this.l)):this.windowAddEventListener("resize",this.ga),(o(y)||m(y))&&window.IntersectionObserver&&(this.Ka=new IntersectionObserver((()=>{this.fa()}),{threshold:[1]}),this.Ka.observe(this.l)),this.l.addEventListener("resize",this.ga),this.windowAddEventListener("orientationchange",this.Ya),(y=window.visualViewport)&&(this.g.Ec=y.height,y.addEventListener("resize",this.cb)),this.m=A,this.h.I.push(this.m),this.m.v.add(this.U),ti&&this.m.m.push(this.Db),this.Ba(this.F.j),Nc(this.F,0,this.va),this.perf&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("longtask")&&this.perf.observe({entryTypes:["longtask"]}),Xn&&Wt().initialize(this.l,this.u),(S(this.u)||this.C||o(this.u))&&(this.textInputElement=L,this.C&&(this.xa=null!==(Q=null===(J=this.textInputElement)||void 0===J?void 0:J.getAttribute("autocapitalize"))&&void 0!==Q?Q:"off",this.ya=null!==(X=null===(Y=this.textInputElement)||void 0===Y?void 0:Y.getAttribute("autocorrect"))&&void 0!==X?X:"off",null===(Z=this.textInputElement)||void 0===Z||Z.setAttribute("autocapitalize","off"),null===(ee=this.textInputElement)||void 0===ee||ee.setAttribute("autocorrect","off"))),(An||ci&&(e||t))&&(function(e,t){if(t)for(const s of t){if(!(t=s.remote.code)||!(t=Ki.get(t)))continue;var n=s.remote.modifiers,i=[];1&n&&i.push(162),2&n&&i.push(164),4&n&&i.push(91),8&n&&i.push(160),n=i,i=s.local.key;const r=s.local.code;r?(i=Ki.get(r))&&e.Z.set(i,{tc:i,hc:s.local.modifiers,ld:Mo(),Yb:t,Zb:n}):i&&e.$.set(i,{Ed:i,hc:s.local.modifiers,ld:Mo(),Yb:t,Zb:n})}else for(n of no)n.Ed?e.$.set(n.Ed,n):n.tc&&e.Z.set(n.tc,n)}(this,d.streamingHotkeys),function(e){var t,n,i,s,r,o,a;for(const r of e.Z.values())Pt.i("{8bacfa5}","{e7c6e9b}",null===(t=r.tc)||void 0===t?void 0:t.toString(16),null===(n=r.hc)||void 0===n?void 0:n.toString(16),null===(i=r.Yb)||void 0===i?void 0:i.toString(16),null===(s=r.Zb)||void 0===s?void 0:s.map((e=>e.toString(16))));for(const t of e.$.values())Pt.i("{8bacfa5}","{b5e3a31}",t.Ed,null===(r=t.hc)||void 0===r?void 0:r.toString(16),null===(o=t.Yb)||void 0===o?void 0:o.toString(16),null===(a=t.Zb)||void 0===a?void 0:a.map((e=>e.toString(16))))}(this))}uninitialize(){var e,t,n,i,s,r,o,a;ho(this,!1);var c=this.l.paused;if(c=void 0!==c?c?"paused":"playing":"unknown",(this.l.paused||1>(null!==(e=this.l.currentTime)&&void 0!==e?e:1))&&nl(this.U,"VideoPaused",c,null===(t=this.l.currentTime)||void 0===t?void 0:t.toFixed(2)),Pt.i("{8bacfa5}","{fdc8bf7}",c,this.l.currentTime),null===(n=this.Ka)||void 0===n||n.disconnect(),null===(i=this.$a)||void 0===i||i.disconnect(),(e=this.m).o&&(e.vb(this.h,0),1>=e.ta.size)){for(var d of(t=!0,e.h))d&&(d.Fa.state=Ys(e,d.Fa.state,!0),rr(e,d.ca.index,!0,t),t=!1);Ws(e),e.j=0,e.o=0,e.g.ob=!1,e.gamepadPollInterval=100,or(e),e.h=[],e.R=!1}-1<(e=(d=this.h).I.indexOf(this.m))&&d.I.splice(e,1),this.toggleRsdmm(!1),this.m.v.delete(this.U),this.toggleUserInput(!1),this.h.stop(),this.perf&&this.perf.disconnect(),this.windowRemoveEventListener("resize",this.ga),this.windowRemoveEventListener("orientationchange",this.Ya),this.l.removeEventListener("resize",this.ga),null===(s=window.visualViewport)||void 0===s||s.removeEventListener("resize",this.cb),_c(this.F,2,this.za),this.V&&($s(this.m,this.P),this.P.Cc(this.l)),this.j.uninitialize(),null===(r=this.ba)||void 0===r||r.stop(),_c(this.F,0,this.va),po(this),null===(o=this.textInputElement)||void 0===o||o.setAttribute("autocapitalize",this.xa),null===(a=this.textInputElement)||void 0===a||a.setAttribute("autocorrect",this.ya),Pt.d("{8bacfa5}","{b6b2756}")}$b(){Es(this.h)&&this.m.$b()}fa(){var e,t=this.l;if(!(0>=t.videoWidth||0>=t.videoHeight)){var n=0,i=0;if(t.clientWidth/t.clientHeight>t.videoWidth/t.videoHeight){var s=t.clientHeight/t.videoHeight,r=t.videoWidth*s,o=t.videoHeight*s;i=(t.clientWidth-r)/2}else s=t.clientWidth/t.videoWidth,r=t.videoWidth*s,o=t.videoHeight*s,n=(t.clientHeight-o)/2;var a=1,c=1;this.g.Qa&&this.g.Ma&&(a=r/this.g.Qa,c=o/this.g.Ma),this.g.Qa=r,this.g.Ma=o,this.g.Nf=s,this.g.Oa=n,this.g.Ra=i,this.g.videoWidth=t.videoWidth,this.g.videoHeight=t.videoHeight,vo(this,this.g.offsetX*a,this.g.offsetY*c,this.g.la),Hr(this.j,this.g),null===(e=this.D)||void 0===e||(t=this.g,n=this.l.getBoundingClientRect(),s=this.g.la,e.F={nb:n.left+window.pageXOffset+this.g.Ra*this.g.la,vertical:n.top+window.pageYOffset+this.g.Oa*this.g.la},e.m=65535/t.Qa,e.o=65535/t.Ma,e.m/=s,e.o/=s),e=this.T,t=this.g.Ra,e.Oa=this.g.Oa,e.Ra=t,uo(this)}}Pb(){this.g.Ec=window.visualViewport.height,vo(this,this.g.offsetX,this.g.offsetY,this.g.la)}Cb(){Pt.d("{8bacfa5}","{b6fbd34}"),history.pushState(null,document.title,location.href)}La(e){var t,n;let i=this.ra;this.sa=!1;const s=Tl(this.G,e.timeStamp);if(this.F.h){(function(e,t){var n;if(null!==(n=Yc(e.o))&&void 0!==n&&n.isVisible())return!1;if(e.oa)switch(t.code){case"Tab":return!t.altKey;case"ZoomToggle":case"SelectTask":case"BrightnessDown":case"BrightnessUp":case"AudioVolumeMute":case"AudioVolumeDown":case"AudioVolumeUp":return!1}return!0})(this,e)&&e.preventDefault();var r,o=!(!this.R||!this.ma)&&"CapsLock"==e.code;o&&(i=i||o),fo(this,e),!(r="CapsLock"==e.code&&("Alphanumeric"==e.key||"Katakana"==e.key||"Hiragana"==e.key))&&(r="KanaMode"==e.code)&&(r="Hiragana"==(r=e.key)||"Katakana"==r||"Romaji"==r||"KanaMode"==r),r=!!r;var a="Lang1"==e.code||"HangulMode"==e.key;if(i=i||r||a,!this.aa.includes(e.keyCode)||r||o)if(0===(o=o?160:go(this,e)))this.ta=!0,this.O.emit("TextComposition",{compositionText:e.key,imeRecommendation:!0});else if(this.ta&&(this.ta=!1,this.O.emit("TextComposition",{compositionText:""})),!this.Sa.has(o)){this.Sa.add(o),r=!1;var c=Yc(this.o);if(a=void 0,187==o){var d;if(null===(d=(r=this.o).T)||void 0===d)var l=0;else 1==d.g?(Pt.i("{4c846ba}","{1f67b97}"),d.g=2,l=!0):l=!1;l?(Ad(r,{latencyTrigger:!0}),r=!0):r=!1,r=!r}else if(e.ctrlKey&&e.altKey)if(!Kt&&!Jt||119!=o&&219!=o)if(Kt)switch(o){case 48:var u="UNSUPPORTED";if((l=this.j).W)switch(Mr(l,(l.I+1)%4),l.I){case 1:u="4ms";break;case 2:u="8ms";break;case 3:u="16ms";break;default:u="OFF"}Xc(l.R,"Non-vsync mouse events: "+u),Pt.i("{70cc40b}","{bac28ff}",u);break;case 49:this.o.Db();break;case 56:this.o.sendCustomMessage({messageType:"GpuViewStartRequest",messageRecipient:"GPUViewTraceControl",data:"GpuView"}),Pt.i("{93c7910}","{0915cd3}");break;case 68:var h;null===(h=(l=this.o).T)||void 0===h?u=0:0==h.g?(h.g=1,Pt.i("{4c846ba}","{008dc86}"),Al(h),Sl(h),u=!0):u=!1,u&&Ad(l,{pcmDumpTrigger:!0});break;case 71:this.Cc();break;case 76:null==c||qa(c,!c.isVisible()),Pr(this.j);break;case 83:Mc(this.T);break;case 115:(l=this.o).ra?(wc(l.D),l.ra=!1,kd(l),Xc(l,"Profiler: OFF, Stats: OFF")):(md(l),Od(l),Xc(l,"Profiler: ON, Stats: ON"));break;case 116:Rd(l=this.o)?(kd(l),Xc(l,"Stats: OFF")):(Od(l),Xc(l,"Stats: ON"));break;case 117:this.o.toggleOnScreenStats(e.shiftKey);break;case 118:case 192:(l=this.o).perfIndicator=!l.perfIndicator,Ad(l,{perfIndicator:{on:l.perfIndicator}});break;case 120:(l=this.j).s=!l.s,Xc(l.R,"UnadjustedMovement: "+(l.s?"ON":"OFF")),Pt.i("{70cc40b}","{796c5cb}",l.s?"ON":"OFF");break;case 189:this.S=!this.S,Xc(this.o,"Position dependent keys: "+(this.S?"ON":"OFF")),Pt.i("{8bacfa5}","{61d2ab5}",this.S?"ON":"OFF");break;case 77:this.o.na();break;default:r=!0}else r=!0;else this.o.toggleStutterIndicator();else{e:{if((e.ctrlKey||e.shiftKey||e.metaKey||e.altKey)&&((a=this.Z.get(o))||(a=this.$.get(e.key)),a)){128==(d=a.hc)&&(d=this.R?4:1),h=e.ctrlKey;const t=e.altKey,n=e.metaKey,i=e.shiftKey;if((1&d?h:!h)&&(2&d?t:!t)&&(4&d?n:!n)&&(8&d?i:!i))break e}a=void 0}if(a){for(l of(c=mo(this,e),a.ld))c!=(d=c&~No(l))&&(c=d,Ts(this.h,4,l,c,s)),this.Sa.delete(l);for(u of a.Zb)c|=No(u),Ts(this.h,3,u,c,s);for(var p of(Ts(this.h,3,a.Yb,c,s),Ts(this.h,4,a.Yb,c,s),a.Zb))c&=~No(p),Ts(this.h,4,p,c,s);this.Sa.delete(o)}else if(null!=c&&c.isVisible())if(13==o)c.toggle(),Pr(this.j);else if(82==o)c.reset(),Pr(this.j);else if(65==o)Ha(c,!c.bc.checked);else if(83==o)if(c.fc.length){for(l=`LDAT_${(new Date).toISOString()}.csv`,u=["Sample #,Total,Render,Decode,Begin,Server + Rtd + Receive,Input Callback"],p=0;p<c.fc.length;p++)d=Xa(c.fc[p]),u.push([p,d.total,d.Kf,d.decode,d.He,d.Of,d.ff].join());Di([u.join("\n")],l,"text/plain")&&Pt.i("{50c79eb}","{690879e}",l)}else Pt.w("{50c79eb}","{2884507}");else 67==o?(Pt.i("{50c79eb}","{d2811a7}"),c.Ub.value="50",c.Vb.value="50",Za(c,.5,.5)):77==o?c.zb.checked=!c.zb.checked:r=!0;else r=!0}r&&(qt(Wt()),Ts(this.h,3,o,mo(this,e),s)),"Hankaku"!=e.key&&"Zenkaku"!=e.key||192!=o||(i=!0),this.R&&e.metaKey&&!a&&(i=!0),this.C&&("Backspace"==e.code&&(i=!0),""==e.code&&"Enter"==e.key&&(r=new CompositionEvent("compositionend",{data:null===(t=this.textInputElement)||void 0===t?void 0:t.value}),null===(n=this.textInputElement)||void 0===n||n.dispatchEvent(r))),i&&(Ts(this.h,4,o,mo(this,e),s),this.Sa.delete(o))}}}Ta(e){let t=!1;const n=Tl(this.G,e.timeStamp);if(this.C&&""==e.code&&"Unidentified"==e.key&&!this.sa)Ts(this.h,3,8,0,n),Ts(this.h,4,8,0,n);else{var i=!(!this.R||!this.ma)&&"CapsLock"==e.code;i&&(t=t||i),fo(this,e),(!this.aa.includes(e.keyCode)||i)&&(i=i?160:go(this,e),t&&(Ts(this.h,3,i,mo(this,e),n),this.Sa.add(i)),this.Sa.has(i)&&(this.Sa.delete(i),qt(Wt()),Ts(this.h,4,i,mo(this,e),n)))}}Ba(e){Pt.d("{8bacfa5}","{77df54c}",e?"fullscreen":"not fullscreen"),this.fa({}),e?(window.isSecureContext&&(e=window.navigator.keyboard)&&e.lock&&e.lock("Escape F11 BrowserBack BrowserForward BrowserRefresh BrowserHome BrowserFavorites BrowserSearch BrowserStop Sleep Power WakeUp KeyT KeyZ Slash Digit1 Digit2 Digit3 Digit4 Digit5 Digit6 Digit7 Digit8 Digit9 KeyM KeyD KeyN KeyS KeyK KeyL Space PrintScreen LaunchApp1 LaunchApp2 LaunchMail Comma Semicolon ArrowLeft ArrowRight BracketLeft BracketRight KeyW KeyQ KeyR KeyY KeyO KeyP KeyF KeyG".split(" ")),this.l.onclick=null,this.l.removeAttribute("controls")):(Ao(this),Xr(this.j),window.isSecureContext&&(e=window.navigator.keyboard)&&e.unlock&&e.unlock())}toggleUserInput(e,t){if(Pt.d("{8bacfa5}","{2424824}",e,t),t=t??15,e){var n,i,s,r,a,c,d=!this.xb(),l=(this.v^t)&t;if(l){if(this.v|=l,4&l&&(this.M?(Js(this.m,this.s),this.s.start()):(this.s.stop(),this.s.reset(),Js(this.m,this.h))),1&l){var u=this.j;if(!u.C){if(u.C=!0,!o(u.u)){if(2==u.cursorType&&u.J){var h=u.M;h.ud="pointerdown",h.Sd="pointerup",u.videoAddEventListener("pointerdown",u.Ba),u.videoAddEventListener("pointerup",u.Ea)}else(h=u.M).ud="mousedown",h.Sd="mouseup",u.videoAddEventListener("mousedown",u.ma),u.videoAddEventListener("mouseup",u.sa);"Xbox"===u.u.os||u.videoAddEventListener("contextmenu",Rr)}u.documentAddEventListener("wheel",u.ta,u.va),Yr(u),0===u.cursorType&&(u.j.style.display="block"),Pr(u),Kr(u)}}2&l&&(this.documentAddEventListener("keydown",this.Pa),this.documentAddEventListener("keyup",this.Ua),null===(n=this.textInputElement)||void 0===n||n.addEventListener("input",this.bb),null===(i=this.textInputElement)||void 0===i||i.addEventListener("compositionstart",this.N),null===(s=this.textInputElement)||void 0===s||s.addEventListener("compositionupdate",this.N),null===(r=this.textInputElement)||void 0===r||r.addEventListener("compositionend",this.N),this.K=0,this.wa&&(null===(a=this.textInputElement)||void 0===a||a.addEventListener("focus",this.Xa),null===(c=this.textInputElement)||void 0===c||c.addEventListener("blur",this.Wa))),8&l&&(this.D&&!this.yb?this.D.start():this.I&&this.I.start()),d&&this.preventNavigation&&!this.W&&(this.W=!0,history.pushState(null,document.title,location.href),this.windowAddEventListener("popstate",this.Za))}}else{var p,f;(s=this.v&t)&&(this.v^=s,n=!this.xb(),4&s&&(this.M?($s(this.m,this.s),this.s.stop(),this.s.reset()):$s(this.m,this.h)),1&s&&((i=this.j).C&&(Xr(i),i.C=!1,o(i.u)||(2==i.cursorType&&i.J?(i.videoRemoveEventListener("pointerdown",i.Ba),i.videoRemoveEventListener("pointerup",i.Ea)):(i.videoRemoveEventListener("mousedown",i.ma),i.videoRemoveEventListener("mouseup",i.sa)),"Xbox"===i.u.os||i.videoRemoveEventListener("contextmenu",Rr)),i.documentRemoveEventListener("wheel",i.ta,i.va),Zr(i),0===i.cursorType&&(i.j.style.display="none"),Pr(i),Kr(i),Qr(i))),2&s&&(Ao(this),this.documentRemoveEventListener("keydown",this.Pa),this.documentRemoveEventListener("keyup",this.Ua),null===(d=this.textInputElement)||void 0===d||d.removeEventListener("input",this.bb),null===(u=this.textInputElement)||void 0===u||u.removeEventListener("compositionstart",this.N),null===(l=this.textInputElement)||void 0===l||l.removeEventListener("compositionupdate",this.N),null===(h=this.textInputElement)||void 0===h||h.removeEventListener("compositionend",this.N),this.wa&&(null===(p=this.textInputElement)||void 0===p||p.removeEventListener("focus",this.Xa),null===(f=this.textInputElement)||void 0===f||f.removeEventListener("blur",this.Wa))),8&s&&(this.I&&this.I.stop(),this.D&&this.D.stop(),0!==this.J&&bo(this),(i=this.L).Ga=void 0,Po(i)),n&&this.preventNavigation&&this.W&&(this.windowRemoveEventListener("popstate",this.Za),history.back(),this.W=!1))}}xb(){return 0!==this.v}Bb(){const e=performance.now();e<this.qa+500?(this.qa=0,this.toggleRsdmm(!this.M)):this.qa=e}toggleRsdmm(e){ei&&e!=this.M&&(e?(Js(this.m,this.s),$s(this.m,this.h),this.s.start()):(this.s.stop(),this.s.reset(),Js(this.m,this.h),$s(this.m,this.s)),this.M=e)}Yc(){return this.M}jb(e){e?(uo(this),Pt.d("{8bacfa5}","{cb19d31}")):(Pt.d("{8bacfa5}","{8744dbe}"),Ao(this),Xr(this.j))}Ab(){this.da&&So(this)}getVirtualGamepadHandler(){return this.m.getVirtualGamepadHandler()}sendTextInput(e){this.h.sendTextInput(e)}Nb(e){switch(e.type){case"compositionstart":this.K=1;break;case"compositionupdate":!o(this.u)&&Eo(e.data)||this.O.emit("TextComposition",{compositionText:e.data,imeRecommendation:!0});break;case"compositionend":const t=this.C?e.data.trim():e.data;t.length&&(e=o(this.u)||!Eo(e.data),this.C&&!e?Io(this,t):wo(this,t),e&&this.O.emit("TextComposition",{compositionText:""})),this.K=0}}Ob(){this.sa=!0;let e=this.textInputElement.value;1==this.K&&(this.C&&1<e.length&&(e=e.charAt(e.length-1)),this.K=2),this.C&&Eo(e)?(Io(this,e),this.K=0):2!=this.K&&wo(this,e)}setVirtualKeyboardState(e){Pt.i("{8bacfa5}","{60b2d45}",e),this.yb!==e&&(this.yb=e,this.I&&this.D&&(this.yb?(this.D.stop(),this.I.start()):(this.I.stop(),1!==this.g.la&&vo(this,0,0,1),this.D.start())))}setKeyboardLayout(e){this.ma="zh-TW"==e}scroll(e,t,n){0<n.length&&ys(this.h,Math.sign(n[0].deltaY),t)}sendKeyEvent(e){Es(this.h)&&(go(this,e)?"keydown"===e.type?this.La(e):"keyup"===e.type&&this.Ta(e):"keydown"===e.type&&1===e.key.length&&(e=(new TextEncoder).encode(e.key),this.sendTextInput(e.buffer)))}lc(e){this.j.lc(e)}Cc(){Kt&&(this.V=!this.V,this.P.Cc(this.l),this.V?Js(this.m,this.P):$s(this.m,this.P))}startInputPlayback(e){var t;this.ba||(this.ba=new class{constructor(e,t){this.h=!0,this.m=e,this.o=t}l(e){var t=e.data;if(t.input)e:{e=this.m,t=t.input,void 0===e.playbackBuffer&&(e.playbackBuffer=new gs(1150,"input_channel_v1"));let o="input_channel_v1";for(let a=0;a<t.length;a++){var n=t[a],i=n.header.packetId,s=void 0;switch(n.header.packetId){case 12:var r=n.data.index;Ps(e,r)&&(s=r);break;case 17:xs(e,r=n.data.id)&&(s=r)}if(void 0!==s&&(o="input_channel_partially_reliable"),!(s=ks(e,e.playbackBuffer,ms(i),!1,s)))break e;switch(i){case 4:case 3:Cs(s,i,(n=n.data).keycode,n.flags,n.captureTs);break;case 8:case 9:bs(s,i,(n=n.data).data1,n.captureTs);break;case 7:case 5:i=n.data,ws(e,s,0,5==n.header.packetId,i.xpos,i.ypos,i.captureTs,!0);break;case 10:Ss(s,(i=n.data).vwheel,i.captureTs);break;case 12:Os(s,(i=n.data).index,i.buttons,i.trigger,i.axes,i.captureTs,i.bitmap);break;case 18:i=(n=n.data).id,n=n.control,s.setUint32(0,18,!0),s.setUint8(4,i),s.setUint8(5,n),s.setUint32(6,1);break;case 17:us((i=n.data).id)&&(n=i.data,Ls(s,i.id,n.ds4Btns,n.triggers,n.axes))}}Rs(e,e.playbackBuffer,o)}else t.result?Pt.d("{5eeca93}","{6ab9f7d}",t.result):t.log&&Pt.d("{59381ac}","{0b0c6f9}",t.log)}j(){}stop(){var e;null===(e=this.g)||void 0===e||e.terminate()}start(){var e;if(this.playbackBuffer){var t={start:{playbackBuffer:this.playbackBuffer,loop:this.h,absStreamBeginTs:performance.timeOrigin+this.o.g}};Pt.d("{5eeca93}","{8a97b19}"),null===(e=this.g)||void 0===e||e.postMessage(t)}}initialize(e){if(8>e.buffer.byteLength)return Pt.e("{5eeca93}","{fbe135e}"),!1;var t=new DataView(e.buffer,0,8);const n=t.getUint32(0),i=t.getInt8(4);if(t=t.getInt8(5),1314280009!=n||1!=i||0!=t)return Pt.e("{5eeca93}","{9946103}"),!1;try{this.g=ls('\nfunction g(a){const c=a.h.getUint8(a.g);a.g++;return c}function m(a){var c=a.h.getUint16(a.g,!1);a.g+=2;return c}function r(a){var c=a.h.getUint32(a.g,!1);a.g+=4;return c}function v(a){var c=a.h,n=a.g;let e;e=c.getUint32(n,!1);c=c.getUint32(n+4,!1);a.g+=8;return 4294967296*e+c}function y(a,c){if(!(c>a.h.byteLength-a.g)){var n=new z(new DataView(a.h.buffer,a.h.byteOffset+a.g,c));c=a.g+c;0<=c&&c<=a.h.byteLength&&(a.g=c);return n}}var z=class{constructor(a){this.g=0;this.h=a}done(){return this.g===this.h.byteLength}};const B=self;function C(a,c){return 0<c?a.g+c:0}async function D(a,c,n){const e=n-(performance.timeOrigin+performance.now()-a.absStreamBeginTs);0<e&&await new Promise(b=>setTimeout(b,e));0<c.length&&B.postMessage({input:c})}\nasync function E(a,c,n=!1){do{a.g=performance.timeOrigin+performance.now()-a.absStreamBeginTs;const q=new z(c);let w=[],u=0;for(;!q.done();){var e=y(q,16);if(void 0===e)return B.postMessage({log:"{76ef155}16{0da0ef8}"+(q.h.byteLength-q.g)}),!1;var b=e;e=v(b)/1E3;var d=r(b);b=r(b);e={recordedTs:e,packetId:d,size:b};b=y(q,e.size);if(void 0===b)return B.postMessage({log:"{fbf3a80}"+e.size+"{0da0ef8}"+(q.h.byteLength-q.g)}),!1;var f=void 0;d=a;switch(e.packetId){case 3:case 4:var l=b;b=m(l);f=m(l);var h=\nm(l);d=C(d,v(l)/1E3);f={keycode:b,flags:f,scancode:h,captureTs:d};break;case 8:case 9:case 10:case 5:case 7:var k=b;b=m(k);f=m(k);h=m(k);l=m(k);var x=m(k),p=r(k),A=m(k),t=m(k);d=C(d,v(k)/1E3);f={flags:b,xpos:f,ypos:h,data1:l,data2:x,windowHandle:p,vwheel:A,hwheel:t,captureTs:d};break;case 12:p=b;b=m(p);f=m(p);h=m(p);l=m(p);x=[0,0,0,0];for(k=0;4>k;k++){A=k;t=p;const F=t.h.getInt16(t.g,!1);t.g+=2;x[A]=F}d=C(d,v(p)/1E3);f={index:b,bitmap:f,buttons:h,trigger:l,axes:x,captureTs:d};break;case 18:d=g(b);\nb=g(b);f={id:d,control:b};break;case 17:if(f=void 0,d=g(b),6<=d&&9>=d){f=[0,0,0,0];for(h=0;4>h;h++)f[h]=g(b);h=[0,0,0];h[0]=g(b);h[1]=g(b);h[2]=g(b);l=[0,0];l[0]=g(b);l[1]=g(b);f={id:d,data:{ds4Btns:h,axes:f,triggers:l}}}}(d=f)?(b=a.g+e.recordedTs,0<u&&b>u&&(await D(a,w,u),w=[]),w.push({header:e,data:d}),u=b):B.postMessage({log:"{20d711f}"+e.packetId})}await D(a,w,u)}while(n);return!0}\nasync function G(a){var c=H;a.start&&(a=a.start,c.absStreamBeginTs=a.absStreamBeginTs,c={result:await E(c,a.playbackBuffer,a.loop)},B.postMessage(c))}class I{constructor(){this.g=this.absStreamBeginTs=0}}let H=new I;B.onmessage=async a=>{G(a.data)};\n\n//# sourceMappingURL=inputplaybackworker.js.map\n',"inputplaybackworker.js",hs),this.g.onmessage=this.l.bind(this),this.g.onerror=this.j.bind(this)}catch(e){return Pt.e("{5eeca93}","{cb06694}",e.message),!1}return this.playbackBuffer=new DataView(e.buffer,8,e.buffer.byteLength-8),this.h=e.loop,!0}}(this.h,this.G)),null!==(t=this.ba)&&void 0!==t&&t.initialize(e)&&this.ba.start()}};function Oo(e){e.h=!0,Po(e),Do(e),e.h=!1}function Po(e){0!==e.g&&(window.clearTimeout(e.g),e.g=0)}function Do(e){const t=e.Ga;t&&(e.Ga=void 0,t())}class Lo{constructor(){this.g=0,this.h=!1}delay(e){this.h?e():(Oo(this),this.Ga=e,this.g=window.setTimeout((()=>{this.g=0,Do(this)}),xo))}}var xo=30;function Mo(){let e=[];return e.push(162),e.push(163),e.push(164),e.push(165),e.push(91),e.push(92),e.push(160),e.push(161),e}function No(e){switch(e){case 162:case 163:return 2;case 164:case 165:return 4;case 91:case 92:return 8;case 160:case 161:return 1}return 0}function _o(e){return e.qualityScore=3*e.qualityScore/4+Math.min(e.latencyScore,e.networkLossScore,e.bandwidthScore)/4,{latencyScore:e.latencyScore,networkLossScore:e.networkLossScore,bandwidthScore:e.bandwidthScore,qualityScore:e.qualityScore}}function Fo(){return!1===$t?Promise.resolve(0):window.navigator.permissions?window.navigator.permissions.query({name:"microphone"}).then((e=>{let t=2;return"granted"==(e=e.state)?t=5:"prompt"==e&&(t=1),t})).catch((()=>0)):Promise.resolve(0)}function Uo(e,t,n=!0){e.h=t,3===e.h&&(e.M=!0),e.I&&n&&e.I.emit("MicCapture",{state:e.h})}function jo(e){if(e.initialized)if(Jo){e.o=!1,e.paused=!0,e.K=void 0;var t=e.h;if(navigator.mediaDevices.ondevicechange=()=>{},e.C){Pt.d("{223689a}","{6faf5bb}");let i=Wo();var n=e.C.getSenders()[0];n?n.replaceTrack(i.getTracks()[0]).then((()=>{Pt.d("{223689a}","{797fa55}"),Uo(e,5,!1),3===t&&(e.D=!0)})).catch((t=>{Pt.e("{223689a}","{79f26cc}",t),Uo(e,7,!1)})).finally((()=>{let t=e.g;e.g=null,t&&t.getTracks().forEach((e=>{e.stop()})),Uo(e,e.h),o(e.u)&&!C(e.u,!1,15,4)&&e.j()})):(Pt.e("{223689a}","{f7f0250}"),e.g=null)}else Pt.e("{223689a}","{9e75fa2}"),Uo(e,0)}else Uo(e,6)}function Go(e,t){var n;e.m=!0,e.s.set(t,(null!==(n=e.s.get(t))&&void 0!==n?n:0)+1),Pt.d("{223689a}","{30f8637}",t)}async function Bo(e,t){return e.v=!0,navigator.mediaDevices.getUserMedia({audio:t}).then((t=>{if(Pt.d("{223689a}","{b204737}"),Uo(e,5,!1),e.v=!1,e.g=t,o(e.u)&&(t.getTracks()[0].onended=()=>{e.N=performance.now(),Pt.i("{223689a}","{6b60d82}"),jo(e)}),e.g.oninactive=()=>{Pt.d("{223689a}","{eee54f1}"),e.J.clear(),e.g=null},e.paused)Pt.d("{223689a}","{21e76e1}"),e.g=null,Uo(e,7);else{var n=e.C.getSenders()[0];n?n.replaceTrack(t.getTracks()[0]).then((()=>{var t;Pt.i("{223689a}","{6c92139}");const n=null!==(t=e.Da)&&void 0!==t?t:e.H;if(o(e.u)&&!C(e.u,!1,15,4)&&n&&!n.muted){let t;n.srcObject&&(t=n.play(),Pt.i("{223689a}","{23a6493}",n.tagName)),t?t.then((()=>{Pt.d("{223689a}","{5593cbe}"),e.j()})).catch((t=>{e.j();try{nl(e.L,"WAR: Play Error",null==t?void 0:t.name,null==t?void 0:t.message),Pt.e("{223689a}","{69aae72}",null==t?void 0:t.name,null==t?void 0:t.message)}catch{}})):Pt.e("{223689a}","{b6a6508}")}Uo(e,3),e.D=!1,C(e.u,!1,15,4)&&(e.m=!1,e.G=!1)})).catch((t=>{Pt.e("{223689a}","{5c42246}",t),e.g=null,Uo(e,7)})):(Pt.e("{223689a}","{f7f0250}"),e.g=null)}})).catch((n=>{var i,s;o(e.u)&&!C(e.u,!1,15,4)&&e.j(),e.v=!1,n instanceof DOMException&&"NotAllowedError"===n.name?(Pt.e("{223689a}","{3f9bd66}"),Uo(e,2),e.G&&!e.m&&Go(e,"permissionDenied")):n instanceof DOMException&&"NotFoundError"===n.name?(Pt.e("{223689a}","{7f04869}"),Uo(e,4)):(n instanceof DOMException&&"NotReadableError"===n.name?(e.J.add(null!==(i=t.deviceId)&&void 0!==i?i:"default"),Pt.e("{223689a}","{af7e08c}",null!==(s=t.deviceId)&&void 0!==s?s:"default",n.name,n.message),navigator.mediaDevices.enumerateDevices().then((n=>{for(const i of n)if("audioinput"===i.kind&&"default"!==i.deviceId&&!e.J.has(i.deviceId)){Pt.d("{223689a}","{655d8b0}",i.deviceId,i.label),t.deviceId=i.deviceId,Bo(e,t);break}})).catch((e=>{Pt.e("{223689a}","{930e826}",e.name,e.message)}))):Pt.e("{223689a}","{c361fc5}",n.name,n.message),Uo(e,7))}))}async function Vo(e,t){var n,i;e.initialized&&(Jo?(e.o=!0,null!=e.g||e.v||(Pt.d("{223689a}","{981c872}",null!==(n=null==t?void 0:t.deviceId)&&void 0!==n?n:"default"),e.K=t,e.paused=!1,Uo(e,1,!1),t={sampleRate:48e3,deviceId:null===(i=e.K)||void 0===i?void 0:i.deviceId},f(e.u)&&(t.googAutoGainControl2=!1),navigator.mediaDevices.ondevicechange=()=>{Pt.i("{223689a}","{50d0169}",!!e.g,e.v),null!=e.g||e.v||(Pt.d("{223689a}","{c849290}"),Vo(e,e.K))},await Bo(e,t),e.F||Ho(e))):(Pt.e("{223689a}","{999b07b}"),Uo(e,6)))}function Ho(e){return navigator.mediaDevices.enumerateDevices().then((t=>{let n=0;Pt.d("{223689a}","{fa1ec18}",JSON.stringify(t));for(const e of t)"audioinput"==e.kind&&n++;switch(n){case 0:e.F="No Audio Input",e.l.Jd++;break;case 1:e.F="Built-in Microphone",e.l.pd++;break;default:e.F="Headset Microphone",e.l.zd++}Pt.d("{223689a}","{0d14ab6}",e.F)})).catch((()=>{Pt.e("{223689a}","{21131d5}")}))}function Wo(){let e=Li(48e3);if(e){let t=e.createMediaStreamDestination().stream.getAudioTracks()[0];return e.close(),t.enabled=!0,new MediaStream([t])}throw Error("Mic stream is not supported")}function qo(e){if(!1!==$t){if(null!=e.g){let t=e.g;e.J.clear(),e.g=null,navigator.mediaDevices&&(navigator.mediaDevices.ondevicechange=()=>{}),t.getTracks().forEach((e=>{e.stop()}))}e.o=!1,Uo(e,5),sl(e.L,"AudioInputType",e.M?"started":"not started",0,e.l.Jd,e.l.pd,e.l.zd),C(e.u,!1,15,4)&&sl(e.L,"LowAudioVolume","",0,e.s.get("permissionDenied"),e.s.get("visibilityChange"),e.s.get("deviceChange")),e.C=null,e.I=null,e.H=void 0,e.Da=void 0,e.initialized=!1,e.l={Jd:0,pd:0,zd:0};for(const[t]of e.s)e.s.set(t,0);e.m=!1,e.D=!1,e.G=!1,e.M=!1}}function zo(e){return"Built-in Microphone"===e.F}function Ko(e,t){Ho(e).then((()=>{0!==t&&C(e.u,!1,15,4)&&!e.m&&zo(e)&&(e.o||e.D)&&Go(e,"deviceChange")}))}var $o=class{constructor(e,t){this.I=null,this.h=0,this.o=!1,this.J=new Set,this.initialized=this.O=!1,this.N=0,this.D=this.G=this.m=!1,this.l={Jd:0,pd:0,zd:0},this.s=new Map([["permissionDenied",0],["visibilityChange",0],["deviceChange",0]]),this.M=!1,this.u=e,this.L=t,this.g=this.C=null,this.paused=this.v=!1,C(e,!1,15)&&(this.O=!0)}initialize(e,t,n,i){if(!1!==$t){if(this.C=e,this.I=t,this.H=n,this.Da=i,Jo){if(null==(e=Wo()))return void Pt.w("{223689a}","{360f38b}");this.C.addTrack(e.getAudioTracks()[0],e),this.o&&Vo(this,this.K)}else Pt.w("{223689a}","{5813c2b}");this.initialized=!0}}j(){var e,t,n;if(ii&&this.O){var i=null!==(t=null===(e=this.Da)||void 0===e?void 0:e.srcObject)&&void 0!==t?t:null===(n=this.H)||void 0===n?void 0:n.srcObject;if(i){Pt.i("{223689a}","{ad4b8c2}");var s=i.getAudioTracks()[0];s.enabled=!1,setTimeout((()=>{s.enabled=!0}),0)}}}getMicState(){return this.h}},Jo=!(!navigator.mediaDevices||!window.AudioContext&&!window.webkitAudioContext);function Qo(e,t){switch(e){case 0:var n,i=window.RTCPeerConnection;if(i)if(o(t))t=C(t,!1,14,3);else{switch(e=!1,S(t)&&(e=!0),window.chrome&&(E(t)?I(t,77)&&(e=!0):e=!0),t.browser){case"Chrome":I(t,77)&&(e=!0);break;case"Chromium":case"Edge":case"Brave":case"Yandex":case"Samsung":case"Silk":case"Opera":e=!0;break;case"Edge_Legacy":e=!1;break;case"Safari":const r=null==i?void 0:i.prototype;if(i=r&&(null===(n=r.hasOwnProperty)||void 0===n?0:n.call(r,"canTrickleIceCandidates")))e:if("Safari"!=t.browser)i=!1;else{try{i=T(t.browserVer,!1,16,4);break e}catch{s.Log.w("{d988e7f}","{07fd1dd}")}i=!0}i&&(e=!0)}t=e}else t=!1;return t;case 1:return Jo;default:return!1}}function Yo(e){return!(p(e)||m(e)||o(e))}function Xo(e,t,n){var i,s,r,o;const a=4953600<=e*t;var c=30===n?1.25*n:Math.min(n,60);let d=e*t*c;return Ci(e,t)||a?(e=null!==(s=null!==(i=cn)&&void 0!==i?i:Mn.bitsPerPixel1440p)&&void 0!==s?s:.325,c=(i=2073600*c)+(3686400*c-i)/3,d=a?c+(d-c)/12:i+(d-i)/3):e=null!==(o=null!==(r=an)&&void 0!==r?r:Mn.bitsPerPixel)&&void 0!==o?o:.3,d=d*e/1200,120<=n&&!a&&(d=Math.min(5e4,Math.round(1.15*d))),[Math.round(d),5e4]}function Zo(e,t){return t*=1e3,t=3600*(120===e?.916*t+293098:.678*t+910569)/1e9/8,30===e&&(t*=.625),Math.round(.95*t)}async function ea(e){return async function(e){var t=ha;t.g={u:e,Xf:await Aa(e),Pd:window.screen.width,Od:window.screen.height,vd:window.devicePixelRatio},e=ta(t.g);for(const n of t.h)n(e);return e}(e)}function ta(e){var t,n,i,s,r,o,d,l;const u=e.u,h=e.vd,f=e.Xf;var v,g,A="iPadOS"===u.os,b=c(u),S=e.Xf,y=(v=!(!m(u)||navigator.userAgent.includes("SamsungBrowser")||null===(g=null===(y=window.webapis)||void 0===y?void 0:y.productinfo)||void 0===g||!g.isUdPanelSupported())&&S.includes("H265"))||!(!p(u)||!navigator.userAgent.includes("PWA"))&&!!window.lge_webrtc_hevc_support||a(u);S=null!==(t=vn)&&void 0!==t?t:Mn.forceHdrSupport,t=S??(!(!(null!==(n=Mn.enableHdrSupport)&&void 0!==n?n:m(u))||!m(u))&&ia(u,f)),n=null!==(s=null!==(i=mn)&&void 0!==i?i:Mn.forceSdr10Support)&&void 0!==s?s:!(null!==(r=Mn.enableSdr10Support)&&void 0!==r&&!r)&&ia(u,f);const[w,E]=vi([e.Pd,e.Od]);if(e={width:Math.round(w*h),height:Math.round(E*h),fps:60,scaleFactor:Math.round(100*h)},i=void 0,y?i={width:3840,height:2160,fps:e.fps}:A&&1366<=w?i={width:1600,height:1200,fps:e.fps}:b&&(i={width:2560,height:1440,fps:e.fps}),A=[{width:2560,height:1600,fps:120},{width:3840,height:1080,fps:120}],y&&A.push({width:3840,height:2160,fps:60}),b=!1,t){if(v)b=!0;else{var I=null===(o=window.matchMedia)||void 0===o?void 0:o.call(window,"(dynamic-range: high)").matches;o=null===(d=window.matchMedia)||void 0===d?void 0:d.call(window,"(video-dynamic-range: high)").matches,d=null===(l=window.matchMedia)||void 0===l?void 0:l.call(window,"(color-gamut: p3)").matches,Pt.i("{5083445}","{f9f1c3b}",I,o,d),b=(I||o)&&d}I=function(e){var t,n;const i=null!==(t=gn)&&void 0!==t?t:Mn.hdr10gParams;if(i&&(t=i.split(",").map((e=>parseInt(e,10))),Pt.i("{5083445}","{4c54116}",t.join(", ")),3<=t.length&&!t.some((e=>isNaN(e))))){const[e,n,i]=t;return{version:e,peakLuminanceIndex:n,peakFullFrameLuminanceIndex:i}}if(m(e))try{const e=window.webapis.hdr10pluscloud;if(e){if(null!==(n=null==e?void 0:e.isHdr10plusGamingSupported())&&void 0!==n&&n){var s=null==e?void 0:e.getPeakLuminanceIndex(),r=null==e?void 0:e.getFullFramePeakLuminanceIndex();return Pt.i("{5083445}","{a5dcb3f}",1,s,r),void 0===s||void 0===r?void 0:{version:1,peakLuminanceIndex:s,peakFullFrameLuminanceIndex:r}}Pt.i("{5083445}","{c91f105}")}else Pt.i("{5083445}","{e293b13}")}catch(e){Pt.w("{5083445}","{b510204}",e)}}(u),!b&&I&&(Pt.w("{5083445}","{e13aa38}"),b=!0)}return S&&(b=!0),l=fi(),na={displayMode:e,maxAutoMode:i,maxSupportedModes:A,features:{vsync:0,vvsync:!1,hdr:b,reflex:!1,audioChannelCount:l,bitDepth:t?10:8,sdrBitDepth:n?10:8,hdr10PlusGamingData:I}}}let na;function ia(e,t){return m(e)||p(e)||o(e)?t.includes("H265"):t.includes("AV1")}function sa(e){let t=0;return null!=e&&e.supported&&(t|=1),null!=e&&e.smooth&&(t|=2),null!=e&&e.powerEfficient&&(t|=4),t}function ra(e){return e.l=ca("av1").then((t=>(e.s=t,e.s))),e.l}function oa(e){return e.m=ca("h265").then((t=>(e.v=t,e.v))),e.m}function aa(e){var t=ha;t.h=t.h.filter((t=>t!==e)),0===t.h.length&&function(e){var t;window.removeEventListener("resize",e.j),window.removeEventListener("focus",e.j);const n=window.screen;null===(t=n.removeEventListener)||void 0===t||t.call(n,"change",e.j)}(t)}function ca(e){const t=navigator.mediaCapabilities;return t?t.decodingInfo({type:"webrtc",video:{contentType:"video/"+e,width:1920,height:1080,framerate:60,bitrate:1e3*Xo(1920,1080,60)[0]}}).catch((t=>{Pt.w("{5083445}","{f5c2155}",e,t)})):Promise.resolve(void 0)}function da(){var e=ha;return e.s?Promise.resolve(e.s):e.l?e.l:ra(e)}function la(){var e=ha;return e.v?Promise.resolve(e.v):e.m?e.m:oa(e)}function ua(e,t){return t&&(e.refreshRate=void 0),e.refreshRate?Promise.resolve(e.refreshRate):e.o?e.o:function(e){return e.o=new Promise(((e,t)=>{let n=!1;const i=window.setTimeout((()=>{n=!0}),4e3),s=[];let r,o=window.innerWidth,a=window.innerHeight,c=window.screenX,d=window.screenY;const l=()=>{window.requestAnimationFrame((()=>{if(n)Pt.w("{5083445}","{0b0c6f9}","Timed out during the refreshRate loop"),window.clearTimeout(i),t();else{if(window.innerWidth!=o||window.innerHeight!=a||c!=window.screenX||d!=window.screenY){o=window.innerWidth,a=window.innerHeight,c=window.screenX,d=window.screenY;var u=!0}else u=!1;u?(Pt.w("{5083445}","{824b461}"),s.length=0,l()):(u=performance.now(),s.length&&s[0]<=u-2e3?(r=Math.floor(s.length/2),Pt.d("{5083445}","{8c3d290}",r,s[s.length-1]-s[0]),u=r,window.clearTimeout(i),e(u)):(s.push(u),l()))}}))};l()})).then((t=>(e.refreshRate=t,e.refreshRate)),(()=>{var t;return null!==(t=e.refreshRate)&&void 0!==t?t:0})),e.o}(e)}var ha=new class{constructor(){this.h=[],this.C=!1,this.j=()=>{if(this.g){var e=window.screen.width,t=window.screen.height,n=window.devicePixelRatio;if(e!==this.g.Pd||t!==this.g.Od||n!==this.g.vd){this.g.Pd=e,this.g.Od=t,this.g.vd=n,e=ta(this.g);for(const t of this.h)t(e)}}}}},pa=1,fa=2,va=4,ga=7;function ma(e,t){return t&&(4953600<=t.width*t.height&&!(e&va)||Ci(t.width,t.height)&&!(e&fa)||120===t.fps&&!(e&pa))}async function Aa(e,t){var n;let i=[];const s=null!==(n=fn)&&void 0!==n?n:Mn.codecList;if(s)for(const e of s)i.push(e);else t=async function(e,t){var n,i,s;const r=null!==(i=null!==(n=hn)&&void 0!==n?n:Mn.enableAv1Support)&&void 0!==i?i:f(e)?E(e):!!v(e)&&(E(e)||"Edge"===e.browser);return n=null!==(s=Mn.enableAv1ByResolutionAndFps)&&void 0!==s?s:ga,!(!r||ma(n,t))&&(p(e)&&null!=window.lge_webrtc_av1_support?window.lge_webrtc_av1_support:!(null==(e=await da())||!e.powerEfficient))}(e,t),e=async function(e){var t,n,i;const s=null!==(n=null!==(t=pn)&&void 0!==t?t:Mn.enableH265Support)&&void 0!==n?n:m(e)||p(e)||a(e);return t=null!==(i=Mn.enableH265ByResolutionAndFps)&&void 0!==i?i:ga,!(!s||ma(t))&&(p(e)&&null!=window.lge_webrtc_hevc_support?window.lge_webrtc_hevc_support:m(e)?(m(e)?(e=null===(c=null===(o=null===(r=window.webapis)||void 0===r?void 0:r.productinfo)||void 0===o?void 0:o.getSmartTVServerVersion)||void 0===c?void 0:c.call(o),(r=e&&(r=e.match(/T-INFOLINK(\d+)-(\d+)/))?{year:parseInt(r[1],10),version:parseInt(r[2],10)}:void 0)?(o=r.year,r=r.version,Pt.i("{5083445}","{fc40a4b}",o,r),r=2021===o||2023<=o||2022===o&&1008<=r):(Pt.e("{5083445}","{e227976}",e),r=!1)):r=!1,r):!(null==(r=await la())||!r.powerEfficient));var r,o,c}(e),await t&&i.push("AV1"),await e&&i.push("H265"),i.push("H264");return i}function ba(e){if(navigator.mediaCapabilities){var t=performance.now();ca("h264").then((async n=>{if(n){var i=ca("h265; level-id=153;profile-id=1;tier-flag=1"),s=ca("h265; level-id=153;profile-id=2;tier-flag=1"),r=da(),o=la();i=sa(await i),s=sa(await s),r=sa(await r),o=sa(await o),sl(e,"MediaCapabilities2",`AV1: ${r}`,sa(n),o,i,s),n=await ua(ha),o=await async function(){return 117<=await ua(ha,!1)}(),Pt.d("{5083445}","{1efbc27}",n,o),sl(e,"DisplayCaps","Is120FpsSupported: "+o,n,0,0,0)}else sl(e,"MediaCapabilities2","webrtc or h264 unsupported",performance.now()-t,-1,-1,-1)}))}else sl(e,"MediaCapabilities2","API unsupported",-1,-1,-1,-1)}function Sa(e,t,n,i){const s=/^([^[.]+)(?:\[(\d+)\])?\.([^:]+): *(.+)$/;let r=!0;for(const c of e.split(/\r?\n/)){var o=s.exec(c);if(o){var a=o[1];e=void 0!==o[2]?Number.parseInt(o[2]):void 0;const s=o[4];o=a+"."+o[3];const c=Ea(t,a=ya(a),e),d=Ea(n,a,e);c&&d?d.has(o)?(Pt.d("{eb7c2d0}","{2beb68f}",i,o,s),c.set(o,s)):(Pt.w("{eb7c2d0}","{cc4fdef}",i,o,s),r=!1):(Pt.w("{eb7c2d0}","{a649ad8}",i,a,e),r=!1)}}return r}function ya(e){switch(e){case"video":case"vqos":case"qscore":case"bwe":case"clientPerfBr":case"packetPacing":return"video";case"audio":case"aqos":case"audioBitrate":return"audio";case"ri":return"application";case"mic":return"mic"}}function wa(e,t,n){e.set(n?"vqos.dfc.adjustResAndFps":"vqos.drc.enable",t?"1":"0")}function Ea(e,t,n){var i;return void 0===t?e.mb:null===(i=e.media.filter((e=>e.mediaType===t))[n??0])||void 0===i?void 0:i.attributes}function Ia(e,t){let n=`v=0\no=${e.origin}\ns=-\nt=${e.time}\n`;const i=(e,t)=>{for(const[i,s]of e){e=i;const r=s;r!==t.get(e)&&(n+=`a=${e}:${r}\n`)}};i(e.mb,t.mb);for(const s of e.media)n+=`m=${s.mediaType} 0 RTP/AVP\n`,n+=`a=msid:${s.xc}\n`,e=t.media.find((e=>e.xc===s.xc)),i(s.attributes,e.attributes);return n}function Ca(e){switch(e){case 0:return 0;case 1:return 1;case 2:return Pt.w("{eb7c2d0}","{30c875c}"),0;default:return Pt.w("{eb7c2d0}","{7cd5754}",e),0}}function Ta(e){const t=e.j-e.g;return 0!=t?(e.l-e.h)/t:0}class Ra{constructor(){this.j=this.g=this.l=this.h=0}update(e,t){0==this.h&&0==this.g?(this.h=e,this.g=t):(this.j=t,this.l=e)}reset(){this.h=this.l,this.g=this.j}}function ka(e,t){e.L.innerText=Oa(e,t),e.j={value:0,count:0,max:0},e.l={value:0,count:0,max:0},e.o.reset()}function Oa(e,t){var n=`Seat: ${e.h.zoneName} (${e.h.Nd}) / ${e.h.gpuType}\n`,i=`Game: CMS ${e.h.appId}`;void 0!==e.avgGameFps&&(i+=` / fps ${e.avgGameFps.toFixed()}`),n=n+(i+"\n")+`Stream: Current ${Pi(e.streamingResolution)}@${e.fps} / Default: ${e.h.streamInfo.width}x${e.h.streamInfo.height}@${e.h.streamInfo.fps} / Codec ${e.codec}${e.hdr?e.s?` HDR10+G (${e.D?"C":"_"}${e.s?"S":"_"})`:" HDR":""} ${e.bitDepth} bpc\nNetwork: RTD ${e.rtd}ms / FL ${e.v} / PL ${e.M} / J ${e.I.toFixed(2)}ms / Bitrate ${e.m.toFixed(2)}Mbps / BWU ${e.Qb.toFixed(2)}%\nQOS: frame ${e.F} / FT ${e.O.toFixed(2)} / D ${(1e3*Ta(e.o)).toFixed(2)} / Q ${Math.floor(e.C.qualityScore)} / Marker ${e.R}\nClient: ${e.u.os} ${e.h.clientAppVersion} ${e.h.clientLocale} Resolution ${Pi({width:window.innerWidth*window.devicePixelRatio,height:window.innerHeight*window.devicePixelRatio})}\nInput ${e.g.gf}\n`,i=`DC ${Da(e.j)}ms (${e.j.max.toFixed(2)}ms) / Blocked ${e.K}\n`;const s=`Stats ${Da(e.l)}ms (${e.l.max.toFixed(2)}ms) / FR ${e.N} / FDR ${e.J}\n`,r=`Latency ${e.C.latencyScore.toFixed(1)} / Network ${e.C.networkLossScore.toFixed(1)} / Bandwidth ${e.C.bandwidthScore.toFixed(1)}\n`,o=`VP ${e.g.kf?"y":"n"} / AP ${e.g.hf?"y":"n"} / UI ${e.g.xb?"y":"n"} / VKB ${e.g.yb?"y":"n"} / MS ${e.g.uf} / RSDMM ${+e.g.Yc}\n`;return e=`KBL ${e.g.keyboardLayout} / ALM ${+e.g.appLaunchMode} / SWD ${e.T?"y":"n"} / ${e.dc}`,t&&(n+=i+s+r+o+e),n}var Pa=class{constructor(e,t,n){this.m=this.fps=0,this.Qb=4,this.M=this.rtd=this.I=this.J=this.N=this.F=this.P=this.G=0,this.streamingResolution={width:0,height:0},this.K=this.O=0,this.j={count:0,max:0,value:0},this.l={count:0,max:0,value:0},this.o=new Ra,this.S=this.v=this.sd=0,this.codec="UNKNOWN",this.s=this.D=this.hdr=!1,this.bitDepth=8,this.T=!1,this.dc="",this.R=0,this.H=e,this.u=t,this.h=n,this.C={qualityScore:0,bandwidthScore:0,networkLossScore:0,latencyScore:0},(e=document.getElementById("overlay-543d9968"))||((e=document.createElement("div")).id="overlay-543d9968",e.style.display="none",e.style.position="fixed",o(this.u)?(e.style.top="env(safe-area-inset-top, 0)",e.style.left="max(24px, env(safe-area-inset-left, 0))"):(e.style.top="0",e.style.left="0"),e.style.padding="0.5em",e.style.backgroundColor="rgba(0,0,0,0.5)",e.style.zIndex="300",e.style.fontSize="12px",e.style.fontFamily="monospace",e.style.color="white",e.style.whiteSpace="pre",e.style.lineHeight="100%",e.style.pointerEvents="none",this.H.insertAdjacentElement("afterend",e)),this.L=e,this.g={kf:!1,hf:!1,xb:!1,yb:!1,uf:0,Yc:!1,keyboardLayout:"",appLaunchMode:0,gf:""}}};function Da(e){let t=0;return 0<e.count&&(t=e.value/e.count),t.toFixed(2)}var La={size:70},xa={size:80},Ma={size:48},Na={size:88},_a=44,Fa=16,Ua={size:20};function ja(e){0<e.j.length&&(yc(e.g,e.j,5),e.j=[])}function Ga(e,t){const n=e.H.videoWidth;return e=e.H.videoHeight,new DOMRect(t.x*n,t.y*e,t.width*n,t.height*e)}function Ba(e,t,n){e.g.push({presentedFrames:n.presentedFrames,nd:t,presentationTime:n.presentationTime,receiveTime:n.receiveTime,processingDuration:n.processingDuration}),t=Ga(e,e.l),function(e,t,n,i,s){return new Promise(((r,o)=>{window.setTimeout((()=>{e:if(0>=i||0>=s)var a=-1;else{var c=new OffscreenCanvas(i,s).getContext("2d");if(c){try{c.drawImage(e,t,n,i,s,0,0,i,s),a=c.getImageData(0,0,i,s).data}catch(e){Pt.e("{0c7ed7c}","{b16b792}",e),a=-1;break e}var d=c=0;for(let e=0;e<a.length-3;e+=4)c+=.2126*a[e]+.7152*a[e+1]+.0722*a[e+2],d++;a=c/d/255}else Pt.e("{0c7ed7c}","{b72639c}"),a=-1}-1===a&&o(-1),r(a)}),0)}))}(e.H,t.x,t.y,t.width,t.height).then((t=>{var i,s=n.presentedFrames;if(e.g.length){var r=e.g[e.g.length-1];if(s!==r.presentedFrames)Pt.d("{0c7ed7c}","{06323ea}",s);else{for(r.ad=t;32<e.g.length;)e.g.shift();if(1!=e.g.length&&(!((t=e.g[e.g.length-2]).presentedFrames<s-2||void 0===t.ad||-1===t.ad)&&r.ad-t.ad>e.m)){let n;t=0;const o={presentedFrames:s,nd:r.nd,presentationTime:r.presentationTime,receiveTime:r.receiveTime,processingDuration:r.processingDuration,Wb:0,wc:0};for(;e.h.length&&e.h[0].Wb<(null!==(i=r.receiveTime)&&void 0!==i?i:r.presentationTime);)t++,n=e.h.shift();n&&(1<t&&Pt.d("{0c7ed7c}","{a4b8c55}",s,t),o.Wb=n.Wb,o.wc=n.wc,e.s&&e.s(o))}}}}))}function Va(e){const t={isPrimary:!0,pointerId:1,button:0};e.H.dispatchEvent(new PointerEvent("pointerdown",t)),e.H.dispatchEvent(new MouseEvent("mousedown")),window.setTimeout((()=>{e.H.dispatchEvent(new PointerEvent("pointerup",t)),e.H.dispatchEvent(new MouseEvent("mouseup"))}),100)}function Ha(e,t){e.bc.checked=t,e.s.disabled=!t,e.C.disabled=!t,e.l.style.color=t?"white":"gray"}function Wa(e,t=!1){t&&(e.g.style.bottom="5px",e.g.style.left="300px",e.g.style.top="",e.g.style.right="",e.g.style.width="150px",e.g.style.height="150px"),e.o()?(e.m.style.display="none",e.g.style.border="2px rgb(76, 175, 80) solid",e.g.style.backgroundColor="transparent"):(e.m.style.display="block",e.g.style.border="none",e.g.style.backgroundColor="rgb(105, 105, 105, 0.7)")}function qa(e,t){if(t!==e.visible){for(var n of(Pt.i("{50c79eb}","{5595c14}",t),e.visible=t,[e.I,e.g,e.v]))n===e.v&&t?$a(e,"Show hotkeys"!==e.h.value):n.style.display=t?"block":"none";var i=xi();if(n=i?"pointerdown":"mousedown",i=i?"pointermove":"mousemove",t){e.M(),function(e,t){let n=0,i=0,s=0,r=0;const o=document.onmouseup,a=document.onmousemove;t.onmousedown=t=>{t.preventDefault(),n=t.clientX,i=t.clientY,document.onmouseup=()=>{document.onmouseup=o,document.onmousemove=a},document.onmousemove=t=>{t.preventDefault(),s=n-t.clientX,r=i-t.clientY,n=t.clientX,i=t.clientY,e.style.top=e.offsetTop-r+"px",e.style.left=e.offsetLeft-s+"px"}}}(e.g,e.m),e.L.oninput=t=>{t=parseFloat(t.target.value);var n=e.j;0>=t||1<=t?Pt.e("{0c7ed7c}","{1cbd879}",t.toFixed(2)):n.m=t,e.O.innerHTML=(100*t).toFixed()+"%"},e.bc.oninput=t=>{Ha(e,t.target.checked)},e.s.oninput=t=>{e.R.innerHTML=t.target.value},e.C.oninput=t=>{e.S.innerHTML=t.target.value+" ms"},e.zb.oninput=t=>{e.zb.checked=t.target.checked};const t=(t,n)=>{n.value=Math.max(Math.min(parseInt(t.target.value),100),0).toFixed(0),Za(e,parseInt(e.Ub.value||"50")/100,parseInt(e.Vb.value||"50")/100)};e.Ub.oninput=n=>t(n,e.Ub),e.Vb.oninput=n=>t(n,e.Vb),e.F.onclick=()=>za(e,"Start"===e.F.value),e.h.onclick=()=>$a(e,"Show hotkeys"===e.h.value),e.g.onmouseup=e.M.bind(e),e.g.onmousedown=()=>{e.o()&&Va(e.j)},Nc(e.T,2,e.U),e.H.addEventListener(n,e.V),e.H.addEventListener(i,e.W)}else za(e,!1),e.L.oninput=null,e.bc.oninput=null,e.s.oninput=null,e.C.oninput=null,e.zb.oninput=null,e.Ub.oninput=null,e.Vb.oninput=null,e.F.onclick=null,e.h.onclick=null,e.g.onmouseup=null,e.g.onmousedown=null,e.m.onmousedown=null,_c(e.T,2,e.U),e.H.removeEventListener(n,e.V),e.H.removeEventListener(i,e.W)}}function za(e,t){t&&!function(e){const t=Ga(e,e.l);return!(0>t.x||0>t.y||t.x+t.width>e.H.videoWidth||t.y+t.height>e.H.videoHeight)}(e.j)?function(e){e.N.style.display="block",window.setTimeout((()=>e.N.style.display="none"),5e3)}(e):t&&e.J?Pt.e("{50c79eb}","{89742e9}"):(function(e,t){e.active!==t&&((e.active=t)?(Pt.i("{0c7ed7c}","{b56e30d}"),e.H.dispatchEvent(new Event("focus",{bubbles:!0})),e.H.addEventListener("pointerdown",e.j),e.H.addEventListener("mousedown",e.j)):(Pt.i("{0c7ed7c}","{00425c2}"),e.H.removeEventListener("pointerdown",e.j),e.H.removeEventListener("mousedown",e.j),e.g=[],e.h=[]))}(e.j,t),Wa(e),t?(e.F.value="Stop",e.bc.checked&&(Pt.i("{50c79eb}","{5974b2c}"),e.J=!0,e.Z=parseInt(e.s.value),e.K=window.setInterval((()=>{0<e.Z--?Va(e.j):(Pt.i("{50c79eb}","{d37e51d}"),Ja(e),za(e,!1))}),parseInt(e.C.value)))):(e.F.value="Start",e.J&&(e.K?(Pt.i("{50c79eb}","{d340c50}"),Ja(e)):Pt.w("{50c79eb}","{6d8948b}")),Qa(e),Ya(e)))}function Ka(e,t){e.value=t.toString(),e.dispatchEvent(new Event("input"))}function $a(e,t){t?(e.h.value="Hide hotkeys",e.v.style.display="block"):(e.h.value="Show hotkeys",e.v.style.display="none")}function Ja(e){window.clearInterval(e.K),e.K=0,e.J=!1}function Qa(e){0!==e.G&&(window.clearTimeout(e.G),e.G=0)}function Ya(e){e.D.innerHTML="",e.D.style.display="none"}function Xa(e){var t;const n=null!==(t=e.processingDuration)&&void 0!==t?t:0;return{ff:e.wc-e.Wb,Of:e.receiveTime?e.receiveTime-e.wc:0,He:e.receiveTime&&e.processingDuration?e.presentationTime-e.processingDuration-e.receiveTime:0,decode:n,Kf:e.nd-e.presentationTime,total:e.nd-e.Wb}}function Za(e,t,n){const i=e.H.getBoundingClientRect(),s=e.g.getBoundingClientRect(),{paddingTop:r,paddingRight:o,paddingBottom:a,paddingLeft:c}=oc(e.H);t=i.left+c+(i.width-c-o)*t-s.width*t,e.g.style.top=(i.top+r+(i.height-r-a)*n-s.height*n).toString()+"px",e.g.style.left=t.toString()+"px",e.M()}function ec(){const e=document.createElement("div");return e.style.display="none",e.style.position="absolute",e.style.color="white",e.style.backgroundColor="rgb(105, 105, 105, 0.7)",e.style.padding="2px",e}function tc(e){const t=document.createElement("div");return t.style.width="100%",t.style.borderBottom="1px dashed darkgray",t.style.paddingBottom="2px",t.innerHTML=e,t}function nc(e){const t=document.createElement("input");return t.type="button",t.value=e,t.style.margin="5px",t.style.backgroundColor="rgb(132, 130, 143, .7)",t.style.color="white",t.style.padding="8px 40px",t.style.border="none",t.style.borderRadius="4px",t.style.cursor="pointer",t}function ic(){const e=document.createElement("input");return e.type="checkbox",e}function sc(e){const t=document.createElement("label");return t.innerHTML=e,t}function rc(e,t,n,i=1){const s=document.createElement("input");return s.type="range",s.min=t.toString(),s.max=n.toString(),s.step=i.toString(),s.value=e.toString(),s}function oc(e){const t=e=>{if(!e)return 0;const t=e.length;return"%"===e.substring(t-1)?parseInt(e.substring(0,t-1)):"px"===e.substring(t-2)?parseInt(e.substring(0,t-2)):(Pt.w("{50c79eb}","{3351f27}",e),0)};return{paddingTop:t(e.style.paddingTop),paddingRight:t(e.style.paddingRight),paddingBottom:t(e.style.paddingBottom),paddingLeft:t(e.style.paddingLeft)}}var ac=class extends Map{constructor(){super([["TCP",0],["MDNS",0],["IPV6",0],["IPV4",0],["UNKNOWN",0]])}};function cc(e){var t,n,i,s;e.s=window.setInterval((()=>{!function(e){if(!e.J)if(e.J=!0,0===e.U)e.F.getStats().then((t=>{e.l=t})).catch((t=>uc(e,t,"early"))).finally((()=>{e.J=!1}));else if(1===e.U)if(e.ma){const t=e.F.getReceivers().find((t=>t.track.kind===e.mediaType&&t.track.enabled));t&&t.getStats().then((t=>lc(e,t))).catch((t=>uc(e,t,"standard"))).finally((()=>{e.J=!1}))}else!function(e){e.F.getStats(null).then((t=>{let n=!1;for(let i of t.values())if("track"===i.type&&(n=!0),["transport","inbound-rtp","candidate-pair"].includes(i.type)){"audio"===i.kind&&(e.za=!0);const t=e.P.get(i.type);t?t.includes(i.id)?Pt.e("{5cea617}","{76f5968}",i.id):t.push(i.id):e.P.set(i.type,[i.id])}e.ea=!n,Pt.i("{5cea617}","{1317761}",e.ea?"yes":"no"),e.ma=!0,e.l=t,lc(e,t)})).catch((t=>uc(e,t,"init"))).finally((()=>{e.J=!1}))}(e);else e.J=!1}(e)}),null!==(t=Mn.getStatsInterval)&&void 0!==t?t:96),window.chrome&&(e.G=window.setInterval((()=>{!function(e){if(!e.T){e.T=!0;var t=()=>{Pt.i("{5cea617}","{cf8b53f}"),e.T=!1,clearInterval(e.G),e.G=0};e.F.getStats((t=>{for(var n of t.result())if("ssrc"==n.type)for(var i of n.names()){"video"===n.stat("mediaType")&&(e.I.ts=Il(e.Z),e.I.timingFrameInfo=n.stat("googTimingFrameInfo"),e.I.targetDelayMs=+n.stat("googTargetDelayMs"),e.I.minPlayoutDelayMs=+n.stat("googMinPlayoutDelayMs"),e.I.currentDelayMs=+n.stat("googCurrentDelayMs"));break}if(t=e.o,!(15>(i=(n=e.I).timingFrameInfo.split(",",15)).length)){var s=new ArrayBuffer(La.size),r=new DataView(s);r.setUint32(0,n.targetDelayMs||0,!0),r.setUint32(4,n.minPlayoutDelayMs||0,!0),r.setUint32(8,n.currentDelayMs||0,!0),r.setFloat64(12,Il(t.h),!0),r.setFloat64(20,parseFloat(i[3])||0,!0),r.setFloat64(28,parseFloat(i[4])||0,!0),r.setFloat64(36,parseFloat(i[8])||0,!0),r.setFloat64(44,parseFloat(i[9])||0,!0),r.setFloat64(52,parseFloat(i[10])||0,!0),r.setFloat64(60,parseFloat(i[11])||0,!0),r.setUint8(68,parseFloat(i[13])||0),r.setUint8(69,parseFloat(i[14])||0),yc(t.g,[s],0)}e.T=!1}),t).catch(t)}}(e)}),null!==(n=Mn.getDeprecatedStatsInterval)&&void 0!==n?n:201)),null===(s=(i=e.H).requestVideoFrameCallback)||void 0===s||s.call(i,e.va)}async function dc(e){e.$=await async function(){const e=await ca("h264");if(void 0!==e)return!(null==e||!e.powerEfficient)}(),void 0===e.$&&(e.m.g=0)}function lc(e,t){var n,i,s,r=performance.now();if(r>=e.da&&"video"===e.mediaType){!function(e,t){var n,i,s,r=e.P.get("inbound-rtp");if(r&&e.l)if(r=r.map((e=>t.get(e))).find((e=>"video"===(null==e?void 0:e.kind)||"video"===(null==e?void 0:e.mediaType)))){var o=(r=vc(e,t,r)).decoderImplementation,a=!1;null!=o&&o.indexOf&&(o!==e.j.dc&&"unknown"!==o&&(e.j.dc=o,e.g.dc=o),a=-1!==o.indexOf("fallback")),(a||"FFmpeg"===o||e.aa||!1===e.$)&&-1===e.j.rc&&(e.j.rc=null!==(n=r.framesDecoded)&&void 0!==n?n:e.V,function(e){var t;if(e.h&&e.g){var n={clientEvent:{TS:null!==(t=Il(e.l))&&void 0!==t?t:0,eventtype:"SoftwareDecodeFallback"},instanceId:e.instanceId};e.g.postMessage(n)}}(e.v),n="Fallback to software decode at frame "+String(e.j.rc),Pt.i("{5cea617}","{953d211}",String(e.j.rc)),e.g.T=!0,ed(e.N,n),a?e.m.g=3:(e.aa||"FFmpeg"===o||!1===e.$)&&(e.m.g=2)),(n=e.l.get(r.id))?(e.j.cc.Wf++,(o=r.codecId)&&((o=t.get(o).mimeType.toUpperCase()).includes("H265")?e.M="H265":o.includes("AV1")?e.M="AV1":o.includes("H264")?e.M="H264":(Pt.d("{5cea617}","{4b31535}",o),e.M="UNKNOWN"),e.g.codec=e.M),function(e,t,n){if(void 0!==t.packetsReceived&&void 0!==t.packetsLost&&void 0!==n.packetsReceived&&void 0!==n.packetsLost&&void 0!==n.pliCount&&void 0!==t.pliCount){var i=t.packetsLost-n.packetsLost,s=100-i/(t.packetsReceived-n.packetsReceived+i)*100;for((isNaN(s)||void 0===s)&&(s=0),0<(t=t.pliCount-n.pliCount)&&i&&(s=0),i=0;i<t+1;i++)e.networkLossScore=7*e.networkLossScore/8+s/8}}(e.K,r,n),function(e,t){if(t.frameWidth&&t.frameHeight&&(e.streamingResolution={width:t.frameWidth,height:t.frameHeight}),t.framesDecoded){const n=e.P,i=t.timestamp;n!==i&&(e.fps=Math.floor((t.framesDecoded-e.F)/(i-n)*1e3)),e.F=t.framesDecoded,t.totalDecodeTime&&(e.o.update(t.totalDecodeTime,t.framesDecoded),e.sd=1e3*t.totalDecodeTime/t.framesDecoded)}t.framesReceived&&(e.N=t.framesReceived,t.totalInterFrameDelay&&(e.O=1e3*t.totalInterFrameDelay/(t.framesReceived-1))),t.framesDropped&&(e.J=t.framesDropped),t.packetsLost&&(e.M=t.packetsLost),t.pliCount&&(e.v=t.pliCount),e.P=t.timestamp}(e.g,r),e.V=null!==(i=r.framesDecoded)&&void 0!==i?i:0,e.wa=null!==(s=r.packetsReceived)&&void 0!==s?s:0,async function(e){const t={width:screen.width*window.devicePixelRatio,height:screen.height*window.devicePixelRatio},n={width:screen.width,height:screen.height},i=e.V,s=e.xa.l;var r=e.qa;if((r=!(t.width===r.width&&t.height===r.height))||(r=e.na,r=!(n.width===r.width&&n.height===r.height)),r||s!==e.fa){e.qa=t,e.na=n,r=await ua(ha),e.fa=s;var o=`Stream[0]: Client display[-1] resolution : {physical : ${Pi(t)}@${r}, logical : ${Pi(n)}@${r}} at frame#${i} topology: ${s}`;Pt.i("{5cea617}","{810d0ec}",Pi(t),r,Pi(n),r,i,s),ed(e.N,o)}}(e)):e.j.cc.Cf++}else e.j.cc.Le++}(e,t);var o,a,c,d,l,u,h,p,f,v,g=e.g,m=e.N,A=m.H.paused,b=null!==(a=null===(o=m.Da)||void 0===o?void 0:o.paused)&&void 0!==a&&a;o=null!==(d=null===(c=m.m)||void 0===c?void 0:c.xb())&&void 0!==d&&d,c=null!==(u=null===(l=m.m)||void 0===l?void 0:l.yb)&&void 0!==u&&u,l=m.La.getMicState(),u=null!==(p=null===(h=m.m)||void 0===h?void 0:h.Yc())&&void 0!==p&&p,h=m.keyboardLayout,p=m.appLaunchMode,null===(f=m.m)||void 0===f?m=void 0:m=`${(m=f.j).g.pb?"local":"alt"} ${Or(m)?"locked":"unlocked"}`,A={kf:A,hf:b,xb:o,yb:c,uf:l,Yc:u,keyboardLayout:h,appLaunchMode:p,gf:null!==(v=m)&&void 0!==v?v:""},g.g=A,function(e,t){var n,i=e.P.get("candidate-pair");if(i=null==i?void 0:i.map((e=>t.get(e))).find((e=>e))){6<=e.C.length&&e.C.splice(0,1),e.C.push(i);var s=null===(n=e.l)||void 0===n?void 0:n.get(i.id);s&&function(e,t,n){var i,s,r,o;let a=null!==(i=t.bytesReceived)&&void 0!==i?i:0;i=null!==(s=n.bytesReceived)&&void 0!==s?s:0,(t=null!==(r=t.timestamp)&&void 0!==r?r:0)!=(n=null!==(o=n.timestamp)&&void 0!==o?o:0)&&(e.m=(a-i)/(125*(t-n)))}(e.g,i,s)}}(e,t),0!==e.L&&ka(e.g,2===e.L),fc(e),e.l=t,e.da=r+1e3}for(const[n,i]of e.P.entries())for(var S of(g=n,v=i))if((v=t.get(S))&&"inbound-rtp"===g)if(A=e.o,"audio"===(v=vc(e,t,v)).kind)b=A,m=v,f=new ArrayBuffer(Ma.size),o=new DataView(f),Qi(m.packetsReceived||0,o,0,!0),Qi(m.bytesReceived||0,o,8,!0),Qi(m.packetsLost||0,o,16,!0),o.setFloat64(24,m.lastPacketReceivedTimestamp||0,!0),o.setFloat64(32,m.jitter||0,!0),o.setFloat64(40,Il(b.h),!0),yc(b.g,[f],2),b=new ArrayBuffer(Na.size),(m=new DataView(b)).setFloat64(0,v.audioLevel||0,!0),Qi(v.concealedSamples||0,m,8,!0),Qi(v.concealmentEvents||0,m,16,!0),Qi(v.insertedSamplesForDeceleration||0,m,24,!0),m.setFloat64(32,v.jitterBufferDelay||0,!0),Qi(v.jitterBufferEmittedCount||0,m,40,!0),Qi(v.removedSamplesForAcceleration||0,m,48,!0),Qi(v.silentConcealedSamples||0,m,56,!0),m.setFloat64(64,v.totalSamplesReceived||0,!0),m.setFloat64(72,v.totalSamplesDuration||0,!0),m.setFloat64(80,Il(A.h),!0),yc(A.g,[b],4);else if(b=A,f=(m=v).packetsLost||0,u=o=m.framesDecoded||0,d=h=m.totalDecodeTime||0,a=p=m.pliCount||0,(l=f)>=(c=b).v&&(c.F=l-c.v,c.v=l),a>=c.o&&(c.pliCount=a-c.o,c.o=a),c.framesDecoded=u-c.C,0<c.framesDecoded&&d>c.s&&(c.D=1e3*(d-c.s)/c.framesDecoded,c.C=u,c.s=d),c=new ArrayBuffer(xa.size),(l=new DataView(c)).setUint32(0,o,!0),l.setUint32(4,m.keyFramesDecoded||0,!0),l.setUint32(8,m.nackCount||0,!0),l.setInt32(12,f,!0),l.setInt32(16,p,!0),Qi(m.bytesReceived||0,l,20,!0),Qi(m.packetsReceived||0,l,28,!0),l.setFloat64(36,h,!0),l.setFloat64(44,m.totalInterFrameDelay||0,!0),l.setFloat64(52,m.totalSquaredInterFrameDelay||0,!0),l.setFloat64(60,m.totalAssemblyTime||0,!0),l.setUint32(68,m.framesAssembledFromMultiplePackets||0,!0),l.setFloat64(72,Il(b.h),!0),yc(b.g,[c],1),A.sendVideoTrack(v),v.perFrameEntries){for(v=JSON.parse(v.perFrameEntries),b=[],m=A.l,f=0;f<v.length;f++)v[f].frameNumber>A.l&&(o=new ArrayBuffer(Ua.size),(h=new DataView(o)).setUint32(0,v[f].frameNumber,!0),h.setFloat64(4,v[f].decodeTime,!0),h.setFloat64(12,v[f].assemblyTime,!0),b.push(o)),m=Math.max(m,v[f].frameNumber);A.l=m,0<b.length&&yc(A.g,b,6)}!(t=performance.memory)||(g=t.usedJSHeapSize,v=t.totalJSHeapSize,t=g-e.ta,S=v-e.sa,e.ta=g,e.sa=v,0<=t&&0<=S)||(g=e.v).h&&g.g&&(v={garbageCollectionStats:{timestamp:null!==(n=Il(g.l))&&void 0!==n?n:0,deltaUsedHeapSize:t,deltaTotalHeapSize:S},instanceId:g.instanceId},g.g.postMessage(v));((t=(n=e.N).D).h&&t.g&&(S={inputChannelStats:{timestamp:null!==(i=Il(t.l))&&void 0!==i?i:0,bufferedAmount:n.J.bufferedAmount,maxSchedulingDelay:n.C.maxSchedulingDelay},instanceId:t.instanceId},t.g.postMessage(S)),n.C.maxSchedulingDelay=0,r>=e.pa&&e.ba&&(i=e.ba,n=new ArrayBuffer(15),(t=new DataView(n)).setUint8(0,2),t.setUint8(1,1),t.setUint8(2,1),t.setUint32(3,i.xg,!0),t.setFloat64(7,i.client,!0),gc(e,n,"rtpmapping"),e.ba=void 0,e.pa=r+1e3),"video"===e.mediaType)&&(Ri(e.u)&&(i=new ArrayBuffer(12),(n=new DataView(i)).setUint8(0,1),n.setUint8(1,1),n.setUint16(2,e.o.F,!0),n.setUint16(4,Math.round(e.o.D),!0),n.setUint16(6,e.o.ua(),!0),n.setUint16(8,e.o.pliCount,!0),n.setUint16(10,e.o.framesDropped,!0),gc(e,i,"clientperf")),i=_o(e.K),e.g.C=i,n=_o(e.K),e.R.emit("StreamingQuality",n),e.Ba&&(i=e.g,e.R.emit("StreamingStats",{fps:i.fps,sd:i.sd,avgDecodeTime:1e3*Ta(i.o),Hg:i.G,Qb:i.Qb,width:i.streamingResolution.width,height:i.streamingResolution.height})),(i=e.v).h&&i.g&&(n={sq:{latencyScore:n.latencyScore,bandwidthScore:n.bandwidthScore,qualityScore:n.qualityScore,networkLossScore:n.networkLossScore,timestamp:null!==(s=Il(i.l))&&void 0!==s?s:0},instanceId:i.instanceId},i.g.postMessage(n)));r>=e.oa&&(s=e.g,Pt.i("{4155ac9}","{a02a36e}",s.F,(1e3*Ta(s.o)).toFixed(2),s.J,s.I.toFixed(2),s.v,s.rtd,s.m.toFixed(2),s.Qb.toFixed(2)),e.oa=r+5e3),r=performance.now()-r,(s=e.v).h&&(s.perf.GetStats+=r),(s=e.g).l.value+=r,s.l.count+=1,s.l.max=Math.max(r,s.l.max),e.za&&(e.mediaType="video"===e.mediaType?"audio":"video")}function uc(e,t,n){e.ha.Aa(t,`Exception in ${n} getStats`,"{5cea617}.ts",0,0,!0,"getStats")}function hc(e){e.s&&(clearInterval(e.s),e.s=0),e.G&&(clearInterval(e.G),e.G=0),ja(e.o)}function pc(e,t,n=!1){e.g.L.style.display=t?"block":"none",t?(e.L=n?2:1,ka(e.g,n),e.da=performance.now()):e.L=0}function fc(e){var t,n=e.g;const i={avgGameFps:null!==(t=n.avgGameFps)&&void 0!==t?t:0,fps:n.fps,rtd:n.rtd,avgDecodeTime:1e3*Ta(n.o),frameLoss:n.v-n.S,packetLoss:n.M,totalBandwidth:n.G,currentBitrateMbps:n.m,utilizedBandwidth:n.Qb,streamingResolution:n.streamingResolution,codec:n.codec,bitDepth:n.bitDepth,sdrHdrMode:n.hdr?1:0,hdr10PlusGaming:n.hdr&&n.s&&n.D};n.S=n.v,e.R.emit("StreamStatsUpdate",i)}function vc(e,t,n){return e.ea||(e=t.get(n.trackId))&&(n=Object.assign(e,n)),n}function gc(e,t,n){try{"open"===e.O.readyState&&e.O.send(t)}catch(t){Pt.e("{5cea617}","{78e74c5}",t),uc(e,t,n)}}function mc(e){if(!(2>e.C.length)){var t=e.C[0],n=e.C[e.C.length-1];e=n.requestsSent-t.requestsSent+n.consentRequestsSent-t.consentRequestsSent;var i=n.responsesReceived-t.responsesReceived;return t=n.packetsReceived-t.packetsReceived,{Hf:isNaN(e)?-1:e,If:isNaN(i)?-1:i,Gf:isNaN(t)?-1:t}}}var Ac=class{constructor(e,t,n,i,s,r,o,a,c,d,l,u){var h,p,f,v,g,m,A,b,S;this.Z=l,this.v=u,this.ra=!0,this.V=this.wa=this.G=this.s=0,this.M="UNKNOWN",this.ma=!1,this.P=new Map,this.ja=this.rtd=this.jitter=this.W=0,this.mediaType="video",this.sa=this.ta=this.da=this.L=0,this.C=[],this.na={width:0,height:0},this.qa={width:0,height:0},this.ea=this.T=this.J=!1,this.fa=this.oa=this.U=this.pa=0,this.aa=!1,this.R=e,this.N=t,this.H=n,this.F=i,this.uc=null!==(p=null===(h=s.video)||void 0===h?void 0:h[0].uc)&&void 0!==p&&p,this.bitDepth=null!==(v=null===(f=s.video)||void 0===f?void 0:f[0].bitDepth)&&void 0!==v?v:8,this.hdr=1===(null===(g=s.video)||void 0===g?void 0:g[0].Uc),this.ha=r,this.u=o,this.ga=a,this.xa=c,this.I={ts:0,timingFrameInfo:"",targetDelayMs:0,minPlayoutDelayMs:0,currentDelayMs:0},e=null!==(A=null===(m=s.video)||void 0===m?void 0:m[0].vc)&&void 0!==A?A:0,s=null!==(S=null===(b=s.video)||void 0===b?void 0:b[0].bd)&&void 0!==S?S:0,this.K=new class{constructor(e,t){this.maxBitrate=e/1e3,this.h=t/1e3,this.g=this.networkLossScore=this.bandwidthScore=this.latencyScore=this.qualityScore=100}reset(){this.g=this.networkLossScore=this.bandwidthScore=this.latencyScore=this.qualityScore=100}}(e,s),this.g=new Pa(n,this.u,this.ga),this.g.bitDepth=this.bitDepth,this.g.hdr=this.hdr,Kt&&(this.S=new class{constructor(e,t){this.T=t,this.visible=!1,this.fc=[],this.J=!1,this.Z=this.K=0,this.P={x:0,y:0},this.G=0,this.H=e,this.j=new class{constructor(e){this.active=!1,this.m=.06,this.l=new DOMRect(0,0,0,0),this.g=[],this.h=[],this.H=e,this.j=this.v.bind(this)}o(){return this.active}v(e){if(this.g.length){if(!(this.h.length&&100>e.timeStamp-this.h[this.h.length-1].Wb))for(this.h.push({Wb:e.timeStamp,wc:performance.now()});32<this.h.length;)this.h.shift()}else Pt.w("{0c7ed7c}","{fe08a50}")}}(e),this.U=this.ba.bind(this),this.V=this.aa.bind(this),this.W=this.onmousemove.bind(this),t=ec();var n=tc("Latency Display Analysis Tool (LDAT)");this.F=nc("Start"),this.h=nc("Show hotkeys"),t.style.bottom="0px",t.style.left="0px",t.style.margin="5px",this.h.style.border="1px solid white",this.h.style.fontSize="10px",this.h.style.padding="5px",this.h.style.position="absolute",this.h.style.right="0px",t.appendChild(n),t.appendChild(this.F),t.appendChild(this.h),n=t.appendChild;var i=document.createElement("div"),s=this.j.m;this.L=rc(s,.01,.2,.01),this.O=document.createElement("span");var r=sc("Activation Level"),o=document.createElement("span");for(var a of(this.O.innerHTML=(100*s).toFixed()+"%",o.style.paddingRight="2px",o.title="% increase in luminance used to determine whether a flash occurred",o.innerHTML="<sup> i </sup>",i.appendChild(r),i.appendChild(o),i.appendChild(this.L),i.appendChild(this.O),n.call(t,i),n=t.appendChild,i=document.createElement("div"),this.l=document.createElement("div"),this.bc=ic(),this.s=rc(20,5,100,5),this.C=rc(1e3,500,5e3,100),s=sc("Autofire"),r=sc("# Shots"),o=sc("Shot Delay"),this.R=document.createElement("span"),this.S=document.createElement("span"),this.R.innerHTML=this.s.value,this.S.innerHTML=this.C.value+" ms",this.s.id="shot-count-slider",this.l.appendChild(r),this.l.appendChild(this.s),this.l.appendChild(this.R),this.l.appendChild(document.createElement("br")),this.l.appendChild(o),this.l.appendChild(this.C),this.l.appendChild(this.S),i.appendChild(s),i.appendChild(this.bc),i.appendChild(this.l),n.call(t,i),t.appendChild(function(e){const t=document.createElement("div"),n=sc("Loupe Position:"),i=sc("X"),s=sc("Y");i.style.paddingLeft="10px",s.style.paddingLeft="10px",i.style.paddingRight="2px",s.style.paddingRight="2px";const r=()=>{const e=document.createElement("input");return e.type="number",e.min="0",e.max="100",e.step="1",e.placeholder="Int",e.style.width="40px",e};return e.Ub=r(),e.Vb=r(),t.appendChild(n),t.appendChild(i),t.appendChild(e.Ub),t.appendChild(sc("%")),t.appendChild(s),t.appendChild(e.Vb),t.appendChild(sc("%")),t}(this)),this.zb=ic(),(n=document.createElement("span")).title="Simulate mouse move event whenever a mouse click is detected.  Introduces two 300 ms delays between move events and requires a minimum shot delay of 1 sec.",n.innerHTML="<sup> i </sup>",t.appendChild(sc("Move On Click")),t.appendChild(n),t.appendChild(this.zb),this.I=t,t=ec(),n=tc("Loupe"),this.m=document.createElement("div"),this.m.style.cursor="move",this.m.style.width="100%",this.m.style.height="100%",this.m.innerHTML="Click here to drag the loupe to the area of the screen where flashes will occur.  Then, press start.",t.appendChild(n),t.appendChild(this.m),this.g=t,(t=ec()).style.position="relative",t.style.backgroundColor="gray",t.style.textAlign="center",t.innerHTML="Warning: Must place loupe over video element to activate the LDAT.  Please reposition the loupe and then click start.",this.N=t,t=ec(),n=tc("LDAT Hot Keys"),i=document.createElement("ul"),t.style.bottom="195px",t.style.left="0px",t.style.margin="5px",i.style.listStyle="none",i.style.paddingLeft="2px",i.style.margin="5px",["Enter - Start/Stop","R - Reset","A - Turn On/Off Auto-Fire Mode","S - Save Log File","C - Center Loupe on Screen"]))(s=document.createElement("li")).innerHTML=a,i.append(s);t.appendChild(n),t.appendChild(i),this.v=t,(a=ec()).style.bottom="325px",a.style.left="0px",a.style.margin="5px",this.D=a,e.insertAdjacentElement("afterend",this.I),this.I.insertAdjacentElement("afterend",this.g),this.g.insertAdjacentElement("afterend",this.N),this.I.insertAdjacentElement("beforebegin",this.v),this.v.insertAdjacentElement("beforebegin",this.D),this.j.s=this.$.bind(this),Ha(this,!1),this.zb.checked=!1,Wa(this,!0)}stop(){this.I.remove(),this.g.remove(),this.N.remove(),this.v.remove(),this.D.remove(),qa(this,!1),this.fc=[]}reset(){za(this,!1),Ka(this.L,.06),Ka(this.s,20),Ka(this.C,1e3),Ha(this,!1),this.zb.checked=!1,Wa(this,!0),$a(this,!1),this.Ub.value="",this.Vb.value="",this.fc=[]}isVisible(){return this.visible}toggle(){za(this,!this.o())}o(){return this.j.o()}Fb(){return!this.isVisible()||this.o()}aa(e){if(this.zb.checked&&this.o()&&!e.Xe){const t=(e,t)=>{switch(e){case 0:this.H.dispatchEvent(new PointerEvent("pointerup",t)),this.H.dispatchEvent(new MouseEvent("mouseup",t));break;case 1:e=new PointerEvent("pointerdown",t),t=new MouseEvent("mousedown",t),e.Xe=!0,t.Xe=!0,this.H.dispatchEvent(e),this.H.dispatchEvent(t);break;case 2:this.H.dispatchEvent(new PointerEvent("pointerrawupdate",t)),this.H.dispatchEvent(new PointerEvent("pointermove",t)),this.H.dispatchEvent(new MouseEvent("mousemove",t))}},n={button:2,isPrimary:!0,pointerId:1},i={clientX:(Math.max(e.clientX,0)||this.P.x)+64,clientY:Math.max(e.clientY,0)||this.P.y,movementX:64,isPrimary:!0};t(1,n),window.setTimeout((()=>{t(2,i),window.setTimeout((()=>{i.clientX-=64,i.movementX=-64,t(2,i),window.setTimeout((()=>t(0,n)),300)}),300)}),300)}}onmousemove(e){this.P={x:e.clientX,y:e.clientY}}M(){var e=this.H.getBoundingClientRect();const t=this.g.getBoundingClientRect();if(this.H.style.paddingTop||this.H.style.paddingRight||this.H.style.paddingBottom||this.H.style.paddingLeft){const{paddingTop:t,paddingRight:n,paddingBottom:i,paddingLeft:s}=oc(this.H);e.x+=s,e.y+=t,e.width-=s+n,e.height-=t+i}t.x=(t.x-e.x)/e.width,t.y=(t.y-e.y)/e.height,t.width/=e.width,t.height/=e.height,e=this.j,0>=t.width||0>=t.height?Pt.e("{0c7ed7c}","{3e0eb8f}",t.width,t.height):e.l=t}ba(){this.M()}$(e){Qa(this),this.fc.push(e);const t=Xa(e),n=t.total.toFixed(),i=`Flash occurred at frame ${e.presentedFrames}. Latency: ${n} ms.`;Pt.i("{50c79eb}","{78905f8}",e.presentedFrames,n),Pt.d("{50c79eb}","{d3d4a0c}",n,t.ff.toFixed(),t.Of.toFixed(),t.He.toFixed(),t.decode.toFixed(),t.Kf.toFixed()),this.D.innerHTML=i,this.D.style.display="block",this.G=window.setTimeout((()=>{Ya(this),this.G=0}),5e3)}}(n,c)),this.F=i,function(e){e.O=e.F.createDataChannel("stats_channel",{ordered:!1,reliable:!1,maxRetransmits:0}),e.O.binaryType="arraybuffer",Zc(e.N,e.O,{open:()=>{e.U=1},close:()=>{hc(e),e.U=2}}),e.O.onmessage=t=>{var n=new DataView(t.data);if(2<=(t=n.getUint8(0))){e.W=n.getFloat64(1,!0)/1e6,e.jitter=1e3*n.getFloat64(9,!0),e.rtd=n.getFloat64(17,!0),e.g.I=e.jitter,e.g.rtd=e.rtd;var i=e.m,s=e.rtd;if(s&&(i.j=Math.min(i.j,s),i.extraData.set("Rtd",i.j)),3<=t&&(e.ja=n.getFloat64(25,!0),e.g.avgGameFps=e.ja,4<=t)){var r=n.getFloat32(33,!0);t=n.getFloat32(37,!0),i=n.getFloat32(41,!0);var o=n.getFloat32(45,!0),a=n.getFloat32(49,!0),c=n.getFloat32(53,!0),d=n.getFloat32(57,!0),l=n.getFloat32(61,!0);s=n.getFloat32(65,!0);var u=n.getFloat32(69,!0);(n=e.m).saScores.gpuPerfScore=t,n.saScores.serverPerfScore=i,n.saScores.visualScore=o,n.saScores.decoderScore=a,n.saScores.downlinkLagScore=c,n.saScores.downlinkCongestionScore=d,n.saScores.uplinkScore=l,n.saScores.overallScore=r,n.extraData.set("WiFiScanScore",100*s),n.extraData.set("ThrottlingScore",100*u)}t=e.K,n=e.W,i=e.g,(s=e.W)&&i.m<=s&&(i.Qb=i.m/s*100),i.G=s,s=100,25<=i.Qb&&(s=(n-t.h)/(t.maxBitrate-t.h)*100),100<s&&(s=100),void 0===s||isNaN(s)||0>s||(t.bandwidthScore=15*t.bandwidthScore/16+s/16,t.bandwidthScore=Math.min(t.bandwidthScore,t.g)),t=e.K,i=0,250>(n=e.rtd)&&(void 0===(i=100*(250-n)/240)||isNaN(i))&&(i=0),t.latencyScore=15*t.latencyScore/16+i/16,t.latencyScore=Math.min(t.latencyScore,t.g)}else Pt.e("{5cea617}","{4f9f4b7}",t)}}(this),this.Ba=this.R.hasListener("StreamingStats"),this.o=new class{constructor(e,t){this.h=e,this.g=t,this.m=this.framesDropped=this.o=this.pliCount=this.framesDecoded=this.s=this.C=this.v=this.D=this.F=this.index=0,this.j=[],this.l=-1}sendVideoTrack(e){const t=e.framesDropped||0;t>=this.m&&(this.framesDropped=t-this.m,this.m=t);const n=new ArrayBuffer(_a),i=new DataView(n);i.setUint32(0,e.framesDecoded||0,!0),i.setUint32(4,t,!0),i.setUint32(8,e.frameHeight||0,!0),i.setUint32(12,e.frameWidth||0,!0),i.setUint32(16,e.framesReceived||0,!0),i.setFloat64(20,e.jitterBufferDelay||0,!0),Qi(e.jitterBufferEmittedCount||0,i,28,!0),i.setFloat64(36,Il(this.h),!0),yc(this.g,[n],3)}ua(){return this.framesDecoded}}(this.Z,this.v),this.j={cc:{Le:0,Cf:0,Wf:0},dc:"",rc:-1},this.D={sg:0,droppedVideoFrames:0,totalVideoFrames:0},this.ya=n,this.h=d,this.va=this.Ea.bind(this),cc(this),this.m=new class{constructor(e){this.u=e,this.extraData=new Map,this.j=65535,this.h=[],this.g=1,this.l=this.m=0,this.saScores={gpuPerfScore:-1,serverPerfScore:-1,visualScore:-1,decoderScore:-1,downlinkLagScore:-1,downlinkCongestionScore:-1,uplinkScore:-1,overallScore:-1}}}(this.u),this.aa=-1!==this.u.gpuDetail.indexOf("SwiftShader"),dc(this)}Ea(e,t){var n,i,s,r,o,a,c=this.m,d=t.width,l=t.height;d*l<=c.m*c.l||(c.m=d,c.l=l,c.extraData.set("MaxStreamingWidth",d),c.extraData.set("MaxStreamingHeight",l)),c=this.o,d=null!==(r=t.receiveTime)&&void 0!==r?r:0,r=t.presentationTime-d,d=1e3*(null!==(o=t.processingDuration)&&void 0!==o?o:0),o=void 0!==(o=t.presentationTime)?o-c.h.g:0,l=new ArrayBuffer(Fa);const u=new DataView(l);u.setFloat64(0,o,!0),u.setUint16(8,Math.min(100*r,65535),!0),u.setUint16(10,Math.min(100*d,65535),!0),u.setUint32(12,null!==(a=t.rtpTimestamp)&&void 0!==a?a:0,!0),c.j.push(l),120==c.j.length&&ja(c),!(null===(n=this.S)||void 0===n)&&n.o()&&Ba(this.S.j,e,t),this.uc&&t.rtpTimestamp&&t.receiveTime&&(this.ba={xg:t.rtpTimestamp,client:t.receiveTime-this.Z.g}),0!=this.s&&(null===(s=(i=this.H).requestVideoFrameCallback)||void 0===s||s.call(i,this.va))}reset(){hc(this),this.K.reset(),this.g=new Pa(this.H,this.u,this.ga),this.l=void 0}stop(){var e;this.ra&&(this.ra=!1,0!=this.s&&(this.reset(),pc(this,!1)),null===(e=this.S)||void 0===e||e.stop(),sl(this.ha,"InboundVideoStats",this.j.dc,this.j.cc.Wf,this.j.cc.Le,this.j.rc,this.j.cc.Cf))}toggleOnScreenStats(e,t){pc(this,t??0===this.L,e)}ua(){return this.V}fb(){return this.M}packetsReceived(){return this.wa}};function bc(e){return"tcp"===e.protocol?"TCP":(e=e.address||e.relatedAddress)?e.endsWith(".local")?"MDNS":-1!==e.indexOf(":")?"IPV6":"IPV4":"UNKNOWN"}function Sc(e){var t=null==(e=e.address||e.relatedAddress)?void 0:e.split(".");if(4===(null==t?void 0:t.length)&&(e=parseInt(t[0]),t=parseInt(t[1]),!isNaN(e)&&!isNaN(t))){let n="UNKNOWN";return 10===e?n="10/8":192===e&&168===t?n="192.168/16":172===e&&16==(240&t)&&(n="172.16/12"),"UNKNOWN"!==n&&Pt.d("{5cea617}","{343589d}",n),n}return Pt.i("{5cea617}","{fa2d6b9}"),"UNKNOWN"}function yc(e,t,n){var i;e.h&&e.g&&(n={webrtcStats:{type:n,stats:t},ackid:null===(i=e.s)||void 0===i?void 0:i.g++,instanceId:e.instanceId},e.g.postMessage(n,t))}function wc(e){if(e.h=!1,e.g){const t={stopStats:!0,instanceId:e.instanceId};Pt.d("{1f5ec29}","{76b05dd}"),e.g.postMessage(t)}}function Ec(e,t){var n,i,s,r;e.Aa(void 0,null!==(n=null==t?void 0:t.message)&&void 0!==n?n:"",null!==(i=null==t?void 0:t.filename)&&void 0!==i?i:"",null!==(s=null==t?void 0:t.lineno)&&void 0!==s?s:0,null!==(r=null==t?void 0:t.colno)&&void 0!==r?r:0,!0,"WorkerError")}var Ic=new class{constructor(){this.g=new Map,this.h=[],this.j=[],this.s=0,this.o=e=>{e=e.data;const t=this.g.get(e.instanceId);t?e.initialized?(Pt.i("{1f5ec29}","{6ccab8d}"),t.o=!0):e.statsStarted?(t.h=!0,Pt.d("{1f5ec29}","{e98d45f}")):e.log?Pt.i("{cbf9f59}","{0b0c6f9}",e.log):e.exception?Pt.i("{cbf9f59}","{0b0c6f9}",e.exception):e.wsClose?t.j?td(t.j,e.wsClose):Pt.e("{1f5ec29}","{900a6f2}"):e.wsMessage?t.j?nd(t.j,e.wsMessage):Pt.e("{1f5ec29}","{900a6f2}"):e.wsOpening?t.j?Pt.i("{93c7910}","{6423101}"):Pt.e("{1f5ec29}","{900a6f2}"):e.wsOpen?t.j?id(t.j):Pt.e("{1f5ec29}","{900a6f2}"):e.uninitialized&&Pt.i("{1f5ec29}","{22b6f70}"):Pt.w("{1f5ec29}","{3a7e49f}",e.instanceId)},this.m=e=>{this.g.size?this.g.forEach((t=>{Ec(t.m,e)})):this.j.push(e)},Pt.i("{1f5ec29}","{139da36}");try{this.l=ls('\nvar r={size:70,version:1,name:"DEPR"},u={size:80,version:3,name:"RTPV"},z={size:48,version:1,name:"RTPA"},A={size:88,version:1,name:"TRAA"},B={size:44,version:1,name:"TRAV"},C={size:16,version:2,name:"VFMD"},D={size:20,version:1,name:"PFDA"},E={size:0,version:1,name:""};function F(a){a.h&&(a.j("{890d3ae}"+a.h),a.h=0);a.g.clear()}function G(a,b){let c=a.g.get(b.type);c||(c=[],a.g.set(b.type,c));for(const g of b.stats)c.push(g)}\nfunction H(a){switch(a){case 0:return r;case 1:return u;case 2:return z;case 3:return B;case 4:return A;case 5:return C;case 6:return D;default:return E}}\nvar I=class{constructor(a){this.j=a;this.g=new Map;this.h=0;F(this)}size(){let a=0;for(let [,b]of this.g){let c=b;for(let g of c)a+=g.byteLength}return a+=9*this.g.size}write(a,b){var c=b;for(let [h,f]of this.g){b=h;var g=f,l=c,e=c;c=g.length;var d=H(b);let k=d.name,n=new DataView(a.buffer);for(let m=0;4>m;m++)n.setUint8(e+m,k.charCodeAt(m));n.setUint8(e+4,d.version);n.setUint16(e+5,c,!0);n.setUint16(e+7,d.size,!0);l=c=l+9;e=a;d=0;for(let m of g)g=new Uint8Array(m),e.set(g,c+d),d+=m.byteLength;c=\nl+d;1===b&&this.h++}return c}};function J(a,b=!1){const c=a.m+1;try{let g;a.sessionId&&(g="x-nv-sessionid."+a.sessionId);let l=a.url;b&&(l+="&reconnect=1");let e=new WebSocket(l,g);e.onopen=()=>{var d;a.h("{48fa30b}"+c);if(e===a.g){null===(d=a.j)||void 0===d?void 0:d.M();for(const h of a.l)h.stats?e.send(h.stats):e.send(JSON.stringify(h));for(const h of a.s)K(a,h);a.s=[]}};e.onclose=d=>{var h;a.h("{6406bff}"+c);e===a.g&&(null===(h=a.j)||void 0===h?void 0:h.L({error:a.u,code:d.code,reason:d.reason,wasClean:d.wasClean}),L(a),a.u=\n!1)};e.onerror=()=>{a.h("{7605058}"+c);e===a.g&&(a.u=!0)};e.onmessage=d=>{if(a.j)try{let f=JSON.parse(d.data);a.o||a.h("{523f5b9}");M(a);if(!f.hb){if(void 0!==f.ack){var h=f.ack;for(let k=a.l.length-1;0<=k;k--)a.l[k].ackid<=h&&a.l.splice(k,1)}if(void 0!==f.ackid){if(a.maxReceivedAckId<f.ackid&&(a.j.H(f),a.maxReceivedAckId=f.ackid),a.g){let k=JSON.stringify({ack:a.maxReceivedAckId});a.h("{903be10}"+k);a.g.send(k)}}else void 0===f.ack&&a.j.H(f)}}catch(f){a.v("Error in local websocket message handling: "+\nf+\' "\'+d.data+\'"\')}};a.g=e}catch(g){a.g=void 0,a.v("WebSocket creation exception: "+g+" for socket "+a.m)}a.m=c}function N(a){0!==a.o&&(self.clearTimeout(a.o),a.o=0)}function L(a){a.g&&(a.g.onclose=null,a.g.onerror=null,a.g.onmessage=null,a.g.onopen=null,a.g=void 0)}function M(a){N(a);a.o=self.setTimeout(()=>{var b;a.h("{6c3505a}"+(null===(b=a.g)||void 0===b?void 0:b.readyState)+"{754f60b}"+a.m);a.g||J(a,!0);M(a)},3E3)}\nfunction K(a,b){void 0!==b.ackid&&void 0!==b.ackid&&a.l.push(b);a.g&&(b.stats?a.g.send(b.stats):a.g.send(JSON.stringify(b)))}\nvar O=class{constructor(a,b){this.sessionId=a;this.u=!1;this.l=[];this.s=[];this.maxReceivedAckId=this.o=0;this.url="";this.m=0;this.h=b.info;this.v=b.exception}initialize(a,b,c,g=!1){this.url=a;this.maxReceivedAckId=b;this.j=c;J(this,g);this.h("{fcf6f89}"+this.m)}uninitialize(a){var b;this.maxReceivedAckId=0;this.l=[];this.s=[];this.j=void 0;N(this);null===(b=this.g)||void 0===b?void 0:b.close(a);L(this);this.h("{986b258}"+a+"{754f60b}"+this.m)}send(a){this.j&&(this.g||J(this,!0),this.g&&this.g.readyState===\nWebSocket.OPEN?K(this,a):this.s.push(a))}};const P=self;function Q(a){a.g=[];a.j=[];F(a.s);a.h=[];a.l=[];a.inputChannelStats=[];a.garbageCollectionStats=[];a.m=[]}function R(a,b,c,g,l,e){for(let d=0;4>d;d++)a.setUint8(b+d,c.charCodeAt(d));a.setUint8(b+4,g);a.setUint16(b+5,l,!0);a.setUint16(b+7,e,!0)}\nfunction S(a){var b;if((a.g.length||a.j.length||a.s.size())&&a.C)try{a.C.ackid=a.v;var c=JSON.stringify(a.C),g=c.length,l=g+2,e=new ArrayBuffer(l);const w=new DataView(e);w.setUint16(0,g);for(g=2;g<l;++g)w.setUint8(g,c.charCodeAt(g-2));var d=new Uint8Array(e),h=13*a.g.length,f=72*a.j.length,k=12*a.h.length,n=10*a.l.length,m=12*a.inputChannelStats.length,v=16*a.garbageCollectionStats.length;const x=8*a.m.length;let t=9+d.length;h&&(t+=9+h);f&&(t+=9+f);k&&(t+=9+k);n&&(t+=9+n);m&&(t+=9+m);v&&(t+=9+v);\nx&&(t+=9+x);t+=a.s.size();const y=new ArrayBuffer(t);var p=new DataView(y);c=0;(new Uint8Array(y)).set(d);c+=d.length;R(p,c,"BPRF",1,0,0);c+=9;if(h){R(p,c,"PERF",2,a.g.length,13);c+=9;d=p;l=c;for(e=0;e<a.g.length;e++)d.setFloat64(l,a.g[e].RAFTS,!0),d.setUint16(l+8,Math.min(1E3*a.g[e].DCSend,65535),!0),d.setUint16(l+10,Math.min(1E3*a.g[e].GetStats,65535),!0),d.setUint8(l+12,a.g[e].FrameInfo),l+=13;c+=h}if(f){R(p,c,"EVNT",1,a.j.length,72);c+=9;h=p;d=c;for(l=0;l<a.j.length;l++){h.setFloat64(d,a.j[l].TS,\n!0);d+=8;var q=a.j[l].eventtype;for(e=0;e<q.length&&63>e;e++)h.setUint8(d+e,q.charCodeAt(e));h.setUint8(d+e,0);d+=64}c+=f}if(k){R(p,c,"SQEV",1,a.h.length,12);c+=9;f=p;q=c;for(h=0;h<a.h.length;h++)f.setUint8(q,a.h[h].qualityScore),f.setUint8(q+1,a.h[h].bandwidthScore),f.setUint8(q+2,a.h[h].latencyScore),f.setUint8(q+3,a.h[h].networkLossScore),f.setFloat64(q+4,a.h[h].timestamp,!0),q+=12;c+=k}if(n){R(p,c,"MTBD",1,a.l.length,10);c+=9;k=p;f=c;for(q=0;q<a.l.length;q++)k.setFloat64(f,a.l[q].timestamp,!0),\nk.setUint16(f+8,Math.min(a.l[q].duration,65535),!0),f+=10;c+=n}if(m){R(p,c,"INPT",1,a.inputChannelStats.length,12);c+=9;n=p;k=c;for(f=0;f<a.inputChannelStats.length;f++)n.setFloat64(k,a.inputChannelStats[f].timestamp,!0),n.setUint16(k+8,Math.min(a.inputChannelStats[f].bufferedAmount,65535),!0),n.setUint16(k+10,Math.min(a.inputChannelStats[f].maxSchedulingDelay,65535),!0),k+=12;c+=m}if(v){R(p,c,"GRBG",1,a.garbageCollectionStats.length,16);c+=9;m=p;n=c;for(k=0;k<a.garbageCollectionStats.length;k++)m.setFloat64(n,\na.garbageCollectionStats[k].timestamp,!0),m.setInt32(n+8,T(a.garbageCollectionStats[k].deltaUsedHeapSize),!0),m.setInt32(n+12,T(a.garbageCollectionStats[k].deltaTotalHeapSize),!0),n+=16;c+=v}if(x){R(p,c,"MKPT",1,a.m.length,8);c+=9;v=p;p=c;for(m=0;m<a.m.length;m++)v.setFloat64(p,a.m[m],!0),p+=8;c+=x}const W=new Uint8Array(y);a.s.write(W,c);null===(b=a.o)||void 0===b?void 0:b.send({stats:y,ackid:a.v})}catch(w){a.F("Exception in perf/stats upload. Error : "+w.message+" stack: "+w.stack)}Q(a)}\nfunction U(a,b,c){a.o=new O(a.sessionId,{info:a.u,exception:a.F});a.o.initialize(a.url,b,{H:a.J,M:a.K,L:a.I,N:a.G},c);a.G()}\nfunction V(a,b){var c,g;b.perf?a.g.push(b.perf):b.clientEvent?a.j.push(b.clientEvent):b.startStats?(a.C=b.startStats.statsHeader,b={statsStarted:!0,instanceId:a.instanceId},a.D=self.setInterval(()=>S(a),5E3),P.postMessage(b),a.u("{5209d98}")):b.stopStats?(self.clearInterval(a.D),S(a),Q(a),a.u("{b58b6ad}")):b.webrtcStats?(b.ackid&&(a.v=b.ackid),b.webrtcStats.stats&&G(a.s,b.webrtcStats)):b.sq?a.h.push(b.sq):b.startWebSocket?(a.url=b.startWebSocket.signInURL,U(a,b.startWebSocket.maxReceivedAckId,b.startWebSocket.reconnect)):\nb.stopWebSocket?(null===(c=a.o)||void 0===c?void 0:c.uninitialize(),a.o=void 0):b.send?null===(g=a.o)||void 0===g?void 0:g.send(b.send):b.duration?a.l.push(b.duration):b.inputChannelStats?a.inputChannelStats.push(b.inputChannelStats):b.garbageCollectionStats?a.garbageCollectionStats.push(b.garbageCollectionStats):b.qosMarker&&a.m.push(b.qosMarker)}\nclass X{constructor(a,b){this.instanceId=a;this.sessionId=b;this.g=[];this.j=[];this.url="";this.D=0;this.h=[];this.l=[];this.inputChannelStats=[];this.garbageCollectionStats=[];this.m=[];this.v=0;this.F=c=>{Y(c,this.instanceId)};this.J=c=>{P.postMessage({wsMessage:c,instanceId:this.instanceId})};this.I=c=>{P.postMessage({wsClose:c,instanceId:this.instanceId})};this.K=()=>{P.postMessage({wsOpen:!0,instanceId:this.instanceId})};this.G=()=>{P.postMessage({wsOpening:!0,instanceId:this.instanceId})};\nthis.u=c=>{P.postMessage({log:c,instanceId:this.instanceId})};this.s=new I(this.u);P.postMessage({initialized:!0,instanceId:a})}}function T(a){return 0>a?Math.max(a,-2147483648):Math.min(a,4294967295)}function Y(a,b=0){P.postMessage({exception:a,instanceId:b})}const Z=new Map;\nP.onmessage=function(a){try{const b=a.data,c=b.instanceId;if(b.initMessage)Z.set(c,new X(c,b.initMessage.sessionId));else if(b.uninitialize)Z.delete(c),P.postMessage({uninitialized:!0,instanceId:c});else{const g=Z.get(c);g?V(g,b):P.postMessage({log:"{d710be2}"+c,instanceId:c})}}catch(b){Y("Worker onmessage exception: "+b)}};\n\n\n',"ragnarokworker.js"),this.l.onmessage=this.o.bind(this),this.l.onerror=this.m.bind(this),Pt.i("{1f5ec29}","{62dee75}")}catch(e){Pt.e("{1f5ec29}","{50fa2e5}",e.message),this.h.push({name:"RagnarokWorkerProblem",error:JSON.stringify(e)})}}};function Cc(e,t=!1){const n=e.m+1;try{let i;e.sessionId&&(i="x-nv-sessionid."+e.sessionId);let s=e.url;t&&(s+="&reconnect=1");let r=new WebSocket(s,i);r.onopen=()=>{var t;if(e.h("{48fa30b}"+n),r===e.g){null===(t=e.j)||void 0===t||id(t);for(const t of e.l)t.stats?r.send(t.stats):r.send(JSON.stringify(t));for(const t of e.s)Oc(e,t);e.s=[]}},r.onclose=t=>{var i;e.h("{6406bff}"+n),r===e.g&&(null===(i=e.j)||void 0===i||td(i,{error:e.v,code:t.code,reason:t.reason,wasClean:t.wasClean}),Rc(e),e.v=!1)},r.onerror=()=>{e.h("{7605058}"+n),r===e.g&&(e.v=!0)},r.onmessage=t=>{if(e.j)try{let i=JSON.parse(t.data);if(e.o||e.h("{523f5b9}"),kc(e),!i.hb){if(void 0!==i.ack){var n=i.ack;for(let t=e.l.length-1;0<=t;t--)e.l[t].ackid<=n&&e.l.splice(t,1)}if(void 0!==i.ackid){if(e.maxReceivedAckId<i.ackid&&(nd(e.j,i),e.maxReceivedAckId=i.ackid),e.g){let t=JSON.stringify({ack:e.maxReceivedAckId});e.h("{903be10}"+t),e.g.send(t)}}else void 0===i.ack&&nd(e.j,i)}}catch(n){e.C("Error in local websocket message handling: "+n+' "'+t.data+'"')}},e.g=r}catch(t){e.g=void 0,e.C("WebSocket creation exception: "+t+" for socket "+e.m)}e.m=n}function Tc(e){0!==e.o&&(self.clearTimeout(e.o),e.o=0)}function Rc(e){e.g&&(e.g.onclose=null,e.g.onerror=null,e.g.onmessage=null,e.g.onopen=null,e.g=void 0)}function kc(e){Tc(e),e.o=self.setTimeout((()=>{var t;e.h("{6c3505a}"+(null===(t=e.g)||void 0===t?void 0:t.readyState)+"{754f60b}"+e.m),e.g||Cc(e,!0),kc(e)}),3e3)}function Oc(e,t){void 0!==t.ackid&&void 0!==t.ackid&&e.l.push(t),e.g&&(t.stats?e.g.send(t.stats):e.g.send(JSON.stringify(t)))}var Pc=class{constructor(e,t){this.sessionId=e,this.v=!1,this.l=[],this.s=[],this.maxReceivedAckId=this.o=0,this.url="",this.m=0,this.h=t.info,this.C=t.exception}initialize(e,t,n,i=!1){this.url=e,this.maxReceivedAckId=t,this.j=n,Cc(this,i),this.h("{fcf6f89}"+this.m)}uninitialize(e){var t;this.maxReceivedAckId=0,this.l=[],this.s=[],this.j=void 0,Tc(this),null===(t=this.g)||void 0===t||t.close(e),Rc(this),this.h("{986b258}"+e+"{754f60b}"+this.m)}send(e){this.j&&(this.g||Cc(this,!0),this.g&&this.g.readyState===WebSocket.OPEN?Oc(this,e):this.s.push(e))}};function Dc(e){switch(e){case"H264":return"h264";case"H265":return"hevc";case"AV1":return"av1";default:return"video"}}function Lc(e,t,n){const{readable:i,writable:s}=t.createEncodedStreams();t=new TransformStream({start:()=>{Pt.i("{d7392d2}","{b96b3ec}",n.Id)},flush:()=>{},transform:(e,t)=>{if(!n.jf){const t=new Uint8Array(e.data);if(n.size+t.byteLength<=n.data.byteLength){var i=n.data,s=n.size,r=t;const e=r.byteLength;for(let t=0;t<e;++t)i.setUint8(s+t,r[t]);n.size+=t.byteLength}else n.jf=!0,Pt.w("{d7392d2}","{f35b2f4}",n.size,n.Id)}t.enqueue(e)}}),i.pipeThrough(t).pipeTo(s),e.streams.push(n)}var xc=class{constructor(e){this.g=e,this.streams=[]}start(e){if(1&this.g.qd){e=Ui(e);for(let t=0;t<e.length;t++){const n={data:new DataView(new ArrayBuffer(209715200)),size:0,Id:"video",hg:Dc(this.g.video[t].nc),jf:!1};Lc(this,e[t].receiver,n)}}}};function Mc(e){e.g&&(e.j=!e.j,e.g.style.display=e.j?"block":"none")}function Nc(e,t,n){e.g.get(t).push(n)}function _c(e,t,n){-1!==(n=(e=e.g.get(t)).indexOf(n))&&e.splice(n,1)}function Fc(e,t){if((e.S||e.F)&&Wc(e,t),e.h!==t){e.h=t;for(const n of e.g.get(0))n(t)}}function Uc(e,t){if(e.C!==t){e.C=t;for(const n of e.g.get(3))n(t)}}function jc(e,t){if(e.s!==t){e.s=t;for(const n of e.g.get(4))n(t)}}function Gc(e,t){return e.R?.22>=t.level:e.V||e.F?.2>=t.level:e.U?.1>=t.level:.33>=t.level}function Bc(e){return!e.T&&void 0!==window.screen.isExtended}function Vc(){var e,t;return di&&(null===(e=Mn.enableComputePressure)||void 0===e||e)&&(null===(t=globalThis.PressureObserver)||void 0===t?void 0:t.prototype)&&PressureObserver.knownSources instanceof Array&&PressureObserver.knownSources.includes("cpu")}function Hc(e){switch(e){case"nominal":default:return 0;case"fair":return 1;case"serious":return 2;case"critical":return 3}}function Wc(e,t){if(e.v!==t){e.v=t;for(const n of e.g.get(1))n(t)}}function qc(e){return e.split("\nm=").map(((e,t)=>(0<t?"m="+e:e).trim()+"\r\n"))}function zc(e,t){return function(e){return e.trim().split("\n").map((e=>e.trim()))}(e).filter((e=>0===e.indexOf(t)))}function Kc(e){return{algorithm:(e=e.substr(14).split(" "))[0].toLowerCase(),value:e[1].toUpperCase()}}function $c(e){var t,n,i;if(null!==(t=e.j)&&void 0!==t){var s=t.g,r=e.h,o=e.g;s.D===r&&s.s===o?s=!1:(Pt.i("{4155ac9}","{417fbf6}",r?"y":"n",o?"y":"n"),s.D=r,s.s=o,s=!0),s&&fc(t)}null!==(n=window.webapis)&&void 0!==n&&n.hdr10pluscloud&&(e.hdr?e.h&&e.g?(t=2,e="HDR10+G"):(t=1,e="HDR"):(t=0,e="SDR"),t!==(n=null!==(i=window.webapis.hdr10pluscloud.isHdr10plusGamingModeEnabled())&&void 0!==i?i:0)&&(i=window.webapis.hdr10pluscloud.enableHdr10plusGamingMode(t),Pt.i("{a5dd7ef}","{fc86642}",e,i)))}function Jc(e,t,n,i){let s=e.split("\r\n"),r=-1;for(let e=0;e<s.length;e++)if(0===s[e].indexOf("m=video")){r=e;break}if(-1===r)return Pt.e("{93c7910}","{e0899ab}","video"),e;for(Pt.d("{93c7910}","{5cc346f}","video",r),r++,e=";x-google-max-bitrate="+n+";x-google-min-bitrate="+t+";x-google-start-bitrate="+i,t=new Set;r<s.length&&0!==s[r].indexOf("m=");)0===(n=s[r]).indexOf("a=rtpmap:")&&0<n.indexOf("H264/")?t.add(n.slice(9,n.indexOf(" "))):0===n.indexOf("a=fmtp:")&&t.has(n.slice(7,n.indexOf(" ")))&&(s[r]+=e),r++;return s.join("\r\n")}function Qc(e,t){var n,i=e.D;i.h&&(i.perf.DCSend+=t),null===(n=e.h)||void 0===n||((e=n.g).j.value+=t,e.j.count+=1,e.j.max=Math.max(t,e.j.max))}function Yc(e){if(Rd(e))return e.h.S}function Xc(e,t){e.ea.innerHTML=t,e.ea.style.display="block",e.P&&clearTimeout(e.P),e.P=window.setTimeout((()=>{e.ea.style.display="none"}),1e3)}function Zc(e,t,n){const i=t.label;let s=!1;t.onopen=()=>{var t;Pt.d("{93c7910}","{8e9ee5d}",i),null===(t=n.open)||void 0===t||t.call(n),n.errorCode&&Cd(e)},t.onclosing=()=>{Pt.d("{93c7910}","{d0c8ae7}",i),s=!0},t.onclose=()=>{var t;Pt.d("{93c7910}","{a3c9826}",i),null===(t=n.close)||void 0===t||t.call(n),n.errorCode&&fd(e)},t.onerror=r=>{if(Pt.e("{93c7910}","{fcd64bb}",i),s&&n.errorCode)fd(e)||ud(e,15867907);else{var o=t.bufferedAmount;r=null==r?void 0:r.error,e.Z||nl(e.l,"ChannelError",i,null==r?void 0:r.name,null==r?void 0:r.message,null==o?void 0:o.toString()),Pt.e("{93c7910}","{db7ae96}",i,null==r?void 0:r.name,null==r?void 0:r.message),n.errorCode&&ud(e,n.errorCode)}}}function ed(e,t){Ad(e,{etwPrint:t})}function td(e,t){const n=()=>{var n,i,s,r,o;const a=null!==(n=t.code)&&void 0!==n?n:1005;Pt.i("{93c7910}","{0a06f78}",a,null!==(i=t.error)&&void 0!==i&&i),rl(e.l,e.L,a,null!==(r=null===(s=e.session)||void 0===s?void 0:s.signalConnectionInfo.ip)&&void 0!==r?r:"",null!==(o=t.reason)&&void 0!==o?o:"",e.ga,t.wasClean),window.clearTimeout(e.F),e.F=0,od(e,{code:_i(a),description:t.reason})};0!==e.F&&(t.error||t.code&&1002<=t.code&&1015>=t.code?(e.ga++,3>=e.ga?(rd(e),hd(e)):n()):n()),t.wasClean||e.za++}function nd(e,t){var n;Pt.i("{93c7910}","{39024c3}",xd(JSON.stringify(t))),t.ackid&&e.maxReceivedAckId<t.ackid&&(e.maxReceivedAckId=t.ackid),t.peer_info?(t.peer_info.name===e.name||0===e.id)&&(e.id=t.peer_info.id,Pt.d("{93c7910}","{c5faf27}",e.id)):t.peer_msg?async function(e,t,n){var i;Pt.d("{93c7910}","{9978507}",t);try{const s=JSON.parse(n);if("offer"===s.type){e.Za=!0;let n,r=s.sdp||"";Pt.d("{93c7910}","{ca9a155}",xd(r));const o=await e.Gc;if(e.s.video[0].nc=function(e,t){e=e.split("\r\n");var n=-1;if(!t.length)return"H264";for(var i=0;i<e.length;i++)if(e[i].startsWith("m=video")){n=i;break}if(-1===n)return Pt.e("{93c7910}","{3ab33e3}"),"H264";for(n+=1,i=new Set;n<e.length&&!e[n].startsWith("m=");){var s=e[n];0===s.indexOf("a=rtpmap:")&&("H264"!==(s=s.slice(s.indexOf(" ")+1,s.indexOf("/")))&&"H265"!==s&&"AV1"!==s||i.add(s)),n++}for(const e of t)if(i.has(e))return Pt.i("{93c7910}","{304c3b1}",e),e;return Pt.i("{93c7910}","{81357e4}"),"H264"}(r,o),s.nvstSdp){const t=null!==(i=s.nvstServerOverrides)&&void 0!==i?i:"";if(n=function(e,t,n){var i,s=e.s,r=e.u;if(t=function(e){let t,n,i={origin:"",time:"",mb:new Map,media:[]},s=new Map,r=!1;const o=()=>{if(r){if(!n||!t)return Pt.e("{eb7c2d0}","{adc37a7}"),!1;i.media.push({mediaType:n,xc:t,attributes:s}),t=n=void 0}else i.mb=s,r=!0;return s=new Map,!0};for(const c of e.split(/\r?\n/))if(!(2>c.length||"="!==c[1])){var a=c[0];if(e=c.substr(2),"m"==a){if(!o())return;n=e.split(" ")[0]}else if("a"==a){if(1!==(a=e.split(":",2)).length){if(2!==a.length)return void Pt.e("{eb7c2d0}","{f6bdb84}",e);if(e=a[0],a=a[1],"msid"===e){if(void 0!==t)return void Pt.e("{eb7c2d0}","{dc7fbec}",a);t=a}else s.set(e,a)}}else if("t"==a){if(r)return void Pt.e("{eb7c2d0}","{14fc069}");i.time=e}else if("o"==a){if(r)return void Pt.e("{eb7c2d0}","{eb0287a}");i.origin=e}}if(o()){if(""!==i.time&&""!==i.origin)return i;Pt.e("{eb7c2d0}","{8e7e486}")}}(t)){var o,a=t;const e={origin:a.origin,time:a.time,mb:new Map,media:[]};for(var c of(e.mb.set("general.clientSupportsIntraRefresh",u(r)?"0":"1"),e.mb.set("general.clientCapture",null!==(o=a.mb.get("general.clientCapture"))&&void 0!==o?o:"0"),e.mb.set("runtime.serverTraceCapture","2"),o=0,a.media)){if(a=new Map,"video"===c.mediaType&&o<s.video.length){var d=void 0,l=a,p=s.video[o],f=r,A=p.nc;l.set("vqos.fec.rateDropWindow","10"),l.set("vqos.fec.minRequiredFecPackets","2"),l.set("vqos.drc.minRequiredBitrateCheckEnabled","1"),l.set("video.dx9EnableNv12","1"),l.set("video.dx9EnableHdr","1"),l.set("vqos.qpg.enable","1"),l.set("vqos.resControl.qp.qpg.featureSetting","7"),l.set("bwe.useOwdCongestionControl","1"),l.set("video.enableRtpNack","1"),l.set("vqos.bw.txRxLag.minFeedbackTxDeltaMs","200"),l.set("vqos.fec.repairMinPercent","5"),l.set("vqos.fec.repairPercent","5"),l.set("vqos.fec.repairMaxPercent","35"),l.set("vqos.drc.bitrateIirFilterFactor","18"),l.set("video.packetSize","1140"),l.set("packetPacing.minNumPacketsPerGroup","15"),l.set("vqos.bllFec.enable","0");var b=void 0,S=v(f)||g(f);(null!==(b=Mn.enableOOFQosEnhancements)&&void 0!==b?b:S)&&(l.set("vqos.adjustStreamingFpsDuringOutOfFocus","1"),l.set("vqos.resControl.cpmRtc.ignoreOutOfFocusWindowState","1"),l.set("vqos.resControl.perfHistory.rtcIgnoreOutOfFocusWindowState","1")),S=120<=p.ic;var y=120===p.ic,w=240===p.ic,E=4953600<=p.Sb*p.Rb,I=Ci(p.Sb,p.Rb)||E,T=2764800<=p.Sb*p.Rb;if((b=Ri(f))&&l.set("vqos.resControl.cpmRtc.featureMask","3"),S&&(l.set("bwe.iirFilterFactor","8"),l.set("video.encoderFeatureSetting","47"),l.set("video.encoderPreset","6"),l.set("vqos.resControl.cpmRtc.badNwSkipFramesCount"," 600"),l.set("vqos.resControl.cpmRtc.decodeTimeThresholdMs","9"),y?(l.set("video.fbcDynamicFpsGrabTimeoutMs","6"),l.set("vqos.resControl.cpmRtc.serverResolutionUpdateCoolDownCount","6000")):w&&(l.set("video.fbcDynamicFpsGrabTimeoutMs","18"),l.set("vqos.resControl.cpmRtc.serverResolutionUpdateCoolDownCount","12000"),l.set("video.enableNextCaptureMode","1"),l.set("vqos.maxStreamFpsEstimate","240"),l.set("video.videoSplitEncodeStripsPerFrame","3"),l.set("video.updateSplitEncodeStateDynamically","1"))),(I||42e3<=p.vc)&&(y?l.set("packetPacing.numGroups","3"):l.set("packetPacing.numGroups","5"),l.set("packetPacing.maxDelayUs","1000"),l.set("packetPacing.minNumPacketsFrame","10"),l.set("video.rtpNackQueueLength","1024"),l.set("video.rtpNackQueueMaxPackets","512"),l.set("video.rtpNackMaxPacketCount","25"),l.set("vqos.drc.qpMaxResThresholdAdj","4"),l.set("vqos.grc.qpMaxResThresholdAdj","4"),l.set("vqos.drc.iirFilterFactor","100"),l.set("vqos.qpg.enable","0"),l.set("vqos.resControl.qp.qpg.featureSetting","0"),I&&(l.set("video.videoSplitEncodeStripsPerFrame","3"),l.set("video.updateSplitEncodeStateDynamically","1")),E&&(l.set("video.encoderPreset","6"),l.set("vqos.drc.add1440pResLevelFor4kDrcTable","1"),l.set("vqos.drc.minAdaptiveQpThreshold","40"),l.set("vqos.grc.minAdaptiveQpThreshold","40"),l.set("vqos.drc.upperQpThreshold","40"),l.set("vqos.grc.upperQpThreshold","40"),l.set("vqos.drc.qpMaxResThresholdAdj","5"),l.set("vqos.grc.qpMaxResThresholdAdj","5"),l.set("vqos.drc.iirFilterFactor","100"),l.set("vqos.fec.repairMinPercent","0"),l.set("vqos.qpg.enable","0"),l.set("vqos.resControl.qp.qpg.featureSetting","0"))),"AV1"===A){var R=I=w=y=void 0,k=void 0,O=void 0,P=void 0,D=void 0,L=void 0,x=void 0,M=void 0,N=void 0,_=void 0,F=void 0,U=void 0,j=l;j.set("vqos.qpg.enable","0"),j.set("vqos.resControl.qp.qpg.featureSetting","0"),j.set("vqos.drc.minQpHeadroom","20"),j.set("vqos.drc.lowerQpThreshold","100"),j.set("vqos.drc.upperQpThreshold","200"),j.set("vqos.drc.minAdaptiveQpThreshold","180");let e=Number(null!==(U=j.get("vqos.drc.qpMaxResThresholdAdj"))&&void 0!==U?U:"0");j.set("vqos.drc.qpMaxResThresholdAdj",(5*e).toString()),j.set("vqos.drc.qpCodecThresholdAdj","0"),j.set("vqos.dfc.minQpHeadroom",null!==(F=j.get("vqos.drc.minQpHeadroom"))&&void 0!==F?F:"0"),j.set("vqos.dfc.qpLowerLimit",null!==(_=j.get("vqos.drc.lowerQpThreshold"))&&void 0!==_?_:"0"),j.set("vqos.dfc.qpMaxUpperLimit",null!==(N=j.get("vqos.drc.upperQpThreshold"))&&void 0!==N?N:"0"),j.set("vqos.dfc.qpMinUpperLimit",null!==(M=j.get("vqos.drc.minAdaptiveQpThreshold"))&&void 0!==M?M:"0"),j.set("vqos.dfc.qpMaxResThresholdAdj",null!==(x=j.get("vqos.drc.qpMaxResThresholdAdj"))&&void 0!==x?x:"0"),j.set("vqos.dfc.qpCodecThresholdAdj",null!==(L=j.get("vqos.drc.qpCodecThresholdAdj"))&&void 0!==L?L:"0"),E&&(j.set("vqos.drc.minAdaptiveQpThreshold",null!==(D=j.get("vqos.drc.upperQpThreshold"))&&void 0!==D?D:"0"),j.set("vqos.dfc.qpMinUpperLimit",null!==(P=j.get("vqos.dfc.qpMaxUpperLimit"))&&void 0!==P?P:"0")),j.set("vqos.grc.minQpHeadroom",null!==(O=j.get("vqos.drc.minQpHeadroom"))&&void 0!==O?O:"0"),j.set("vqos.grc.lowerQpThreshold",null!==(k=j.get("vqos.drc.lowerQpThreshold"))&&void 0!==k?k:"0"),j.set("vqos.grc.upperQpThreshold",null!==(R=j.get("vqos.drc.upperQpThreshold"))&&void 0!==R?R:"0"),j.set("vqos.grc.minAdaptiveQpThreshold",null!==(I=j.get("vqos.drc.minAdaptiveQpThreshold"))&&void 0!==I?I:"0"),j.set("vqos.grc.qpMaxResThresholdAdj",null!==(w=j.get("vqos.drc.qpMaxResThresholdAdj"))&&void 0!==w?w:"0"),j.set("vqos.grc.qpCodecThresholdAdj",null!==(y=j.get("vqos.drc.qpCodecThresholdAdj"))&&void 0!==y?y:"0"),T&&j.set("video.videoSplitEncodeStripsPerFrame","23"),j.set("video.minQp","25")}if(l.set("video.clientViewportWd",p.Sb.toString()),l.set("video.clientViewportHt",p.Rb.toString()),l.set("video.maxFPS",p.ic.toString()),l.set("video.initialBitrateKbps",p.Ad.toString()),l.set("video.initialPeakBitrateKbps",p.ef.toString()),l.set("vqos.bw.maximumBitrateKbps",p.vc.toString()),l.set("vqos.bw.minimumBitrateKbps",p.bd.toString()),l.set("video.maxNumReferenceFrames","4"),l.set("video.mapRtpTimestampsToFrames",p.uc?"1":"0"),h()&&(l.set("vqos.drc.stepDownMinHeight","480"),C(f,!1,14,5)||(T=p.Sb/p.Rb*100,l.set("vqos.drc.stepDownResolutionAlignment","16"),l.set("vqos.drc.stepDownTargetAspectRatioX100",T.toFixed(0)))),T=l,y=p.dynamicStreamingMode,(S||2===y)&&(1!==y&&(T.set("vqos.drc.enable","0"),T.set("vqos.dfc.enable","1")),T.set("vqos.dfc.decodeFpsAdjPercent","85"),T.set("vqos.dfc.targetDownCooldownMs","250"),T.set("vqos.dfc.dfcAlgoVersion","1"),T.set("vqos.dfc.minTargetFps","60"),b&&T.set("vqos.cpm.flags","1"),T.set("vqos.resControl.dfc.useClientFpsPerf","0")),void 0!==y)switch(y){case 3:wa(T,!0,S);break;case 2:wa(T,!0,!0);break;case 1:wa(T,!0,!1);break;case 0:wa(T,!1,S)}f=m(f)?2:3,b=0,S=8,("H265"===A||"AV1"===A)&&(T=null!==(d=null==(S=na)?void 0:S.features.hdr)&&void 0!==d&&d,d=1===p.Uc,T&&d?(f=4,b=p.Uc,S=Math.max(10,Math.min((null==S?void 0:S.features.bitDepth)||10,p.bitDepth))):S=Math.max(8,Math.min((null==S?void 0:S.features.sdrBitDepth)||8,p.bitDepth))),10===S&&"H265"===A&&l.set("video.minQp","14"),l.set("video.encoderCscMode",f.toString()),l.set("video.dynamicRangeMode",b.toString()),l.set("video.bitDepth",S.toString()),o++}"application"===c.mediaType&&(d=A=p=l=void 0,b=c,(f=a).set("ri.partialReliableThresholdMs",null!==(d=b.attributes.get("ri.partialReliableThresholdMs"))&&void 0!==d?d:"0"),f.set("ri.hidDeviceMask",null!==(A=b.attributes.get("ri.hidDeviceMask"))&&void 0!==A?A:"0"),f.set("ri.enablePartiallyReliableTransferGamepad",null!==(p=b.attributes.get("ri.enablePartiallyReliableTransferGamepad"))&&void 0!==p?p:"0xff"),f.set("ri.enablePartiallyReliableTransferHid",null!==(l=b.attributes.get("ri.enablePartiallyReliableTransferHid"))&&void 0!==l?l:"0xffffffffffffffff")),e.media.push({mediaType:c.mediaType,xc:c.xc,attributes:a})}var G,B;r=e,Sa(c=null!==(B=null===(G=Mn.nvscClientConfigFields)||void 0===G?void 0:G.join("\n"))&&void 0!==B?B:"",r,t,"remoteconfig"),Sa(n,r,t,"server"),n=Kt&&!Sa(Nn,r,t,"client")?{error:3237093917}:function(e,t){let n=!0;const i=(e,t)=>(e=e.get(t))&&(e=parseInt(e),!Number.isNaN(e))?e:(Pt.e("{eb7c2d0}","{0a60213}",t),n=!1,0),s=(e,t)=>{if(e=e.get(t))try{return BigInt(e)}catch{Pt.e("{eb7c2d0}","{66a68eb}",e)}return Pt.e("{eb7c2d0}","{0a60213}",t),n=!1,BigInt(0)};e.qd=i(t.mb,"general.clientCapture");let r=0;for(const n of t.media){if("video"===n.mediaType&&r<e.video.length){t=e.video[r];const s=n.attributes;t.Sb=i(s,"video.clientViewportWd"),t.Rb=i(s,"video.clientViewportHt"),t.ic=i(s,"video.maxFPS"),t.Ad=i(s,"video.initialBitrateKbps"),t.ef=i(s,"video.initialPeakBitrateKbps"),t.vc=i(s,"vqos.bw.maximumBitrateKbps"),t.bd=i(s,"vqos.bw.minimumBitrateKbps"),t.uc=0<i(s,"video.mapRtpTimestampsToFrames"),t.Uc=i(s,"video.dynamicRangeMode"),t.bitDepth=i(s,"video.bitDepth"),r++}"application"===n.mediaType&&(e.Lb.Kd=i(n.attributes,"ri.partialReliableThresholdMs"),e.Lb.bf=i(n.attributes,"ri.hidDeviceMask"),e.Lb.Qe=i(n.attributes,"ri.enablePartiallyReliableTransferGamepad"),e.Lb.Re=s(n.attributes,"ri.enablePartiallyReliableTransferHid"))}return n}(s,r)?{config:s,De:Ia(r,t)}:{error:3237093918}}else n={error:3237093911};if(n.config&&n.De)return e.s=n.config,n.De;od(e,{code:null!==(i=n.error)&&void 0!==i?i:3237093910})}(e,s.nvstSdp,t),!n)return}e.ba=new xc(e.s),function(e,t){var n,i,s,r,o;Pt.d("{93c7910}","{d79ed0a}",t);try{let a={};Mn.enableStunServer&&(a.iceServers=[{urls:"stun:s1.stun.gamestream.nvidia.com:19308"}]),null===(n=e.ba)||void 0===n||n.g.qd&&(a.encodedInsertableStreams=!0),Pt.d("{93c7910}","{93106c2}",JSON.stringify(a)),e.ta=t,e.g=new RTCPeerConnection(a);const c=t=>{var n,i;if(e.W){var s=e.W;sl(e.l,"IceStats","disconnected",0,s.Hf,s.If,s.Gf),e.W=void 0}(s=null===(n=e.h)||void 0===n?void 0:mc(n))&&sl(e.l,"IceStats","failed",0,s.Hf,s.If,s.Gf),e.o|=16,4&e.o?e.h&&0==e.h.packetsReceived()?ud(e,3237093900):e.h&&0==e.h.ua()?ud(e,3237093901):ud(e,t?3237093906:3237093899):ud(e,null!==(i=ld(e))&&void 0!==i?i:3237093894)};if(e.g.onconnectionstatechange=()=>{if(e.g){if("failed"===(Pt.d("{93c7910}","{4ced155}",e.g.connectionState),e.g.connectionState))fd(e)||c(!1)}else Pt.e("{93c7910}","{648f784}")},e.g.oniceconnectionstatechange=()=>{var t;if(e.g)switch(Pt.d("{93c7910}","{3a3143a}",e.g.iceConnectionState),e.g.iceConnectionState){case"new":e.o|=1;break;case"checking":e.o|=2;break;case"connected":e.W=void 0,32&e.o&&(e.M.emit("StreamingEvent",{streamingState:{state:"reconnected"}}),e.cb++),e.o|=4;break;case"completed":e.W=void 0,e.o|=12;break;case"failed":c(!0);break;case"disconnected":e.W=null===(t=e.h)||void 0===t?void 0:mc(t),4&e.o&&e.M.emit("StreamingEvent",{streamingState:{state:"reconnecting"}}),e.o|=32;break;case"closed":e.o|=64,32&e.o&&ud(e,3237093892)}else Pt.e("{93c7910}","{648f784}")},e.g.ondatachannel=t=>{Pt.d("{93c7910}","{b364db9}",t.channel.label),"control_channel"==t.channel.label&&(Zc(e,t.channel,{errorCode:3237093898,open:()=>{var n,i,s,r,o,a;e.U=t.channel;for(const t of e.fa)ad(e,t);Pt.d("{93c7910}","{038895c}",e.fa.length),e.fa=[],ed(e,`NvRtcClient Browser name: ${e.u.browser}, Browser version: ${e.u.browserFullVer}`),Ad(e,{etwPrintPair:{key:"GPU Detail",value:e.u.gpuDetail}}),wd(e,null!==(i=null===(n=e.h)||void 0===n?void 0:n.ua())&&void 0!==i?i:0),Nc(e.j,0,e.S),Nc(e.j,1,e.S),Nc(e.j,2,e.S),navigator.getBattery&&(Ed(e,null!==(r=null===(s=e.h)||void 0===s?void 0:s.ua())&&void 0!==r?r:0),Nc(e.j,4,e.ha),Nc(e.j,3,e.ha)),Vc()&&(ed(e,"ClientGenericMapping: {ProcCpuUsage, TotalCpuUsage}"),Id(e,null!==(a=null===(o=e.h)||void 0===o?void 0:o.ua())&&void 0!==a?a:0),Nc(e.j,5,e.Xa)),Bc(e.j)&&(e.Pa(e.j.l),Nc(e.j,6,e.Ea)),window.requestAnimationFrame(e.Ta)}}),t.channel.onmessage=t=>{try{let l=JSON.parse(t.data);if(Pt.d("{93c7910}","{9371373}"),l.exitMessage)ud(e,Vt(l.exitMessage));else if(l.timerNotification){var n=l,i=n.timerNotification.code,s=0;switch(Pt.d("{c00be32}","{44bd2b6}",i),i){case 1:case 2:s=1;break;case 4:s=2;break;case 6:s=3}var r=s;0===r?Pt.e("{93c7910}","{de37ac5}",n.timerNotification.code):bd(e,r,n.timerNotification.secondsLeft)}else if(l.debugMessage)Xc(e,l.debugMessage.message);else if(l.customMessage){var o=JSON.parse(l.customMessage);if("Hdr10PlusGaming"===o.messageRecipient){if("Hdr10PlusGamingChange"===o.messageType&&o.data){const t=JSON.parse(o.data);n=e.aa,r=t;const i=null===(s=na)||void 0===s?void 0:s.features.hdr10PlusGamingData;null!=i&&i.version?r.isSupported?(r.isOn?r.version===i.version&&r.peakLuminanceIndex===i.peakLuminanceIndex&&r.peakFullFrameLuminanceIndex===i.peakFullFrameLuminanceIndex?(n.g=!0,Pt.i("{a5dd7ef}","{09b4301}")):(n.g=!1,Pt.i("{a5dd7ef}","{6aed760}")):(n.g=!1,Pt.i("{a5dd7ef}","{a358edc}")),$c(n)):Pt.i("{a5dd7ef}","{15eb580}"):Pt.i("{a5dd7ef}","{0eae5fd}",JSON.stringify(r))}}else e.M.emit("CustomMessage",o)}else if(l.videoStreamProgressEvent)e.videoStreamProgress=l.videoStreamProgressEvent.videoStreamProgress;else if(l.gameSessionHdrMode){var a,c=e.aa,d=0<l.gameSessionHdrMode.hdrMode;c.hdr=d,null===(a=c.j)||void 0===a||a.hdr!==d&&(Pt.i("{5cea617}","{3cc6c54}",d?"on":"off"),a.hdr=d,a.g.hdr=d,fc(a)),$c(c)}else Pt.d("{93c7910}","{d14e0fd}")}catch(t){Pt.e("{93c7910}","{a40734a}",t),e.l.Aa(t,"Error in control_channel message handling","{93c7910}.ts",0,0,!0)}})},Pt.d("{93c7910}","{d9ffda2}"),Pt.d("{93c7910}","{2bd4728}"),e.J=e.g.createDataChannel("input_channel_v1",{ordered:!0,reliable:!0}),e.J.binaryType="arraybuffer",Zc(e,e.J,{errorCode:3237093896}),0<e.s.Lb.Kd){Pt.d("{93c7910}","{860d2d7}");let t={ordered:!1,maxPacketLifeTime:e.s.Lb.Kd};Pt.d("{93c7910}","{25e5dc3}",JSON.stringify(t)),e.K=e.g.createDataChannel("input_channel_partially_reliable",t),e.K.binaryType="arraybuffer",Zc(e,e.K,{errorCode:3237093929})}if(e.V=e.g.createDataChannel("cursor_channel",{ordered:!0,reliable:!0}),e.V.binaryType="arraybuffer",Zc(e,e.V,{errorCode:3237093897}),function(e){var t;return-1!==(null!==(t=Mn.requireDS4TrackpadForAppIds)&&void 0!==t?t:[]).indexOf(e)}(e.session.appId)&&function(e){js(e),e.aa=!0,Bs(e,!0)}(e.C),function(e,t){js(e),e.qa=kn||0!=(4&t),e.Ta=On||0!=(2&t),Bs(e,!0)}(e.C,e.s.Lb.bf),e.m=new ko(e,e.H,e.J,e.V,e.l,e.M,e.Nb,2===e.appLaunchMode,e.Ob,e.C,e.u,e.ja,e.ma,e.j,e.Ka,e.O,e.D,e.s.Lb,e.K,e.textInputElement),e.qa&&(e.setKeyboardLayout(e.keyboardLayout),e.qa=!1),Bn){Pt.d("{93c7910}","{9ae428b}");const t={zoneName:e.session.zoneName,clientAppVersion:null!==(i=e.clientAppVersion)&&void 0!==i?i:"",appId:e.session.appId,Nd:null!==(s=e.Nd)&&void 0!==s?s:"",gpuType:e.session.gpuType,streamInfo:null!==(r=e.session.streamInfo[0])&&void 0!==r?r:{width:0,height:0,fps:0},clientLocale:e.session.clientLocale};e.h=new Ac(e.M,e,e.H,e.g,e.s,e.l,e.u,t,e.j,e.Ka,e.O,e.D),e.aa.j=e.h}e.g.addEventListener("icecandidate",e.ab),e.g.onsignalingstatechange=()=>{Pt.i("{93c7910}","{3236227}",e.g.signalingState)},e.g.onicecandidate=t=>Sd(e,t),e.g.g=e=>{Pt.w("{93c7910}","{9871b05}",e.port,e.url,e.errorCode,e.Ig)},(null!==(o=$t)&&void 0!==o?o:!p(e.u))&&e.La.initialize(e.g,e.M,e.H,e.Da),e.g.ontrack=t=>{var n;const i=t.streams[0];Pt.d("{93c7910}","{47359d4}",i.id,t.track.kind,t.track.id,t.streams.length,l(e.o));let s={kind:"video"===t.track.kind?"video":"audio",trackId:t.track.id};"audio"!==t.track.kind||"stream_id"!==i.id&&"app_media_stream"!==i.id&&"second_stream_id"!==i.id&&"app_audio_stream"!==i.id||(e.sa=t.track.id,function(e,t){(t=function(e){let t=null;return e=e.getAudioTracks(),e.length&&(t=e[0]),t}(t))&&(t.onunmute=()=>{e.Ua=!1})}(e,i),null===(n=e.T)||void 0===n||n.initialize(new MediaStream(i.getAudioTracks()))),(t=e.v.find((e=>e.streamId===i.id)))?t.tracks.push(s):e.v.push({streamId:i.id,tracks:[s]}),Cd(e)}}catch(t){Pt.e("{93c7910}","{ff11182}",t),e.l.Aa(t,"Exception in creating peer connection","{93c7910}.ts",0,0,!0)}}(e,t);let c=Date.now();r=function(e,t){return t.split("\r\n").map((t=>t.startsWith("a=candidate:")?(e.pa=!0,"a="+Td(e,t.substr(2))):t)).join("\r\n")}(e,r),r=function(e,t,n,i){let s=e.split("\r\n"),r=-1;for(var o=0;o<s.length;o++)if(s[o].startsWith("m=video")){r=o;break}if(-1===r)return Pt.e("{93c7910}","{3ab33e3}"),e;for(r++,o=r;o<s.length;o++)if(s[o].startsWith("a=imageattr"))return Pt.d("{93c7910}","{b38bf22}"),e;for(e=new Set;r<s.length&&!s[r].startsWith("m=");)o=s[r],/a=rtpmap:.*H26[45]\//.test(o)?e.add(o.slice(9,o.indexOf(" "))):0===o.indexOf("a=fmtp:")&&(o=o.slice(7,o.indexOf(" ")),e.has(o)&&(r++,s.splice(r,0,`a=imageattr:${o} send [x=[960:${t}],y=[540:${n}],fps=[30:${i}]]`))),r++;return s.join("\r\n")}(r,e.s.video[0].Sb,e.s.video[0].Rb,e.s.video[0].ic),function(e){var t;return null!==(t=Mn.allowUpdateH265Tier)&&void 0!==t?t:a(e)}(e.u)&&(r=function(e){var t,n;return null!==(n=null===(t=null==RTCRtpReceiver?void 0:RTCRtpReceiver.getCapabilities("video"))||void 0===t?void 0:t.codecs)&&void 0!==n&&n.some((e=>{var t;return"video/H265"===e.mimeType&&(null===(t=e.sdpFmtpLine)||void 0===t?void 0:t.includes("tier-flag=1"))}))?(Pt.i("{93c7910}","{9da2c0f}"),e):(t=e.replace(RegExp("tier-flag=1","g"),"tier-flag=0"),t.localeCompare(e)&&Pt.i("{93c7910}","{c656b20}"),t)}(r)),Pt.d("{93c7910}","{542f9d5}",xd(r)),e.g.setRemoteDescription({type:s.type,sdp:r}).then((()=>{e.ya=Date.now()-c,function(e){let t=e.g.getTransceivers();if(0===t.length)Pt.d("{93c7910}","{3399d9d}"),od(e,{code:3237093909});else{for(const n of t)"3"===n.mid&&n.receiver.track.id!==e.sa?(Pt.i("{93c7910}","{981392f}"),n.receiver.track.enabled=!1):e.$.push({trackId:n.receiver.track.id,kind:n.receiver.track.kind});Pt.d("{93c7910}","{648ae93}",JSON.stringify(e.$))}}(e),Pt.d("{93c7910}","{ab7b3af}",e.ya),function(e){for(const t of e.v)"stream_id"===t.streamId&&2===e.v.length?t.streamId="app_video_stream":"stream_id"===t.streamId?t.streamId="app_media_stream":"second_stream_id"===t.streamId&&(t.streamId="app_audio_stream")}(e);const i=function(e){var t=e.v.find((e=>"app_media_stream"===e.streamId));if(t)vd(e,t,e.H),Pt.i("{93c7910}","{a5e354c}");else{t=e.v.find((e=>"app_video_stream"===e.streamId));var n=e.v.find((e=>"app_audio_stream"===e.streamId));if(t&&n){const i={streamId:"app_media_stream",tracks:t.tracks.concat(n.tracks)};e.v.splice(e.v.indexOf(t),1),e.v.splice(e.v.indexOf(n),1),e.v.push(i),vd(e,i,e.H),Pt.i("{93c7910}","{e2dc4ec}")}else if(t)vd(e,t,e.H),Pt.i("{93c7910}","{07f3411}");else if(n){if(!e.Da)return 3237093937;vd(e,n,e.Da),Pt.i("{93c7910}","{243a50b}")}else Pt.w("{93c7910}","{c3a2679}")}}(e);i?ud(e,i):(function(e){var t;null===(t=e.ba)||void 0===t||t.start(e.g)}(e),function(e){try{if(e.g&&e.sendVideoTrack){const t=Ui(e.g)[0];if(t){let n="",i=t.direction;"sendrecv"!==t.direction&&(t.direction="sendrecv",n=" ("+i+" direction is overridden by sendrecv)"),t.sender.replaceTrack(e.sendVideoTrack).then((()=>{Pt.i("{93c7910}","{b54f651}",n)})).catch((e=>{t.direction!==i&&(t.direction=i),Pt.w("{93c7910}","{d225159}",e)}))}else Pt.w("{93c7910}","{8272b59}")}}catch(e){Pt.w("{93c7910}","{66082ec}",e)}}(e),function(e){var t,n,i,s,r=null===(t=e.s.video[0])||void 0===t?void 0:t.nc;if((t=Ui(e.g)[0])&&void 0!==r)if(RTCRtpReceiver.getCapabilities&&RTCRtpSender.getCapabilities&&t.setCodecPreferences){var o=[r,"flexfec-03","rtx"];if(r=null===(n=RTCRtpReceiver.getCapabilities("video"))||void 0===n?void 0:n.codecs,n=[],r){for(const e of o)(o=r.filter((t=>t.mimeType==="video/"+e)))&&n.push.apply(n,o);try{t.setCodecPreferences(n)}catch(r){gd(e,"Failed to set codec preferences to receiver capabilities",r);try{n=n.concat(null!==(s=null===(i=RTCRtpSender.getCapabilities("video"))||void 0===i?void 0:i.codecs)&&void 0!==s?s:[]),t.setCodecPreferences(n)}catch(t){gd(e,"Failed to set codec preferences to sender and receiver capabilities",t)}}}}else Pt.w("{93c7910}","{274c489}")}(e),c=Date.now(),e.g.createAnswer().then((i=>{var s;e.wa=Date.now()-c,Pt.d("{93c7910}","{2984003}",e.wa);const o=e.s.video[0].vc.toString(),a=e.s.video[0].bd.toString(),d=e.s.video[0].Ad.toString();Pt.d("{93c7910}","{b535c15}",xd(Md(null!==(s=i.sdp)&&void 0!==s?s:""))),void 0!==i.sdp&&(i.sdp=function(e,t){let n=e.split("\r\n"),i=-1;for(let e=0;e<n.length;e++)if(0===n[e].indexOf("m=video")){i=e;break}if(-1===i)return Pt.e("{93c7910}","{e0899ab}","video"),e;for(Pt.d("{93c7910}","{5cc346f}","video",i),i++;0===n[i].indexOf("i=")||0===n[i].indexOf("c=");)i++;return 0===n[i].indexOf("b")?(Pt.d("{93c7910}","{e77177e}",i),n[i]="b=AS:"+t,n.join("\r\n")):(Pt.d("{93c7910}","{3dfc348}",i),(e=n.slice(0,i)).push("b=AS:"+t),(e=e.concat(n.slice(i,n.length))).join("\r\n"))}(i.sdp,o),window.chrome&&(i.sdp=Jc(i.sdp,a,o,d)),i.sdp=function(e){var t=[];let n=e.split("\r\n");var i="-1";let s;for(let e=0;e<n.length;e++)0===n[e].indexOf("a=rtpmap:")?(s=n[e].split(" ")[1],0===s.indexOf("opus")&&(i=n[e].split(" ")[0].slice(9),Pt.i("{93c7910}","{c3dd71b}","audio",i))):0===n[e].indexOf("a=fmtp:"+i+" ")&&(t.push(e),i="-1");if(0===t.length)return Pt.e("{93c7910}","{115f256}","audio"),e;e=-1,i=[];for(const s of t)t=n[s],Pt.d("{93c7910}","{9bb0e6f}",t),t+=";stereo=1",Pt.d("{93c7910}","{4f021eb}",t),(i=i.concat(n.slice(e+1,s))).push(t),e=s;return(i=i.concat(n.slice(e+1))).join("\r\n")}(i.sdp),(s=function(e){e=e.split("\r\n");for(var t=-1,n=0;n<e.length;n++)if(0===e[n].indexOf("m=audio")){t=n;break}if(-1===t)Pt.d("{93c7910}","{a939549}","audio");else{for(var i=n=void 0,s=void 0,r=void 0,o=t+1;o<e.length;o++)if(0===e[o].indexOf("a=rtpmap:")){var a=e[o].split(" ")[1];0===a.indexOf("red")?(i=e[o].split(" ")[0].slice(9),r=a.split("/")[2],Pt.i("{93c7910}","{4e6ce55}","audio",i,r)):0===a.indexOf("multiopus")&&(n=e[o].split(" ")[0].slice(9),s=a.split("/")[2],Pt.i("{93c7910}","{53ebbb1}","audio",n,s))}else if(0===e[o].indexOf("m=")){Pt.d("{93c7910}","{9fc6964}",e[o]);break}if(n){for(a=[],o=[],t+=1;t<e.length;t++)if(0===e[t].indexOf("a=rtpmap:"+i)||0===e[t].indexOf("a=rtcp-fb:"+i)||0===e[t].indexOf("a=fmtp:"+i))o.push(e[t]);else if(0===e[t].indexOf("a=rtpmap:"+n)||0===e[t].indexOf("a=rtcp-fb:"+n)||0===e[t].indexOf("a=fmtp:"+n))a.push(e[t]);else if(0===e[t].indexOf("m=")){Pt.d("{93c7910}","{9fc6964}",e[t]);break}return r&&r!==s&&(i=void 0,o=[],Pt.w("{93c7910}","{ad53601}",r,s)),{wd:i,We:n,Bg:o.join("\r\n"),Ag:a.join("\r\n")}}Pt.d("{93c7910}","{cf4ee2d}","audio")}}(r))&&(i.sdp=function(e,t){let n=e.split("\r\n"),i=-1,s=-1;for(var r=0;r<n.length;r++)if(0===n[r].indexOf("m=audio")){i=r;break}if(-1===i)return Pt.d("{93c7910}","{e0899ab}","audio"),e;r=n.slice(0,i);let o=n[i].split(" ");if("0"!==o[3])return Pt.d("{93c7910}","{794b3c6}","audio",o.join(" ")),e;for(t.wd?(o[3]=t.wd,o[4]=t.We):o[3]=t.We,r.push(o.join(" ")),e=i+1;e<n.length;e++)if(0===n[e].indexOf("m=")){s=e;break}return-1===s&&(s=n.length-1),r=r.concat(n.slice(i+1,s)),t.wd&&(r=r.concat(t.Bg.split("\r\n"))),(r=(r=r.concat(t.Ag.split("\r\n"))).concat(n.slice(s))).join("\r\n")}(i.sdp,s)),Pt.d("{93c7910}","{1a048a7}",xd(Md(i.sdp)))),c=Date.now(),e.g.setLocalDescription(i).then((()=>{if(e.xa=Date.now()-c,Pt.d("{93c7910}","{de86c01}",e.xa),void 0===i.sdp||window.chrome||(i.sdp=Jc(i.sdp,a,o,d)),void 0!==i.sdp&&n){var s=qc(i.sdp),r=s.shift(),l=s[0],u=r,h=zc(l+u,"a=ice-ufrag:")[0];l=zc(l+u,"a=ice-pwd:")[0],h=h.substr(12),l=l.substr(10),s=zc(s[0]+r,"a=fingerprint:").map(Kc),(r=qc(n))[0]+="a=general.icePassword:"+l+"\r\n",r[0]+="a=general.iceUserNameFragment:"+h+"\r\n",r[0]+="a=general.dtlsFingerprint:"+s[0].value+"\r\n",n=r.join("")}yd(e,t,{type:i.type,sdp:i.sdp,nvstSdp:n}),Pt.i("{93c7910}","{bd70666}",JSON.stringify(e.v)),Cd(e)})).catch((t=>{Pt.e("{93c7910}","{ba2deaa}",t),ud(e,3237093902)}))})).catch((e=>{Pt.d("{93c7910}","{40c0f69}",e)})))})).catch((t=>{Pt.e("{93c7910}","{ec2853e}",t),ud(e,3237093902)}))}else if(s.candidate){Pt.d("{93c7910}","{cf4c103}");let t=Td(e,s.candidate);Pt.d("{93c7910}","{43e80e0}",t),e.g.addIceCandidate({sdpMLineIndex:s.sdpMLineIndex,sdpMid:s.sdpMid,candidate:t}).then((()=>{Pt.d("{93c7910}","{db0ae14}"),e.pa=!0})).catch((t=>{Pt.e("{93c7910}","{62f207e}",t),nl(e.l,"AddCandidateFailed",null==t?void 0:t.name,null==t?void 0:t.message)})),Pt.d("{93c7910}","{9454009}")}}catch(t){"BYE"===n?ud(e,15868672):(Pt.e("{93c7910}","{93367fc}",t),e.l.Aa(t,"Invalid handlePeerMessage Response","{93c7910}.ts",0,0,!0))}}(e,t.peer_msg.from,t.peer_msg.msg):t.error&&("peerRemoved"===t.error?(0!==e.G?(t=null!==(n=ld(e))&&void 0!==n?n:3237094161,Pt.w("{93c7910}","{cbb35d3}")):t=3237094159,ud(e,t)):ud(e,3237094160))}function id(e){0!==e.F&&(window.clearTimeout(e.F),e.F=0,e.kb=Date.now()-e.Ab),e.I||0!==e.G||function(e){e.G=window.setTimeout((()=>{var t;e.G=0,Pt.i("{93c7910}","{d22df91}"),ud(e,null!==(t=ld(e))&&void 0!==t?t:3237093895)}),3e4),e.Cb=Date.now()}(e)}function sd(e){Pt.d("{93c7910}","{440d709}",e.O.g,performance.timeOrigin)}function rd(e){var t=1;for(let e=1;10>e;e++)t*=10;t=(t=""+Math.floor(Math.random()*t)).padEnd(10,"0"),e.name="peer-"+t,Pt.d("{93c7910}","{f2b789d}",e.name),e.L=e.N+"/sign_in?peer_id="+e.name+"&version=2",e.signalingUrlQueryParameters&&(e.L+="&"+e.signalingUrlQueryParameters),Pt.d("{93c7910}","{05b8afd}",e.L)}function od(e,t){var n,i,s;if(!e.I){var r;if(e.Bb=Date.now()-e.Cb,void 0===t){if(!Ln)null===(r=e.R)||void 0===r||r.uninitialize(4001),e.R=void 0,e.D.startWebSocket(e.L,e.maxReceivedAckId,e,!0),Vn&&md(e)}else!function(e){var t,n,i,s,r,o,a,c,d;const l=e=>{var t,n;return(null!==(t=null==e?void 0:e.get("TCP"))&&void 0!==t?t:0)+(e=null!==(n=null==e?void 0:e.get("IPV6"))&&void 0!==n?n:0)};var u=(e,t)=>{let n=0;if(t){e=`${e} local candidates:`;for(const[i,s]of t){n+=s,e+=` ${t=i}: ${s}`}Pt.i("{93c7910}","{0b0c6f9}",e)}return n};const h=null===(t=e.h)||void 0===t?void 0:function(e){let t=new ac;if(!e.l)return t;for(const n of e.l.values())"local-candidate"===n.type&&(e=bc(n),t.set(e,t.get(e)+1));return t}(t);t=u("event",e.da);const p=u("stats",h);u=t-e.$a;let f="";const v=null===(n=e.g)||void 0===n?void 0:n.getReceivers().find((e=>"video"===e.track.kind&&e.track.enabled));(n=null===(o=null===(r=null===(s=null===(i=null==v?void 0:v.Ng)||void 0===i?void 0:i.Jg)||void 0===s?void 0:s.getSelectedCandidatePair)||void 0===r?void 0:r.call(s))||void 0===o?void 0:o.local)&&(f=`category: ${bc(n)}, type: ${n.type}`),sl(e.l,"LocalCandidatesCategories",f,t,t-l(e.da),p,p-l(h)),i=null!==(c=null===(a=e.h)||void 0===a?void 0:function(e){let t=new Set;if(!e.l)return t;for(const n of e.l.values())"local-candidate"===n.type&&"IPV4"===bc(e=n)&&"UNKNOWN"!==(e=Sc(e))&&t.add(e);return t}(a))&&void 0!==c?c:new Set,sl(e.l,"LocalCandidateRanges",`${null===(d=e.g)||void 0===d?void 0:d.iceGatheringState}`,u,null==i?void 0:i.size,e.oa.size,new Set([...i,...e.oa]).size)}(e);e.I=!0,0!==e.G&&(window.clearTimeout(e.G),e.G=0),t={sessionId:e.session.sessionId,subSessionId:e.session.subSessionId,streams:e.v,streamInfo:e.session.streamInfo,error:t,zoneName:e.session.zoneName,zoneAddress:e.session.zoneAddress,gpuType:e.session.gpuType,isResume:null!==(n=e.isResume)&&void 0!==n&&n,bitDepth:null!==(s=null===(i=e.h)||void 0===i?void 0:i.bitDepth)&&void 0!==s?s:8},e.ja.yc(t),e.ma.send()}}function ad(e,t){var n;try{if("open"===(null===(n=e.U)||void 0===n?void 0:n.readyState)){let n=performance.now();e.U.send(JSON.stringify(t)),Qc(e,performance.now()-n)}else Pt.w("{93c7910}","{593db1b}")}catch(t){Pt.e("{93c7910}","{a585a6e}",t),e.l.Aa(t,"sendControlMessage exception","{93c7910}.ts",0,0,!0)}}function cd(e){e.m&&(e.m.uninitialize(),e.m=void 0)}function dd(e){var t;null===(t=e.h)||void 0===t||t.stop()}function ld(e){var t;const n=pd(e);let i;switch(e.videoStreamProgress){case 0:case 2:break;case 3:i=3237093922;break;case 5:i=3237093923;break;case 7:i=3237093924;break;default:i=3237093925}if(null===(t=e.h)||void 0===t)var s=void 0;else e:{if(t.l){var r=s=0,o=0,a=0;for(const e of t.l.values())"candidate-pair"===e.type&&(s+=(t=e).requestsSent+t.consentRequestsSent,r+=t.responsesReceived,t.Kg&&o++,"succeeded"===t.state&&a++);if(Pt.i("{5cea617}","{47c0ce7}",s,r),0<s&&0===r){s=3237093926;break e}if(!o){s=3237093927;break e}if(!a){s=3237093928;break e}}s=void 0}return e.id?e.Za?15859712!==n?i=n:e.pa?e.Ya?s?i=s:4&e.o&&("connecting"===Ld(e.J)?i=3237093919:"connecting"===Ld(e.V)?i=3237093920:"connecting"===Ld(e.U)?i=3237093921:e.K&&"connecting"===Ld(e.K)&&(i=3237093936)):i=3237093903:i=3237093904:i=3237093913:i=3237093912,i}function ud(e,t){var n;if(!e.Z){if(e.Z=!0,cd(e),dd(e),e.I){const i={sessionId:e.session.sessionId,subSessionId:e.session.subSessionId,error:{code:t,description:void 0},zoneName:e.session.zoneName,zoneAddress:e.session.zoneAddress,isSessionAlive:Ii(t)};nl(e.l,"SignalingState",l(t),null===(n=e.g)||void 0===n?void 0:n.signalingState),Pt.i("{93c7910}","{89d3ea6}",e.g.signalingState),e.ja.yf(i)}else od(e,{code:t});Pt.e("{93c7910}","{573fb24}",l(t))}}function hd(e){e.R=new Pc(e.session.sessionId,{info:e.Mc.bind(e),exception:e.Lc.bind(e)}),e.R.initialize(e.L,e.maxReceivedAckId,e)}function pd(e){const t=e.v.flatMap((e=>e.tracks));for(const n of e.$)if(!t.find((e=>e.trackId===n.trackId)))return"audio"===n.kind?3237093914:3237093905;return Pt.d("{93c7910}","{4fef10b}"),t.length>e.$.length&&Pt.w("{93c7910}","{7861bb3}"),15859712}function fd(e){let t=!1;return window.chrome&&"closed"===e.g.signalingState&&(t=!0,ud(e,15867908)),t}function vd(e,t,n){e=e.g.getTransceivers().map((e=>e.receiver.track)),e=new MediaStream(e.filter((e=>t.tracks.find((t=>t.trackId===e.id))))),n.srcObject=e}function gd(e,t,n){Pt.w("{93c7910}","{4d3c418}",t,n),e.l.Aa(n,t,"{93c7910}.ts",0,0,!0)}function md(e){var t=e.D,n={stats:{from:e.id,to:e.ta}};t.h=!1,t.g&&(n={startStats:{statsHeader:n},instanceId:t.instanceId},Pt.d("{1f5ec29}","{6897d5e}"),t.g.postMessage(n)),e.ra=!0}function Ad(e,t){"connecting"===Ld(e.U)?e.fa.push(t):ad(e,t)}function bd(e,t,n){var i;2===t&&(null===(i=e.m)||void 0===i||ho(i,!0)),Pt.d("{93c7910}","{5ba6173}",t,n),e.M.emit("StreamingEvent",{streamingWarnings:{code:t,secondsLeft:n}})}function Sd(e,t,n){t.candidate?(n||(n=bc(t.candidate),e.da.set(n,e.da.get(n)+1),"IPV4"===n&&("UNKNOWN"!==(n=Sc(t.candidate))&&e.oa.add(n))),"tcp"===t.candidate.protocol?Pt.d("{93c7910}","{6f19d1e}"):(Pt.d("{93c7910}","{ac052fa}",t.candidate.port,t.candidate.protocol),yd(e,e.ta,{sdpMLineIndex:t.candidate.sdpMLineIndex,sdpMid:t.candidate.sdpMid,candidate:t.candidate.candidate}),e.Ya=!0)):Pt.d("{93c7910}","{a759d16}")}function yd(e,t,n){const i=JSON.stringify(n);n={peer_msg:{from:e.id,to:t,msg:i},ackid:e.Ba.g++},Pt.d("{93c7910}","{7ecb902}",t,i.length,xd(Md(JSON.stringify(n)))),e.R?e.R.send(n):(e=e.D).g&&e.g.postMessage({send:n,instanceId:e.instanceId})}function wd(e,t){let n=0;e.j.h&&(n|=2),e.j.v&&(n|=1),e.j.j&&(n|=16);const i={windowState:{streamIndex:0,frameNumber:t,windowStateFlags:n}};Pt.i("{93c7910}","{ca317d5}",n.toString(16),t),Ad(e,i)}function Ed(e,t){var n;let i=0;e.j.s&&(i|=4),e.j.C&&(i|=1),null===(n=e.h)||void 0===n||n.m.extraData.set("Power",i),n={systemState:{streamIndex:0,frameNumber:t,systemStateFlags:i}},Pt.i("{93c7910}","{455ccc0}",i.toString(16),t),Ad(e,n)}function Id(e,t){var n;const i=function(e){switch(e.o){case"nominal":return 60;case"fair":return 75;case"serious":return 90;case"critical":return 100}return-1}(e.j);if(-1!=i){if(null!==(n=e.h)&&void 0!==n){var s=t;0==s&&(s=1),n.m.h.push({frameNumber:s,cpuUsage:i})}n={cpuUsage:{streamIndex:0,frameNumber:t,procCpuUsage:0,totalCpuUsage:i}},Pt.i("{93c7910}","{9bb3298}",i.toString(),t),Ad(e,n)}}function Cd(e){0<e.$.length&&"connecting"!==Ld(e.U)&&"connecting"!==Ld(e.V)&&"connecting"!==Ld(e.J)&&(!e.K||"connecting"!==Ld(e.K))&&15859712===pd(e)&&od(e)}function Td(e,t){return Pt.d("{93c7910}","{2dd62a2}"),(e=e.session.mediaConnectionInfo.find((e=>2===e.usage||17===e.usage)))?(t=t.split(" "),e.ip&&(t[4]=e.ip),e.port&&(t[5]=""+e.port),t=t.join(" "),Pt.d("{93c7910}","{1fbcd88}",t),t):(Pt.d("{93c7910}","{aee7283}"),t)}function Rd(e){return!(!e.h||0==e.h.s)}function kd(e){var t;null===(t=e.h)||void 0===t||0!=t.s&&(t.reset(),pc(t,!1))}function Od(e){var t;null===(t=e.h)||void 0===t||0!=t.s||cc(t)}function Pd(e){var t;if(null===(t=e.h)||void 0===t)var n=void 0;else{e=t.m,t=t.ua();var i=0;if(v(e.u)?i=1:g(e.u)?i=2:"Linux"===e.u.os&&(i=3),e.extraData.set("Platform",i),0===e.h.length||0===t)t=0;else{var s=i=0,r=0;for(const{frameNumber:t,cpuUsage:n}of e.h)i+=r*(t-s-1),i+=n,s=t,r=n;t>s&&(i+=r*(t-s)),t=i/t}for(n of(t&&e.extraData.set("AvgTotalCPUUsage",t),e.extraData.set("DecodeType",e.g),e={saScores:e.saScores,extraData:e.extraData},Pt.i("{240ae89}","{d1eda5e}",e.saScores.overallScore,e.saScores.gpuPerfScore,e.saScores.serverPerfScore,e.saScores.visualScore,e.saScores.decoderScore,e.saScores.downlinkLagScore,e.saScores.downlinkCongestionScore,e.saScores.uplinkScore),e.extraData.entries()))Pt.i("{240ae89}","{4d3c418}",n[0],n[1]);n=e}return n}var Dd=class{constructor(e,t,n,i,s,r,d,l,u,p,f,v,m,A,b,S,y,w,E,I){var C;let T;this.O=f,this.signalingUrlQueryParameters=I,this.name="",this.id=0,this.s={video:[],qd:0,Lb:{Kd:0,bf:0,Qe:0,Re:BigInt("0")}},this.ta=-1,this.I=this.Z=!1,this.G=this.P=this.o=0,this.ra=!1,this.F=this.za=0,this.pa=this.Ya=this.Za=!1,this.Ua=!0,this.stutterIndicator=this.perfIndicator=!1,this.va=0,this.$=[],this.v=[],this.L="",this.ga=0,this.Ba=new class{constructor(){this.g=1}},this.Ab=this.wa=this.xa=this.ya=0,this.Cb=Date.now(),this.cb=this.Bb=this.kb=0,this.qa=!1,this.keyboardLayout="",this.videoStreamProgress=this.maxReceivedAckId=0,this.fa=[],this.sa="",this.S=this.Kc.bind(this),this.ha=this.Jc.bind(this),this.Xa=this.Ic.bind(this),this.Ea=this.Pa.bind(this),this.$a=0,this.da=new ac,this.ab=this.Hc.bind(this),this.oa=new Set,this.aa=new class{constructor(){this.index=0,this.hdr=!1,this.h=!0,this.g=!1}},this.u=u,this.H=t,this.Da=n,this.La=i,this.M=e,Pt.d("{93c7910}","{e1ca54d}",JSON.stringify(p)),p.finalizedStreamingFeatures||Pt.w("{93c7910}","{6f17ef5}"),this.session=p,Hn?(T=Hn,Pt.d("{93c7910}","{55e5b30}",T)):null!=v&&v.maxBitrateKbps&&(T=null==v?void 0:v.maxBitrateKbps,Pt.d("{93c7910}","{965049f}",T)),void 0===w&&void 0!==(null==v?void 0:v.drc)&&(w=v.drc?3:0);for(const e of p.streamInfo){null!=T?I=T:(n=Xo(e.width,e.height,e.fps)[0],Pt.d("{93c7910}","{aff4184}",n),I=n),i=(n=this.s.video).push,f=void 0;var R=I;I=p.finalizedStreamingFeatures,R=Math.max(4e3,R);const t=Math.max(4e3,Math.round(R/4));R={Sb:e.width,Rb:e.height,ic:e.fps,dynamicStreamingMode:w,vc:R,Ad:t,ef:t,uc:!0,bd:4e3,Uc:Ca(null!==(f=e.sdrHdrMode)&&void 0!==f?f:0),bitDepth:Ni(I),nc:"UNKNOWN"},i.call(n,R)}if(this.Gc=Aa(this.u,this.session.streamInfo[0]),async function(){let e=2;var t="minptime=10;useinbandfec=1;channel_mapping=0,4,1,2,3,5;num_streams=4;coupled_streams=2";const n=Mi(6,"v=0\no=- 0 3 IN IP4 127.0.0.1\ns=-\nt=0 0\na=fingerprint:sha-256 A7:24:72:CA:6E:02:55:39:BA:66:DF:6E:CC:4C:D8:B0:1A:BF:1A:56:65:7D:F4:03:AD:7E:77:43:2A:29:EC:93\nm=audio 9 UDP/TLS/RTP/SAVPF 100 101\nc=IN IP4 0.0.0.0\na=rtcp-mux\na=sendonly\na=mid:audio\na=setup:actpass\na=ice-ufrag:ETEn\na=ice-pwd:OtSK0WpNtpUjkY4+86js7Z/l\r\na=rtpmap:100 multiopus/48000/6\r\na=fmtp:100 "+t+"\r\na=rtpmap:101 opus/48000/2\na=fmtp:101 minptime=10;useinbandfec=1\n",t);t=Mi(8,"v=0\no=- 0 3 IN IP4 127.0.0.1\ns=-\nt=0 0\na=fingerprint:sha-256 A7:24:72:CA:6E:02:55:39:BA:66:DF:6E:CC:4C:D8:B0:1A:BF:1A:56:65:7D:F4:03:AD:7E:77:43:2A:29:EC:93\nm=audio 9 UDP/TLS/RTP/SAVPF 100 101\nc=IN IP4 0.0.0.0\na=rtcp-mux\na=sendonly\na=mid:audio\na=setup:actpass\na=ice-ufrag:ETEn\na=ice-pwd:OtSK0WpNtpUjkY4+86js7Z/l\r\na=rtpmap:100 multiopus/48000/8\r\na=fmtp:100 "+(t="minptime=10;useinbandfec=1;channel_mapping=0,6,1,2,3,4,5,7;num_streams=5;coupled_streams=3")+"\r\na=rtpmap:101 opus/48000/2\na=fmtp:101 minptime=10;useinbandfec=1\n",t),await Promise.all([n,t]).then((t=>{e=Math.max(Number(t[0]),Number(t[1]))})),Pt.i("{d988e7f}","{dc7ee29}",e)}(),this.l=l,l=p.appId,(w=Mn.disableUnadjustedMovementForAppIds)&&-1!==w.indexOf(l)?(Pt.i("{d988e7f}","{265cfdc}",l),l=!1):l=Yt,this.Nb={unadjustedMovement:l,...s},this.ja=e,this.Ob=r,this.C=d,this.T=m,this.textInputElement=A,this.appLaunchMode=p.appLaunchMode,this.clientAppVersion=b,this.isResume=S,this.Nd=y,E)for(const e of E)if(e.track instanceof MediaStreamTrack&&"video"===e.track.kind){this.sendVideoTrack=e.track;break}if(this.sendVideoTrack=null!==(C=this.sendVideoTrack)&&void 0!==C?C:null==v?void 0:v.sendVideoTrack,e=(e=this.session.signalConnectionInfo.protocol).replace("http","ws"),this.N=e+"://"+this.session.signalConnectionInfo.ip+":"+this.session.signalConnectionInfo.port,(e=this.session.signalConnectionInfo.resourcePath)&&(this.N+=("/"===e.charAt(0)?"":"/")+e,"/"===this.N.charAt(this.N.length-1)&&(this.N=this.N.slice(0,-1))),s=this.session.sessionId,r=this.l,d=this.Ba,p=this.O,0<(e=Ic).h.length){for(var k of e.h)nl(r,k.name,k.error);e.h=[]}if(0<e.j.length){for(var O of e.j)Ec(r,O);e.j=[]}k=e.s++,Pt.i("{1f5ec29}","{c194458}",k,s),O=new class{constructor(e,t,n,i,s,r){this.instanceId=e,this.m=n,this.s=i,this.l=s,this.g=r,this.o=this.h=!1,this.perf={RAFTS:0,DCSend:0,GetStats:0,FrameInfo:0},this.g?(this.g.postMessage({initMessage:{sessionId:t},instanceId:this.instanceId}),Pt.d("{1f5ec29}","{404f264}")):Pt.e("{1f5ec29}","{c62bf29}")}startWebSocket(e,t,n,i){this.j=n,this.g&&(this.g.postMessage({startWebSocket:{signInURL:e,maxReceivedAckId:t,reconnect:i},instanceId:this.instanceId}),Pt.d("{1f5ec29}","{b3f6faa}"))}stopWebSocket(){if(this.g){const e={stopWebSocket:!0,instanceId:this.instanceId};Pt.d("{1f5ec29}","{7ac815d}"),this.g.postMessage(e)}this.j=void 0}uninitialize(){var e;this.o||null===(e=this.m)||void 0===e||nl(e,"Worker Thread Creation Failed"),this.g&&(e={uninitialize:!0,instanceId:this.instanceId},Pt.d("{1f5ec29}","{9212ec5}",this.instanceId),this.g.postMessage(e))}}(k,s,r,d,p,e.l),e.g.set(k,O),this.D=O,this.O.g=performance.now(),this.ma=new class{constructor(e,t,n,i){this.m=e,this.H=t,this.u=n,this.l=i,this.h={top:-1,left:-1,bottom:-1,right:-1},this.Ra=this.Oa=0,this.j=!1,this.o=0,Kt&&((e=document.createElement("div")).style.display="none",e.style.position="absolute",e.style.color="white",e.style.backgroundColor="rgb(105, 105, 105, 0.7)",e.style.padding="2px",e.style.bottom="0px",e.style.left="0px",e.style.margin="5px",this.g=e,t.insertAdjacentElement("afterend",this.g))}uninitialize(){this.g&&this.g.remove()}send(){var e,t,n;if(!(0>=this.H.videoHeight||0>=this.H.videoWidth)){var i=Ai(),s=function(e,t){let{width:n,height:i}={width:screen.width,height:screen.height};var s=()=>{let e;switch(void 0!==window.orientation?e=window.orientation:screen.orientation&&(e=screen.orientation.angle),e){case 90:case-90:case 270:return!1;default:return!0}};o(e.u)&&(t.top=Math.max(t.top,20),s()||(s=n,n=i,i=s)),s=(t=>{let n=t.offsetTop,i=t.offsetLeft;for(var s=t.offsetParent;s;)n+=s.offsetTop,i+=s.offsetLeft,s=s.offsetParent;s=t.clientHeight;let r=t.clientWidth;return"Android"===e.u.os&&(window.innerHeight>window.innerWidth&&t.clientHeight<t.clientWidth||window.innerHeight<window.innerWidth&&t.clientHeight>t.clientWidth)&&(Pt.w("{48f82fd}","{c9d343e}"),s=t.clientWidth,r=t.clientHeight),{top:n,left:i,bottom:Math.max(window.innerHeight-n-s,0),right:Math.max(window.innerWidth-i-r,0)}})(e.H);const r=Math.max(i-window.innerHeight,0)/2,a=Math.max(n-window.innerWidth,0)/2;return{top:Math.max(t.top-r-s.top-e.Oa,0)/(e.H.clientHeight-2*e.Oa),left:Math.max(t.left-a-s.left-e.Ra,0)/(e.H.clientWidth-2*e.Ra),bottom:Math.max(t.bottom-r-s.bottom-e.Oa,0)/(e.H.clientHeight-2*e.Oa),right:Math.max(t.right-a-s.right-e.Ra,0)/(e.H.clientWidth-2*e.Ra)}}(this,i);if(!function(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0}(s,this.h)){var r=JSON.stringify(s,((e,t)=>t.toFixed?Number(t.toFixed(2)):t));Pt.d("{48f82fd}","{054b8b0}",JSON.stringify(i),r),null!==(e=Mn.sendInsetValueUpdateEvents)&&void 0!==e&&e&&2>this.o++&&(i=(e=(e,t=1)=>{for(const n of Object.keys(e)){const i=Math.round(e[n]*t);e[n]=isNaN(i)?-1:i}return e})(Object.assign({},i)),e=e(Object.assign({},s),1e3),null===(t=this.l)||void 0===t||sl(t,"InsetValueUpdate","Original",i.top,i.left,i.bottom,i.right),null===(n=this.l)||void 0===n||sl(n,"InsetValueUpdate","Normalized",e.top,e.left,e.bottom,e.right)),this.h=Object.assign({},s);for(const e of Object.keys(s))s[e]=isNaN(s[e])?0:s[e];t={messageType:"SAFE_ZONE",messageRecipient:"NvGridSvc:NGS",data:JSON.stringify({safeZoneData:{type:"InsetValueUpdate",rect:s}})},this.m.sendCustomMessage(t),Kt&&this.g&&(this.g.innerText="Safe Zone: \nTop: "+(100*Math.max(this.h.top,0)).toFixed()+"%\nRight: "+(100*Math.max(this.h.right,0)).toFixed()+"%\nBottom: "+(100*Math.max(this.h.bottom,0)).toFixed()+"%\nLeft: "+(100*Math.max(this.h.left,0)).toFixed()+"%")}}}}(this,t,this.u,this.l),this.j=new class{constructor(e){var t,n,i,s;this.g=new Map,this.C=this.s=this.j=!1,this.o=void 0,this.g.set(0,[]),this.g.set(2,[]),this.g.set(1,[]),this.g.set(3,[]),this.g.set(4,[]),this.g.set(5,[]),this.g.set(6,[]),this.S=function(e){var t;switch(null!==(t=e.platformType)&&void 0!==t?t:e.deviceType){case"PHONE":case"TABLET":return!0;default:return!1}}(e),this.V=h(e),this.U="iPadOS"===e.os,this.R=g(e),this.F=a(e),this.T=c(e),this.h=this.v=document.hasFocus(),this.l=0;const r=null!==(n=null===(t=null==(e=window.zoneless)?void 0:e.windowAddEventListener)||void 0===t?void 0:t.bind(window))&&void 0!==n?n:window.addEventListener.bind(window),o=null!==(s=null===(i=null==e?void 0:e.documentAddEventListener)||void 0===i?void 0:i.bind(document))&&void 0!==s?s:document.addEventListener.bind(document);this.M=this.aa.bind(this),this.K=this.Z.bind(this),this.N=this.I.bind(this),this.O=this.ba.bind(this),this.P=this.da.bind(this),this.L=this.$.bind(this),this.J=this.W.bind(this),this.D=this.G.bind(this),r("focus",this.M),r("blur",this.K),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach((e=>o(e,this.N))),o("mouseenter",this.O),o("mouseleave",this.P),navigator.getBattery&&navigator.getBattery().then((e=>{Uc(this,!e.charging),jc(this,Gc(this,e)),e.addEventListener("chargingchange",this.L),e.addEventListener("levelchange",this.J)})),Bc(this)&&(this.G(),window.screen.addEventListener("change",this.D)),Vc()?(this.m=new PressureObserver((e=>{if(0<e.length){let t="nominal";for(const n of e)Hc(n.state)>Hc(t)&&(t=n.state);if(e=t,this.o!=e){this.o=e;for(const e of this.g.get(5))e()}}})),this.m.observe("cpu")):Pt.i("{0c4eeb2}","{c70b747}"),this.I()}uninitialize(){var e,t,n,i,s,r,o;const a=window.zoneless,c=null!==(t=null===(e=null==a?void 0:a.windowRemoveEventListener)||void 0===e?void 0:e.bind(window))&&void 0!==t?t:window.removeEventListener.bind(window),d=null!==(i=null===(n=null==a?void 0:a.documentRemoveEventListener)||void 0===n?void 0:n.bind(document))&&void 0!==i?i:document.removeEventListener.bind(document);c("focus",this.M),c("blur",this.K),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"].forEach((e=>d(e,this.N))),d("mouseenter",this.O),d("mouseleave",this.P),navigator.getBattery&&navigator.getBattery().then((e=>{e.removeEventListener("chargingchange",this.L),e.removeEventListener("levelchange",this.J)})),Bc(this)&&window.screen.removeEventListener("change",this.D),null==(e=null===(s=this.m)||void 0===s?void 0:s.takeRecords())||e.map((e=>Pt.i("{0c4eeb2}","{4f27ba0}",JSON.stringify(e)))),null===(r=this.m)||void 0===r||r.unobserve("cpu"),null===(o=this.m)||void 0===o||o.disconnect();for(const e of this.g.values())e.splice(0)}aa(){Fc(this,!0)}Z(){Fc(this,!1)}I(){var e=window.document;if(e=!!(document.fullscreen||1==e.webkitIsFullScreen||e.mozFullScreen||e.msFullscreenElement),this.j!==e){this.j=e;for(const t of this.g.get(2))t(e)}}ba(){Wc(this,!0)}da(){Wc(this,!1)}$(){navigator.getBattery().then((e=>{Uc(this,!e.charging)}))}W(){navigator.getBattery().then((e=>{jc(this,Gc(this,e))}))}G(){let e;if(e=window.screen.isExtended?3:0,Pt.i("{0c4eeb2}","{ee99c72}",e),this.l!==e){this.l=e;for(const t of this.g.get(6))t(e)}}}(u),(t=document.createElement("div")).style.position="absolute",t.style.zIndex="300",t.style.left="0",t.style.top="0",t.style.width="100%",t.style.display="none",t.style.fontSize="3em",t.style.color="white",t.style.backgroundColor="gray",t.style.textAlign="center",this.H.insertAdjacentElement("afterend",t),this.ea=t,this.ib={Eb:32768,Jb:256,Kb:255,Ga:this.na.bind(this)},this.jb={Eb:16384,Jb:512,Kb:65280,Ga:this.Db.bind(this)},this.Wa={Eb:16384,Jb:512,Kb:255,Ga:this.Fc.bind(this)},this.bb={Eb:8192,Jb:256,Kb:255,Ga:this.toggleOnScreenStats.bind(this)},this.Nc={Eb:4096,Jb:256,Kb:255,Ga:this.toggleStutterIndicator.bind(this)},this.Ka={od:0,Ee:0,Pc:0,fd:0,hd:0,gd:0,Qd:0,cd:0,Oc:0,dd:0},this.Ta=this.Pb.bind(this)}start(){(function(e){rd(e);let t=1e4;Mn.signInTimeout&&0!==Mn.signInTimeout&&(t=Mn.signInTimeout,Pt.i("{93c7910}","{4f2f101}",t)),e.F=window.setTimeout((()=>e.signInTimeout()),t),e.Ab=Date.now(),hd(e)})(this),this.O.g=performance.now(),sd(this),Kt&&(this.C.m.push(this.ib),this.C.m.push(this.jb),this.C.m.push(this.Wa),this.C.m.push(this.bb),this.C.m.push(this.Nc))}stop(e){var t,n,i,s;sl(this.l,"StreamTimersAndReconnects",l(e),0,this.kb,this.Bb,this.cb);const r=t=>{Pt.i("{93c7910}","{a848987}",t),sl(this.l,"PeerAPIDurationsAndMic",l(e),this.wa,this.ya,this.xa,t)};Fo().then((e=>{r(e)})),od(this,{code:e,description:"Session stopped before stream connected"}),this.P&&(clearTimeout(this.P),this.P=0),this.ea.remove(),this.Z=!0;try{ad(this,{exitMessage:{code:Bt(e)}})}catch(e){Pt.e("{93c7910}","{d337883}",e)}cd(this),this.J&&this.J.close(),null===(t=this.K)||void 0===t||t.close(),dd(this),null===(n=this.g)||void 0===n||n.removeEventListener("icecandidate",this.ab),this.g&&this.g.close(),function(e){var t;if(null!==(t=e.ba)&&void 0!==t){for(const e of t.streams){var n=(new Date).toISOString();n=`streamkit-${e.Id}-${n}.${e.hg}`,Di([new DataView(e.data.buffer,0,e.size)],n,"text/plain")&&Pt.i("{d7392d2}","{4b3378a}",n)}t.streams=[]}e.ba=void 0}(this),0!==this.G&&(window.clearTimeout(this.G),this.G=0),0!==this.F&&(window.clearTimeout(this.F),this.F=0),wc(this.D),null===(i=this.R)||void 0===i||i.uninitialize(),this.D.stopWebSocket(),sd(this),function(e){var t=Ic;e.uninitialize(),t.g.delete(e.instanceId)}(this.D),this.sa&&this.Ua&&(Pt.e("{93c7910}","{283a180}"),nl(this.l,"Audio track muted")),0<this.za&&sl(this.l,"WebSocketClose","",0,this.za,0,0),null===(s=this.T)||void 0===s||s.uninitialize(),this.ma.uninitialize(),_c(this.j,0,this.S),_c(this.j,1,this.S),_c(this.j,2,this.S),_c(this.j,4,this.ha),_c(this.j,3,this.ha),_c(this.j,5,this.Xa),_c(this.j,6,this.Ea),this.j.uninitialize(),mr(this.C,this.ib),mr(this.C,this.jb),mr(this.C,this.Wa),mr(this.C,this.bb),this.H.srcObject=null,this.Da&&(this.Da.srcObject=null)}signInTimeout(){var e,t;this.F=0,Pt.i("{93c7910}","{6d6b337}"),rl(this.l,this.L,0,null!==(t=null===(e=this.session)||void 0===e?void 0:e.signalConnectionInfo.ip)&&void 0!==t?t:"","signInTimeout",this.ga,!1),od(this,{code:3237093907})}Mc(e){Pt.i("{8ba4138}","{0b0c6f9}",e)}Lc(e){this.l.Aa(void 0,e,"{8ba4138}.ts",0,0,!0),Pt.e("{8ba4138}","{0b0c6f9}",e)}setUpstreamMedia(){return Promise.resolve(!1)}unsetUpstreamMedia(){return Promise.resolve(!1)}stopUpstreamMedia(){return Promise.resolve(!1)}Hc(e){Pt.d("{93c7910}","{4742d5e}"),e.candidate&&this.$a++,!window.chrome&&this.g&&this.g.canTrickleIceCandidates&&this.g.onicecandidate&&Sd(this,e,!0)}Pb(){var e,t;null===(e=this.h)||void 0===e||function(e){var t,n=e.v;if(n.h&&(0!=n.perf.RAFTS&&(n.g&&n.g.postMessage({perf:n.perf,instanceId:n.instanceId}),n.perf.RAFTS=0,n.perf.DCSend=0,n.perf.GetStats=0,n.perf.FrameInfo=0),n.perf.RAFTS=null!==(t=Il(n.l))&&void 0!==t?t:0),!Fn){if(n=window.performance.now(),(t=e.ya).getVideoPlaybackQuality){var i=t.getVideoPlaybackQuality();t={td:i.totalVideoFrames,Ne:i.droppedVideoFrames}}else t=void 0!==t.webkitDecodedFrameCount?{td:t.webkitDecodedFrameCount,Ne:null!==(i=t.webkitDroppedFrameCount)&&void 0!==i?i:0}:void 0;var s=t;if(s){const n=s.Ne;i=n-e.D.droppedVideoFrames,t=s.td-e.D.totalVideoFrames,e.D.droppedVideoFrames=n,e.D.totalVideoFrames=s.td,1==i?e.h.Qd++:1<i&&(e.h.cd+=i),(s=e.v).h&&(s.perf.FrameInfo=Math.min(t,15)<<4|Math.min(i,15))}e.D.sg=n}}(e),window.setTimeout((()=>{var e,t;if(this.Z||window.requestAnimationFrame(this.Ta),null!==(e=this.m)&&void 0!==e){var n=e.j;0===n.I&&As(n.o),Gn&&zn&&e.m.fa()}null===(t=this.h)||void 0===t||Fn||((e=window.performance.now())>t.h.od+1e4?(0!==t.h.od&&Pt.i("{5cea617}","{5fa9066}",t.h.Pc,t.h.fd,t.h.hd,t.h.gd,t.D.totalVideoFrames-t.h.Ee,t.h.Qd,t.h.cd,t.h.Oc,t.h.dd),t.h.od=e,t.h.Ee=t.D.totalVideoFrames,t.h.Pc=1,t.h.fd=0,t.h.hd=0,t.h.gd=0,t.h.Qd=0,t.h.cd=0,t.h.Oc=0,t.h.dd=0):t.h.Pc+=1)})),null===(t=this.m)||void 0===t||function(e){if(e.h.Sc){e.h.Sc=!1;var t=e.g.qb,n=e.g.rb;if(0===e.cursorType)if(e.ba&&e.g.pb){var i=Wr(e.h.ub/e.g.cursor.scale);e.h.Xc&&(e.h.Xc=!1,qr(e,i));const s=e.g.cursor,r=e.h.ub;i/=r,t=(t*e.l.la-s.Ha*i)*r,n=(n*e.l.la-s.Ia*i)*r,e.fa||(t=Math.round(t),n=Math.round(n)),e.j.style.transform="translate("+t/r+"px, "+n/r+"px)",e.h.jd||(e.h.jd=!0,e.j.style.visibility="visible")}else zr(e)}}(t.j)}toggleOnScreenStats(e=!1,t){Kt&&(Rd(this)?this.h.toggleOnScreenStats(e,t):Xc(this,"Stats is OFF. Please enable by ctrl+alt+F5/F6"))}na(){var e;if(null!==(e=this.h)&&void 0!==e){var t=e.v;t.h&&t.g&&t.g.postMessage({qosMarker:Il(t.l),instanceId:t.instanceId}),e.g.R++,(t=e.g).L.innerText=Oa(t,2===e.L)}Xc(this,"User marker added")}ua(){return this.h?this.h.ua():0}fb(){var e;let t=null===(e=this.h)||void 0===e?void 0:e.fb();return(void 0===t||"UNKNOWN"===t)&&(t=this.s.video[0].nc),t}toggleUserInput(e,t){this.m?this.m.toggleUserInput(e,t):Pt.e("{93c7910}","{5a0e299}",e)}toggleRsdmm(e){var t;null===(t=this.m)||void 0===t||t.toggleRsdmm(e)}getVirtualGamepadHandler(){var e;return null===(e=this.m)||void 0===e?void 0:e.getVirtualGamepadHandler()}toggleStutterIndicator(e){this.stutterIndicator=e??!this.stutterIndicator,Ad(this,{stutterIndicator:{on:this.stutterIndicator}})}Db(){this.va^=1,Ad(this,{riDeviceOverlay:{bitmap:this.va}})}Fc(){var e;null===(e=this.m)||void 0===e||e.Cc()}sendTextInput(e){var t;null===(t=this.m)||void 0===t||t.sendTextInput(e)}setVirtualKeyboardState(e){var t;null===(t=this.m)||void 0===t||t.setVirtualKeyboardState(e)}setVideoTransforms(e,t,n){var i;if(null!==(i=this.m)&&void 0!==i){const s=window.visualViewport;s&&(i.g.Ec=s.height),vo(i,e,t,n)}}sendCustomMessage(e){Ad(this,e={customMessage:JSON.stringify(e)})}setStreamingMaxBitrate(e,t,n){n||(Ad(this,{setMaxBitrate:{streamIndex:e,maxBitrate:t}}),Pt.d("{93c7910}","{6bbc1a2}",t))}setDrcDfcState(e,t,n){n||(Ad(this,{setDrcState:{streamIndex:e,state:!!(1&t)}}),Ad(this,{setDfcState:{streamIndex:e,state:!!(2&t)}}),Pt.d("{93c7910}","{0ed76f3}",t))}startInputPlayback(e){var t;null===(t=this.m)||void 0===t||t.startInputPlayback(e)}sendKeyEvent(e){var t;null===(t=this.m)||void 0===t||t.sendKeyEvent(e)}setKeyboardLayout(e){this.keyboardLayout=e,this.m?(this.sendCustomMessage({messageType:"kbLayout",messageRecipient:"KBLayoutChange",data:e}),this.m.setKeyboardLayout(e)):this.qa=!0}Kc(){Rd(this)?wd(this,this.h.ua()):Pt.w("{93c7910}","{76bcede}")}Jc(){Rd(this)?Ed(this,this.h.ua()):Pt.w("{93c7910}","{20ab5a1}")}Ic(){Rd(this)?Id(this,this.h.ua()):Pt.w("{93c7910}","{7b1f129}")}Pa(e){var t;Rd(this)?null===(t=this.h)||void 0===t||t.m.extraData.set("Display",e):Pt.w("{93c7910}","{1b4b74e}")}};function Ld(e){var t;return null!==(t=null==e?void 0:e.readyState)&&void 0!==t?t:"connecting"}function xd(e){return e.replace(/((ice-pwd|ufrag)(:|\s))((?!(\\|\s)).)*/g,"$1***")}function Md(e){const t=RegExp('(candidate:[^"\\r\\n\\\\]+)(\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b)',"g");let n="";for(;n!==e;)n=e,e=e.replace(t,"$1***");return e}function Nd(e,t){e.h=!1,e.j=!1,e.g=t,e.g.onversionchange=()=>{Pt.w("{10dc2cc}","{65276d8}"),e.close(),e.g=void 0},e.g.onclose=()=>{Pt.w("{10dc2cc}","{342f7f8}"),e.h=!0,e.j=!0}}function _d(e){return e.l?e.g?e.h?R(2,"Db is closing, unexpectedly: "+e.j+", visibility state hidden: "+("hidden"===document.visibilityState)):void 0:R(1,"Db not yet open"):R(17,"Indexdb object not found")}function Fd(e,t){const n=_d(e);return n?Promise.reject(n):new Promise(((n,i)=>{try{const s=e.g.transaction(t,"readwrite"),r=s.objectStore(t);s.oncomplete=()=>{Pt.i("{10dc2cc}","{30f23d1}")};const o=r.clear();o.onsuccess=()=>{n()},o.onerror=()=>{i(R(80,"clear method failed)",s.error))}}catch(e){i(R(81,"Unexpected Exception happened in clear",e))}}))}function Ud(e,t){const n=_d(e);return n?Promise.reject(n):new Promise(((n,i)=>{try{const s=e.g.transaction(t,"readonly"),r=s.objectStore(t);s.oncomplete=()=>{Pt.i("{10dc2cc}","{59d1f78}")};const o=r.getAll();o.onsuccess=()=>{n(o.result)},o.onerror=()=>{i(R(96,"getAll method failed",s.error))}}catch(e){i(R(97,"Unexpected Exception in getAll",e))}}))}function jd(e,t){const n=e.j.get(t);if(n){e.h=n;for(const t of e.g)t(e.getCurrentNetworkType())}else Pt.d("{aac1655}","{1e3c13d}",t)}var Gd=new class{constructor(){var e;this.j=new Map([["Ethernet","ETHERNET"],["5GHz_WiFi","WIFI_5_0"],["2.4GHz_WiFi","WIFI_2_4"],["Others","OTHER"],["disconnected","UNKNOWN"],["wifi","WIFI"],["ethernet","ETHERNET"],["none","UNKNOWN"],["bluetooth","BLUETOOTH"],["wimax","WIMAX"],["other","OTHER"],["mobile","MOBILE"],["unknown","UNKNOWN"],["NONE","UNKNOWN"],["UNKNOWN","UNKNOWN"],["ETHERNET","ETHERNET"],["WIFI","WIFI"],["NET_PROXY","OTHER"],["2G","MOBILE_2G"],["2.5G","MOBILE_2G"],["3G","MOBILE_3G"],["4G","MOBILE_4G"]]),this.h="UNKNOWN",this.g=[],window.addEventListener("GFNNetworkInfo",(e=>{Pt.d("{aac1655}","{2925c9d}",e.detail.state),jd(this,e.detail.state)}));const t=navigator.connection;if(null!=t&&t.type&&(jd(this,t.type),t.addEventListener("change",(()=>{var e;const t=null===(e=navigator.connection)||void 0===e?void 0:e.type;t&&(Pt.d("{aac1655}","{4a9e05b}",t),jd(this,t))}))),null!==(e=window.tizen)&&void 0!==e&&e.systeminfo){e=e=>{(e=e.networkType)&&(Pt.d("{aac1655}","{e9b5f27}",e),jd(this,e))};try{window.tizen.systeminfo.getPropertyValue("NETWORK",e),window.tizen.systeminfo.addPropertyValueChangeListener("NETWORK",e)}catch(e){Pt.w("{aac1655}","{7d035ae}",e)}}}registerCallback(e){this.g.push(e)}unregisterCallback(e){const t=this.g.findIndex((t=>t==e));-1!==t&&this.g.splice(t,1)}getCurrentNetworkType(){return this.h}};function Bd(e,t,n,i){var s,r,o,a;Pt.e("{f7c1592}","{146ec91}",n,l(t.code),t.description),i&&(i=null!==(o=null!==(r=null===(s=t.error)||void 0===s?void 0:s.message)&&void 0!==r?r:t.description)&&void 0!==o?o:`Exception in ${n}`,e.G?e.G(t.error,i,"telemetryeventprocessor.ts",t.code,0,!0,null===(a=t.error)||void 0===a?void 0:a.name):Pt.w("{f7c1592}","{12e0846}"))}function Vd(e,t){let n={};if(!e.g.commonData)return n;const i={name:t.name,ts:t.ts,parameters:t.parameters};return Wd(n,e.g),(e=n.commonData).clientId=t.clientConfig.clientId,e.eventSchemaVer=t.clientConfig.eventSchemaVer,e.sentTs=(new Date).toISOString(),e.events=[i],n}function Hd(e,t){if(e.g.commonData){var n=t.gdprLevel;let i=!1;e.g.commonData&&("functional"!==n||"Full"!==e.g.commonData.deviceGdprFuncOptIn&&"Temp"!==e.g.commonData.deviceGdprFuncOptIn?("technical"===n&&"Full"===e.g.commonData.gdprTechOptIn||"behavioral"===n&&"Full"===e.g.commonData.gdprBehOptIn)&&(i=!0):i=!0),i&&(window.navigator.onLine?function(e){var t,n,i,s;null!==(t=e.config)&&void 0!==t&&t.server&&null!==(n=e.config)&&void 0!==n&&n.version&&(t={method:"POST",headers:{"Content-Type":"application/json","X-Event-Protocol":null!==(s=null===(i=e.commonData)||void 0===i?void 0:i.eventProtocol)&&void 0!==s?s:"1.5"},body:JSON.stringify(e.commonData),retryCount:3,timeout:2e3},Pt.i("{f7c1592}","{056661f}",t.body),Lt(qd(e.config),t).then((()=>{})).catch((()=>{})))}(Vd(e,t)):function(e,t){!e.j&&Xd(t)&&e.m.then((()=>e.l.set("telemetry-events",t))).then((()=>{Pt.i("{f7c1592}","{f03d70b}")})).catch((t=>{const n=!e.D;e.D=!0,Bd(e,t,"cacheTelemetryEventInDb",n)}))}(e,{userId:e.g.commonData.userId,sessionId:e.g.commonData.sessionId,name:t.name,eventPayload:t}))}else e.C.push(t)}function Wd(e,t){e.commonData=t.commonData?Object.assign({},t.commonData):void 0,e.experiments=[],e.config=t.config,e.telemetryEventIds=t.telemetryEventIds}function qd(e){return e.server+"/"+e.version+"/events/json"}function zd(e,t){var n,i,s;e.h.userId=null!==(i=null===(n=e.g.commonData)||void 0===n?void 0:n.userId)&&void 0!==i?i:"",e.h.sessionId=null!==(s=t.parameters.sessionId)&&void 0!==s?s:"",e.h.name=t.name,e.h.eventPayload=t}function Kd(e){var t,n;null!==(t=e.config)&&void 0!==t&&t.server&&null!==(n=e.config)&&void 0!==n&&n.version&&e.experiments&&(e.commonData&&(e.commonData.sentTs=(new Date).toISOString()),t=JSON.stringify(e.commonData),e=navigator.sendBeacon(qd(e.config),new Blob([t],{type:"text/plain"})),Pt.i("{f7c1592}","{b9367c5}",e,t))}function $d(e){Pt.d("{f7c1592}","{badefed}",!0),function(e){e.j||e.m.then((()=>Fd(e.l,"exit-events"))).then((()=>{Pt.i("{f7c1592}","{1b8f127}")})).catch((t=>{Bd(e,t,"clearExitEventStoreInDb",!e.s),e.s||(e.s=!0)}))}(e),e.h.eventPayload=void 0}function Jd(e,t){var n;const i=new _t({zoneAddress:t.zoneAddress,networkSessionId:null!==(n=t.networkTestSessionId)&&void 0!==n?n:"",sessionId:t.sessionId,subSessionId:t.subSessionId,resumeType:Oi(t.isResume),overrideConfigType:_n.type,overrideConfigVersion:_n.version,exitReason:tl(t.connectivityInfo,t.sleep),result:t.exitErrorCode,frameCount:t.frameCount,codec:Ti(t.codec),ipVersion:"UNKNOWN",streamDuration:Math.round(t.streamDuration),networkType:k(Gd.getCurrentNetworkType()),streamingProfileGuid:Qd(e),systemInfoGuid:Yd(e),cmsId:String(e.F)});return{name:i.name,gdprLevel:i.gdprLevel,parameters:i.parameters,ts:i.ts,clientConfig:Mt}}function Qd(e){var t,n,i;return null!==(i=null===(n=null===(t=e.g)||void 0===t?void 0:t.telemetryEventIds)||void 0===n?void 0:n.streamingProfileGuid)&&void 0!==i?i:""}function Yd(e){var t,n,i;return null!==(i=null===(n=null===(t=e.g)||void 0===t?void 0:t.telemetryEventIds)||void 0===n?void 0:n.systemInfoGuid)&&void 0!==i?i:""}function Xd(e){return!!e.userId&&!!e.sessionId&&!!e.name}function Zd(e){return e.j||!Xd(e.h)?Promise.resolve():e.m.then((()=>e.l.set("exit-events",e.h))).then((()=>{Pt.i("{f7c1592}","{5d026f8}")})).catch((t=>{Bd(e,t,"cacheExitEventInDb",!e.o),e.o||(e.o=!0)}))}function el(e){e.j||window.navigator.onLine&&e.m.then((()=>Ud(e.l,"telemetry-events"))).then((t=>{if(Pt.i("{f7c1592}","{d4e574c}",t.length),0<t.length){!function(e){e.j||e.m.then((()=>Fd(e.l,"telemetry-events"))).then((()=>{Pt.i("{f7c1592}","{8f62936}")})).catch((t=>{Bd(e,t,"clearEventStoreInDb",!e.v),e.v||(e.v=!0)}))}(e);for(const n of t)n.eventPayload&&Hd(e,n.eventPayload)}})).catch((e=>{Pt.e("{f7c1592}","{aaaa3de}",e.code,e.description)}))}function tl(e,t){var n;return t?"SleepExit":null!==(n=null==e?void 0:e.description)&&void 0!==n?n:"undefined"}function nl(e,t,n,i,s,r){t=new we({key1:t??"",key2:n??"",key3:i??"",key4:s??"",key5:r??"",moduleName:"RAGNAROK",networkType:k(Gd.getCurrentNetworkType()),overrideConfigType:_n.type,overrideConfigVersion:_n.version,cmsId:e.h(),sessionId:e.sessionId,subSessionId:e.subSessionId}),e.processEvent(t)}function il(e,t,n,i,s,r,o,a,c){50<=e.D||(e.D++,t=new Ft({deviceName:t,deviceType:"GAMEPAD",vendorId:n,productId:i,deviceIndex:s,reportIndex:o?0:s,hapticsSupported:ki(r),hapticsFeedbackCount:0,state:a,eventMapReceived:c,eventMapProcessed:c,sessionId:e.sessionId,subSessionId:e.subSessionId,cmsId:e.h()}),e.processEvent(t))}function sl(e,t,n,i,s,r,o){t=new Ie({metricName:t,moduleName:"RAGNAROK",valueInt1:s,valueInt2:r,valueInt3:o,valueString:n,valueDouble:i,networkType:k(Gd.getCurrentNetworkType()),cmsId:e.h(),sessionId:e.sessionId,subSessionId:e.subSessionId}),e.processEvent(t)}function rl(e,t,n,i,s,r,o){t=new Te({retryCount:r,sessionId:e.sessionId,subSessionId:e.subSessionId,serverId:i,url:t,overrideConfigType:_n.type,overrideConfigVersion:_n.version,disconnectionReason:s,cleanDisconnection:ki(o),networkType:k(Gd.getCurrentNetworkType()),statusCode:n?n.toString():"",cmsId:e.h(),moduleName:"RAGNAROK"}),e.processEvent(t)}function ol(e,t,n,i,s,r){var o,a,c;const d=xt.getTelemetryEventIds();t=new _t({zoneAddress:e.zoneAddress,sessionId:e.sessionId,subSessionId:e.subSessionId,resumeType:Oi(e.isResume),cmsId:e.cmsId,overrideConfigType:_n.type,overrideConfigVersion:_n.version,exitReason:n,result:t,frameCount:r,codec:Ti(s),ipVersion:"UNKNOWN",streamDuration:Math.round(i),networkType:k(Gd.getCurrentNetworkType()),streamingProfileGuid:null!==(o=d.streamingProfileGuid)&&void 0!==o?o:"",systemInfoGuid:null!==(a=d.systemInfoGuid)&&void 0!==a?a:"",networkSessionId:null!==(c=d.networkSessionId)&&void 0!==c?c:""}),e.m=e.j.cacheEvent(t,e.m)}function al(e){e.j.processCachedEvent(e.m),e.m=0}var cl=class{constructor(){this.cmsId=this.subSessionId=this.sessionId="",this.isResume=!1,this.zoneAddress="",this.D=0,this.s=new Map,this.l=this.m=this.v=0,this.j=xt.createTelemetryProvider(Mt)}Aa(e,t,n,i,s,r,o){var a;if(50<=this.v)var c=!1;else{var d=null!==(c=this.s.get(t))&&void 0!==c?c:0;10<=d?c=!1:(this.v++,this.s.set(t,d+1),c=!0)}c&&(e instanceof DOMException&&(e={name:e.name,message:e.message}),e=new Ee({filename:n,lineno:i,stacktrace:null!==(a=null==e?void 0:e.stack)&&void 0!==a?a:"",colno:s,handled:ki(r),category:o??"",message:t,moduleName:"RAGNAROK",sessionId:this.sessionId,subSessionId:this.subSessionId}),this.processEvent(e))}processEvent(e){this.j.processEvent(e)}h(){return this.cmsId}};function dl(e){return e.clientShutDownCallback?(Pt.d("{9838627}","{c7dcc4e}"),function(e){return e.j?Promise.resolve([]):e.m.then((()=>Ud(e.l,"exit-events"))).then((e=>{Pt.i("{f7c1592}","{d938300}",e.length);let t=[];if(0<e.length)for(const n of e)n.eventPayload&&t.push(n.eventPayload);return t})).catch((t=>(Bd(e,t,"getCachedExitEvents",!0),Promise.reject())))}(e.g).then((t=>{for(const n of t)e.C(n);$d(e.g)})).catch((()=>{Pt.d("{9838627}","{41cf828}")}))):(Pt.d("{9838627}","{77df598}"),function(e){return e.j?Promise.resolve():e.m.then((()=>Ud(e.l,"exit-events"))).then((t=>{if(Pt.i("{f7c1592}","{ca568ff}",t.length),0<t.length){for(const n of t)n.eventPayload&&Kd(Vd(e,n.eventPayload));$d(e)}})).catch((t=>{Bd(e,t,"sendCachedExitEvent",!0)}))}(e.g))}function ll(e,t,n){let i=!1;e.clientShutDownCallback&&(i=e.clientShutDownCallback(t),Pt.d("{9838627}","{caf81d9}",i)),i||(Pt.d("{9838627}","{e939db1}"),n(t))}function ul(e,t,n){e.F.hasListener("TelemetryEvent")?e.F.emit("TelemetryEvent",t):n(t)}var hl=class extends cl{constructor(e,t){super(),this.F=e,this.g=t,this.g.G=this.Aa.bind(this)}processEvent(e){this.o({name:e.name,gdprLevel:e.gdprLevel,parameters:e.parameters,ts:e.ts,clientConfig:Mt})}h(){return this.g.F}},pl=class extends hl{o(e){ul(this,e,(()=>{Hd(this.g,e)}))}C(e){ll(this,e,(()=>{var t,n=this.g;Pt.d("{f7c1592}","{01dcfe5}",null===(t=e.parameters)||void 0===t?void 0:t.sessionId),zd(n,e),Kd(Vd(n,n.h.eventPayload))}))}getTelemetryEventIds(){return{streamingProfileGuid:Qd(this.g),systemInfoGuid:Yd(this.g)}}};function fl(e,t,n){n={name:t.name,gdprLevel:t.gdprLevel,priority:n,ts:t.ts,parameters:t.parameters},(t=t.clientConfig).clientId===Mt.clientId?e=e.j:(e.G||(e.G=xt.createTelemetryProvider(t)),e=e.G),e.processEvent(n)}class vl extends hl{constructor(e,t){super(e,t),this.j=xt.createTelemetryProvider(Mt)}o(e){ul(this,e,(()=>{fl(this,e,!1)}))}C(e){ll(this,e,(()=>{fl(this,e,!0)}))}getTelemetryEventIds(){return xt.getTelemetryEventIds()}}function gl(e){let t=document.createElement("div");return t.id=e.yd,t.className="genericdiv",t.style.display="grid",t.style.gridTemplateColumns="1fr 1fr",t.style.gridTemplateRows="1fr 1fr",e.visible=!0,(e=document.createElement("p")).id="instruction",e.style.color="white",e.style.position="fixed",e.innerHTML="Connect GamePads",e.style.top="0",t.appendChild(e),t}var ml=class{constructor(){this.yd="gamepadTester",this.visible=!1,this.wb=[],this.Rd=[],this.ac=new Map,Zn&&(document.body.appendChild(gl(this)),this.start())}vb(e){for(let t=0;4>t;t++){const n=this.ac.get(t);void 0!==n&&!(e&1<<t)&&(this.wb[n]=null,this.ac.delete(t))}}Jf(e){for(let t=0;t<this.wb.length;t++){let n=this.wb[t];n&&n.ec&&n.ia==e&&(this.wb[t]=null)}}Wc(e,t,n,i,s,r,o,a){this.ac.set(t,e),this.wb[e]={index:e,ia:t,buttons:n,trigger:i,axes:s,name:a,ec:!1}}Tc(e,t,n,i,s,r,o,a){this.wb[e]={index:e,ia:t,buttons:n,trigger:i,axes:s,name:a,ec:!0}}Rc(e){4>e.index&&(this.Rd[e.index]={index:e.index,ia:e.index,buttons:-1,trigger:-1,axes:[-1],name:e.id,ec:!1})}Cc(e){let t=document.getElementById(this.yd);t?(t.remove(),this.wb=[],this.visible=!1):(e.insertAdjacentElement("afterend",gl(this)),this.start())}start(){let e,t=document.getElementById(this.yd);if(null==t)Pt.e("{e13a879}","{0c955af}");else{var n=.49*window.innerWidth,i=.4*window.innerHeight,s=.3*n,r=.7*n,o=.8*i,a=.8*i,c=.07*n,d=e=>{e.style.position="absolute",e.style.width="2%",e.style.height="3.5%",e.style.backgroundColor="red",e.style.borderRadius="50%",e.style.transform="translate(-50%, -50%)"},l=e=>{let n=(e=>e?{left:{X:e.axes[0],Y:e.axes[1]},right:{X:e.axes[2],Y:e.axes[3]}}:null)(e);if(null===t.querySelector(`.gamepad${e.index}`).querySelector(".leftStick")){var i=document.createElement("div");i.className="gamepadJoystickPointer leftStick",d(i),i.style.left=`${s+n.left.X*c}px`,i.style.top=`${o+n.left.Y*c}px`,t.querySelector(`.gamepad${e.index}`).querySelector(".gamepadContainer").appendChild(i)}else(i=t.querySelector(`.gamepad${e.index}`).querySelector(".leftStick")).style.opacity="1",i.style.left=`${s+c*n.left.X}px`,i.style.top=`${o+n.left.Y*c}px`;null===t.querySelector(`.gamepad${e.index}`).querySelector(".rightStick")?((i=document.createElement("div")).className="gamepadJoystickPointer rightStick",d(i),i.style.left=`${r+n.right.X*c}px`,i.style.top=`${a+n.right.Y*c}px`,t.querySelector(`.gamepad${e.index}`).querySelector(".gamepadContainer").appendChild(i)):((e=t.querySelector(`.gamepad${e.index}`).querySelector(".rightStick")).style.opacity="1",e.style.left=(r+n.right.X*c).toString()+"px",e.style.top=(a+n.right.Y*c).toString()+"px")},u=(e,t,n,i)=>{var s=e.getContext("2d");if(s){s.beginPath();var r=!0===n?1:!1===n?0:n;switch(s.fillStyle=n?i?"#006FCD":"#0e7a0d":"grey",n=t=>{if(s){var n=.12*r;s.rect(e.width*t,e.height*(.12-n+.07),.02*e.width,e.height*n),s.closePath(),s.fill(),s.beginPath(),s.fillStyle="grey",s.rect(e.width*t,.07*e.height,.02*e.width,e.height*(.12-n))}},t){case 0:s.moveTo(.14*e.width,.48*e.height),s.lineTo(.19*e.width,.48*e.height),s.lineTo(.165*e.width,.54*e.height),s.lineTo(.14*e.width,.48*e.height);break;case 1:s.moveTo(.14*e.width,.66*e.height),s.lineTo(.19*e.width,.66*e.height),s.lineTo(.165*e.width,.61*e.height),s.lineTo(.14*e.width,.66*e.height);break;case 2:s.moveTo(.09*e.width,.55*e.height),s.lineTo(.09*e.width,.61*e.height),s.lineTo(.135*e.width,.57*e.height),s.lineTo(.09*e.width,.55*e.height);break;case 3:s.moveTo(.24*e.width,.55*e.height),s.lineTo(.24*e.width,.61*e.height),s.lineTo(.195*e.width,.57*e.height),s.lineTo(.24*e.width,.55*e.height);break;case 4:s.arc(.7*e.width,.4*e.height,.02*e.width,0,2*Math.PI);break;case 5:s.arc(.3*e.width,.4*e.height,.02*e.width,0,2*Math.PI);break;case 6:s.arc(.3*e.width,.8*e.height,.07*e.width,0,2*Math.PI);break;case 7:s.arc(.7*e.width,.8*e.height,.07*e.width,0,2*Math.PI);break;case 8:s.rect(.13*e.width,.23*e.height,.07*e.width,.05*e.height);break;case 9:s.rect(.815*e.width,.23*e.height,.07*e.width,.05*e.height);break;case 12:s.arc(.85*e.width,.65*e.height,.02*e.width,0,2*Math.PI);break;case 13:s.arc(.9*e.width,.55*e.height,.02*e.width,0,2*Math.PI);break;case 14:s.arc(.8*e.width,.55*e.height,.02*e.width,0,2*Math.PI);break;case 15:s.arc(.85*e.width,.45*e.height,.02*e.width,0,2*Math.PI);break;case-1:n(.155);break;case-2:n(.84);break;case 16:if(!i)break;s.arc(.5*e.width,.5*e.height,.02*e.width,0,2*Math.PI);break;case 17:i&&(s.roundRect?s.roundRect(.395*e.width,.085*e.height,.21*e.width,.18*e.height,.02*e.width):s.arc(.5*e.width,.175*e.height,.02*e.width,0,2*Math.PI))}s.closePath(),s.fill()}},h=e=>{if(null===t.querySelector(`.gamepad${e.index}`)){var s=document.createElement("div");s.className=`gamepad gamepad${e.index}`,s.style.display="flex",s.style.flexDirection="column",s.style.justifyContent="space-between",s.style.height="98%";var r=document.createElement("p");r.className="active",r.style.margin="0px";var o=document.createElement("span");o.className="gamepadPlayerNumber",o.style.color="white",o.style.background=e.ec?"#006FCD":"#0e7a0d",o.style.position="relative",o.style.marginRight="0.5vw",o.innerHTML=e.ec?"S":"X",o.style.fontSize="1.5vw",r.appendChild(o),(o=document.createElement("span")).className="gamepadPlayerNumber",o.style.color="white",o.style.position="relative",o.innerHTML=`P${e.index+1}|${e.name}`,o.style.fontSize="1.5vw",r.appendChild(o),s.appendChild(r),(e=document.createElement("div")).className="gamepadContainer",e.style.position="relative",e.style.width=`${n+2}px`,e.style.height=`${i}px`,(r=document.createElement("canvas")).className="canvas",r.width=n,r.height=i,r.style.width=`${n}px`,r.style.height=`${i}px`,r.style.border="1px solid white",e.appendChild(r),s.appendChild(e),t.appendChild(s),(s=t.querySelector("#instruction"))&&(s.style.display="none")}},p=()=>{if(this.visible){for(let e=0;e<this.wb.length;e++){var n=this.wb[e];if(n){var i=n.ec;t.querySelector(`.gamepad${n.index}`)||h(n),l(n);let e=t.querySelector(`.gamepad${n.index}`).querySelector("canvas"),s=i?2:0;for(let t=0;16>t;t++)u(e,t,0!=(n.buttons&1<<t),i);1<=s&&u(e,16,65536&n.buttons,i),2<=s&&u(e,17,131072&n.buttons,i),u(e,-1,(255&n.trigger)/255,i),u(e,-2,(n.trigger>>8&255)/255,i)}else this.Rd[e]?!t.querySelector(`.gamepad${e}`)&&(h(this.Rd[e]),i=(n=t.querySelector(`.gamepad${e}`).querySelector("canvas")).getContext("2d"))&&(i.font="20px Arial",i.fillStyle="white",i.textAlign="center",i.fillText("Unsupported Gamepad",n.width/2,n.height/2)):((n=t.querySelector(`.gamepad${e}`))&&t.removeChild(n),1>=t.childNodes.length&&(n=t.querySelector("#instruction"))&&(n.style.display="block"))}e=window.requestAnimationFrame(p)}else window.cancelAnimationFrame(e)};p()}}$b(){}Vc(){}};function Al(e){if(Pt.i("{4c846ba}","{b11cb24}"),e.l){try{e.h=new MediaRecorder(e.l)}catch(e){return void Pt.e("{4c846ba}","{0d1420e}",e)}e.h&&(e.h.onstart=()=>{},e.h.onstop=()=>{Pt.i("{4c846ba}","{7a944b4}")},e.h.ondataavailable=t=>{t.data&&0<t.data.size&&(e.s.push(t.data),e.v.push(e.s),++e.m,e.s=[])},Pt.i("{4c846ba}","{ffb713f}",e.h)),e.o=!1}else Pt.e("{4c846ba}","{74475ae}")}function bl(e){var t;null===(t=e.h)||void 0===t||t.stop(),e.h=void 0,0!==e.j&&(window.clearTimeout(e.j),e.j=0)}function Sl(e){let t;if(1==e.g)t=18e5;else{if(2!=e.g)return;t=3e3}e.h&&!e.o&&(e.h.start(),e.o=!0,e.j=window.setTimeout((()=>{Pt.i("{4c846ba}","{2282d21}"),bl(e)}),t),Pt.i("{4c846ba}","{4f438e3}"))}var yl=class{constructor(){this.o=!1,this.s=[],this.v=[],this.g=this.m=this.j=0}initialize(e){this.l=e}uninitialize(){bl(this),this.downloadAudio(),this.l=void 0,this.g=0}downloadAudio(){if(0!=this.g){for(let e=0;e<this.m;++e)Di(this.v[e],"audioCapture_"+e+".wmv","audio/webm")&&Pt.i("{4c846ba}","{c24ed3b}");this.m=0,this.v=[]}}};function wl(e,t){return e.h=t,15868704===e.h||15859712===e.h?(ke(e.g,!1),!1):(ke(e.g,!0),Me(e.g),e.j)}var El=class{constructor(e){this.subSessionId=this.sessionId="",this.h=0,this.j=!1,this.l=e,this.g=new _e(this,1e4,1e4)}Qf(e){(15867909===this.h||15867908===this.h)&&(e.Ja="other");var t=this.l,n=l(this.h);e=new Ce({eventSequence:e.Ja,sleepTime:Math.round(e.duration/1e3),error:n,timeToSleep:Math.round((e.Se-e.Rf)/1e3),moduleName:"RAGNAROK",cmsId:t.h(),sessionId:this.sessionId,subSessionId:this.subSessionId}),t.processEvent(e),ke(this.g,!1),this.j=!0}reset(e,t){this.sessionId=e,this.subSessionId=t,this.h=0,this.j=!1}};function Il(e){return performance.now()-e.g}var Cl=class{constructor(){this.g=0}};function Tl(e,t){var n;return(null!==(n=Mn.usePerfNowCaptureTimestamp)&&void 0!==n?n:!window.chrome)?Il(e):t-e.g}var Rl=class extends Cl{};function kl(e){if(e.g){const n=e.g.getSessionId(),i=e.g.getSubSessionId();Pt.d("{9d1820c}","{2fd42df}",n,i);var t=e.l;t.subSessionId=i,t.s.clear(),t.v=0,(t=e.l).sessionId=n,t.D=0,e.M.reset(n,i),(e=e.v).o=!1,e.s=!1,e.D=!1,e.v=!1}}function Ol(e,t){var n,i,s,r,o,a,c,d,l,u;e.K&&(e.K=!1,e.framesDecoded=null!==(i=null===(n=e.h)||void 0===n?void 0:n.ua())&&void 0!==i?i:0,n={sessionId:null!==(r=null===(s=e.g)||void 0===s?void 0:s.getSessionId())&&void 0!==r?r:"",subSessionId:null!==(a=null===(o=e.g)||void 0===o?void 0:o.getSubSessionId())&&void 0!==a?a:"",zoneName:null!==(d=null===(c=e.g)||void 0===c?void 0:c.getZoneName())&&void 0!==d?d:"",zoneAddress:(null===(l=e.g)||void 0===l?void 0:l.getZoneAddress())||e.j.serverAddress,error:{code:t}},s=Ll(e,n,performance.now()-e.startTime),qo(e.m),(!e.h||!(null===(u=e.h)||void 0===u)&&u.I)&&Dl(e,s),Hl(e,t),e.cancelSessionSetup())}function Pl(e){0!==e.I&&(window.clearTimeout(e.I),e.I=0)}function Dl(e,t){var n;Pl(e);var i=e.l;let s;s=Jd(i.g,t),i.C(s),$d(i.g),e.s&&(null===(n=e.V)||void 0===n||n.dropCachedEvent(e.s),e.s=0),t=t.streamDuration,"hidden"===document.visibilityState&&(e.C+=performance.now()-e.J),n=0,t&&(n=Math.max(0,100*(t-e.C)/t)),sl(e.l,"sessionVisibilityMetrics","",n,Math.round(t),Math.round(e.C),0),e.C=0,e.J=0}function Ll(e,t,n,i,s){var r,o,a,c;return{exitErrorCode:t.error?l(t.error.code):l(15859712),sessionId:t.sessionId,subSessionId:t.subSessionId,zoneAddress:t.zoneAddress,streamDuration:n,frameCount:e.framesDecoded,codec:null!==(o=null===(r=e.h)||void 0===r?void 0:r.fb())&&void 0!==o?o:"UNKNOWN",isResume:e.isResume,connectivityInfo:i,sleep:s??!1,networkTestSessionId:null!==(c=null===(a=e.F)||void 0===a?void 0:a.ka.networkSessionId)&&void 0!==c?c:""}}function xl(e){var t,n,i;const s=Ul(e,l(null!==(t=e.S)&&void 0!==t?t:15867911)),r=e.I;e.useTelemetryV2?(t={name:s.name,gdprLevel:s.gdprLevel,priority:!0,ts:s.ts,parameters:s.parameters},e.s=null!==(i=null===(n=e.V)||void 0===n?void 0:n.cacheEvent(t,e.s))&&void 0!==i?i:0,n=Promise.resolve()):n=Zd(e.v),n.then((()=>{r===e.I&&function(e){Pl(e),e.I=window.setTimeout((()=>xl(e)),12e4)}(e)})).catch((()=>{Pt.e("{9d1820c}","{204a7ac}")}))}function Ml(e){return{code:3237093380,description:e+" called before initialize"}}function Nl(e,t){var n,i,s,r,o,a,c,d,l,u,h;let p={sessionId:null!==(i=null===(n=e.g)||void 0===n?void 0:n.getSessionId())&&void 0!==i?i:"",subSessionId:null!==(r=null===(s=e.g)||void 0===s?void 0:s.getSubSessionId())&&void 0!==r?r:"",error:{code:3237089284,description:"Quitting due to exception"},streamInfo:null===(o=e.G)||void 0===o?void 0:o.streamInfo,zoneName:null!==(c=null===(a=e.g)||void 0===a?void 0:a.getZoneName())&&void 0!==c?c:"",zoneAddress:null!==(l=null===(d=e.g)||void 0===d?void 0:d.getZoneAddress())&&void 0!==l?l:"",gpuType:null!==(h=null===(u=e.g)||void 0===u?void 0:u.getGpuType())&&void 0!==h?h:"",isResume:e.isResume};e.yc(p,!0),Pt.e("{9d1820c}","{90f98fb}",t),e.l.Aa(t,"Exception happened in session call","{9d1820c}.ts",0,0,!0)}function _l(e,t){var n=y();e.yc({sessionId:"",subSessionId:n,error:t,zoneName:"",zoneAddress:"",gpuType:"",isResume:e.isResume},!0)}function Fl(e,t,n,i){if(e.G=void 0,e.ba=!1,e.g){Gs(e.T,n.ka.additionalInputDevices),n.ka.remoteControllersBitmap=br(e.T);try{(function(e,t){e.g.F=t})(e.l,n.ka.appId,n.ka.shortName),e.startTime=performance.now(),Oe(e.M.g),Pt.d("{9d1820c}","{892168d}",O(JSON.stringify(n.ka)));const s=e.g;s.putOrPostSession(n.ka,t,i).then((t=>(kl(e),Pt.d("{9d1820c}","{92a2573}",null==t?void 0:t.sessionId,null==t?void 0:t.subSessionId),"ready_for_connection"===(null==t?void 0:t.state)?(Pt.d("{9d1820c}","{2042e0a}"),e.G=t,new Promise((e=>{e(t)}))):s.getSession(t.sessionId,!0)))).then((t=>{e.G=t,Pt.d("{9d1820c}","{315afdc}",null==t?void 0:t.sessionId),e.startStreaming(n)})).catch((t=>{var n,i,r,o,a,c;if(kl(e),t.code){15867905!=t.code&&15867906!=t.code||!s.getSessionId()||e.ba||e.sendDeleteRequest(s.getSessionId(),s),Pt.e("{9d1820c}","{09efe49}",l(t.code));let d={sessionId:null!==(n=s.getSessionId())&&void 0!==n?n:"",subSessionId:null!==(i=s.getSubSessionId())&&void 0!==i?i:"",error:t,sessionList:t.sessionList,streamInfo:null===(r=e.G)||void 0===r?void 0:r.streamInfo,zoneName:null!==(o=s.getZoneName())&&void 0!==o?o:"",zoneAddress:null!==(a=s.getZoneAddress())&&void 0!==a?a:"",gpuType:null!==(c=s.getGpuType())&&void 0!==c?c:"",isResume:e.isResume};e.yc(d,!0)}else Nl(e,t)}))}catch(t){Nl(e,t)}}else e.emit("SessionStartResult",{sessionId:"",subSessionId:"",zoneName:"",zoneAddress:"",gpuType:"",isResume:e.isResume,error:Ml(e.isResume?"Resume":"Start")})}function Ul(e,t){var n,i,s,r,o,a,c,d,l,u=e.v,h=null!==(i=null===(n=e.g)||void 0===n?void 0:n.getSessionId())&&void 0!==i?i:"";return n=null!==(r=null===(s=e.g)||void 0===s?void 0:s.getSubSessionId())&&void 0!==r?r:"",s=(null===(o=e.g)||void 0===o?void 0:o.getZoneAddress())||e.j.serverAddress,o=null!==(c=null===(a=e.h)||void 0===a?void 0:a.ua())&&void 0!==c?c:0,a=null!==(l=null===(d=e.h)||void 0===d?void 0:d.fb())&&void 0!==l?l:"UNKNOWN",zd(u,e=Jd(u,{exitErrorCode:t,sessionId:h,subSessionId:n,zoneAddress:s,streamDuration:performance.now()-e.startTime,frameCount:o,codec:a,isResume:e.isResume,sleep:!1,networkTestSessionId:""})),e}function jl(e){e.U&&(window.clearTimeout(e.U),e.U=0)}function Gl(e){window.removeEventListener("pagehide",e.ja),window.removeEventListener("online",e.fa),document.removeEventListener("visibilitychange",e.ma),navigator.mediaDevices&&navigator.mediaDevices.removeEventListener("devicechange",e.Z),p(e.u)&&(document.removeEventListener("SystemIdle",e.ha),jl(e))}function Bl(e,t){e.S=void 0,el(e.v),e.K=!0,window.addEventListener("pagehide",e.ja),window.addEventListener("online",e.fa),document.addEventListener("visibilitychange",e.ma),navigator.mediaDevices&&navigator.mediaDevices.addEventListener("devicechange",e.Z),e.isResume=t,e.P&&nl(e.l,"SessionSetupInProgressError",e.isResume?"resume":"start"),e.P=!0}function Vl(e,t){var n,i,s;if((t={ka:Object.assign({},t),Xd:[]}).ka.streamParams)for(const n of t.ka.streamParams){const i=document.getElementById(n.videoTagId);if(null==i||!(i instanceof HTMLVideoElement))return void _l(e,{code:3237094400,description:"Didn't find video element for videoTagId: "+n.videoTagId});t.Xd.push({H:i})}if(t.ka.keyboardLayout=null!==(n=t.ka.keyboardLayout)&&void 0!==n?n:g(e.u)?"m-us":"en_US",(void 0===t.ka.appLaunchMode||0===t.ka.appLaunchMode)&&(t.ka.appLaunchMode=A()||S(e.u)||"Xbox"===e.u.os||function(e){return"HMD"===(e.platformType||e.deviceType)}(e.u)?1:0),ln)if(t.ka.metaData)for(const e in ln)t.ka.metaData[e]=ln[e];else t.ka.metaData=ln;void 0!==Zt&&(t.ka.appLaunchMode=Zt,Pt.d("{9d1820c}","{c4969b1}",Zt));const r=!!Wn&&!!qn,o=!!ai;return(r||o)&&(null===(i=t.ka.streamParams)||void 0===i||i.forEach((e=>{r&&(e.width=Wn,e.height=qn),o&&(e.fps=ai)})),null===(s=t.ka.monitorSettings)||void 0===s||s.forEach((e=>{r&&(e.widthInPixels=Wn,e.heightInPixels=qn),o&&(e.framesPerSecond=ai)})),r&&Pt.i("{9d1820c}","{92a6b38}",Wn,qn),o&&Pt.d("{9d1820c}","{6618bcd}",ai)),e.F=t,e.F}function Hl(e,t){e.h&&(e.h.stop(t),e.h=void 0)}function Wl(e,t,n){var i,s;t={sessionId:t,subSessionId:null!==(s=null===(i=e.g)||void 0===i?void 0:i.getSubSessionId())&&void 0!==s?s:"",framesDecoded:e.framesDecoded,error:n},ql(e),o(e.u)&&e.o&&(Pt.d("{9d1820c}","{b9b1288}"),e.setMicRecordingEnabled(!1)),e.emit("SessionStopResult",t)}function ql(e){ii&&(window.ios15AudioContext&&(window.ios15AudioContext.close(),window.ios15AudioContext=void 0,Pt.i("{9d1820c}","{0ac2a42}")),window.ios15AudioStream=void 0,navigator.mediaDevices&&e.O&&navigator.mediaDevices.removeEventListener("devicechange",e.O))}function zl(e,t){e.P=!1,t.error&&(e.K=!1,Gl(e)),e.emit("SessionStartResult",t)}function Kl(e,t,n,i){var s,r,o,a,c;if(ql(e),i){const n=i.connectivityInfo;n&&!n.kc?(Pl(e),i=Ul(e,l(null!==(r=null===(s=t.error)||void 0===s?void 0:s.code)&&void 0!==r?r:15867911)),e.useTelemetryV2?(s={name:i.name,gdprLevel:i.gdprLevel,priority:!0,ts:i.ts,parameters:i.parameters},e.s=null!==(a=null===(o=e.V)||void 0===o?void 0:o.cacheEvent(s,e.s))&&void 0!==a?a:0):Zd(e.v).catch((()=>{Pt.e("{9d1820c}","{0c2de99}")}))):Dl(e,i)}Hl(e,t.error?t.error.code:15859712),n?zl(e,t):(t.error&&(n=Ei(t.error.code,e.u),t.isResumable=n,t.isSessionAlive=Ii(t.error.code,n),Pt.i("{9d1820c}","{723f7be}",n)),e.K=!1,e.P=!1,Gl(e),e.h&&(n=null===(c=e.h)||void 0===c?void 0:Pd(c))&&e.emit("StreamQualityReport",n),e.emit("StreamStopped",t))}performance.mark("GfnRBegin");var $l=s.AuthType,Jl=s.LogImpl,Ql=s.performHttpRequest,Yl=s.PayloadOSType,Xl=s.PayloadBrowserType,Zl=s.PayloadDeviceType,eu=s.ClientHeaderOSType,tu=s.ClientHeaderBrowserType,nu=s.ClientHeaderDeviceType,iu=s.SdrHdrMode,su=s.BitDepth,ru=s.NetworkType,ou=s.PlatformOS,au=s.PlatformBrowser,cu=s.translatePlatformInfoForPayload,du=s.translatePlatformInfoForClientHeader;function lu(e,t,n){var i;if(4!==e.streamingState&&0!==e.streamingState){var s=e.streamingState;e.streamingState=4,function(e){e.l&&(window.clearInterval(e.l),e.l=0)}(e.h),sl(e.h,"HotPlug","",0,e.s,0,0),o(e.u)&&e.m&&(Pt.d("{0a9be04}","{b9b1288}"),e.captureMic(!1)),qo(e.j),null===(i=e.g)||void 0===i||i.stop(t);var r=wl(e.F,t);r&&(t=wi(t,e.u)),Fi(e.zoneAddress,t).then((i=>{var o,a,c,d,u;if(t=yi(t,i),1!==s){var h=Ei(t,e.u);h={code:t,isResumable:h,isSessionAlive:Ii(t,h),reason:3};var f,v,g,m,A=new Set([3237093892,15867907,3237093896,3237093897,3237093898,3237093899,3237093900,3237093895,3237093901,3237093906,3237093929,15867908,15868418,3237094151,3237094158]);n?h.reason=0:A.has(t)?h.reason=2:15868672==(268435200&t)&&(h.reason=1),(A=null===(o=e.g)||void 0===o?void 0:Pd(o))&&e.l.streamQualityReport&&e.l.streamQualityReport(A),e.l.onStreamStopped(h),A=l(t),o=performance.now()-e.startTime,h=null!==(v=null===(f=e.g)||void 0===f?void 0:f.fb())&&void 0!==v?v:"UNKNOWN",f=null!==(m=null===(g=e.g)||void 0===g?void 0:g.ua())&&void 0!==m?m:0,ol(g=e.h,m=A,v=tl(i,r),o,h,f),i.kc?al(g):Pt.d("{9838627}","{30029be}",m,v)}uu(e),hu(e),e.g=void 0,e.startTime=0,e.isResume=!1,e.J=void 0,e.G=0,e.s=0,e.sessionId="",e.subSessionId="",e.zoneAddress="",e.zoneName="",e.H=void 0,e.Da=void 0,e.m=!1,e.v=void 0,e.appId=0,e.setSupportedHidTypes(0),e.setGamepadRsdmm(!1),i=null!==(c=null===(a=null==(g=window.zoneless)?void 0:g.windowRemoveEventListener)||void 0===a?void 0:a.bind(window))&&void 0!==c?c:window.removeEventListener.bind(window),a=null!==(u=null===(d=null==g?void 0:g.documentRemoveEventListener)||void 0===d?void 0:d.bind(document))&&void 0!==u?u:document.removeEventListener.bind(document),i("pagehide",e.N),i("error",e.M),a("visibilitychange",e.O),navigator.mediaDevices&&navigator.mediaDevices.removeEventListener("devicechange",e.I),p(e.u)&&(a("SystemIdle",e.L),hu(e))}))}}function uu(e){ii&&(window.ios15AudioContext&&(window.ios15AudioContext.close(),window.ios15AudioContext=void 0,Pt.i("{0a9be04}","{0ac2a42}")),window.ios15AudioStream=void 0,navigator.mediaDevices&&e.C&&navigator.mediaDevices.removeEventListener("devicechange",e.C))}function hu(e){e.D&&(window.clearTimeout(e.D),e.D=0)}performance.mark("GfnNskBegin");window.Ragnarok=window.Ragnarok||{},window.Ragnarok.GridApp=class extends Ae{constructor(e){var t;super(),this.u=e,this.o=this.$=!1,this.ea=new ml,this.P=!1,this.O=this.Z=void 0,this.ga=!1,this.R=this.J=this.U=this.I=0,this.ba=this.K=!1,this.s=this.C=0,this.useTelemetryV2=!1,Dt.isCallbackRegistered()||Dt.register(this.aa.bind(this)),this.j={clientIdentification:"GFN-PC",clientVersion:"29.0",deviceHashId:"",serverAddress:""},this.startTime=performance.now(),this.ja=this.sa.bind(this),this.fa=this.kc.bind(this),this.ma=this.Ba.bind(this),this.za=this.ra.bind(this),this.framesDecoded=0,this.v=new class{constructor(){this.h={userId:"",sessionId:"",eventPayload:void 0,name:""},this.g={},this.v=this.D=this.s=this.o=!1,this.F="",this.C=[],this.j=!1,this.l=new class{constructor(){this.l=window.indexedDB,this.version=2,this.j=this.h=!1,this.name="ragnarok",this.m=[{Vf:"exit-events",kd:{keyPath:["userId","sessionId","name"]},Uf:"exit-event-index"},{Vf:"telemetry-events",kd:{keyPath:["userId","sessionId","name","eventPayload.ts"]},Uf:"telemetry-event-index"}]}open(){return new Promise(((e,t)=>{try{if(this.l){let n=this.l.open(this.name,this.version);n.onerror=()=>{t(R(18,`${this.name} db opening failed`,n.error))},n.onsuccess=()=>{Nd(this,n.result),e()},n.onupgradeneeded=e=>{Pt.i("{10dc2cc}","{1f70767}",e.oldVersion,e.newVersion),Nd(this,n.result);const t=e=>{var t;const n=null===(t=this.g)||void 0===t?void 0:t.createObjectStore(e.Vf,e.kd);e.kd.keyPath&&(null==n||n.createIndex(e.Uf,e.kd.keyPath,{unique:!0}))};switch(e.oldVersion){case 0:t(this.m[0]);case 1:t(this.m[1])}},n.onblocked=()=>{t(R(19,`${this.name} db blocked during opening`,n.error))}}else t(R(17,"Indexdb object not found"))}catch(e){t(R(20,"Unexpected Exception in open",e))}}))}get(e,t){const n=_d(this);return n?Promise.reject(n):new Promise(((n,i)=>{try{const s=this.g.transaction(e,"readonly"),r=s.objectStore(e);s.oncomplete=()=>{Pt.i("{10dc2cc}","{82638ba}")};const o=r.get(t);o.onsuccess=()=>{n(o.result)},o.onerror=()=>{i(R(32,"get method failed",s.error))}}catch(e){i(R(33,"Unexpected Exception happened in get",e))}}))}set(e,t){const n=_d(this);return n?Promise.reject(n):new Promise(((n,i)=>{try{const s=this.g.transaction(e,"readwrite"),r=s.objectStore(e);s.oncomplete=()=>{Pt.i("{10dc2cc}","{f993875}")};const o=r.put(t);o.onsuccess=()=>{n()},o.onerror=()=>{i(R(48,"put method failed",s.error))}}catch(e){i(R(49,"Unexpected Exception happened in set",e))}}))}close(){var e;this.h=!0,null===(e=this.g)||void 0===e||e.close()}},this.m=this.l.open().catch((e=>{this.j=!0,Bd(this,e,"TelemetryEventProcessorConstruction",!0)}))}updateEventDataElements(e){var t;if(Wd(this.g,e),this.g.commonData){Pt.d("{f7c1592}","{66f209c}");for(let e of this.C)Hd(this,e);this.C=[]}this.h.userId=null===(t=this.g.commonData)||void 0===t?void 0:t.userId}},this.useTelemetryV2=null===(t=Mn.useTelemetryV2)||void 0===t||t,this.l=function(e,t,n){return e?new vl(t,n):new pl(t,n)}(this.useTelemetryV2,this,this.v),this.useTelemetryV2&&(this.V=xt.createTelemetryProvider(Mt)),this.M=new El(this.l),this.isResume=!1,this.N=Gt,this.da=new yl,window.addEventListener("error",this.za),e=window.zoneless,this.m=new $o(this.u,this.l),this.O=this.m.j.bind(this.m),this.Z=this.na.bind(this),this.qa=new Rl,this.T=Us(this.u,e),Zn&&Js(this.T,this.ea),this.ha=this.oa.bind(this),ue(this.l),function(e){var t,n,i;if(Mn.sendNonEssentialMetricEvents){var s=performance.getEntriesByName("GfnJsInitStart")[0];const r=performance.getEntriesByName("platformBegin")[0],o=performance.getEntriesByName("GfnRBegin")[0],a=performance.getEntriesByType("navigation");s=Math.round(null!==(t=null==s?void 0:s.startTime)&&void 0!==t?t:-1),t=Math.round(null!==(n=null==r?void 0:r.startTime)&&void 0!==n?n:-1),sl(e.l,"PerformanceTiming","application timings",s,t,Math.round(null!==(i=null==o?void 0:o.startTime)&&void 0!==i?i:-1),t-s),a.length?(n=a[a.length-1],sl(e.l,"PerformanceTiming","load timings",Math.round(n.loadEventStart),Math.round(n.loadEventEnd),Math.round(n.domContentLoadedEventStart),Math.round(n.domContentLoadedEventEnd))):sl(e.l,"PerformanceTiming","navigation timings unsupported",0,0,0,0)}}(this),ba(this.l),Mn.sendNonEssentialMetricEvents&&sl(this.l,"PlatformDetailsExecutionTime","",this.u.totalTime,0,0,0),Gd.registerCallback((e=>{var t;null===(t=this.g)||void 0===t||t.setNetworkType(e)}))}ra(e){return Pt.e("{9d1820c}","{8516485}",e.filename,e.lineno,e.colno),this.l.Aa(e.error,e.error&&e.error.message?e.error.message:e.message,e.filename,e.lineno,e.colno,!1),Mn.terminateUnhandledException&&Ol(this,3237093392),!1}sa(){var e,t;this.ga||(this.ga=!0,Ol(this,(null!==(e=this.S)&&void 0!==e?e:null!==(t=this.h)&&void 0!==t&&t.I)?15867912:15867905))}kc(){Pt.i("{9d1820c}","{a9a135f}"),el(this.v)}Ba(){var e;if(Pt.i("{9d1820c}","{478a408}",document.visibilityState,!!this.h),this.h){var t=this.F.Xd[0].H,n=C(this.u,!1,15,4)&&oi,i=C(this.u,!1,15,4)&&this.o&&ri;"hidden"===document.visibilityState?(this.J=performance.now(),n&&(Pt.i("{9d1820c}","{cbd3b6e}"),t.muted=!0),xl(this)):"visible"===document.visibilityState&&(this.C+=performance.now()-this.J,n&&(Pt.i("{9d1820c}","{05deefa}"),t.muted=!1),i?(t=null!==(e=Mn.userTerminatedMicRecorderThreshold)&&void 0!==e?e:2e3,this.J-this.m.N<t?(Pt.i("{9d1820c}","{862bd20}"),this.m.G=!0,this.setMicRecordingEnabled(!0,this.L)):(this.o=!1,this.L=void 0)):C(this.u,!1,15,4)&&!this.m.m&&zo(this.m)&&this.m.D&&Go(this.m,"visibilityChange"))}}ya(e){Pt.d("{9d1820c}","{972bb72}",JSON.stringify(e)),this.l.o(e)}va(e){this.emit("ActiveSessionsResult",e)}wa(e){this.emit("ProgressUpdate",e)}xa(e){this.emit("SessionUpdate",e)}initialize(e,t=Gt){var n,i,s,r,o,a,c,l,u,h,p,f,v,g,m,A,b,S,y;if(Pt.i("{9d1820c}","{16f11e6}","Local"),Pt.d("{9d1820c}","{e85ad66}",navigator.userAgent),!e)return Pt.e("{9d1820c}","{a98b177}"),!1;Object.assign(this.j,e),null===(n=this.g)||void 0===n||n.uninitialize(),!this.j.serverAddress||d(this.j.serverAddress)?(Pt.d("{9d1820c}","{e2d9a04}"),this.g=new Ot):this.g=new kt(this.u,!0),e=this.g,Pt.d("{9d1820c}","{3c652b7}"),kl(this),e.addListener("TelemetryEvent",this.ya.bind(this)),e.addListener("Log",this.aa.bind(this)),e.addListener("ActiveSessionsResult",this.va.bind(this)),e.addListener("ProgressUpdate",this.wa.bind(this)),e.addListener("SessionUpdate",this.xa.bind(this)),this.j.clientHeaders=null!==(l=this.j.clientHeaders)&&void 0!==l?l:new Map,(n="NATIVE"!==(l=sn||this.j.clientType||"BROWSER"))&&this.j.clientHeaders.set("nv-browser-version",this.u.browserFullVer);var w=this.j.clientHeaders;for(var[E]of w){const e=E;en&&"nv-device-os"===e.toLowerCase()&&w.set(e,en),tn&&"nv-device-type"===e.toLowerCase()&&w.set(e,tn),ui.deviceModel&&"nv-device-model"===e.toLowerCase()&&w.set(e,ui.deviceModel),nn&&"nv-client-streamer"===e.toLowerCase()&&w.set(e,nn),on&&"nv-client-id"===e.toLowerCase()&&w.set(e,on)}return E={deviceOs:null!==(h=null!==(u=en)&&void 0!==u?u:this.u.os)&&void 0!==h?h:this.u.deviceOS,deviceOsVer:null!==(p=this.u.osVersion)&&void 0!==p?p:this.u.osVer,deviceType:null!==(v=null!==(f=tn)&&void 0!==f?f:this.u.platformType)&&void 0!==v?v:this.u.deviceType,deviceModel:null!==(m=null!==(g=ui.deviceModel)&&void 0!==g?g:this.u.model)&&void 0!==m?m:this.u.deviceModel,clientIdentification:null!==(A=this.j.clientIdentification)&&void 0!==A?A:"GFN-PC",clientVersion:null!==(b=this.j.clientVersion)&&void 0!==b?b:"29.0",clientAppVersion:this.j.clientAppVersion,clientStreamer:null!==(S=nn)&&void 0!==S?S:"WEBRTC",clientId:on||this.j.clientId,browserType:n?null===(y=this.u.browser)||void 0===y?void 0:y.toUpperCase():void 0,clientPlatformName:rn||"browser",clientType:l,deviceHashId:this.j.deviceHashId,serverAddress:this.j.serverAddress,authTokenCallback:this.j.authTokenCallback,clientHeaders:this.j.clientHeaders},e.initialize(E),e.setNetworkType(Gd.getCurrentNetworkType()),this.N={...t},null!==(i=(o=this.N).windowedStreaming)&&void 0!==i||(o.windowedStreaming=this.j.windowedStreaming),null!==(s=(a=this.N).windowedStreaming)&&void 0!==s||(a.windowedStreaming=2===t.cursorType),null!==(r=(c=this.N).cursorType)&&void 0!==r||(c.cursorType=this.j.cursorType),this.l.clientShutDownCallback=this.j.clientShutDownCallback,!0}downloadAudio(){this.da.downloadAudio()}updateEventDataElements(e){var t,n,i;if(Pt.i("{9d1820c}","{4008dc4}",JSON.stringify(e)),this.useTelemetryV2){const i=e.commonData;var r,o,a,c,d,l,u=e.config;if(u){const e=qd(u);var h,p,f,v,g;u={clientVariant:null!==(h=null==i?void 0:i.clientVariant)&&void 0!==h?h:"undefined",clientType:null!==(p=null==i?void 0:i.clientType)&&void 0!==p?p:"undefined",clientVer:null!==(f=null==i?void 0:i.clientVer)&&void 0!==f?f:"undefined",productName:null!==(v=null==i?void 0:i.productName)&&void 0!==v?v:"undefined",productVersion:null!==(g=null==i?void 0:i.productVersion)&&void 0!==g?g:"undefined"},h=(0,s.translatePlatformInfoForPayload)(this.u),p=(null==i?void 0:i.deviceModel)||this.u.model||this.u.deviceModel,f=(null==i?void 0:i.deviceMake)||this.u.make||this.u.vendor,v=(null!==(t=null==i?void 0:i.deviceOSVersion)&&void 0!==t?t:"")||this.u.osVersion||this.u.osVer,t={...this.u,deviceId:null!==(n=null==i?void 0:i.deviceId)&&void 0!==n?n:"",deviceOS:h.os,deviceOSVersion:v,osVersion:v,deviceType:h.deviceType,deviceModel:p,model:p,deviceMake:f,make:f,browserType:h.browser},xt.configure(u,t,e??1)}n={gdprFuncOptIn:null!==(r=null==i?void 0:i.gdprFuncOptIn)&&void 0!==r?r:"None",gdprTechOptIn:null!==(o=null==i?void 0:i.gdprTechOptIn)&&void 0!==o?o:"None",gdprBehOptIn:null!==(a=null==i?void 0:i.gdprBehOptIn)&&void 0!==a?a:"None"},r={deviceGdprFuncOptIn:null!==(c=null==i?void 0:i.deviceGdprFuncOptIn)&&void 0!==c?c:"None",deviceGdprTechOptIn:null!==(d=null==i?void 0:i.deviceGdprTechOptIn)&&void 0!==d?d:"None",deviceGdprBehOptIn:null!==(l=null==i?void 0:i.deviceGdprBehOptIn)&&void 0!==l?l:"None"},xt.updateClientCommonData({userId:null==i?void 0:i.userId,externalUserId:null==i?void 0:i.externalUserId,idpId:null==i?void 0:i.idpId},r,n,null==i?void 0:i.integrationId)}this.v.updateEventDataElements(e),e.telemetryEventIds&&(xt.setTelemetryEventIds(e.telemetryEventIds),null===(i=this.g)||void 0===i||i.updateTelemetryEventIds(e.telemetryEventIds)),this.h&&!this.P&&xl(this)}getActiveSessions(){this.g?this.g.getAllActiveSessions():this.emit("ActiveSessionsResult",{sessionList:[],error:Ml("ActiveSessions")})}startSession(e){Bl(this,!1),(e=Vl(this,e))&&Fl(this,0,e)}updateAdState(e){var t;return this.g?null===(t=this.g)||void 0===t?void 0:t.updateAdState(e):3237093380}getSession(e){this.g?this.g.getSession(e,!1).then((e=>{var t,n;let i={sessionId:null!==(t=null==e?void 0:e.sessionId)&&void 0!==t?t:"",appId:null==e?void 0:e.appId,subSessionId:null!==(n=null==e?void 0:e.subSessionId)&&void 0!==n?n:"",state:null==e?void 0:e.state,status:null==e?void 0:e.state};this.emit("GetSessionResult",i)})).catch((t=>{var n,i;let s={sessionId:e,subSessionId:null!==(i=null===(n=this.g)||void 0===n?void 0:n.getSubSessionId())&&void 0!==i?i:"",error:t};this.emit("GetSessionResult",s)})):this.emit("GetSessionResult",{sessionId:"",subSessionId:"",error:Ml("GetSession")})}resume(){this.resumeSession(this.F.ka,this.g.getSessionId())}resumeSession(e,t){Bl(this,!0),(e=Vl(this,e))&&Fl(this,2,e,t)}stopSession(e,t){var n,i,s,r,o,a,c;this.g?(void 0!==t&&Pt.i("{9d1820c}","{ae7f61b}",l(t)),e===this.g.getSessionId()||void 0===e?(15867910===t?this.ba=!0:this.$=!1,qo(this.m),this.framesDecoded=null!==(i=null===(n=this.h)||void 0===n?void 0:n.ua())&&void 0!==i?i:0,ke(this.M.g,!1),n=Ll(this,{sessionId:null!==(s=this.g.getSessionId())&&void 0!==s?s:"",subSessionId:null!==(r=this.g.getSubSessionId())&&void 0!==r?r:"",error:t?{code:t}:void 0,zoneName:null!==(o=this.g.getZoneName())&&void 0!==o?o:"",zoneAddress:this.g.getZoneAddress()||this.j.serverAddress,gpuType:null!==(a=this.g.getGpuType())&&void 0!==a?a:"",isResume:this.isResume},performance.now()-this.startTime),e=null!==(c=this.g.getSessionId())&&void 0!==c?c:"",this.h?(this.K=!1,Gl(this),this.h.I&&Dl(this,n),Hl(this,t??(this.h.I?15859712:15867905)),15867910===t?(Pt.d("{9d1820c}","{12bc45e}",e),Wl(this,e)):this.sendDeleteRequest(e,this.g)):this.G?Wl(this,e):this.cancelSessionSetup()):e&&this.sendDeleteRequest(e,this.g)):this.emit("SessionStopResult",{sessionId:"",subSessionId:"",error:Ml("StopSession")})}pauseSession(e){this.stopSession(e,15867910)}startStreaming(e){var t,n,i,s,r;const o={sessionId:null!==(n=null===(t=this.g)||void 0===t?void 0:t.getSessionId())&&void 0!==n?n:"",subSessionId:null!==(s=null===(i=this.g)||void 0===i?void 0:i.getSubSessionId())&&void 0!==s?s:"",progressState:"StartingStreamer",queuePosition:0,eta:0,ads:[],isAdsRequired:!1};this.emit("SessionUpdate",o),this.emit("ProgressUpdate",{...o,state:o.progressState}),t=d(this.j.serverAddress)?"":this.j.serverAddress.split(".")[0];const{H:a}=e.Xd[0];if(C(this.u,!1,15)){a.streamKitOldPlay||(a.streamKitOldPlay=a.play);const e=ni&&C(this.u,!0,15,1);a.play=()=>{if(ii&&(Pt.i("{9d1820c}","{4a5b360}"),ql(this),function(e){if(ii)if(window.ios15AudioContext)Pt.i("{9d1820c}","{e2aba64}");else{var t=new(window.AudioContext||window.webkitAudioContext)({latencyHint:"interactive",sampleRate:48e3});t.onstatechange=()=>{"suspended"===t.state&&(t.resume(),e.m.j(),Pt.i("{9d1820c}","{faee684}"))},window.ios15AudioContext=t,window.ios15AudioStream=t.createMediaStreamDestination(),navigator.mediaDevices&&e.O&&navigator.mediaDevices.addEventListener("devicechange",e.O),Pt.i("{9d1820c}","{b5f7b9b}")}}(this),this.m.j()),e){Pt.i("{9d1820c}","{8f5cd77}");const e=a.srcObject;a.srcObject=null,a.srcObject=e}return a.streamKitOldPlay.apply(a)}}si&&(C(this.u,!0,15,0)||C(this.u,!0,15,1))&&(a.hasAttribute("data-shouldautoplay")?a.setAttribute("autoplay",""):(a.setAttribute("data-shouldautoplay",""),a.removeAttribute("autoplay"))),this.h=new Dd(this,a,void 0,this.m,this.N,this.ea,this.T,this.l,this.u,this.G,this.qa,e.ka.streamParams[0],this.da,this.j.textInputElement,this.j.clientAppVersion,this.isResume,t,void 0,void 0,e.ka.signalingUrlQueryParameters),this.h.start(),e.ka.keyboardLayout&&this.h.setKeyboardLayout(e.ka.keyboardLayout),this.useTelemetryV2?(null===(r=this.V)||void 0===r||r.processCachedEvent(this.s),e=Promise.resolve()):e=dl(this.l),e.then((()=>{xl(this)})).catch((()=>{Pt.e("{9d1820c}","{c761bfd}")}))}yc(e,t){var n,i,s,r,o,a;if(e.error){const n=wl(this.M,e.error.code);n&&(e.error.code=wi(e.error.code,this.u)),Fi(this.j.serverAddress,e.error.code).then((i=>{var s,r,o;this.framesDecoded=null!==(r=null===(s=this.h)||void 0===s?void 0:s.ua())&&void 0!==r?r:0,e.zoneAddress||(e.zoneAddress=this.j.serverAddress),e.error&&(e.error.code=yi(e.error.code,i)),s=void 0,t||(s=Ll(this,e,0,i,n),this.S=null===(o=e.error)||void 0===o?void 0:o.code),Kl(this,e,!0,s)}))}else(function(e,t,n,i,s,r,o,a,c,d){var l,u;const h=e.getTelemetryEventIds();t=new Nt({zoneAddress:s,networkSessionId:d,sessionId:t,subSessionId:n,resumeType:Oi(i),overrideConfigType:_n.type,overrideConfigVersion:_n.version,result:o,codec:Ti(a),ipVersion:"UNKNOWN",launchDuration:Math.round(r),networkType:k(Gd.getCurrentNetworkType()),streamingProfileGuid:null!==(l=h.streamingProfileGuid)&&void 0!==l?l:"",systemInfoGuid:null!==(u=h.systemInfoGuid)&&void 0!==u?u:"",cmsId:c}),e.o({name:t.name,gdprLevel:t.gdprLevel,parameters:t.parameters,ts:t.ts,clientConfig:Mt})})(this.l,e.sessionId,e.subSessionId,this.isResume,e.zoneAddress||this.j.serverAddress,Math.round(performance.now()-this.startTime),l(15859712),null!==(i=null===(n=this.h)||void 0===n?void 0:n.fb())&&void 0!==i?i:"UNKNOWN",this.F?String(null===(s=this.F)||void 0===s?void 0:s.ka.appId):"",null!==(o=null===(r=this.F)||void 0===r?void 0:r.ka.networkSessionId)&&void 0!==o?o:""),this.startTime=performance.now(),"hidden"===document.visibilityState&&(this.J=this.startTime),this.C=0,this.isResume&&this.o&&this.setMicRecordingEnabled(!0,this.L),zl(this,e),this.$&&(null===(a=this.h)||void 0===a||a.toggleUserInput(!0,this.pa)),p(this.u)&&document.addEventListener("SystemIdle",this.ha)}yf(e){var t,n;qo(this.m),Pt.d("{9d1820c}","{a94b484}");let i=wl(this.M,e.error.code);i&&(e.error.code=wi(e.error.code,this.u)),this.framesDecoded=null!==(n=null===(t=this.h)||void 0===t?void 0:t.ua())&&void 0!==n?n:0,e.zoneAddress||(e.zoneAddress=this.j.serverAddress),Fi(this.j.serverAddress,e.error.code).then((t=>{var n;e.error.code=yi(e.error.code,t),t=Ll(this,e,performance.now()-this.startTime,t,i),this.S=null===(n=e.error)||void 0===n?void 0:n.code,sl(this.l,"HotPlug","",0,this.R,0,0),this.R=0,Kl(this,e,!1,t)}))}zf(){jl(this)}sendDeleteRequest(e,t){t.sendDeleteRequest(e).then((()=>{Pt.d("{9d1820c}","{fee1eea}",e),Wl(this,e)}),(t=>{Pt.e("{9d1820c}","{50e2a6e}",e),Wl(this,e,t)}))}isMicSupported(){return Jo}setMicRecordingEnabled(e,t){Pt.i("{9d1820c}","{f5b2f30}",e),e?(this.o=!0,this.L=t,Vo(this.m,this.L)):(this.o=!1,this.L=void 0,jo(this.m))}getMicState(){var e;e=this.m,!1!==$t&&(e.v||3==e.h||2==e.h||6==e.h||7==e.h?Uo(e,e.h):Fo().then((t=>{0!==t&&Uo(e,t)})))}shouldDefaultEnableMic(){return Yo(this.u)}sendCustomMessage(e){var t;null===(t=this.h)||void 0===t||t.sendCustomMessage(e)}toggleUserInput(e,t){var n;null===(n=this.h)||void 0===n||n.toggleUserInput(e,t),this.$=e,this.pa=t}toggleRsdmm(e){var t;null===(t=this.h)||void 0===t||t.toggleRsdmm(e)}getVirtualGamepadHandler(){var e;return null===(e=this.h)||void 0===e?void 0:e.getVirtualGamepadHandler()}setAuthInfo(e){var t;null===(t=this.g)||void 0===t||t.setAuthInfo(e)}sendTextInput(e){var t;null===(t=this.h)||void 0===t||t.sendTextInput(e)}setVirtualKeyboardState(e){var t;null===(t=this.h)||void 0===t||t.setVirtualKeyboardState(e)}setVideoTransforms(e,t,n){var i;null===(i=this.h)||void 0===i||i.setVideoTransforms(e,t,n)}toggleOnScreenStats(){var e;Kt&&(null===(e=this.h)||void 0===e||e.toggleOnScreenStats())}toggleStutterIndicator(){var e;null===(e=this.h)||void 0===e||e.toggleStutterIndicator()}setKeyboardLayout(e){var t;Pt.i("{9d1820c}","{10717a6}",e),null===(t=this.h)||void 0===t||t.setKeyboardLayout(e)}sendKeyEvent(e){var t;null===(t=this.h)||void 0===t||t.sendKeyEvent(e)}setStreamingMaxBitrate(e,t=0){var n;null===(n=this.h)||void 0===n||n.setStreamingMaxBitrate(t,e)}setDrcDfcState(e,t=0){var n;null===(n=this.h)||void 0===n||n.setDrcDfcState(t,e?3:0)}setHdr10PlusGaming(e){var t;null===(t=this.h)||void 0===t||((t=t.aa).h=e,$c(t))}startInputPlayback(e){var t;null===(t=this.h)||void 0===t||t.startInputPlayback(e)}oa(e){var t;e.detail.idle&&(null===(t=this.h)||void 0===t||bd(t,2,60),this.U=window.setTimeout((()=>{var e;null===(e=this.h)||void 0===e||ud(e,15867913)}),6e4))}na(){Ko(this.m,this.R),this.R++}cancelSessionSetup(){!this.h&&this.g&&this.g.cancelSessionSetup()}},window.Ragnarok.ChooseStreamingSettings=function(e=0,t,n){return gi(e,t,mi(n))},window.Ragnarok.ChooseStreamingResolution=function(e=0,t){return gi(e,t=null==t?void 0:t.map((e=>({resolution:e,frameRate:60}))),mi()).resolution},window.Ragnarok.InitializeUtils=function(){},window.Ragnarok.GetSupportedAudioChannelCount=fi,window.Ragnarok.GetDeviceCapabilities=ea,window.Ragnarok.getSupportedCodecs=Aa,window.Ragnarok.VirtualButton={A:4096,B:8192,X:16384,Y:32768,LB:256,RB:512,LT:255,RT:65280,BACK:32,START:16,STICK_LEFT:64,STICK_RIGHT:128,DPAD_UP:1,DPAD_DOWN:2,DPAD_LEFT:4,DPAD_RIGHT:8},window.Ragnarok.VirtualGamepadHandler=Ns,window.Ragnarok.ConfigureRagnarokSettings=pi,window.Ragnarok.CHANGELIST="rel-71-24504671",window.Ragnarok.AddPlatformTelemetry=function(e){ue(e)},window.Ragnarok.registerLogCallback=function(e){e?s.Logger.register(e):s.Logger.unregister()},window.Ragnarok.DeviceOS={WINDOWS:"WINDOWS",MACOS:"MACOS",SHIELD:"SHIELD",ANDROID:"ANDROID",IOS:"IOS",IPADOS:"IPADOS",CHROMEOS:"CHROMEOS",LINUX:"LINUX",TIZEN:"TIZEN",WEBOS:"WEBOS",TVOS:"TVOS",XBOX:"XBOX",STEAMOS:"STEAMOS",CCOS:"CCOS",VISIONOS:"VISIONOS"},window.Ragnarok.DeviceType={DESKTOP:"DESKTOP",LAPTOP:"LAPTOP",TV:"TV",PHONE:"PHONE",TABLET:"TABLET",CONSOLE:"CONSOLE",HMD:"HMD"},window.Ragnarok.DeviceModel={STEAMDECK:"STEAMDECK",XBOX_ONE:"XBOXONE",XBOX_SERIES:"XBOXSERIES",VISION_PRO:"VISIONPRO",QUEST:"QUEST"},window.Ragnarok.DeviceVendor={APPLE:"APPLE",LG:"LG",SAMSUNG:"SAMSUNG",TIZEN_LICENSED:"TIZENLICENSED",MICROSOFT:"MICROSOFT",AMAZON:"AMAZON",HKMC:"HKMC",SONY:"SONY",PHILIPS:"PHILIPS",GOOGLE:"GOOGLE",NVIDIA:"NVIDIA",XIAOMI:"XIAOMI",TVISION:"TVISION",UNKNOWN:""},window.Ragnarok.IsFeatureSupported=Qo,window.Ragnarok.CalculateMaxBitrateKbps=function(e,t,n){return Xo(e,t,n)[0]},window.Ragnarok.CalculateDataUsage=function(e,t){return Zo(e,t)},window.Ragnarok.AuthType=$l,window.Ragnarok.LogImpl=Jl,window.Ragnarok.performHttpRequest=Ql,window.Ragnarok.PayloadOSType=Yl,window.Ragnarok.PayloadBrowserType=Xl,window.Ragnarok.PayloadDeviceType=Zl,window.Ragnarok.ClientHeaderOSType=eu,window.Ragnarok.ClientHeaderBrowserType=tu,window.Ragnarok.ClientHeaderDeviceType=nu,window.Ragnarok.SdrHdrMode=iu,window.Ragnarok.BitDepth=su,window.Ragnarok.NetworkType=ru,window.Ragnarok.PlatformName=ou,window.Ragnarok.BrowserName=au,window.Ragnarok.translatePlatformDetailsForPayload=cu,window.Ragnarok.translatePlatformDetailsForClientHeader=du,window.Ragnarok.EVENTS={SESSION_START_RESULT:"SessionStartResult",SESSION_STOP_RESULT:"SessionStopResult",ACTIVE_SESSIONS_RESULT:"ActiveSessionsResult",PROGRESS_UPDATE:"ProgressUpdate",SESSION_UPDATE:"SessionUpdate",STREAM_STOPPED:"StreamStopped",STREAMING_EVENT:"StreamingEvent",GETSESSIONRESULT:"GetSessionResult",GET_SESSION_RESULT:"GetSessionResult",LOG_EVENT:"Log",STREAMING_QUALITY:"StreamingQuality",MIC_CAPTURE:"MicCapture",CUSTOM_MESSAGE:"CustomMessage",TEXT_COMPOSITION:"TextComposition",STREAM_STATS_UPDATE:"StreamStatsUpdate",TELEMETRY_EVENT:"TelemetryEvent",STREAM_QUALITY_REPORT:"StreamQualityReport"},window.Ragnarok.HotkeyModifier={None:0,Ctrl:1,Alt:2,Meta:4,Shift:8,Default:128},window.Ragnarok.defaultInputConfigFlags=Gt,window.Ragnarok.StreamingProfilePreset={BALANCED:0,DATASAVER:1,COMPETITIVE:2},window.Ragnarok.TrackType=Ut,window.Ragnarok.STREAMING_STATE={RECONNECTING:"reconnecting",RECONNECTED:"reconnected"},window.Ragnarok.RNotificationCode=jt,window.Ragnarok.ClientType={BROWSER:"BROWSER",GFNSDK:"GFNSDK",NATIVE:"NATIVE"},window.Ragnarok.SessionState={INITIALIZING:"initializing",READY_FOR_CONNECTION:"ready_for_connection",STREAMING:"streaming",PAUSED:"paused",RESUMING:"resuming",FINISHED:"finished",UNKNOWN:"unknown"},window.Ragnarok.SessionProgressState={CONNECTING:"Connecting",IN_QUEUE:"InQueue",CONFIGURING:"Configuring",PREVIOUS_SESSION_CLEANUP:"PreviousSessionCleanup",STARTING_STREAMER:"StartingStreamer"},window.Ragnarok.AppLaunchMode={Default:0,GamepadFriendly:1,TouchFriendly:2},window.Ragnarok.createSessionControl=function(e){const t=new St;if(t.init(e))return t;throw Error("Session Control initialization failure.")},window.Ragnarok.Usage={UNKNOWN:0,CONTROL:1,VIDEO:2,AUDIO:3,INPUT:4,CUSTOM:5,USB:6,RTSP:7,GAMESTREAM_CONTROL:8,GAMESTREAM_SECURE_CONTROL:9,SESSION_CONTROL:10,NETWORK_TEST_CONTROL:11,RTSPRU:12,AUDIO_INPUT:13,SIGNALING:14,MEDIA:15,RTSPS:16,BUNDLE:17},window.Ragnarok.Protocol={UNKNOWN:0,TCP:1,UDP:2},window.Ragnarok.AppLevelProtocol={UNKNOWN:0,RTSP:1,HTTP:2,RTSPRU:3,SOCKET:4,HTTPS:5,RTSPS:6},window.Ragnarok.AdState={UNKNOWN:0,NOT_STARTED:1,STARTED:2,PAUSED:3,RESUMED:4,FINISHED:5,CANCELED:6},window.Ragnarok.AdAction={UNKNOWN:0,START:1,PAUSE:2,RESUME:3,FINISH:4,CANCEL:5},window.Ragnarok.updateSessionParameters=function(e,t){var n;t=JSON.parse(t),e.monitorSettings=null!==(n=t.clientRequestMonitorSettings)&&void 0!==n?n:[],e.streamingFeatures=t.requestedStreamingFeatures},window.Ragnarok.isResumableSessionState=st,window.Ragnarok.getResumableSession=function(e,t){for(const n of e)if(n.appId===t&&st(n.state))return n},window.Ragnarok.isCancelCode=it,window.Ragnarok.ScErrorCode=wt,window.Ragnarok.configureSessionControlSettings=Je,window.Ragnarok.GsErrorCode=wt,window.Ragnarok.GridServerSettings=$e,window.Ragnarok.ConfigureGridServerSettings=function(e){Je(e)},window.Ragnarok.getPlatformDetails=me,window.Ragnarok.LogLevel=We,window.Ragnarok.CLIENT_VERSION="29.0",window.Ragnarok.CLIENT_IDENTIFICATION="GFN-PC",window.Ragnarok.SESSIONMODIFY_ACTION={UNKNOWN:0,PAUSE:1,RESUME:2,Fg:3,Eg:4,Dg:5,Cg:6,Gg:7},window.Ragnarok.AudioFormat={UNKNOWN:0,STEREO:1,UP_TO_5_1_SURROUND_PCM:2,UP_TO_7_1_SURROUND_PCM:3},window.Ragnarok.ClientStreamer={CLASSIC:"NVIDIA-CLASSIC",WEBRTC:"WEBRTC"},window.Ragnarok.GS_EVENTS={ACTIVE_SESSIONS_RESULT:"ActiveSessionsResult",PROGRESS_UPDATE:"ProgressUpdate",SESSION_UPDATE:"SessionUpdate",TELEMETRY_EVENT:"TelemetryEvent",LOG_EVENT:"Log"},window.Ragnarok.GridServer=kt,window.Ragnarok.PassThruServer=Ot,window.Ragnarok.RErrorCode={Success:15859712,AuthProviderError:3237085185,InvalidOperation:3237085186,NoNetwork:3237089281,NetworkError:3237089282,GetActiveSessionServerError:3237089283,ExceptionHappened:3237089284,AuthTokenNotUpdated:3237093377,SessionFinishedState:3237093378,ResponseParseFailure:3237093379,GridAppNotInitialized:3237093380,InvalidServerResponse:3237093381,PutOrPostInProgress:3237093382,GridServerNotInitialized:3237093383,DOMExceptionInGridServer:3237093384,InvalidAdStateTransition:3237093386,SessionServerErrorBegin:3237093632,RequestForbidden:3237093634,ServerInternalTimeout:3237093635,ServerInternalError:3237093636,ServerInvalidRequest:3237093637,ServerInvalidRequestVersion:3237093638,SessionListLimitExceeded:3237093639,InvalidRequestDataMalformed:3237093640,InvalidRequestDataMissing:3237093641,RequestLimitExceeded:3237093642,SessionLimitExceeded:3237093643,InvalidRequestVersionOutOfDate:3237093644,SessionEntitledTimeExceeded:3237093645,AuthFailure:3237093646,InvalidAuthenticationMalformed:3237093647,InvalidAuthenticationExpired:3237093648,InvalidAuthenticationNotFound:3237093649,EntitlementFailure:3237093650,InvalidAppIdNotAvailable:3237093651,InvalidAppIdNotFound:3237093652,InvalidSessionIdMalformed:3237093653,InvalidSessionIdNotFound:3237093654,EulaUnAccepted:3237093655,MaintenanceStatus:3237093656,ServiceUnAvailable:3237093657,SteamGuardRequired:3237093658,SteamLoginRequired:3237093659,SteamGuardInvalid:3237093660,SteamProfilePrivate:3237093661,InvalidCountryCode:3237093662,InvalidLanguageCode:3237093663,MissingCountryCode:3237093664,MissingLanguageCode:3237093665,SessionNotPaused:3237093666,EmailNotVerified:3237093667,InvalidAuthenticationUnsupportedProtocol:3237093668,InvalidAuthenticationUnknownToken:3237093669,InvalidAuthenticationCredentials:3237093670,SessionNotPlaying:3237093671,InvalidServiceResponse:3237093672,AppPatching:3237093673,GameNotFound:3237093674,NotEnoughCredits:3237093675,InvitationOnlyRegistration:3237093676,RegionNotSupportedForRegistration:3237093677,SessionTerminatedByAnotherClient:3237093678,DeviceIdAlreadyUsed:3237093679,ServiceNotExist:3237093680,SessionExpired:3237093681,SessionLimitPerDeviceReached:3237093682,ForwardingZoneOutOfCapacity:3237093683,RegionNotSupportedIndefinitely:3237093684,RegionBanned:3237093685,RegionOnHoldForFree:3237093686,RegionOnHoldForPaid:3237093687,AppMaintenanceStatus:3237093688,ResourcePoolNotConfigured:3237093689,InsufficientVmCapacity:3237093690,InsufficientRouteCapacity:3237093691,InsufficientScratchSpaceCapacity:3237093692,RequiredSeatInstanceTypeNotSupported:3237093693,ServerSessionQueueLengthExceeded:3237093694,RegionNotSupportedForStreaming:3237093695,SessionForwardRequestAllocationTimeExpired:3237093696,SessionForwardGameBinariesNotAvailable:3237093697,GameBinariesNotAvailableInRegion:3237093698,UekRetrievalFailed:3237093699,EntitlementFailureForResource:3237093700,SessionInQueueAbandoned:3237093701,MemberTerminated:3237093702,SessionRemovedFromQueueMaintenance:3237093703,ZoneMaintenanceStatus:3237093704,GuestModeCampaignDisabled:3237093705,RegionNotSupportedAnonymousAccess:3237093706,InstanceTypeNotSupportedInSingleRegion:3237093707,InvalidZoneForQueuedSession:3237093710,SessionWaitingAdsTimeExpired:3237093711,UserCancelledWatchingAds:3237093712,StreamingNotAllowedInLimitedMode:3237093713,ForwardRequestJPMFailed:3237093714,MaxSessionNumberLimitExceeded:3237093715,GuestModePartnerCapacityDisabled:3237093716,SessionRejectedNoCapacity:3237093717,SessionInsufficientPlayabilityLevel:3237093718,SessionServerErrorEnd:3237093887,StreamerErrorCategory:3237093888,StreamErrorGeneric:3237093889,StreamerSignInFailure:3237093890,StreamerHangingGetFailure:3237093891,StreamerNetworkError:3237093892,StreamerVideoPlayError:3237093893,StreamerIceConnectionFailed:3237093894,StreamerGetRemotePeerTimedOut:3237093895,StreamInputChannelError:3237093896,StreamCursorChannelError:3237093897,StreamControlChannelError:3237093898,StreamerReConnectionFailed:3237093899,StreamerNoVideoPacketsReceivedEver:3237093900,StreamerNoVideoFramesLossyNetwork:3237093901,StreamerSetSDPFailure:3237093902,StreamerNoLocalCandidates:3237093903,StreamerNoRemoteCandidates:3237093904,StreamerNoVideoTrack:3237093905,StreamerIceReConnectionFailed:3237093906,StreamerSignInTimeout:3237093907,StreamerSignInWorkerFailure:3237093908,StreamerNoTracksReceivedInSdp:3237093909,StreamerNvstSdpFailure:3237093910,StreamerNvstSdpParseFailure:3237093911,StreamerNoPeerInfo:3237093912,StreamerNoOffer:3237093913,StreamerNoAudioTrack:3237093914,StreamerInvalidRemoteConfigOverride:3237093915,StreamerInvalidServerOverride:3237093916,StreamerInvalidClientOverride:3237093917,StreamerConfigUpdateFailure:3237093918,StreamerInputChannelNotOpen:3237093919,StreamerCursorChannelNotOpen:3237093920,StreamerControlChannelNotOpen:3237093921,StreamerVideoAdapterInitTimeOut:3237093922,StreamerVideoFrameProviderInitTimeOut:3237093923,StreamerVideoEncoderInitTimeOut:3237093924,StreamerVideoSetupTimeOut:3237093925,StreamerNoStunResponsesReceived:3237093926,StreamerNoNominatedCandidatePairs:3237093927,StreamerNoSucceededCandidatePairs:3237093928,StreamPartiallyReliableInputChannelError:3237093929,StreamerPartiallyReliableInputChannelNotOpen:3237093936,StreamerNeedAudioElement:3237093937,SessionSetupCancelled:15867905,SessionSetupCancelledDuringQueuing:15867906,StreamerDataChannelClosing:15867907,SystemSleepDuringStreaming:15867908,SystemSleepDuringSessionSetup:15867909,PauseSession:15867910,DelayedSessionError:15867911,WebPageClosed:15867912,ClientDisconnectedUserIdle:15867913,UnhandledException:3237093392,NoInternetDuringSessionSetup:15868417,NoInternetDuringStreaming:15868418,StreamDisconnectedFromServer:15868672,ServerDisconnectedNoResponse:3237094145,ServerDisconnectedRemoteInputError:3237094146,ServerDisconnectedFrameGrabFailed:3237094147,ServerDisconnectedConfigUnAvailable:3237094148,ServerDisconnectedInvalidCommand:3237094149,ServerDisconnectedInvalidMouseState:3237094150,ServerDisconnectedNetworkError:3237094151,ServerDisconnectedGameLaunchFailed:3237094152,ServerDisconnectedVideoFirstFrameSendFailed:3237094153,ServerDisconnectedVideoNextFrameSendFailed:3237094154,ServerDisconnectedFrameGrabTimedOut:3237094155,ServerDisconnectedFrameEncodeTimedOut:3237094156,ServerDisconnectedFrameSendTimedOut:3237094157,ServerDisconnectedNetworkTimedOut:3237094158,ServerDisconnectedPeerRemovedByServer:3237094159,ServerDisconnectedUnknownError:3237094160,ServerDisconnectedPeerRemovedBeforeStream:3237094161,ServerDisconnectedIntended:15868704,ServerDisconnectedHotKey:15868705,ServerDisconnectedUserLoggedInDifferentAccount:15868706,ServerDisconnectedWindowedMode:15868707,ServerDisconnectedUserIdle:15868708,ServerDisconnectedUnAuthorizedProcessDetected:15868709,ServerDisconnectedMaliciousProcessDetected:15868710,ServerDisconnectedUnKnownProcessDetected:15868711,ServerDisconnectedMinerProcessDetected:15868712,ServerDisconnectedStreamingUnsupported:15868713,ServerDisconnectedAnotherClient:15868714,ServerDisconnectedCodeIntegrityViolation:15868715,ServerDisconnectedUnauthorizedActivityDetected:15868716,ServerDisconnectedGameNotOwnedByUser:15868717,ServerDisconnectedProtectedContent:15868718,ServerDisconnectedDisplayTopologyChanged:15868719,ServerDisconnectedAbruptly:15868688,ServerDisconnectedUnknownFromPm:15868736,ServerDisconnectedUserEntitledMinutesExceeded:15868737,ServerDisconnectedClientReconnectTimeLimitExceeded:15868738,ServerDisconnectedOperatorCommandedTermination:15868739,ServerDisconnectedConcurrentSessionLimitExceeded:15868740,ServerDisconnectedMaxSessionTimeLimitExceeded:15868741,ServerDisconnectedBifrostInitiatedSessionPause:15868742,ServerDisconnectedSystemCommandTermination:15868743,ServerDisconnectedMultipleLogin:15868744,ServerDisconnectedMaintenanceMode:15868745,ServerDisconnectedMultipleTab:15868752,InvalidVideoElement:3237094400,InvalidAudioElement:3237094401,WebSocketClosed:3237097472,WebSocketNormalClosure:3237101567,WebSocketGoingAway:3237101566,WebSocketProtocolError:3237101565,WebSocketUnsupportedData:3237101564,WebSocketNoStatusRcvd:3237101562,WebSocketInvalidFramePayloadData:3237101560,WebSocketPolicyViolation:3237101559,WebSocketMessageTooBig:3237101558,WebSocketMandatoryExt:3237101557,WebSocketInternalError:3237101556,WebSocketServiceRestart:3237101555,WebSocketTryAgainLater:3237101554,WebSocketBadGateway:3237101553,WebSocketTLSHandshakeFailure:3237101552,WebSocketUnauthorized:3237101551,WebSocketForbidden:3237101550,WebSocketTimeout:3237101549},window.Ragnarok.VsyncType={OFF:0,ON:1,ADAPTIVE:2},window.Ragnarok.getDeviceCapabilities=ea,window.Ragnarok.serializeDeviceCapabilities=function(e){return JSON.stringify(e)},window.Ragnarok.prefetchDeviceCapabilities=function(){var e=ha;e.C||(e.C=!0,async function(e){await ua(e,!0)}(e),ra(e),oa(e))},window.Ragnarok.registerDeviceCapabilitiesChanged=function(e){var t,n=ha;(n.h.push(e),0<n.h.length)&&(null===(t=(e=window.screen).addEventListener)||void 0===t||t.call(e,"change",n.j),window.addEventListener("focus",n.j),window.addEventListener("resize",n.j))},window.Ragnarok.unregisterDeviceCapabilitiesChanged=function(e){aa(e)},window.Ragnarok.decodeWsErrorCodes=function(e){switch(e){case 3237101567:return 1e3;case 3237101566:return 1001;case 3237101565:return 1002;case 3237101564:return 1003;case 3237101562:return 1005;case 3237093890:return 1006;case 3237101560:return 1007;case 3237101559:return 1008;case 3237101558:return 1009;case 3237101557:return 1010;case 3237101556:return 1011;case 3237101555:return 1012;case 3237101554:return 1013;case 3237101553:return 1014;case 3237101552:return 1015;case 3237101551:return 3e3;case 3237101550:return 3003;case 3237101549:return 3008}if(3237097472<=e&&3237101567>=e)return e-3237097472+4e3},window.Ragnarok.getStreamerType=function(){return"WEBRTC"},window.Ragnarok.BrowserFeature={Streaming:0,MicCapture:1},window.Ragnarok.isFeatureSupported=Qo,window.Ragnarok.shouldDefaultEnableMic=Yo,window.Ragnarok.getRecommendedBitrate=Xo,window.Ragnarok.getStreamStartParameters=function(e){const t={downstreamParams:[],signalConnectionInfo:{address:"",port:0},enableTouchInput:2===(e=JSON.parse(e)).appLaunchMode,sessionId:e.sessionId,subSessionId:e.subSessionId,audioTagId:"",zoneAddress:e.zoneAddress,statTelemetryInfo:{appId:e.appId,zoneName:e.zoneName,gpuType:e.gpuType},streamingFeatures:e.finalizedStreamingFeatures};for(const n of e.monitorSettings)t.downstreamParams.push({width:n.widthInPixels,height:n.heightInPixels,fps:n.framesPerSecond,videoTagId:"",sdrHdrMode:n.sdrHdrMode});for(const n of e.connectionInfo)switch(n.usage){case 14:t.signalConnectionInfo.address=n.ip,t.signalConnectionInfo.port=n.port,t.signalConnectionInfo.secure=5===n.appLevelProtocol,t.signalConnectionInfo.resourcePath=n.resourcePath;break;case 2:case 17:t.mediaConnectionInfo={address:n.ip,port:n.port}}return t},window.Ragnarok.estimateDataUsage=Zo,window.Ragnarok.createNskStreamClient=function(e,t,n){return new class{constructor(e,t,n){this.u=e,this.l=t,this.S=n,this.K=new ml,this.P=new yl,this.startTime=this.streamingState=0,this.isResume=!1,this.s=this.G=this.D=0,this.zoneName=this.zoneAddress=this.subSessionId=this.sessionId="",this.m=!1,this.appId=0,this.M=e=>(Pt.e("{0a9be04}","{8516485}",e.filename,e.lineno,e.colno),this.h.Aa(e.error,e.error&&e.error.message?e.error.message:e.message,e.filename,e.lineno,e.colno,!1),Mn.terminateUnhandledException&&lu(this,3237093392),!1),this.O=()=>{var e;if(Pt.i("{0a9be04}","{478a408}",document.visibilityState,!!this.g),this.g){var t=this.H,n=this.Da,i=t&&n&&C(this.u,!1,15,4)&&oi,s=C(this.u,!1,15,4)&&this.m&&ri;"hidden"===document.visibilityState?(this.G=performance.now(),i&&(Pt.i("{0a9be04}","{cbd3b6e}"),t.muted=!0,n.muted=!0)):"visible"===document.visibilityState&&(i&&(Pt.i("{0a9be04}","{05deefa}"),t.muted=!1,n.muted=!1),s?(t=null!==(e=Mn.userTerminatedMicRecorderThreshold)&&void 0!==e?e:2e3,this.G-this.j.N<t?(Pt.i("{0a9be04}","{862bd20}"),this.j.G=!0,this.captureMic(!0,this.v)):(this.m=!1,this.v=void 0)):C(this.u,!1,15,4)&&!this.j.m&&zo(this.j)&&this.j.D&&Go(this.j,"visibilityChange"))}},this.N=()=>{var e,t;lu(this,(null!==(e=this.J)&&void 0!==e?e:null!==(t=this.g)&&void 0!==t&&t.I)?15867912:15867905)},this.I=()=>{Ko(this.j,this.s),this.s++},this.L=e=>{var t;e.detail.idle&&(null===(t=this.g)||void 0===t||bd(t,2,60),this.D=window.setTimeout((()=>{var e;null===(e=this.g)||void 0===e||ud(e,15867913)}),6e4))},this.C=()=>{this.j.j()},e=window.zoneless,this.R=new Rl,this.o=Us(this.u,e),this.h=new cl,this.j=new $o(this.u,this.h),this.F=new El(this.h),Zn&&Js(this.o,this.K),ue(this.h),function(e){var t,n,i;if(Mn.sendNonEssentialMetricEvents){var s=performance.getEntriesByName("GfnJsInitStart")[0];const r=performance.getEntriesByName("platformBegin")[0],o=performance.getEntriesByName("GfnNskBegin")[0],a=performance.getEntriesByType("navigation");s=Math.round(null!==(t=null==s?void 0:s.startTime)&&void 0!==t?t:-1),t=Math.round(null!==(n=null==r?void 0:r.startTime)&&void 0!==n?n:-1),sl(e.h,"PerformanceTiming","application timings",s,t,Math.round(null!==(i=null==o?void 0:o.startTime)&&void 0!==i?i:-1),t-s),a.length?(n=a[a.length-1],sl(e.h,"PerformanceTiming","load timings",Math.round(n.loadEventStart),Math.round(n.loadEventEnd),Math.round(n.domContentLoadedEventStart),Math.round(n.domContentLoadedEventEnd))):sl(e.h,"PerformanceTiming","navigation timings unsupported",0,0,0,0)}}(this),ba(this.h),Mn.sendNonEssentialMetricEvents&&sl(this.h,"PlatformDetailsExecutionTime","",this.u.totalTime,0,0,0),Pt.i("{0a9be04}","{16f11e6}","Local"),Pt.d("{0a9be04}","{e85ad66}",navigator.userAgent)}startStreaming(e){var t,n,i,s,r,o,a,c,d,l,u,h,f,v,g;if(4!==this.streamingState&&0!==this.streamingState)return Pt.w("{0a9be04}","{60a7ff5}"),nl(this.h,"SessionSetupInProgressError",e.resume?"resume":"start"),3237085186;const m=function(e){var t;const n={errorCode:void 0,streamParams:Object.assign({},e),Da:void 0,Yd:[]};if(0<n.streamParams.downstreamParams.length||!e.audioTagId){for(var i of n.streamParams.downstreamParams)(e=document.getElementById(i.videoTagId))&&e instanceof HTMLVideoElement&&n.Yd.push(e);if(!n.Yd.length)return{errorCode:3237094400}}else{if(!((i=document.getElementById(e.audioTagId))&&i instanceof HTMLAudioElement))return{errorCode:3237094401};n.Da=i}const s=!!Wn&&!!qn,r=!!ai;return(s||r)&&(null===(t=n.streamParams.downstreamParams)||void 0===t||t.forEach((e=>{s&&(e.width=Wn,e.height=qn),r&&(e.fps=ai)})),s&&Pt.i("{0a9be04}","{92a6b38}",Wn,qn),r&&Pt.d("{0a9be04}","{6618bcd}",ai)),n}(e);if(m.errorCode)return m.errorCode;if(e=m.streamParams,this.H=m.Yd[0],this.Da=m.Da,this.isResume=null!==(t=e.resume)&&void 0!==t&&t,this.sessionId=e.sessionId,this.subSessionId=null!==(n=e.subSessionId)&&void 0!==n?n:"",this.zoneAddress=null!==(i=e.zoneAddress)&&void 0!==i?i:"",this.zoneName=null!==(r=null===(s=e.statTelemetryInfo)||void 0===s?void 0:s.zoneName)&&void 0!==r?r:"",this.appId=null!==(a=null===(o=e.statTelemetryInfo)||void 0===o?void 0:o.appId)&&void 0!==a?a:0,function(e,t,n,i,s,r){e.subSessionId=t,e.sessionId=n,e.cmsId=i,e.isResume=s,e.zoneAddress=r}(this.h,this.subSessionId,this.sessionId,this.appId.toString(),this.isResume,this.zoneAddress),this.F.reset(this.sessionId,this.subSessionId),C(this.u,!1,15)){const e=this.H;e.streamKitOldPlay||(e.streamKitOldPlay=this.H.play);const t=ni&&C(this.u,!0,15,1);this.H.play=()=>{var n,i,s;if(ii&&(Pt.i("{0a9be04}","{4a5b360}"),uu(this),function(e){if(ii)if(window.ios15AudioContext)Pt.i("{0a9be04}","{e2aba64}");else{var t=new(window.AudioContext||window.webkitAudioContext)({latencyHint:"interactive",sampleRate:48e3});t.onstatechange=()=>{"suspended"===t.state&&(t.resume(),e.j.j(),Pt.i("{0a9be04}","{faee684}"))},window.ios15AudioContext=t,window.ios15AudioStream=t.createMediaStreamDestination(),navigator.mediaDevices&&e.C&&navigator.mediaDevices.addEventListener("devicechange",e.C),Pt.i("{0a9be04}","{b5f7b9b}")}}(this),this.j.j()),t){Pt.i("{0a9be04}","{8f5cd77}");const e=null!==(i=null===(n=this.H)||void 0===n?void 0:n.srcObject)&&void 0!==i?i:null;null!==(s=this.H)&&void 0!==s&&s.srcObject&&(this.H.srcObject=null,this.H.srcObject=e)}return e.streamKitOldPlay.apply(this.H)}}return si&&(C(this.u,!0,15,0)||C(this.u,!0,15,1))&&(this.H.hasAttribute("data-shouldautoplay")?this.H.setAttribute("autoplay",""):(this.H.setAttribute("data-shouldautoplay",""),this.H.removeAttribute("autoplay"))),i={ip:"",port:0,appLevelProtocol:0,usage:0,protocol:0},e.mediaConnectionInfo&&(i.ip=e.mediaConnectionInfo.address,i.port=e.mediaConnectionInfo.port,i.usage=2),s={ip:e.signalConnectionInfo.address,port:e.signalConnectionInfo.port,protocol:e.signalConnectionInfo.secure?"wss":"ws",resourcePath:e.signalConnectionInfo.resourcePath},r={width:(t=e.downstreamParams[0]).width,height:t.height,fps:t.fps,sdrHdrMode:t.sdrHdrMode},n={appId:this.appId,appLaunchMode:e.enableTouchInput?2:0,clientLocale:null!==(d=null===(c=e.statTelemetryInfo)||void 0===c?void 0:c.clientLocale)&&void 0!==d?d:"",gpuType:null!==(u=null===(l=e.statTelemetryInfo)||void 0===l?void 0:l.gpuType)&&void 0!==u?u:"",mediaConnectionInfo:[i],sessionId:this.sessionId,signalConnectionInfo:s,state:"ready_for_connection",streamInfo:[r],subSessionId:this.subSessionId,zoneAddress:this.zoneAddress,zoneName:this.zoneName,finalizedStreamingFeatures:e.streamingFeatures},c={width:t.width,height:t.height,fps:t.fps,maxBitrateKbps:t.maxBitrateKbps,videoTagId:t.videoTagId,audioTagId:e.audioTagId},null!==(h=(d={...Gt}).windowedStreaming)&&void 0!==h||(d.windowedStreaming=e.windowedStreaming),null!==(f=d.cursorType)&&void 0!==f||(d.cursorType=e.cursorType),this.g=new Dd(this,this.H,this.Da,this.j,d,this.K,this.o,this.h,this.u,n,this.R,c,this.P,this.S.textInputElement,null===(v=e.statTelemetryInfo)||void 0===v?void 0:v.clientAppVersion,this.isResume,null===(g=e.statTelemetryInfo)||void 0===g?void 0:g.region,t.dynamicStreamingMode,e.upstreamParams,e.signalConnectionInfo.queryParameters),function(e){var t,n,i,s;const r=window.zoneless,o=null!==(n=null===(t=null==r?void 0:r.windowAddEventListener)||void 0===t?void 0:t.bind(window))&&void 0!==n?n:window.addEventListener.bind(window);t=null!==(s=null===(i=null==r?void 0:r.documentAddEventListener)||void 0===i?void 0:i.bind(document))&&void 0!==s?s:document.addEventListener.bind(document),o("pagehide",e.N),o("error",e.M),t("visibilitychange",e.O),navigator.mediaDevices&&navigator.mediaDevices.addEventListener("devicechange",e.I),p(e.u)&&t("SystemIdle",e.L)}(this),this.streamingState=1,Oe(this.F.g),this.startTime=performance.now(),this.g.start(),e.keyboardLayout&&this.g.setKeyboardLayout(e.keyboardLayout),15859712}stopStreaming(e){!this.g||1!==this.streamingState&&2!==this.streamingState||(e=e??15859712,Pt.i("{0a9be04}","{ae7f61b}",l(e)),this.streamingState=3,lu(this,e,!0))}getStreamingState(){return this.streamingState}sendCustomMessage(e){var t;return null===(t=this.g)||void 0===t||t.sendCustomMessage(e),!!this.g}setStreamingMaxBitrate(e,t,n){var i;return null===(i=this.g)||void 0===i||i.setStreamingMaxBitrate(t??0,e,n),!!this.g}setDynamicStreamingMode(e,t,n){var i;return null===(i=this.g)||void 0===i||i.setDrcDfcState(t??0,e,n),!!this.g}setHdr10PlusGaming(e){var t;return null===(t=this.g)||void 0===t||((t=t.aa).h=e,$c(t)),!!this.g}setKeyboardLayout(e){var t;return null===(t=this.g)||void 0===t||t.setKeyboardLayout(e),!!this.g}setSupportedHidTypes(e){Gs(this.o,e)}setGamepadRsdmm(e){var t;return!!this.g&&(null===(t=this.g)||void 0===t||t.toggleRsdmm(e),!0)}getVirtualInputController(){return this}getGamepadBitmap(){return br(this.o)}captureUserInput(e,t){var n;return null===(n=this.g)||void 0===n||n.toggleUserInput(e,t),!!this.g}sendTextInput(e){var t;return null===(t=this.g)||void 0===t||t.sendTextInput(e),!!this.g}getMicState(){return Fo()}captureMic(e,t){return!!this.g&&(this.v=(this.m=e)?t:void 0,this.m?Vo(this.j,t):jo(this.j),!0)}setVideoTransforms(e,t,n){var i;return null===(i=this.g)||void 0===i||i.setVideoTransforms(e,t,n),!!this.g}setUpstreamMedia(e,t){var n;return this.g?null===(n=this.g)||void 0===n?void 0:n.setUpstreamMedia(e,t):Promise.resolve(!1)}unsetUpstreamMedia(e){var t;return this.g?null===(t=this.g)||void 0===t?void 0:t.unsetUpstreamMedia(e):Promise.resolve(!1)}stopUpstreamMedia(e){var t;return this.g?null===(t=this.g)||void 0===t?void 0:t.stopUpstreamMedia(e):Promise.resolve(!1)}startInputPlayback(e){var t;null===(t=this.g)||void 0===t||t.startInputPlayback(e)}yc(e){var t,n,i,s,r,o,a,c;let d=15859712;if(e.error)d=e.error.code,this.l.onStreamStartFailed(d),lu(this,d);else if(null!==(t=e.streamInfo)&&void 0!==t&&t.length&&null!==(n=e.streams)&&void 0!==n&&n.length){this.streamingState=2,t={streams:[],separateAudioStream:!!e.streams.find((e=>{const t=e.tracks.find((e=>"video"===e.kind));return e=e.tracks.find((e=>"audio"===e.kind)),!t&&e}))};for(const a of e.streamInfo)n={width:a.width,height:a.height,fps:a.fps,sdrHdrMode:a.sdrHdrMode,bitDepth:null!==(i=e.bitDepth)&&void 0!==i?i:8,codec:null===(s=this.g)||void 0===s?void 0:s.fb(),videoTagId:null!==(o=null===(r=this.H)||void 0===r?void 0:r.tagName)&&void 0!==o?o:""},t.streams.push(n);this.l.onStreamStarted(t),this.isResume&&this.m&&this.captureMic(!0,this.v)}else d=3237093905,Pt.e("{0a9be04}","{0cfb100}"),this.l.onStreamStartFailed(d),lu(this,d);(function(e,t,n,i){var s,r,o;const a=xt.getTelemetryEventIds(),c=new Nt({zoneAddress:e.zoneAddress,networkSessionId:null!==(s=a.networkSessionId)&&void 0!==s?s:"",sessionId:e.sessionId,subSessionId:e.subSessionId,resumeType:Oi(e.isResume),overrideConfigType:_n.type,overrideConfigVersion:_n.version,result:n,codec:Ti(i),ipVersion:"UNKNOWN",launchDuration:Math.round(t),networkType:k(Gd.getCurrentNetworkType()),streamingProfileGuid:null!==(r=a.streamingProfileGuid)&&void 0!==r?r:"",systemInfoGuid:null!==(o=a.systemInfoGuid)&&void 0!==o?o:"",cmsId:e.cmsId});e.processEvent(c)})(this.h,Math.round(performance.now()-this.startTime),l(d),null!==(c=null===(a=this.g)||void 0===a?void 0:a.fb())&&void 0!==c?c:"UNKNOWN"),15859712===d&&function(e,t){if(!e.l){al(e);const n=()=>{const n=l(t.ig());ol(e,n,n,t.jg(),t.fb(),t.ua())};n(),e.l=window.setInterval(n,12e4)}}(this.h,{ua:()=>{var e,t;return null!==(t=null===(e=this.g)||void 0===e?void 0:e.ua())&&void 0!==t?t:0},ig:()=>{var e;return null!==(e=this.J)&&void 0!==e?e:15867911},fb:()=>{var e,t;return null!==(t=null===(e=this.g)||void 0===e?void 0:e.fb())&&void 0!==t?t:"UNKNOWN"},jg:()=>performance.now()-this.startTime}),this.startTime=performance.now()}yf(e){lu(this,e.error.code)}zf(){hu(this)}emit(e,...t){if(t.length)switch(e){case"StreamingEvent":t[0].streamingWarnings&&this.l.onStreamWarning(t[0].streamingWarnings);break;case"StreamingQuality":this.l.onStreamQuality(t[0]);break;case"MicCapture":this.l.onMicStateUpdate&&void 0!==t[0].state&&this.l.onMicStateUpdate(t[0].state);break;case"TextComposition":this.l.onTextComposition(t[0]);break;case"CustomMessage":this.l.onCustomMessage&&this.l.onCustomMessage(t[0]);break;case"StreamStatsUpdate":this.l.onStreamStatistics(t[0])}}addListener(){}removeListener(){}removeAllListeners(){}removeAllListenersOfEvent(){}hasListener(){return!0}setClientSupportsVirtualGamepad(){this.o.getVirtualGamepadHandler().enable()}handleVirtualGamepadState(e,t,n){this.o.getVirtualGamepadHandler().updateInput(e,t,n)}setVirtualKeyboardState(e){var t;return null===(t=this.g)||void 0===t||t.setVirtualKeyboardState(e),!!this.g}handleVirtualKeyInput(e){var t;return null===(t=this.g)||void 0===t||t.sendKeyEvent(e),!!this.g}}(e,t,n)},window.Ragnarok.configureStreamKitSettings=pi,window.Ragnarok.getNetworkTypeDetector=function(){return Gd},window.Ragnarok.HidType={NONE:0,DS4:1,DS5:2},window.Ragnarok.InputType={None:0,Mouse:1,Keyboard:2,Gamepad:4,Touch:8,All:15},window.Ragnarok.VideoCodecType={H264:"H264",H265:"H265",AV1:"AV1",UNKNOWN:"UNKNOWN"},window.Ragnarok.MicState={UNINITIALIZED:0,PERMISSION_PENDING:1,PERMISSION_DENIED:2,STARTED:3,NO_SUITABLE_DEVICE:4,STOPPED:5,UNSUPPORTED:6,ERROR:7},window.Ragnarok.DynamicStreamingMode={NONE:0,DRC:1,DFC:2,ALL:3},window.Ragnarok.MediaTrackKind=Ut,window.Ragnarok.StreamStopReason={CLIENT_DISCONNECTED:0,SERVER_DISCONNECTED:1,NETWORK_ERROR:2,ERROR:3},window.Ragnarok.StreamWarningType=jt,window.Ragnarok.CursorType={SOFTWARE:0,HARDWARE:1,FREE:2},window.Ragnarok.StreamingState={NONE:0,STARTING_STREAM:1,STREAMING:2,STOPPING_STREAM:3,STOPPED:4}},134:
/*!******************************************************************!*\
          !*** ./node_modules/rtcpeerconnection-shim/rtcpeerconnection.js ***!
          \******************************************************************/(e,t,n)=>{var i=n(
/*! sdp */
985);function s(e,t,n,s,r){var o=i.writeRtpDescription(e.kind,t);if(o+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":r||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var c="msid:"+(s?s.id:"-")+" "+a+"\r\n";o+="a="+c,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),o}function r(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},s=function(e,t,n,s){var r=i(e.parameters.apt,n),o=i(t.parameters.apt,s);return r&&o&&r.name.toLowerCase()===o.name.toLowerCase()};return e.codecs.forEach((function(i){for(var r=0;r<t.codecs.length;r++){var o=t.codecs[r];if(i.name.toLowerCase()===o.name.toLowerCase()&&i.clockRate===o.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&o.parameters.apt&&!s(i,o,e.codecs,t.codecs))continue;(o=JSON.parse(JSON.stringify(o))).numChannels=Math.min(i.numChannels,o.numChannels),n.codecs.push(o),o.rtcpFeedback=o.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var s=t.headerExtensions[i];if(e.uri===s.uri){n.headerExtensions.push(s);break}}})),n}function o(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function a(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}e.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,n,i,s){var r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=s,e.setTimeout((function(){t._dispatchEvent("track",r)}))}var l=function(n){var s=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){s[e]=r[e].bind(r)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var s="string"==typeof i;return s&&(i=[i]),i=i.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=s?i[0]:i,!!i.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var o=n.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var s=this._createIceAndDtlsTransports();i.iceTransport=s.iceTransport,i.dtlsTransport=s.dtlsTransport}return t||this.transceivers.push(i),i},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var i,s=0;s<this.transceivers.length;s++)!this.transceivers[s].track&&this.transceivers[s].kind===t.kind&&(i=this.transceivers[s]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),i.getTracks().forEach((function(e){n.addTrack(e,i)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var i=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var s=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(s,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;s.state=n?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},s.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),s},l.prototype._gather=function(t,n){var s=this,r=this.transceivers[n].iceGatherer;if(!r.onlocalcandidate){var o=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,r.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),r.onlocalcandidate=function(e){if(!(s.usingBundle&&n>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:n};var a=e.candidate,c=!a||0===Object.keys(a).length;if(c)("new"===r.state||"gathering"===r.state)&&(r.state="completed");else{"new"===r.state&&(r.state="gathering"),a.component=1,a.ufrag=r.getLocalParameters().usernameFragment;var d=i.writeCandidate(a);o.candidate=Object.assign(o.candidate,i.parseCandidate(d)),o.candidate.candidate=d,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var l=i.getMediaSections(s._localDescription.sdp);l[o.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",s._localDescription.sdp=i.getDescription(s._localDescription.sdp)+l.join("");var u=s.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==s.iceGatheringState&&(s.iceGatheringState="gathering",s._emitGatheringStateChange()),c||s._dispatchEvent("icecandidate",o),u&&(s._dispatchEvent("icecandidate",new Event("icecandidate")),s.iceGatheringState="complete",s._emitGatheringStateChange())}},e.setTimeout((function(){o.forEach((function(e){r.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,s){var o=r(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(o.encodings=e.sendEncodingParameters,o.rtcp={cname:i.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(o.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(o)),s&&e.rtpReceiver&&o.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?o.encodings=e.recvEncodingParameters:o.encodings=[{}],o.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(o.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(o.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(o))},l.prototype.setLocalDescription=function(e){var t,n,s=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!o("setLocalDescription",e.type,s.signalingState)||s._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+s.signalingState));if("offer"===e.type)t=i.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=i.parseRtpParameters(e);s.transceivers[t].localCapabilities=n})),s.transceivers.forEach((function(e,t){s._gather(e.mid,t)}));else if("answer"===e.type){t=i.splitSections(s._remoteDescription.sdp),n=t.shift();var a=i.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var o=s.transceivers[t],c=o.iceGatherer,d=o.iceTransport,l=o.dtlsTransport,u=o.localCapabilities,h=o.remoteCapabilities;if(!(i.isRejected(e)&&0===i.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var p=i.getIceParameters(e,n),f=i.getDtlsParameters(e,n);a&&(f.role="server"),(!s.usingBundle||0===t)&&(s._gather(o.mid,t),"new"===d.state&&d.start(c,p,a?"controlling":"controlled"),"new"===l.state&&l.start(f));var v=r(u,h);s._transceive(o,v.codecs.length>0,!1)}}))}return s._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(s){var l=this;if(-1===["offer","answer"].indexOf(s.type))return Promise.reject(c("TypeError",'Unsupported type "'+s.type+'"'));if(!o("setRemoteDescription",s.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+s.type+" in state "+l.signalingState));var u={};l.remoteStreams.forEach((function(e){u[e.id]=e}));var h=[],p=i.splitSections(s.sdp),f=p.shift(),v=i.matchPrefix(f,"a=ice-lite").length>0,g=i.matchPrefix(f,"a=group:BUNDLE ").length>0;l.usingBundle=g;var m=i.matchPrefix(f,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!m&&m.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(o,c){var d=i.splitLines(o),p=i.getKind(o),m=i.isRejected(o)&&0===i.matchPrefix(o,"a=bundle-only").length,A=d[0].substr(2).split(" ")[2],b=i.getDirection(o,f),S=i.parseMsid(o),y=i.getMid(o)||i.generateIdentifier();if(m||"application"===p&&("DTLS/SCTP"===A||"UDP/DTLS/SCTP"===A))l.transceivers[c]={mid:y,kind:p,protocol:A,rejected:!0};else{!m&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(p,!0));var w,E,I,C,T,R,k,O,P,D,L,x=i.parseRtpParameters(o);m||(D=i.getIceParameters(o,f),(L=i.getDtlsParameters(o,f)).role="client"),k=i.parseRtpEncodingParameters(o);var M=i.parseRtcpParameters(o),N=i.matchPrefix(o,"a=end-of-candidates",f).length>0,_=i.matchPrefix(o,"a=candidate:").map((function(e){return i.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===s.type||"answer"===s.type)&&!m&&g&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==s.type||m){if("answer"===s.type&&!m){E=(w=l.transceivers[c]).iceGatherer,I=w.iceTransport,C=w.dtlsTransport,T=w.rtpReceiver,R=w.sendEncodingParameters,O=w.localCapabilities,l.transceivers[c].recvEncodingParameters=k,l.transceivers[c].remoteCapabilities=x,l.transceivers[c].rtcpParameters=M,_.length&&"new"===I.state&&(!v&&!N||g&&0!==c?_.forEach((function(e){a(w.iceTransport,e)})):I.setRemoteCandidates(_)),(!g||0===c)&&("new"===I.state&&I.start(E,D,"controlling"),"new"===C.state&&C.start(L)),!r(w.localCapabilities,w.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&w.sendEncodingParameters[0].rtx&&delete w.sendEncodingParameters[0].rtx,l._transceive(w,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!T||"sendrecv"!==b&&"sendonly"!==b?delete w.rtpReceiver:(P=T.track,S?(u[S.stream]||(u[S.stream]=new e.MediaStream),n(P,u[S.stream]),h.push([P,T,u[S.stream]])):(u.default||(u.default=new e.MediaStream),n(P,u.default),h.push([P,T,u.default])))}}else{(w=l.transceivers[c]||l._createTransceiver(p)).mid=y,w.iceGatherer||(w.iceGatherer=l._createIceGatherer(c,g)),_.length&&"new"===w.iceTransport.state&&(!N||g&&0!==c?_.forEach((function(e){a(w.iceTransport,e)})):w.iceTransport.setRemoteCandidates(_)),O=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(O.codecs=O.codecs.filter((function(e){return"rtx"!==e.name}))),R=w.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var F,U=!1;if("sendrecv"===b||"sendonly"===b){if(U=!w.rtpReceiver,T=w.rtpReceiver||new e.RTCRtpReceiver(w.dtlsTransport,p),U)P=T.track,S&&"-"===S.stream||(S?(u[S.stream]||(u[S.stream]=new e.MediaStream,Object.defineProperty(u[S.stream],"id",{get:function(){return S.stream}})),Object.defineProperty(P,"id",{get:function(){return S.track}}),F=u[S.stream]):(u.default||(u.default=new e.MediaStream),F=u.default)),F&&(n(P,F),w.associatedRemoteMediaStreams.push(F)),h.push([P,T,F])}else w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===w.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),w.associatedRemoteMediaStreams=[]);w.localCapabilities=O,w.remoteCapabilities=x,w.rtpReceiver=T,w.rtcpParameters=M,w.sendEncodingParameters=R,w.recvEncodingParameters=k,l._transceive(l.transceivers[c],!1,U)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===s.type?"active":"passive"),l._remoteDescription={type:s.type,sdp:s.sdp},"offer"===s.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(u).forEach((function(t){var n=u[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",i)}))}h.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&d(l,t,i,[n])}))}})),h.forEach((function(e){e[2]||d(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"!==this.signalingState||!0===this.needNegotiation||(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var r=n.transceivers.filter((function(e){return"audio"===e.kind})).length,o=n.transceivers.filter((function(e){return"video"===e.kind})).length,a=arguments[0];if(a){if(a.mandatory||a.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==a.offerToReceiveAudio&&(r=!0===a.offerToReceiveAudio?1:!1===a.offerToReceiveAudio?0:a.offerToReceiveAudio),void 0!==a.offerToReceiveVideo&&(o=!0===a.offerToReceiveVideo?1:!1===a.offerToReceiveVideo?0:a.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--r<0&&(e.wantReceive=!1):"video"===e.kind&&(--o<0&&(e.wantReceive=!1))}));r>0||o>0;)r>0&&(n._createTransceiver("audio"),r--),o>0&&(n._createTransceiver("video"),o--);var d=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(s,r){var o=s.track,a=s.kind,c=s.mid||i.generateIdentifier();s.mid=c,s.iceGatherer||(s.iceGatherer=n._createIceGatherer(r,n.usingBundle));var d=e.RTCRtpSender.getCapabilities(a);t<15019&&(d.codecs=d.codecs.filter((function(e){return"rtx"!==e.name}))),d.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),s.remoteCapabilities&&s.remoteCapabilities.codecs&&s.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),d.headerExtensions.forEach((function(e){(s.remoteCapabilities&&s.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=s.sendEncodingParameters||[{ssrc:1001*(2*r+1)}];o&&t>=15019&&"video"===a&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),s.wantReceive&&(s.rtpReceiver=new e.RTCRtpReceiver(s.dtlsTransport,a)),s.localCapabilities=d,s.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(d+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){d+=s(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),d+="a=rtcp-rsize\r\n",e.iceGatherer&&"new"!==n.iceGatheringState&&(0===t||!n.usingBundle)&&(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+i.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var o=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(o+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),o+="a=ice-options:trickle\r\n";var a=i.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,i){if(!(i+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?o+="m=application 0 DTLS/SCTP 5000\r\n":o+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?o+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(o+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(o+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;if(e.stream)"audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var d=r(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,o+=s(e,d,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(o+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:o});return Promise.resolve(d)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(s,r){if(!n._remoteDescription)return r(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===e.sdpMid){o=d;break}var l=n.transceivers[o];if(!l)return r(c("OperationError","Can not add ICE candidate"));if(l.rejected)return s();var u=Object.keys(e.candidate).length>0?i.parseCandidate(e.candidate):{};if("tcp"===u.protocol&&(0===u.port||9===u.port)||u.component&&1!==u.component)return s();if((0===o||o>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!a(l.iceTransport,u))return r(c("OperationError","Can not add ICE candidate"));var h=e.candidate.trim();0===h.indexOf("a=")&&(h=h.substr(2)),(t=i.getMediaSections(n._remoteDescription.sdp))[o]+="a="+(u.type?h:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=i.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);s()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])})),t}))}}}));var u=["createOffer","createAnswer"];return u.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(u=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},985:
/*!*********************************!*\
          !*** ./node_modules/sdp/sdp.js ***!
          \*********************************/e=>{var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),s=0;s<i.length;s++)n[(t=i[s].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],s=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substr(12),password:s.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" "),s=3;s<i.length;s++){var r=i[s],o=t.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(o){var a=t.parseRtpMap(o),c=t.matchPrefix(e,"a=fmtp:"+r+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(t.parseRtcpFb),n.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" UDP/TLS/RTP/SAVPF ",i+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));var s=0;return n.codecs.forEach((function(e){e.maxptime>s&&(s=e.maxptime)})),s>0&&(i+="a=maxptime:"+s+"\r\n"),i+="a=rtcp-mux\r\n",n.headerExtensions&&n.headerExtensions.forEach((function(e){i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){var n,i=[],s=t.parseRtpParameters(e),r=-1!==s.fecMechanisms.indexOf("RED"),o=-1!==s.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,d=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(n=d[0][1]),s.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),i.push(t),r&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},i.push(t))}})),0===i.length&&c&&i.push({ssrc:c});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,i.forEach((function(e){e.maxBitrate=l}))),i},t.parseRtcpParameters=function(e){var n={},i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);var s=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=s.length>0,n.compound=0===s.length;var r=t.matchPrefix(e,"a=rtcp-mux");return n.mux=r.length>0,n},t.parseMsid=function(e){var n,i=t.matchPrefix(e,"a=msid:");if(1===i.length)return{stream:(n=i[0].substr(7).split(" "))[0],track:n[1]};var s=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return s.length>0?{stream:(n=s[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,i=t.parseMLine(e),s=t.matchPrefix(e,"a=max-message-size:");s.length>0&&(n=parseInt(s[0].substr(19),10)),isNaN(n)&&(n=65536);var r=t.matchPrefix(e,"a=sctp-port:");if(r.length>0)return{port:parseInt(r[0].substr(12),10),protocol:i.fmt,maxMessageSize:n};if(t.matchPrefix(e,"a=sctpmap:").length>0){var o=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(o[0],10),protocol:o[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,i){var s=void 0!==n?n:2;return"v=0\r\no="+(i||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+s+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,i,s){var r=t.writeRtpDescription(e.kind,n);if(r+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),r+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===i?"actpass":"active"),r+="a=mid:"+e.mid+"\r\n",e.direction?r+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?r+="a=sendrecv\r\n":e.rtpSender?r+="a=sendonly\r\n":e.rtpReceiver?r+="a=recvonly\r\n":r+="a=inactive\r\n",e.rtpSender){var o="msid:"+s.id+" "+e.rtpSender.track.id+"\r\n";r+="a="+o,r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o,e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o,r+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),r},t.getDirection=function(e,n){for(var i=t.splitLines(e),s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),i=0;i<n.length;i++)if(n[i].length<2||"="!==n[i].charAt(1))return!1;return!0},e.exports=t},771:
/*!************************************!*\
          !*** external "@gamestream/utils" ***!
          \************************************/e=>{e.exports=O0()},754:
/*!*************************************!*\
          !*** external "@opentelemetry/api" ***!
          \*************************************/e=>{e.exports=Jm}},n={};function i(e){var s=n[e];if(void 0!==s)return s.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{
/*!*******************************!*\
        !*** ./index.js + 16 modules ***!
        \*******************************/
i.r(s),i.d(s,{AdAction:()=>lt,AdState:()=>dt,AddPlatformTelemetry:()=>Ee,AppLaunchMode:()=>st,AppLevelProtocol:()=>ct,AudioFormat:()=>Ct,AuthType:()=>Le,BitDepth:()=>Ve,BrowserFeature:()=>jt,BrowserName:()=>qe,CHANGELIST:()=>we,CLIENT_IDENTIFICATION:()=>Et,CLIENT_VERSION:()=>wt,CalculateDataUsage:()=>De,CalculateMaxBitrateKbps:()=>Pe,ChooseStreamingResolution:()=>fe,ChooseStreamingSettings:()=>pe,ClientHeaderBrowserType:()=>je,ClientHeaderDeviceType:()=>Ge,ClientHeaderOSType:()=>Ue,ClientStreamer:()=>Tt,ClientType:()=>tt,ConfigureGridServerSettings:()=>bt,ConfigureRagnarokSettings:()=>ye,CursorType:()=>nn,DeviceModel:()=>Re,DeviceOS:()=>Ce,DeviceType:()=>Te,DeviceVendor:()=>ke,DynamicStreamingMode:()=>Xt,EVENTS:()=>$e,GS_EVENTS:()=>Rt,GetDeviceCapabilities:()=>me,GetSupportedAudioChannelCount:()=>ge,GridApp:()=>he,GridServer:()=>kt,GridServerSettings:()=>At,GsErrorCode:()=>mt,HidType:()=>$t,HotkeyModifier:()=>Je,InitializeUtils:()=>ve,InputType:()=>Jt,IsFeatureSupported:()=>Oe,LogImpl:()=>xe,LogLevel:()=>yt,MediaTrackKind:()=>Zt,MicState:()=>Yt,NetworkType:()=>He,PassThruServer:()=>Ot,PayloadBrowserType:()=>_e,PayloadDeviceType:()=>Fe,PayloadOSType:()=>Ne,PlatformName:()=>We,Protocol:()=>at,RErrorCode:()=>Pt,RNotificationCode:()=>et,SESSIONMODIFY_ACTION:()=>It,STREAMING_STATE:()=>Ze,ScErrorCode:()=>vt,SdrHdrMode:()=>Be,SessionProgressState:()=>it,SessionState:()=>nt,StreamStopReason:()=>en,StreamWarningType:()=>tn,StreamingProfilePreset:()=>Ye,StreamingState:()=>sn,TrackType:()=>Xe,Usage:()=>ot,VideoCodecType:()=>Qt,VirtualButton:()=>be,VirtualGamepadHandler:()=>Se,VsyncType:()=>Dt,configureSessionControlSettings:()=>gt,configureStreamKitSettings:()=>zt,createNskStreamClient:()=>qt,createSessionControl:()=>rt,decodeWsErrorCodes:()=>Ft,defaultInputConfigFlags:()=>Qe,estimateDataUsage:()=>Wt,getDeviceCapabilities:()=>Lt,getNetworkTypeDetector:()=>Kt,getPlatformDetails:()=>St,getRecommendedBitrate:()=>Vt,getResumableSession:()=>pt,getStreamStartParameters:()=>Ht,getStreamerType:()=>Ut,getSupportedCodecs:()=>Ae,isCancelCode:()=>ft,isFeatureSupported:()=>Gt,isResumableSessionState:()=>ht,performHttpRequest:()=>Me,prefetchDeviceCapabilities:()=>Mt,registerDeviceCapabilitiesChanged:()=>Nt,registerLogCallback:()=>Ie,serializeDeviceCapabilities:()=>xt,shouldDefaultEnableMic:()=>Bt,translatePlatformDetailsForClientHeader:()=>Ke,translatePlatformDetailsForPayload:()=>ze,unregisterDeviceCapabilitiesChanged:()=>_t,updateSessionParameters:()=>ut});var e={};i.r(e),i.d(e,{fixNegotiationNeeded:()=>D,shimAddTrackRemoveTrack:()=>O,shimAddTrackRemoveTrackWithNative:()=>k,shimGetDisplayMedia:()=>w,shimGetSendersWithDtmf:()=>C,shimGetStats:()=>T,shimGetUserMedia:()=>y,shimMediaStream:()=>E,shimOnTrack:()=>I,shimPeerConnection:()=>P,shimSenderReceiverGetStats:()=>R});var t={};i.r(t),i.d(t,{shimGetDisplayMedia:()=>N,shimGetUserMedia:()=>M,shimPeerConnection:()=>_,shimReplaceTrack:()=>F});var n={};i.r(n),i.d(n,{shimAddTransceiver:()=>z,shimCreateAnswer:()=>J,shimCreateOffer:()=>$,shimGetDisplayMedia:()=>j,shimGetParameters:()=>K,shimGetUserMedia:()=>U,shimOnTrack:()=>G,shimPeerConnection:()=>B,shimRTCDataChannel:()=>q,shimReceiverGetStats:()=>H,shimRemoveStream:()=>W,shimSenderGetStats:()=>V});var r={};i.r(r),i.d(r,{shimAudioContext:()=>se,shimCallbacksAPI:()=>X,shimConstraints:()=>ee,shimCreateOfferLegacy:()=>ie,shimGetUserMedia:()=>Z,shimLocalStreamsAPI:()=>Q,shimRTCIceServerUrls:()=>te,shimRemoteStreamsAPI:()=>Y,shimTrackEventTransceiver:()=>ne});var o={};i.r(o),i.d(o,{removeAllowExtmapMixed:()=>ue,shimConnectionState:()=>le,shimMaxMessageSize:()=>ce,shimRTCIceCandidate:()=>ae,shimSendThrowTypeError:()=>de});let a=!0,c=!0;function d(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function l(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,s=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return s.apply(this,arguments);const r=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,r),s.apply(this,[e,r])};const r=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return r.apply(this,arguments);if(!this._eventMap[t].has(n))return r.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,r.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function u(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(a=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function h(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(c=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function p(){if("object"==typeof window){if(a)return;typeof console<"u"&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function f(e,t){c&&console.warn(e+" is deprecated, please use "+t+" instead.")}function v(e){const{navigator:t}=e,n={browser:null,version:null};if(typeof e>"u"||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=d(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=d(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=d(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=d(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n}function g(e){return"[object Object]"===Object.prototype.toString.call(e)}function m(e){return g(e)?Object.keys(e).reduce((function(t,n){const i=g(e[n]),s=i?m(e[n]):e[n],r=i&&!Object.keys(s).length;return void 0===s||r?t:Object.assign(t,{[n]:s})}),{}):e}function A(e,t,n){!t||n.has(t.id)||(n.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?A(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((t=>{A(e,e.get(t),n)}))})))}function b(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",s=new Map;if(null===t)return s;const r=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&r.push(e)})),r.forEach((t=>{e.forEach((n=>{n.type===i&&n.trackId===t.id&&A(e,n,s)}))})),s}const S=p;function y(e){const t=e&&e.navigator;if(!t.mediaDevices)return;const n=v(e),i=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const s=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"==typeof i.ideal?(e[s("min",n)]=i.ideal,t.optional.push(e),e={},e[s("max",n)]=i.ideal,t.optional.push(e)):(e[s("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[s("",n)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[s(e,n)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,s){if(n.version>=61)return s(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let r=e.video.facingMode;r=r&&("object"==typeof r?r:{ideal:r});const o=n.version<66;if(r&&("user"===r.exact||"environment"===r.exact||"user"===r.ideal||"environment"===r.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||o)){let n;if(delete e.video.facingMode,"environment"===r.exact||"environment"===r.ideal?n=["back","rear"]:("user"===r.exact||"user"===r.ideal)&&(n=["front"]),n)return t.mediaDevices.enumerateDevices().then((t=>{let o=(t=t.filter((e=>"videoinput"===e.kind))).find((e=>n.some((t=>e.label.toLowerCase().includes(t)))));return!o&&t.length&&n.includes("back")&&(o=t[t.length-1]),o&&(e.video.deviceId=r.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=i(e.video),S("chrome: "+JSON.stringify(e)),s(e)}))}e.video=i(e.video)}return S("chrome: "+JSON.stringify(e)),s(e)},r=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,i){s(e,(e=>{t.webkitGetUserMedia(e,n,(e=>{i&&i(r(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){const e=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(t){return s(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(r(e))))))}}}function w(e,t){if((!e.navigator.mediaDevices||!("getDisplayMedia"in e.navigator.mediaDevices))&&e.navigator.mediaDevices){if("function"!=typeof t)return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const i=n.video&&n.video.width,s=n.video&&n.video.height,r=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:r||3}},i&&(n.video.mandatory.maxWidth=i),s&&(n.video.mandatory.maxHeight=s),e.navigator.mediaDevices.getUserMedia(n)}))}}}function E(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function I(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const s=new Event("track");s.track=n.track,s.receiver=i,s.transceiver={receiver:i},s.streams=[t.stream],this.dispatchEvent(s)})),t.stream.getTracks().forEach((n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const s=new Event("track");s.track=n,s.receiver=i,s.transceiver={receiver:i},s.streams=[t.stream],this.dispatchEvent(s)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else l(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function C(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let s=n.apply(this,arguments);return s||(s=t(this,e),this._senders.push(s)),s};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function T(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,i]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const s=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},r=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const i=function(e){n(r(s(e)))};return t.apply(this,[i,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(r(s(t)))},n])})).then(n,i)}}function R(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>b(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),l(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>b(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach((n=>{n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?i=!0:n=t),t.track===e))),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function k(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),s.apply(this,arguments)}}function O(e){if(!e.RTCPeerConnection)return;const t=v(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return k(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const s=e.RTCPeerConnection.prototype.removeStream;function r(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(s.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const s=this._streams[n.id];if(s)s.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=r(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>r(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),s.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:r(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function P(e){const t=v(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),!e.RTCPeerConnection)return;const n=0===e.RTCPeerConnection.prototype.addIceCandidate.length;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const i=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return n||arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}function D(e){const t=v(e);l(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var L=i(134),x=i.n(L);function M(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e))))}}function N(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function _(e){const t=v(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=x()(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((e=>{if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&f("RTCIceServer.url","RTCIceServer.urls");const i="string"==typeof t;return i&&(t=[t]),t=t.filter((e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))}(e.iceServers,t.version),p("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function F(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function U(e){const t=v(e),n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){f("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function j(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function G(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function B(e){const t=v(e);if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]})),t.version<68){const t=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,s,r]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!s)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(s,r)}}function V(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function H(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),l(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function W(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){f("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function q(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function z(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();"encodings"in n||(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function K(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"sendEncodings"in this?Object.assign({},{encodings:this.sendEncodings},e):e})}function $(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function J(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function Q(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function Y(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function X(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,s=t.setLocalDescription,r=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],s=n.apply(this,[i]);return t?(s.then(e,t),Promise.resolve()):s},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],s=i.apply(this,[n]);return t?(s.then(e,t),Promise.resolve()):s};let a=function(e,t,n){const i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=a}function Z(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(ee(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function ee(e){return e&&void 0!==e.video?Object.assign({},e,{video:m(e.video)}):e}function te(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(f("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function ne(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ie(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){typeof e.offerToReceiveAudio<"u"&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0===e.offerToReceiveAudio&&!t&&this.addTransceiver("audio"),typeof e.offerToReceiveVideo<"u"&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0===e.offerToReceiveVideo&&!n&&this.addTransceiver("video")}return t.apply(this,arguments)}}function se(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var re=i(985),oe=i.n(re);function ae(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),i=oe().parseCandidate(e.candidate),s=Object.assign(n,i);return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,l(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function ce(e){if(!e.RTCPeerConnection)return;const t=v(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=oe().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=oe().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const s=oe().matchPrefix(e.sdp,"a=max-message-size:");return s.length>0?i=parseInt(s[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let s;s=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const r={};Object.defineProperty(r,"maxMessageSize",{get:()=>s}),this._sctp=r}return n.apply(this,arguments)}}function de(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],s=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&s>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},l(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function le(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function ue(e){if(!e.RTCPeerConnection)return;const t=v(e);if("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n")),n.apply(this,arguments)}}(function({window:i}={},s={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const a=p,c=v(i),l={browserDetails:c,commonShim:o,extractVersion:d,disableLog:u,disableWarnings:h};switch(c.browser){case"chrome":if(!e||!P||!s.shimChrome)return a("Chrome shim is not included in this adapter release."),l;if(null===c.version)return a("Chrome shim can not determine version, not shimming."),l;a("adapter.js shimming chrome."),l.browserShim=e,y(i),E(i),P(i),I(i),O(i),C(i),T(i),R(i),D(i),ae(i),le(i),ce(i),de(i),ue(i);break;case"firefox":if(!n||!B||!s.shimFirefox)return a("Firefox shim is not included in this adapter release."),l;a("adapter.js shimming firefox."),l.browserShim=n,U(i),B(i),G(i),W(i),V(i),H(i),q(i),z(i),K(i),$(i),J(i),ae(i),le(i),ce(i),de(i);break;case"edge":if(!t||!_||!s.shimEdge)return a("MS edge shim is not included in this adapter release."),l;a("adapter.js shimming edge."),l.browserShim=t,M(i),N(i),_(i),F(i),ce(i),de(i);break;case"safari":if(!r||!s.shimSafari)return a("Safari shim is not included in this adapter release."),l;a("adapter.js shimming safari."),l.browserShim=r,te(i),ie(i),X(i),Q(i),Y(i),ne(i),Z(i),se(i),ae(i),ce(i),de(i),ue(i);break;default:a("Unsupported browser!")}})({window:window}),i(853);var he=Ragnarok.GridApp,pe=Ragnarok.ChooseStreamingSettings,fe=Ragnarok.ChooseStreamingResolution,ve=Ragnarok.InitializeUtils,ge=Ragnarok.GetSupportedAudioChannelCount,me=Ragnarok.GetDeviceCapabilities,Ae=Ragnarok.getSupportedCodecs,be=Ragnarok.VirtualButton,Se=Ragnarok.VirtualGamepadHandler,ye=Ragnarok.ConfigureRagnarokSettings,we=Ragnarok.CHANGELIST,Ee=Ragnarok.AddPlatformTelemetry,Ie=Ragnarok.registerLogCallback,Ce=Ragnarok.DeviceOS,Te=Ragnarok.DeviceType,Re=Ragnarok.DeviceModel,ke=Ragnarok.DeviceVendor,Oe=Ragnarok.IsFeatureSupported,Pe=Ragnarok.CalculateMaxBitrateKbps,De=Ragnarok.CalculateDataUsage,Le=Ragnarok.AuthType,xe=Ragnarok.LogImpl,Me=Ragnarok.performHttpRequest,Ne=Ragnarok.PayloadOSType,_e=Ragnarok.PayloadBrowserType,Fe=Ragnarok.PayloadDeviceType,Ue=Ragnarok.ClientHeaderOSType,je=Ragnarok.ClientHeaderBrowserType,Ge=Ragnarok.ClientHeaderDeviceType,Be=Ragnarok.SdrHdrMode,Ve=Ragnarok.BitDepth,He=Ragnarok.NetworkType,We=Ragnarok.PlatformName,qe=Ragnarok.BrowserName,ze=Ragnarok.translatePlatformDetailsForPayload,Ke=Ragnarok.translatePlatformDetailsForClientHeader,$e=Ragnarok.EVENTS,Je=Ragnarok.HotkeyModifier,Qe=Ragnarok.defaultInputConfigFlags,Ye=Ragnarok.StreamingProfilePreset,Xe=Ragnarok.TrackType,Ze=Ragnarok.STREAMING_STATE,et=Ragnarok.RNotificationCode,tt=Ragnarok.ClientType,nt=Ragnarok.SessionState,it=Ragnarok.SessionProgressState,st=Ragnarok.AppLaunchMode,rt=Ragnarok.createSessionControl,ot=Ragnarok.Usage,at=Ragnarok.Protocol,ct=Ragnarok.AppLevelProtocol,dt=Ragnarok.AdState,lt=Ragnarok.AdAction,ut=Ragnarok.updateSessionParameters,ht=Ragnarok.isResumableSessionState,pt=Ragnarok.getResumableSession,ft=Ragnarok.isCancelCode,vt=Ragnarok.ScErrorCode,gt=Ragnarok.configureSessionControlSettings,mt=Ragnarok.GsErrorCode,At=Ragnarok.GridServerSettings,bt=Ragnarok.ConfigureGridServerSettings,St=Ragnarok.getPlatformDetails,yt=Ragnarok.LogLevel,wt=Ragnarok.CLIENT_VERSION,Et=Ragnarok.CLIENT_IDENTIFICATION,It=Ragnarok.SESSIONMODIFY_ACTION,Ct=Ragnarok.AudioFormat,Tt=Ragnarok.ClientStreamer,Rt=Ragnarok.GS_EVENTS,kt=Ragnarok.GridServer,Ot=Ragnarok.PassThruServer,Pt=Ragnarok.RErrorCode,Dt=Ragnarok.VsyncType,Lt=Ragnarok.getDeviceCapabilities,xt=Ragnarok.serializeDeviceCapabilities,Mt=Ragnarok.prefetchDeviceCapabilities,Nt=Ragnarok.registerDeviceCapabilitiesChanged,_t=Ragnarok.unregisterDeviceCapabilitiesChanged,Ft=Ragnarok.decodeWsErrorCodes,Ut=Ragnarok.getStreamerType,jt=Ragnarok.BrowserFeature,Gt=Ragnarok.isFeatureSupported,Bt=Ragnarok.shouldDefaultEnableMic,Vt=Ragnarok.getRecommendedBitrate,Ht=Ragnarok.getStreamStartParameters,Wt=Ragnarok.estimateDataUsage,qt=Ragnarok.createNskStreamClient,zt=Ragnarok.configureStreamKitSettings,Kt=Ragnarok.getNetworkTypeDetector,$t=Ragnarok.HidType,Jt=Ragnarok.InputType,Qt=Ragnarok.VideoCodecType,Yt=Ragnarok.MicState,Xt=Ragnarok.DynamicStreamingMode,Zt=Ragnarok.MediaTrackKind,en=Ragnarok.StreamStopReason,tn=Ragnarok.StreamWarningType,nn=Ragnarok.CursorType,sn=Ragnarok.StreamingState})(),e.exports=s})()}(Af);var O=Af.exports;class jn{static browser(){return this._clientDetails.browser||"Unknown"}static browserVersion(){return this._clientDetails.browserFullVer}static os(){return this._clientDetails.os||"Unknown"}static osVersion(){return this._clientDetails.osVersion}static platformType(){var e;return null==(e=this._clientDetails.platformType)?void 0:e.toLowerCase()}static async platformDetails(){if(!this._clientDetails){const e=await O.getPlatformDetails();this._clientDetails=e,Object.freeze(this._clientDetails)}return this._clientDetails}}function Qm(e){return e>>>0}function Ym(e){return"0x"+("00000000"+(e=Qm(e)).toString(16).toUpperCase()).slice(-8)}function Xm(e){const t=e.split(".");if(4!==t.length)return!1;for(const e of t){const t=parseInt(e);if(isNaN(t))return!1}return!0}function hf(e){const t=e.split(".");if(4!==t.length)return!1;for(const e of t){const t=parseInt(e);if(isNaN(t)||t<0||t>255)return!1}return!0}function Zm(e){return e.os===Vt.IPADOS}function eA(e){return e.os===Vt.IOS}function tA(e){return eA(e)||Zm(e)}function iA(e){if(e){const t=Number.parseInt(e);if(!Number.isNaN(t))return t}}function nA(e){let t=(new TextEncoder).encode(e),n=new ArrayBuffer(t.byteLength),i=new DataView(n);for(let e=0;e<t.byteLength;e++)i.setUint8(e,t[e]);return n}Re(jn,"_clientDetails");class ff{static map(e){switch(e){case O.RErrorCode.AuthProviderError:return"Error happened during request to auth provider.";case O.RErrorCode.NoNetwork:return"No internet connection.";case O.RErrorCode.NetworkError:return"A network error occurred.";case O.RErrorCode.GetActiveSessionServerError:return"Error occurred due to GetActiveSessionServerError.";case O.RErrorCode.ExceptionHappened:return"Unexpected exception happened.";case O.RErrorCode.AuthTokenNotUpdated:return"Error occurred due to AuthTokenNotUpdated.";case O.RErrorCode.SessionFinishedState:return"Unexpected session state while polling.";case O.RErrorCode.ResponseParseFailure:return"Failed to parse server response.";case O.RErrorCode.StreamerVideoPlayError:return"Video play failure.";case O.RErrorCode.GridAppNotInitialized:return"Grid app instance was not initialized.";case O.RErrorCode.SessionLimitExceeded:return"Session Limit Exceeded.";case O.RErrorCode.StreamErrorGeneric:return"Some generic error happened in streamer.";case O.RErrorCode.StreamerSignInFailure:return"Error occurred during sign-in request to signaling server.";case O.RErrorCode.StreamerHangingGetFailure:return"Error occurred in hanging get request of peer connection.";case O.RErrorCode.StreamerIceConnectionFailed:return"Could not find valid ice candidate pair.";case O.RErrorCode.StreamerGetRemotePeerTimedOut:return"Streaming stopped due to no remote peer.";case O.RErrorCode.StreamInputChannelError:return"Streaming stopped due to input channel error.";case O.RErrorCode.StreamCursorChannelError:return"Streaming stopped due to cursor channel error.";case O.RErrorCode.StreamControlChannelError:return"Streaming stopped due to control channel error.";case O.RErrorCode.StreamerIceReConnectionFailed:return"Reconnect attempt failed after network problem, or remote peer not alive.";case O.RErrorCode.StreamerNoVideoPacketsReceivedEver:return"Streaming stopped as NoVideoPacketsReceivedEver.";case O.RErrorCode.StreamerNoVideoFramesLossyNetwork:return"Streaming stopped as NoVideoFramesLossyNetwork.";case O.RErrorCode.StreamDisconnectedFromServer:return"Stream disconnected from server, unknown reason.";case O.RErrorCode.ServerDisconnectedNoResponse:return"Stream disconnected from server, NoResponse.";case O.RErrorCode.ServerDisconnectedRemoteInputError:return"Stream disconnected from server, RemoteInputError.";case O.RErrorCode.ServerDisconnectedFrameGrabFailed:return"Stream disconnected from server, FrameGrabFailed.";case O.RErrorCode.ServerDisconnectedConfigUnAvailable:return"Stream disconnected from server, ConfigUnAvailable.";case O.RErrorCode.ServerDisconnectedInvalidCommand:return"Stream disconnected from server, InvalidCommand.";case O.RErrorCode.ServerDisconnectedInvalidMouseState:return"Stream disconnected from server, InvalidMouseState.";case O.RErrorCode.ServerDisconnectedNetworkError:return"Stream disconnected from server, NetworkError.";case O.RErrorCode.ServerDisconnectedGameLaunchFailed:return"Stream disconnected from server, GameLaunchFailed.";case O.RErrorCode.ServerDisconnectedVideoFirstFrameSendFailed:return"Stream disconnected from server, VideoFirstFrameSendFailed.";case O.RErrorCode.ServerDisconnectedVideoNextFrameSendFailed:return"Stream disconnected from server, VideoNextFrameSendFailed.";case O.RErrorCode.ServerDisconnectedFrameGrabTimedOut:return"Stream disconnected from server, FrameGrabTimedOut.";case O.RErrorCode.ServerDisconnectedFrameEncodeTimedOut:return"Stream disconnected from server, FrameEncodeTimedOut.";case O.RErrorCode.ServerDisconnectedFrameSendTimedOut:return"Stream disconnected from server, FrameSendTimedOut.";case O.RErrorCode.ServerDisconnectedIntended:return"Stream disconnected from server as user quit the game.";case O.RErrorCode.ServerDisconnectedUserLoggedInDifferentAccount:return"Stream disconnected from server, userLoggedInDifferentAccount.";case O.RErrorCode.ServerDisconnectedWindowedMode:return"Stream disconnected from server, WindowedMode.";case O.RErrorCode.ServerDisconnectedUserIdle:return"Stream disconnected from server, UserIdle.";case O.RErrorCode.ServerDisconnectedUnAuthorizedProcessDetected:return"Stream disconnected from server, UnAuthorizedProcessDetected.";case O.RErrorCode.ServerDisconnectedMaliciousProcessDetected:return"Stream disconnected from server, MaliciousProcessDetected.";case O.RErrorCode.ServerDisconnectedUnKnownProcessDetected:return"Stream disconnected from server, UnKnownProcessDetected.";case O.RErrorCode.ServerDisconnectedMinerProcessDetected:return"Stream disconnected from server, MinerProcessDetected.";case O.RErrorCode.ServerDisconnectedStreamingUnsupported:return"Stream disconnected from server, StreamingUnsupported.";case O.RErrorCode.ServerDisconnectedAnotherClient:return"Stream disconnected from server, AnotherClient.";case O.RErrorCode.ServerDisconnectedUnknownFromPm:return"Stream disconnected from server, UnknownFromPm.";case O.RErrorCode.ServerDisconnectedUserEntitledMinutesExceeded:return"Stream disconnected from server, UserEntitledMinutesExceeded.";case O.RErrorCode.ServerDisconnectedClientReconnectTimeLimitExceeded:return"Stream disconnected from server, ClientReconnectTimeLimitExceeded.";case O.RErrorCode.ServerDisconnectedOperatorCommandedTermination:return"Stream disconnected from server, OperatorCommandedTermination.";case O.RErrorCode.ServerDisconnectedConcurrentSessionLimitExceeded:return"Stream disconnected from server, ConcurrentSessionLimitExceeded.";case O.RErrorCode.ServerDisconnectedMaxSessionTimeLimitExceeded:return"Stream disconnected from server, MaxSessionTimeLimitExceeded.";case O.RErrorCode.ServerDisconnectedBifrostInitiatedSessionPause:return"Stream disconnected from server, BifrostInitiatedSessionPause.";case O.RErrorCode.ServerDisconnectedSystemCommandTermination:return"Stream disconnected from server, SystemCommandTermination.";case O.RErrorCode.ServerDisconnectedMultipleLogin:return"Stream disconnected from server, MultipleLogin.";case O.RErrorCode.ServerInternalError:return"Session setup failed on server.";case O.RErrorCode.RequestLimitExceeded:return"You have tried to play too many games in a short period of time. Please wait a few minutes and try again.";case O.RErrorCode.EntitlementFailure:return"You are not entitled to play this game. Please check you entitlement.";case O.RErrorCode.AppPatching:return"Game is currently in patching state, please try again later.";case O.RErrorCode.GameNotFound:return"Requested game is not available in the zone. Please try another zone.";case O.RErrorCode.AppMaintenanceStatus:return"Requested game is under maintenance.";case O.RErrorCode.RequiredSeatInstanceTypeNotSupported:return"Required instance type for the game is not available in current zone. Please try different zone.";case O.RErrorCode.ServerSessionQueueLengthExceeded:return"We have reached our limit for the number of gamers who can wait for the next available rig. Please try again later.";case O.RErrorCode.SessionTerminatedByAnotherClient:return"Session setup request was terminated by another client.";case O.RErrorCode.ServerDisconnectedGameNotOwnedByUser:return"Your session ended as you do not own the requested game.";case O.RErrorCode.SystemSleepDuringStreaming:return"Your session ended as device went to sleep during streaming.";case O.RErrorCode.SessionInQueueAbandoned:return"Session abandoned during polling.";case O.RErrorCode.NoInternetDuringSessionSetup:case O.RErrorCode.NoInternetDuringStreaming:return"Cannot connect to server.";case O.RErrorCode.SessionLimitPerDeviceReached:return"There is an active session for this device belonging to another user. Please try again after sometime";case O.RErrorCode.SessionSetupCancelled:case O.RErrorCode.SessionSetupCancelledDuringQueuing:return"Session setup was cancelled, please reconfigure your session.";case O.RErrorCode.StreamerSignInTimeout:return"Sign in request timed out.";case O.RErrorCode.StreamerSignInWorkerFailure:return"Sign in request failed due to worker failure.";case O.RErrorCode.InvalidOperation:return"The operation is invalid.";case O.RErrorCode.InvalidServerResponse:return"The server response is invalid.";case O.RErrorCode.PutOrPostInProgress:return"A PUT or POST operation is already in progress.";case O.RErrorCode.GridServerNotInitialized:return"The grid server is not initialized.";case O.RErrorCode.DOMExceptionInGridServer:return"A DOM exception occurred in the grid server.";case O.RErrorCode.InvalidAdStateTransition:return"Invalid advertisement state transition.";case O.RErrorCode.RequestForbidden:return"The request is forbidden.";case O.RErrorCode.ServerInternalTimeout:return"The server encountered an internal timeout.";case O.RErrorCode.ServerInvalidRequest:return"The server received an invalid request.";case O.RErrorCode.ServerInvalidRequestVersion:return"The request version is invalid.";case O.RErrorCode.SessionListLimitExceeded:return"The session list limit has been exceeded.";case O.RErrorCode.InvalidRequestDataMalformed:return"The request data is malformed.";case O.RErrorCode.InvalidRequestDataMissing:return"The request data is missing.";case O.RErrorCode.InvalidRequestVersionOutOfDate:return"The request version is out of date.";case O.RErrorCode.SessionEntitledTimeExceeded:return"The entitled session time has been exceeded.";case O.RErrorCode.AuthFailure:return"Authentication failed.";case O.RErrorCode.InvalidAuthenticationMalformed:return"The authentication token is malformed.";case O.RErrorCode.InvalidAuthenticationExpired:return"The authentication token has expired.";case O.RErrorCode.InvalidAuthenticationNotFound:return"The authentication token was not found.";case O.RErrorCode.EulaUnAccepted:return"The EULA has not been accepted.";case O.RErrorCode.MaintenanceStatus:return"The system is under maintenance.";case O.RErrorCode.ServiceUnAvailable:return"The service is unavailable.";case O.RErrorCode.SteamGuardRequired:return"Steam Guard is required.";case O.RErrorCode.SteamLoginRequired:return"Steam login is required.";case O.RErrorCode.SteamGuardInvalid:return"The Steam Guard token is invalid.";case O.RErrorCode.SteamProfilePrivate:return"The Steam profile is private.";case O.RErrorCode.InvalidCountryCode:return"The country code is invalid.";case O.RErrorCode.InvalidLanguageCode:return"The language code is invalid.";case O.RErrorCode.MissingCountryCode:return"The country code is missing.";case O.RErrorCode.MissingLanguageCode:return"The language code is missing.";case O.RErrorCode.SessionNotPaused:return"The session is not paused.";case O.RErrorCode.EmailNotVerified:return"The email address is not verified.";case O.RErrorCode.InvalidAuthenticationUnsupportedProtocol:return"The authentication protocol is unsupported.";case O.RErrorCode.InvalidAuthenticationUnknownToken:return"The authentication token is unknown.";case O.RErrorCode.InvalidAuthenticationCredentials:return"The authentication credentials are invalid.";case O.RErrorCode.SessionNotPlaying:return"The session is not in a playing state.";case O.RErrorCode.InvalidServiceResponse:return"The service response is invalid.";case O.RErrorCode.NotEnoughCredits:return"There are not enough credits.";case O.RErrorCode.InvitationOnlyRegistration:return"Registration is by invitation only.";case O.RErrorCode.RegionNotSupportedForRegistration:return"The region is not supported for registration.";case O.RErrorCode.DeviceIdAlreadyUsed:return"The device ID is already in use.";case O.RErrorCode.ServiceNotExist:return"The requested service does not exist.";case O.RErrorCode.SessionExpired:return"The session has expired.";case O.RErrorCode.ForwardingZoneOutOfCapacity:return"The forwarding zone is out of capacity.";case O.RErrorCode.RegionNotSupportedIndefinitely:return"The region is not supported indefinitely.";case O.RErrorCode.RegionBanned:return"The region is banned.";case O.RErrorCode.RegionOnHoldForFree:return"The region is on hold for free users.";case O.RErrorCode.RegionOnHoldForPaid:return"The region is on hold for paid users.";case O.RErrorCode.ResourcePoolNotConfigured:return"The resource pool is not configured.";case O.RErrorCode.InsufficientVmCapacity:return"There is insufficient VM capacity.";case O.RErrorCode.InsufficientRouteCapacity:return"There is insufficient route capacity.";case O.RErrorCode.InsufficientScratchSpaceCapacity:return"There is insufficient scratch space capacity.";case O.RErrorCode.RegionNotSupportedForStreaming:return"The region is not supported for streaming.";case O.RErrorCode.SessionForwardRequestAllocationTimeExpired:return"The session forward request allocation time has expired.";case O.RErrorCode.SessionForwardGameBinariesNotAvailable:return"The game binaries are not available for session forwarding.";case O.RErrorCode.GameBinariesNotAvailableInRegion:return"The game binaries are not available in the region.";case O.RErrorCode.UekRetrievalFailed:return"UEK retrieval failed.";case O.RErrorCode.EntitlementFailureForResource:return"Entitlement failure for the requested resource.";case O.RErrorCode.SessionRemovedFromQueueMaintenance:return"The session was removed from the queue due to maintenance.";case O.RErrorCode.ZoneMaintenanceStatus:return"The zone is under maintenance.";case O.RErrorCode.GuestModeCampaignDisabled:return"Guest mode campaign is disabled.";case O.RErrorCode.RegionNotSupportedAnonymousAccess:return"The region does not support anonymous access.";case O.RErrorCode.InstanceTypeNotSupportedInSingleRegion:return"The instance type is not supported in the single region.";case O.RErrorCode.InvalidZoneForQueuedSession:return"The zone is invalid for the queued session.";case O.RErrorCode.SessionWaitingAdsTimeExpired:return"The session waiting ads time has expired.";case O.RErrorCode.UserCancelledWatchingAds:return"The user cancelled watching ads.";case O.RErrorCode.StreamingNotAllowedInLimitedMode:return"Streaming is not allowed in limited mode.";case O.RErrorCode.ForwardRequestJPMFailed:return"The forward request to JPM failed.";case O.RErrorCode.MaxSessionNumberLimitExceeded:return"The maximum session number limit has been exceeded.";case O.RErrorCode.GuestModePartnerCapacityDisabled:return"Guest mode partner capacity is disabled.";case O.RErrorCode.SessionRejectedNoCapacity:return"The session was rejected due to no capacity.";case O.RErrorCode.SessionInsufficientPlayabilityLevel:return"The session has insufficient playability level.";case O.RErrorCode.StreamerDataChannelClosing:return"The streamer data channel is closing.";case O.RErrorCode.WebPageClosed:return"The web page was closed.";case O.RErrorCode.ClientDisconnectedUserIdle:return"The client was disconnected due to user inactivity.";case O.RErrorCode.UnhandledException:return"An unhandled exception occurred.";case O.RErrorCode.StreamerNoPeerInfo:return"No peer info found.";default:return""}}static defaultMessage(e){return`No displayable error message found for error code ${Ym(e)}.`}}var ye=(e=>(e.unknown="unknown",e.active="active",e.configure="configure",e.connect="connect",e.get="get",e.newSession="newSession",e.start="start",e.stop="stop",e.stream="stream",e.terminate="terminate",e.update="update",e.message="message",e.authUser="authUser",e.clipboardCopy="clipboardCopy",e.clipboardPaste="clipboardPaste",e))(ye||{}),Se=(e=>(e.unknown="unknown",e.inProgress="inProgress",e.success="success",e.canceled="canceled",e.error="error",e.warning="warning",e.waiting="waiting",e))(Se||{}),Ri=(e=>(e.sessionProgressUpdateEvent="SessionProgressUpdateEvent",e.streamingEvent="StreamingEvent",e.streamUpdateEvent="StreamUpdateEvent",e.startSessionResultEvent="StartSessionResultEvent",e.stopSessionResultEvent="StopSessionResultEvent",e.streamingTerminatedEvent="StreamingTerminatedEvent",e.activeSessionResultEvent="ActiveSessionResultEvent",e.getSessionResult="GetSessionResult",e.logEvent="LogEvent",e))(Ri||{});class nt{static convert(e,t){return"SessionProgressUpdateEvent"===t?nt.fromSessionProgressUpdateEvent(e):"ActiveSessionResultEvent"===t?nt.fromActiveSessionResultEvent(e):"StreamingEvent"===t?nt.fromStreamingEvent(e):"StreamUpdateEvent"===t?nt.fromStreamUpdateEvent(e):"GetSessionResult"===t?nt.fromGetSessionResult(e):"StreamingTerminatedEvent"===t?nt.fromStreamingTerminatedEvent(e):"StartSessionResultEvent"===t?nt.fromStartSessionResultEvent(e):"StopSessionResultEvent"===t?nt.fromStopSessionResultEvent(e):"LogEvent"===t?nt.fromLogEvent(e):{action:"unknown",status:"unknown",info:"An unknown event has occurred."}}static fromSessionProgressUpdateEvent(e){const t=e.state===O.SessionProgressState.STARTING_STREAMER?"start":e.state===O.SessionProgressState.CONFIGURING?"configure":e.state===O.SessionProgressState.CONNECTING?"connect":"unknown";return{action:t,status:"inProgress",info:`${t}ing`,sessionId:e.sessionId,subSessionId:e.subSessionId,queuePosition:e.queuePosition,eta:e.eta}}static fromStartSessionResultEvent(e){return{action:"start",status:null!=e&&e.error?"error":"success",info:null!=e&&e.error?nt.parseErrorMessage(e):"Session started successfully",sessionId:e.sessionId,subSessionId:e.subSessionId}}static fromStopSessionResultEvent(e){return{action:"stop",status:null!=e&&e.error?"error":"success",info:null!=e&&e.error?nt.parseErrorMessage(e):"Session stopped successfully",sessionId:e.sessionId,subSessionId:e.subSessionId}}static fromStreamingEvent(e){return{action:"stream",status:"unknown",info:"streaming"}}static fromStreamUpdateEvent(e){return{action:"update",status:"success",info:"stat-update",stats:{codec:e.codec,fps:e.fps,rtd:e.rtd,avgDecodeTime:e.avgDecodeTime,frameLoss:e.frameLoss,packetLoss:e.packetLoss,totalBandwidth:e.totalBandwidth,currentBitrate:e.currentBitrateMbps,utilizedBandwidth:e.utilizedBandwidth,streamingResolutionHeight:e.streamingResolution.height,streamingResolutionWidth:e.streamingResolution.width}}}static fromStreamingTerminatedEvent(e){return{action:"terminate",status:null!=e&&e.error?"error":"success",info:null!=e&&e.error?nt.parseErrorMessage(e):"terminating",sessionId:e.sessionId,subSessionId:e.subSessionId}}static fromActiveSessionResultEvent(e){return{action:"active",status:"unknown",info:"active"}}static fromGetSessionResult(e){return{action:"get",status:"unknown",info:"streaming",sessionId:e.sessionId,subSessionId:e.subSessionId}}static fromLogEvent(e){return{action:"message",status:"unknown",info:e.logstr,sessionId:e.sessionId,subSessionId:void 0}}static toStreamSDKLog(e){return{type:"error"===e.status?"error":"warning"===e.status?"warning":"info",title:e.status,status:"success"===e.status?200:"error"===e.status?500:100,detail:e.info.toString(),request:e.action,sessionId:e.sessionId||null,requestId:null,timestamp:(new Date).toISOString(),browser:jn.browser(),browserVersion:jn.browserVersion(),os:jn.os(),osVersion:jn.osVersion(),platformType:jn.platformType()}}static parseErrorMessage(e){var t,n,i;return(null==(t=null==e?void 0:e.error)?void 0:t.description)||ff.map(null==(n=null==e?void 0:e.error)?void 0:n.code)||ff.defaultMessage(null==(i=null==e?void 0:e.error)?void 0:i.code)}}var cc=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR",e))(cc||{});const Ct=class e{static setLogLevel(t){e.LOG_LEVEL=cc[t]}static setLogFormat(t){e.LOG_FORMAT=t}static event(t,n){var i;R0(t)&&(t=nt.convert(t,Ri.logEvent));const s=nt.toStreamSDKLog(t),r=cc[null==(i=s.type)?void 0:i.toUpperCase()];if(r>=e.LOG_LEVEL)switch(n&&r>0&&n.log(yr(s,e.LOG_FORMAT)),r){case 0:console.debug(yr(s,e.LOG_FORMAT));break;case 1:console.log(yr(s,e.LOG_FORMAT));break;case 2:console.warn(yr(s,e.LOG_FORMAT));break;case 3:console.error(yr(s,e.LOG_FORMAT));break;default:console.error(`Unsupported log level: ${yr(s,e.LOG_FORMAT)}`)}}static info(t,n){e.event({action:ye.unknown,status:Se.success,info:t},n)}static debug(t,n){e.event({action:ye.unknown,status:Se.success,info:t},n)}static warn(t,n){e.event({action:ye.unknown,status:Se.warning,info:t},n)}static error(t,n){e.event({action:ye.unknown,status:Se.error,info:t},n)}};Re(Ct,"LOG_LEVEL",2),Re(Ct,"LOG_FORMAT",uo.JSON);let ke=Ct;const ns=class e{constructor(t,n){Re(this,"buffer"),Re(this,"maxLength"),Re(this,"encoder",new TextEncoder),Re(this,"logIndex",0),Re(this,"full",!1),Re(this,"logfile"),this.buffer=new Uint8Array(t+e.FULL_MESSAGE.length),this.maxLength=t,this.logfile=n}clear(){this.encoder=new TextEncoder,this.logIndex=0,this.full=!1}log(t){if(this.full)return;let n=this.encoder.encode(t+"\n");this.logIndex+n.byteLength>this.maxLength&&(this.full=!0,n=this.encoder.encode(e.FULL_MESSAGE)),this.buffer.set(n,this.logIndex),this.logIndex+=n.byteLength}download(){const e=document.createElement("a");e.style.display="none";const t=new Blob([new DataView(this.buffer.buffer,0,this.logIndex)],{type:"text/plain"}),n=URL.createObjectURL(t);e.href=n,this.logfile?e.download=this.logfile:e.download=`omniverse-streaming-${(new Date).toISOString()}.log`,document.body.appendChild(e),e.click(),URL.revokeObjectURL(n),document.body.removeChild(e)}};Re(ns,"FULL_MESSAGE","Log is full\n");let lc=ns;var ti=(e=>(e.WINDOWS="Windows",e.LINUX="Linux",e.MACOS="MacOSX",e.BROWSER="browser",e))(ti||{});class rA{constructor(e){Re(this,"sessionStartParams"),Re(this,"_sessionId"),Re(this,"sessionsToDelete"),Re(this,"gridApp"),Re(this,"startResult"),Re(this,"tracksMap",new Map),Re(this,"totalTracks",0),Re(this,"hasPlatformBeenSimulated",!1),Re(this,"hasAppLaunchBeenSimulated",!1),Re(this,"sessionStartRetryLeft",0),Re(this,"useTelemetry"),Re(this,"nativeTouchEvents"),Re(this,"videoElement"),Re(this,"audioElement"),Re(this,"platformDetails"),Re(this,"logBuffer"),Re(this,"authProvider"),Re(this,"queryParams"),Re(this,"connectivityTimeout"),Re(this,"enableAV1Support"),Re(this,"codecList"),Re(this,"_onProgressUpdate"),Re(this,"_onSessionStartResult"),Re(this,"_onStreamStopped"),Re(this,"_onActiveSessionResult"),Re(this,"_onStreamingEvent"),Re(this,"_onGetSessionResult"),Re(this,"_onISSOUpdate"),Re(this,"_onCustomEvent"),Re(this,"_hasFocus",!1),this.sessionStartParams={},this._sessionId="",this.sessionsToDelete=0,this.sessionStartRetryLeft=e.maxSessionStartRetry,this.logBuffer=e.logBuffer,this.authProvider=e.authProvider,this.codecList=e.codecList,this.useTelemetry=e.useTelemetry,this.nativeTouchEvents=e.nativeTouchEvents,this.connectivityTimeout=e.connectivityTimeout,this.enableAV1Support=e.enableAV1Support,this.platformDetails=e.platformDetails,ke.debug(`Platform details: ${JSON.stringify(this.platformDetails)}`),this.instantiateGridApp(),this.setupHTMLElements(e.videoElementId,e.audioElementId),this.queryParams=new URLSearchParams(e.urlLocation.search),this.setCallbackListeners({onSessionStartResult:e.onSessionStartResult,onStreamStopped:e.onStreamStopped,onActiveSessionResult:e.onActiveSessionResult,onProgressUpdate:e.onProgressUpdate,onStreamingEvent:e.onStreamingEvent,onGetSessionResult:e.onGetSessionResult,onISSOUpdate:e.onISSOUpdate,onCustomEvent:e.onCustomEvent})}connect(e){return this.setCallbackListeners(e)}sessionId(){return this._sessionId}setupHTMLElements(e,t){this.videoElement=document.getElementById(e),this.audioElement=document.getElementById(t),this.audioElement&&(this.audioElement.muted=!0),this.videoElement.muted=!0,this.videoElement.playsInline=!0,this.videoElement.autoplay=!0,this.videoElement.tabIndex=-1,this.videoElement.parentElement.tabIndex=-1,this.videoElement.parentElement.style.outline="none",this.videoElement.parentElement.addEventListener("contextmenu",(function(e){e.preventDefault()})),this.videoElement.parentElement.addEventListener("keydown",this.keyUpDownEventHandler.bind(this)),this.videoElement.parentElement.addEventListener("keyup",this.keyUpDownEventHandler.bind(this)),document.addEventListener("focusin",this.focusinEventHandler.bind(this)),document.addEventListener("focusout",this.focusoutEventHandler.bind(this)),this.videoElement.parentElement.addEventListener("pointerdown",this.videoElementClickedEventHandler.bind(this)),this._hasFocus=-1===this.videoElement.parentElement.tabIndex,ke.debug(`Viewport has focus: ${this._hasFocus}`)}videoElementClickedEventHandler(e){this.videoElement.parentElement.focus()}focusoutEventHandler(e){!e.relatedTarget&&!0!==this._hasFocus&&(ke.debug("Viewport getting focus"),this._hasFocus=!0,this.tracksMap.size>0&&this.gridApp.toggleUserInput(!0,O.InputType.All))}focusinEventHandler(e){document.activeElement===this.videoElement.parentElement?!0!==this._hasFocus&&(ke.debug("Viewport getting focus"),this._hasFocus=!0,this.tracksMap.size>0&&this.gridApp.toggleUserInput(!0,O.InputType.All)):!0===this._hasFocus&&(ke.debug("Viewport losing focus"),this._hasFocus=!1,this.tracksMap.size>0&&this.gridApp.toggleUserInput(!1,O.InputType.Keyboard|O.InputType.Gamepad|O.InputType.Touch))}keyUpDownEventHandler(e){!(73==e.keyCode&&e.ctrlKey&&e.shiftKey)&&!(67==e.keyCode&&e.shiftKey&&e.metaKey)&&!(68==e.keyCode&&e.ctrlKey&&e.shiftKey)&&!("Tab"==e.code&&e.altKey)&&"ZoomToggle"!=e.code&&"SelectTask"!=e.code&&"BrightnessDown"!=e.code&&"BrightnessUp"!=e.code&&"AudioVolumeMute"!=e.code&&"AudioVolumeDown"!=e.code&&"AudioVolumeUp"!=e.code&&!(e.keyCode>=48&&e.keyCode<=57)&&"Backspace"!=e.code&&e.preventDefault(),86==e.keyCode&&e.ctrlKey&&this.onPasteClipboardText()}onPasteClipboardText(){navigator.clipboard&&window.isSecureContext?navigator.clipboard.readText().then((e=>{e&&(ke.event({action:ye.clipboardCopy,status:Se.success,info:"Clipboard text sent to the server.",sessionId:this.sessionId()||null}),this.gridApp.sendTextInput(nA(e)))})).catch((e=>{ke.event({action:ye.clipboardCopy,status:Se.error,info:`Failed to read clipboard contents: ${e}`,sessionId:this.sessionId()||null})})):ke.event({action:ye.clipboardCopy,status:Se.error,info:"Cannot read from clipboard because in insecure context.",sessionId:this.sessionId()||null})}onCopyTextToClipboard(e){navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e).then((()=>{ke.event({action:ye.clipboardCopy,status:Se.success,info:`Clipboard text copied from the server: ${e}`,sessionId:this.sessionId()||null})})).catch((e=>{ke.event({action:ye.clipboardCopy,status:Se.error,info:`Failed to write to clipboard: ${e}`,sessionId:this.sessionId()||null})})):ke.event({action:ye.clipboardCopy,status:Se.error,info:"Cannot write to clipboard because in insecure context.",sessionId:this.sessionId()||null})}getQueryParam(e){return this.queryParams.get(e)}onLogEvent(e){e.sessionId=e.sessionId||this.sessionId()||null,ke.event(e,this.logBuffer)}updateEventDataElements(){var e;null==(e=this.gridApp)||e.updateEventDataElements({commonData:{clientId:"78589530426925203",clientVer:"2.0.45.34",clientVariant:"Release",eventSchemaVer:"23.0",eventSysVer:"0.12.2",deviceId:this.authProvider.getDeviceId(),userId:this.authProvider.getUserId(),externalUserId:this.authProvider.getExternalUserId(),idpId:this.authProvider.getIdpId(),integrationId:"undefined",sessionId:"92774af7-fbc1-488f-a090-ba49cfd13da2",deviceOS:I0(this.platformDetails.os),deviceOSVersion:this.platformDetails.osVer,deviceType:w0(this.platformDetails.deviceType),deviceMake:"APPLE",deviceModel:"undefined",clientType:"Browser",browserType:C0(this.platformDetails.browser),platform:"Web",eventProtocol:"1.4",deviceGdprFuncOptIn:"Full",deviceGdprTechOptIn:"None",deviceGdprBehOptIn:"None",gdprFuncOptIn:"Full",gdprTechOptIn:"Full",gdprBehOptIn:"Full"},experiments:[{id:"6376d3bf-3f62-419d-989c-2955c25f2b4e",group:"ENABLE"},{id:"feb30a68-ee9a-44a0-a717-da2d28c81e97",group:"ENABLE"},{id:"ea128779-32c7-45c1-94c8-c9374d64219d",group:"ENABLE"},{id:"ac00061b-eb8d-4d6c-978a-f3ac96f8e91a",group:"ENABLE"},{id:"21f7e7af-b5ae-4c76-b269-3cc4351671d2",group:"ENABLE"},{id:"b205ded0-6c08-4436-b818-f0bde4633f08",group:"ENABLE"},{id:"d639ef8f-c6c5-4931-8e75-451e9e075c62",group:"ENABLE"},{id:"cdce276d-d611-4ef9-ba6f-a90c3e7040d4",group:"ENABLE"},{id:"4c57b739-c860-4c5e-b3e4-9d89ff91b561",group:"ENABLE"},{id:"86bf4cf1-b717-4f72-8414-0f40d6a32656",group:"ENABLE"}],config:{server:"https://events.gfestage.nvidia.com",version:"v1.0"},telemetryEventIds:{streamingProfileGuid:"testClientStreamingProfileGuid",systemInfoGuid:"testClientSystemInfoGuid"}})}setCallbackListeners(e){return!!this.gridApp&&(this._onProgressUpdate=e.onProgressUpdate,this._onSessionStartResult=e.onSessionStartResult,this._onStreamStopped=e.onStreamStopped,this._onActiveSessionResult=e.onActiveSessionResult,this._onStreamingEvent=e.onStreamingEvent,this._onGetSessionResult=e.onGetSessionResult,this._onISSOUpdate=e.onISSOUpdate,this._onCustomEvent=e.onCustomEvent,this.gridApp.addListener(O.EVENTS.SESSION_START_RESULT,this.onSessionStartResult.bind(this)),this.gridApp.addListener(O.EVENTS.SESSION_STOP_RESULT,this.onSessionStopResult.bind(this)),this.gridApp.addListener(O.EVENTS.ACTIVE_SESSIONS_RESULT,this.onActiveSessionResult.bind(this)),this.gridApp.addListener(O.EVENTS.PROGRESS_UPDATE,this.onProgressUpdate.bind(this)),this.gridApp.addListener(O.EVENTS.STREAM_STOPPED,this.onStreamStopped.bind(this)),this.gridApp.addListener(O.EVENTS.STREAMING_EVENT,this.onStreamingEvent.bind(this)),this.gridApp.addListener(O.EVENTS.GET_SESSION_RESULT,this.onGetSessionResult.bind(this)),this.gridApp.addListener(O.EVENTS.CUSTOM_MESSAGE,this.onCustomMessage.bind(this)),this.gridApp.addListener(O.EVENTS.STREAM_STATS_UPDATE,this.onISSOUpdate.bind(this)),this.gridApp.addListener(O.EVENTS.LOG_EVENT,this.onLogEvent.bind(this)),!0)}instantiateGridApp(){this.gridApp||(ke.debug("Instantiating grid app."),this.gridApp=new O.GridApp(this.platformDetails))}handleActiveSessions(e){for(let t=0;t<e.length;t++)if(this.sessionStartParams.appId==e[t].appId&&(e[t].state==O.SessionState.READY_FOR_CONNECTION||e[t].state==O.SessionState.STREAMING||e[t].state==O.SessionState.PAUSED))return ke.debug("Existing session found with the appid "+e[t].appId+" and SessionState "+e[t].state),this.sessionStartParams.appLaunchMode==O.AppLaunchMode.TouchFriendly&&e[t].appLaunchMode!=O.AppLaunchMode.TouchFriendly&&(this.sessionStartParams.appLaunchMode=O.AppLaunchMode.Default,ke.warn("session "+e[t].sessionId+" was not launched in touch friendly mode, ignoring touch input mode.")),void this.gridApp.resumeSession(this.sessionStartParams,e[t].sessionId);this.sessionsToDelete=e.length;for(let t=0;t<e.length;t++)this.gridApp.stopSession(e[t].sessionId)}resetTrackInfo(){this.totalTracks=0,this.tracksMap.clear()}playTrack(e,t){const n=t.play(),i=n=>{var i;const s=(null==(i=t.srcObject)?void 0:i.getTracks())||[];0===s.length&&ke.event({action:ye.start,status:Se.error,info:`No tracks found for ${e}`,sessionId:this.sessionId()||null});for(const e of s)this.tracksMap.set(e.id,n)};if(n){const s=this._hasFocus;n.then((()=>{ke.debug(`${e} play succeeded.`),t instanceof HTMLVideoElement&&(s?this.gridApp.toggleUserInput(!0,O.InputType.All):this.gridApp.toggleUserInput(!0,O.InputType.Mouse)),i(!0)})).catch((e=>{ke.event({action:ye.start,status:Se.error,info:`Play failed: ${null==e?void 0:e.name} , ${null==e?void 0:e.message}`,sessionId:this.sessionId()||null}),i(!1),this.gridApp.stopSession(this.sessionId())}))}else t instanceof HTMLVideoElement&&(this._hasFocus?this.gridApp.toggleUserInput(!0,O.InputType.All):this.gridApp.toggleUserInput(!0,O.InputType.Mouse)),i(!0)}playMedia(){for(let e of this.startResult.streams)for(let t of e.tracks)t.kind===O.TrackType.VIDEO&&this.videoElement.srcObject?this.playTrack(t.trackId,this.videoElement):t.kind===O.TrackType.AUDIO&&this.audioElement.srcObject&&this.playTrack(t.trackId,this.audioElement)}onSessionStartResult(e){let t=!1;if(e.error)t=e.error.code!==O.RErrorCode.SessionLimitExceeded&&e.error.code!==O.RErrorCode.SessionLimitPerDeviceReached&&e.error.code!==O.RErrorCode.SessionSetupCancelled&&e.error.code!==O.RErrorCode.SessionSetupCancelledDuringQueuing&&this.sessionStartRetryLeft>0,e.error.code==O.RErrorCode.SessionLimitExceeded?e.sessionList?(ke.event({action:ye.start,status:Se.error,info:`Session limit reached. Number of active sessions: ${e.sessionList.length}`,sessionId:this.sessionId()||null}),e.sessionList.length&&this.handleActiveSessions(e.sessionList)):(ke.debug("Checking for existing sessions.."),this.gridApp.getActiveSessions()):t&&window.setTimeout((()=>{this.sessionStartRetryLeft-=1,this.startButtonClick()}),5e3);else{ke.debug("client: successfully set up session: "+e.sessionId),ke.debug("Should enable mic: "+this.getGridApp().shouldDefaultEnableMic()),this._sessionId=e.sessionId,this.startResult=e,ke.debug("streams: "+JSON.stringify(this.startResult.streams));for(let e of this.startResult.streams)this.totalTracks+=e.tracks.length;this.playMedia()}const n=nt.convert(e,Ri.startSessionResultEvent),i=t?this.sessionStartRetryLeft:0;n.info=`${n.info} ${i} retries left.`,i>0&&(n.status=Se.warning),ke.event(n),this._onSessionStartResult&&this._onSessionStartResult(n)}onSessionStopResult(e){this.sessionId()==e.sessionId?(this._sessionId="",0==e.framesDecoded&&ke.event({action:ye.stop,status:Se.warning,info:"Zero frame decoded.",sessionId:this.sessionId()||null})):this.sessionsToDelete>0&&(this.sessionsToDelete--,0===this.sessionsToDelete&&this.begin());const t=nt.convert(e,Ri.stopSessionResultEvent);ke.event(t),this._onStreamStopped&&this._onStreamStopped(t)}onProgressUpdate(e){const t=nt.convert(e,Ri.sessionProgressUpdateEvent);ke.event(t),this._onProgressUpdate&&this._onProgressUpdate(t)}onStreamStopped(e){this.resetTrackInfo(),e.error&&this.getQueryParam("resume")&&e.isResumable&&(ke.event({action:ye.stop,status:Se.inProgress,info:"Will resuming 15 secs after stopping.",sessionId:this.sessionId()||null}),window.setTimeout((()=>this.gridApp.getActiveSessions()),15e3));const t=nt.convert(e,Ri.streamingTerminatedEvent);ke.event(t),this._onStreamStopped&&this._onStreamStopped(t)}onActiveSessionResult(e){e.error||(ke.event({action:ye.active,status:Se.success,info:"Active session request succeeded. Number of active sessions: "+e.sessionList.length,sessionId:this.sessionId()||null}),e.sessionList.length?this.handleActiveSessions(e.sessionList):this.begin());const t=nt.convert(e,Ri.activeSessionResultEvent);ke.event(t),this._onActiveSessionResult&&this._onActiveSessionResult(t)}onStreamingEvent(e){if(e.streamingState&&e.streamingState.state===O.STREAMING_STATE.RECONNECTING){const t=nt.convert(e,Ri.streamingEvent);ke.event(t),this._onStreamingEvent&&this._onStreamingEvent(t)}}onGetSessionResult(e){e.error||(e.state==O.SessionState.INITIALIZING||e.state==O.SessionState.RESUMING?window.setTimeout((()=>this.gridApp.getSession(e.sessionId)),1e3):e.state==O.SessionState.READY_FOR_CONNECTION&&this.gridApp.resumeSession(this.sessionStartParams,e.sessionId));const t=nt.convert(e,Ri.getSessionResult);ke.event(t),this._onGetSessionResult&&this._onGetSessionResult(t)}sendCustomMessage(e){ke.event({action:ye.message,status:Se.inProgress,info:`Custom message being sent to the stream: ${JSON.stringify(e)}`,sessionId:this.sessionId()||null}),this.gridApp.sendCustomMessage(e)}onCustomMessage(e){"clipboard_set"in e?this.onCopyTextToClipboard(String(e.clipboard_set)):(ke.event({action:ye.message,status:Se.success,info:"Custom message successfully recieved from stream.",sessionId:this.sessionId()||null}),this._onCustomEvent?this._onCustomEvent(e):ke.event({action:ye.message,status:Se.warning,info:"Stream sent a custom message, but client has not provided an onCustomEvent handler method.",sessionId:this.sessionId()||null}))}onISSOUpdate(e){this._onISSOUpdate&&this._onISSOUpdate(nt.convert(e,Ri.streamUpdateEvent))}downloadLogs(){this.logBuffer.download()}downloadAudioRecordings(){var e;null==(e=this.gridApp)||e.downloadAudio()}getPlatformOverride(e,t,n,i,s){return"clientplatformname="+e+"&clienttype="+t+"&deviceos="+n+"&devicetype="+i+"&clientstreamer="+s}getPlatformAndAppLaunchOverrides(e,t){let n,i=this.queryParams.toString(),s="";switch(e){case 0:this.hasPlatformBeenSimulated&&this.getPlatformOverride("","","","","");break;case 1:s=this.getPlatformOverride(ti.WINDOWS,O.ClientType.NATIVE,Vt.WINDOWS,St.DESKTOP,O.ClientStreamer.CLASSIC);break;case 2:s=this.getPlatformOverride(ti.MACOS,O.ClientType.NATIVE,Vt.MAC,St.DESKTOP,O.ClientStreamer.CLASSIC);break;case 3:s=this.getPlatformOverride(ti.LINUX,O.ClientType.NATIVE,Vt.ANDROID,St.TABLET,O.ClientStreamer.CLASSIC);break;case 4:s=this.getPlatformOverride(ti.BROWSER,O.ClientType.BROWSER,Vt.IOS,St.PHONE,O.ClientStreamer.WEBRTC);break;case 5:s=this.getPlatformOverride(ti.BROWSER,O.ClientType.BROWSER,Vt.IPADOS,St.TABLET,O.ClientStreamer.WEBRTC);break;case 6:s=this.getPlatformOverride(ti.BROWSER,O.ClientType.BROWSER,Vt.CHROME_OS,St.DESKTOP,O.ClientStreamer.WEBRTC);break;case 7:s=this.getPlatformOverride(ti.BROWSER,O.ClientType.BROWSER,Vt.WINDOWS,St.DESKTOP,O.ClientStreamer.WEBRTC);break;case 8:s=this.getPlatformOverride(ti.BROWSER,O.ClientType.BROWSER,Vt.MAC,St.DESKTOP,O.ClientStreamer.WEBRTC);break;case 9:s=this.getPlatformOverride(ti.BROWSER,O.ClientType.BROWSER,Vt.LINUX,St.DESKTOP,O.ClientStreamer.WEBRTC);break;case 10:s=this.getPlatformOverride(ti.BROWSER,O.ClientType.BROWSER,Vt.WEBOS,St.TV,O.ClientStreamer.WEBRTC);break;case 11:s=this.getPlatformOverride(ti.BROWSER,O.ClientType.BROWSER,Vt.TIZEN,St.TV,O.ClientStreamer.WEBRTC);break;case 12:s=this.getPlatformOverride(ti.BROWSER,O.ClientType.BROWSER,Vt.XBOX,St.CONSOLE,O.ClientStreamer.WEBRTC)}switch(s&&(this.hasPlatformBeenSimulated=!0,i+=s+"&"),t){case 0:this.hasAppLaunchBeenSimulated&&(n=O.AppLaunchMode.Default);break;case 1:n=O.AppLaunchMode.Default;break;case 2:n=O.AppLaunchMode.TouchFriendly;break;case 3:n=O.AppLaunchMode.GamepadFriendly}return void 0!==n&&(this.hasAppLaunchBeenSimulated=!0,i+="applaunchmode="+n+"&"),i.endsWith("&")||(i+="&"),i+"webrtcstreamer=enable"}configureGridApp(e){return new Promise(((t,n)=>{this.useTelemetry&&this.updateEventDataElements();const i={serverAddress:e,authTokenCallback:this.authProvider.getTokenCallback(),deviceHashId:"",clientShutDownCallback:void 0};let s;switch(this.getQueryParam("cursor")){case"hw":s=O.CursorType.HARDWARE;break;case"free":default:s=O.CursorType.FREE;break;case"sw":s=O.CursorType.SOFTWARE}const r={cursorType:s,allowUnconfined:null!==this.getQueryParam("allowunconfined")};ke.debug("initializing gridApp with server: "+i.serverAddress),this.gridApp.initialize(i,r)?this.authProvider.getAuthInfo().then((e=>{this.gridApp.setAuthInfo(e),t()})).catch((()=>{n()})):n()}))}getGridApp(){return this.gridApp}begin(){this.gridApp.startSession(this.sessionStartParams)}async startButtonClick(){var e;let t=this.getPlatformAndAppLaunchOverrides(0,0);const n={connectivityCheckTimeout:this.connectivityTimeout,sleepErrorsStreaming:["0xC0F2230F"]};null!=(e=this.codecList)&&e.length&&(n.codecList=this.codecList),"boolean"==typeof this.enableAV1Support&&(n.enableAv1Support=this.enableAV1Support);const i={remoteConfigData:{ragnarok:JSON.stringify(n)},gxtOverrideData:JSON.stringify({params:[{name:"ragnarok",value:{enableCpm:!1}}]}),overrideData:t};O.ConfigureRagnarokSettings(i);let s=this.getQueryParam("server");try{let e=this.getQueryParam("resolution").split(":"),t=iA(this.getQueryParam("fps"));const n="0";let i="en-US";this.configureGridApp(s).then((()=>{ke.debug("grid app setup completed");const r=this.nativeTouchEvents&&tA(this.platformDetails);this.sessionStartParams={streamParams:[],appLaunchMode:r?O.AppLaunchMode.TouchFriendly:O.AppLaunchMode.Default,keyboardLayout:i,shortName:"Omniverse App Streaming",accountLinked:!1};let o=parseInt(e[0]),a=parseInt(e[1]),c=t;const d=parseInt(n);if(!o||!a){const e=[{resolution:{width:3840,height:2160},frameRate:60},{resolution:{width:3440,height:1440},frameRate:60},{resolution:{width:2560,height:1600},frameRate:120},{resolution:{width:2560,height:1600},frameRate:60},{resolution:{width:2560,height:1440},frameRate:120},{resolution:{width:2560,height:1440},frameRate:60},{resolution:{width:1920,height:1200},frameRate:60},{resolution:{width:1920,height:1080},frameRate:60},{resolution:{width:1920,height:1080},frameRate:30},{resolution:{width:1920,height:1080},frameRate:120},{resolution:{width:1680,height:1050},frameRate:60},{resolution:{width:1600,height:900},frameRate:60},{resolution:{width:1280,height:1024},frameRate:60},{resolution:{width:1440,height:900},frameRate:60},{resolution:{width:1366,height:768},frameRate:60},{resolution:{width:1280,height:800},frameRate:60},{resolution:{width:1280,height:720},frameRate:60},{resolution:{width:1600,height:1200},frameRate:60},{resolution:{width:1112,height:834},frameRate:60},{resolution:{width:1024,height:768},frameRate:60},{resolution:{width:960,height:540},frameRate:60}],t=O.ChooseStreamingSettings(O.StreamingProfilePreset.BALANCED,e,this.platformDetails);o=t.resolution.width,a=t.resolution.height,ke.debug("Recommended stream settings: "+o+"x"+a+"@"+t.frameRate),ke.debug("Capable stream settings: "+JSON.stringify(e))}this.sessionStartParams.streamParams.push({width:o,height:a,fps:c,maxBitrateKbps:d,drc:!1,videoTagId:this.videoElement.id,audioTagId:this.audioElement.id});const l=this.getQueryParam("signalingserver");let u=[];if(l){const e=parseInt(this.getQueryParam("signalingport")),t=this.getQueryParam("signalingpath"),n=hf(l)?O.AppLevelProtocol.HTTP:O.AppLevelProtocol.HTTPS;u.push({ip:l,port:e,resourcePath:t,usage:O.Usage.SIGNALING,appLevelProtocol:n,protocol:O.Protocol.TCP}),ke.debug("initializing signaling connection: "+JSON.stringify({signalingserver:l,signalingport:e,signalingpath:t}))}const h=this.getQueryParam("mediaserver");if(h)if(Xm(h)&&!hf(h))ke.event({action:ye.start,status:Se.error,info:`mediaserver query parameter is not a valid IP. value: ${h}`,sessionId:this.sessionId()||null});else{const e=parseInt(this.getQueryParam("mediaport"));u.push({ip:h,port:e,usage:O.Usage.VIDEO,appLevelProtocol:O.AppLevelProtocol.UNKNOWN,protocol:O.Protocol.UDP})}const p=this.getQueryParam("signalingquery");if(p&&(this.sessionStartParams.signalingUrlQueryParameters=decodeURIComponent(p)),s)this.sessionStartParams.connectionInfo=void 0,this.sessionStartParams.sessionId=void 0;else{if(!u.length){const e={action:ye.start,status:Se.error,info:"Signaling server info is required in pass-thru use case. Please add signalingserver=<> to the query parameters"};return ke.event(e),void(this._onSessionStartResult&&this._onSessionStartResult(e))}this.sessionStartParams.connectionInfo=u;const e=this.getQueryParam("sessionid");e&&(this.sessionStartParams.sessionId=e)}this.getQueryParam("accessToken")&&(this.sessionStartParams.sessionId+="-Authorization.Bearer-"+this.getQueryParam("accessToken")),this.begin()})).catch((e=>{ke.event({action:ye.start,status:Se.error,info:`Something unexpected happened: ${null==e?void 0:e.name} ${null==e?void 0:e.message}`,sessionId:this.sessionId()||null})}))}catch(e){ke.event({action:ye.start,status:Se.error,info:`Exception in start button click: ${e}`,sessionId:this.sessionId()||null})}}stopButtonClick(e=!1,t=!1){this.resetTrackInfo(),this.sessionId()&&(e?this.gridApp.pauseSession(this.sessionId()):this.gridApp.stopSession(this.sessionId()))}}const xf={accessToken:null,autoLaunch:!0,cursor:"free",fps:60,height:1080,mediaPort:null,mediaServer:null,mic:!1,nucleus:null,server:null,sessionId:null,signalingPort:48322,signalingServer:null,signalingPath:null,signalingQuery:null,width:1920};class _f{static query(e){const t=Object.keys(e).reduce(((t,n)=>{if(void 0!==xf[n]&&void 0!==e[n]&&null!==e[n]&&"width"!==n&&"height"!==n){const i=["accessToken"].includes(n)?n:n.toLowerCase();t.push([i,e[n]])}return t}),[["resolution",`${e.width}x${e.height}`]]);return new URLSearchParams(t).toString()}}const sA=512e3,oA={videoElementId:"remote-video",audioElementId:"remote-audio",authenticate:!1,maxReconnects:5,nativeTouchEvents:!1,backendUrl:"",connectivityTimeout:2e3,newSession:!1,onUpdate:null,onStart:null,onStop:null,onTerminate:null,onStreamStats:null,onCustomEvent:null,...xf};class Ff{constructor(){Re(this,"_ragnarokApp"),Re(this,"_backendURL"),Re(this,"_accessToken"),Re(this,"_sessionID"),Re(this,"_nucleus"),this._ragnarokApp=null,this._backendURL="",this._accessToken=null,this._nucleus=null,this._sessionID=null}async connect(e){return this._backendURL=e.backendUrl,this._accessToken=e.accessToken,this._nucleus=e.nucleus,this._sessionID=e.sessionId,e.newSession?(e.onStart&&e.onStart({action:ye.newSession,status:Se.inProgress,info:"Requesting new session."}),this.newSession().then((t=>(e.sessionId=t.sessionId,e.onStart&&e.onStart(t),this._connect(e)))).catch((t=>{throw e.onStart&&e.onStart(t),t}))):this._connect(e)}async _connect(e){if((e={...oA,...e}).maxReconnects<0)throw{action:ye.start,status:Se.error,info:`Invalid prop DirectConfig.maxReconnects: ${e.maxReconnects}. Must be >= 0.`};const t=this.getURLLocation(e);try{this._backendURL=e.backendUrl,this._accessToken=e.accessToken,this._nucleus=e.nucleus,this._sessionID=e.sessionId;const n=await jn.platformDetails();e.authenticate||(t.search=t.search.replace("accessToken","accessTokenUnused"));const i={onSessionStartResult:e.onStart||null,onProgressUpdate:e.onUpdate||null,onStreamStopped:e.onStop||null,onActiveSessionResult:null,onStreamingEvent:null,onGetSessionResult:null,onISSOUpdate:e.onStreamStats||null,onCustomEvent:e.onCustomEvent||null};if(this._ragnarokApp){if(!this._ragnarokApp.connect(i))throw{action:ye.start,status:Se.error,info:"Failed to connect to current stream"};return{action:ye.start,status:Se.success,info:"Stream already connected"}}this._ragnarokApp=new rA({maxSessionStartRetry:e.maxReconnects,platformDetails:n,videoElementId:e.videoElementId,audioElementId:e.audioElementId,urlLocation:t,authProvider:new T0,logBuffer:new lc(sA),...i,useTelemetry:!1,nativeTouchEvents:e.nativeTouchEvents,connectivityTimeout:e.connectivityTimeout,enableAV1Support:e.enableAV1Support,codecList:e.codecList}),e.autoLaunch&&await this._ragnarokApp.startButtonClick()}catch(e){const t={action:ye.start,status:Se.error,info:e};throw ke.event(t),t}const n={action:ye.start,status:Se.inProgress,info:"Starting stream."};return ke.event(n),n}getURLLocation(e){return{search:_f.query(e)}}sendMessage(e){const t={messageType:"json",messageRecipient:"kit",data:e};this._ragnarokApp.sendCustomMessage(t)}async stop(){try{return this._ragnarokApp.stopButtonClick(),{action:ye.stop,status:Se.inProgress,info:"Stopping stream."}}catch{return{action:ye.stop,status:Se.error,info:"Stopping stream."}}}async start(){try{return await this._ragnarokApp.startButtonClick(),{action:ye.start,status:Se.inProgress,info:"Starting stream."}}catch(e){return{action:ye.start,status:Se.error,info:e}}}backendUrl(){return this._backendURL}async newSession(){return new Promise(((e,t)=>{t({action:ye.newSession,status:Se.error,info:`New session request not supported for ${this.constructor.name}.`})}))}_terminateStream(){this._ragnarokApp&&this._ragnarokApp.stopButtonClick(!1,!0),this._ragnarokApp=null,this._backendURL="",this._accessToken=null,this._nucleus=null,this._sessionID=null}async terminate(e){const t=this.sessionId();if(!e)return this._terminateStream(),{action:ye.terminate,status:Se.success,sessionId:t,info:"Session has terminated"};if(confirm("Terminating the session will destroy all associated resources and is not recoverable. All unsaved changes will be lost. Are you sure you would like to terminate the session?")){const e=this._accessToken;this._nucleus;const n=this._sessionID,i=this._backendURL;this._terminateStream();const s="DELETE";if(i){let r=null;{const t=`https://${i}/stream`;r=await fetch(t,{method:s,headers:{Authorization:`Bearer ${e}`,accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({session_id:`${n}`})})}if(200!==(null==r?void 0:r.status)){let e=null,n=null;try{e=await r.setHeader("Strict-Transport-Security","max-age=63072000; includeSubDomains").json(),n=`${r.status}: ${e.message}`}catch{n=`${r.status}: ${r.statusText} ${r.url}`}const i={action:ye.terminate,status:Se.error,sessionId:t,info:n};return ke.event(i),i}}const r={action:ye.terminate,status:Se.success,sessionId:t,info:"Session has terminated"};return ke.event(r),r}const n={action:ye.terminate,status:Se.canceled,sessionId:t,info:"Termination has been cancelled"};return ke.event(n),n}resize(e,t){const n={messageType:"json",messageRecipient:"stream",data:JSON.stringify({type:"resize",value:{height:t,width:e}})};this._ragnarokApp.sendCustomMessage(n)}sessionId(){var e;return(null==(e=this._ragnarokApp)?void 0:e.sessionId())??""}}const aA={GFN:null,catalogClientId:null,clientId:null,cmsId:null,nonce:null,partnerId:null,muteAudio:!0,onUpdate:null,onStart:null,onCustomEvent:null};class dA{constructor(){Re(this,"_GFN"),Re(this,"_catalogClientId"),Re(this,"_clientId"),Re(this,"_cmsId"),Re(this,"_nonce"),Re(this,"_partnerId"),Re(this,"_muteAudio"),this._GFN=null,this._catalogClientId="",this._clientId="",this._cmsId=-9999,this._nonce="",this._partnerId="",this._muteAudio=!0}async connect(e){if(!e)throw{action:ye.start,status:Se.error,info:"Invalid GFNConfig props provided. Please refer to usage documentation."};return e={...aA,...e},this._GFN=e.GFN,this._catalogClientId=e.catalogClientId,this._clientId=e.clientId,this._cmsId=e.cmsId,this._muteAudio=e.muteAudio,this._nonce=e.nonce,this._partnerId=e.partnerId,this._initialize().then((async()=>{var t,n;await this._login();const i=await this._GFN.server.getServerInfo();e.onUpdate({action:ye.authUser,status:Se.success,info:null==(t=this._GFN.currentUser)?void 0:t.displayName}),await this._stream(null==(n=null==i?void 0:i.defaultZone)?void 0:n.address),console.debug("Started streaming"),this._GFN.streamer.on("started",(()=>{e.onStart({action:ye.start,status:Se.success,info:"streamready"})})),this._GFN.streamer.on("message",(t=>{console.debug(`Received message from GFN app: ${t}`);const n=JSON.parse(t);n.event_type&&n.payload?e.onCustomEvent(n):Object.keys(n).forEach((t=>{e.onUpdate({action:ye.update,status:Se.success,info:JSON.stringify({key:t,value:n[t]})})}))}))})).catch((e=>{throw{action:ye.start,status:Se.error,info:e}})),{action:ye.start,status:Se.inProgress,info:"Starting stream."}}async start(){throw new Error("GFNStreamer::start is not defined.")}async stop(){throw new Error("GFNStreamer::stop is not defined.")}async terminate(){throw new Error("GFNStreamer::terminate is not defined.")}sendMessage(e){try{this._GFN.streamer.sendMessage(e)}catch(e){console.error("Error sending message: "+e)}}async _initialize(){console.debug("initialize");const e=new this._GFN.Settings({clientId:this._clientId,catalogClientId:this._catalogClientId,partnerId:this._partnerId});try{if(await this._GFN.initialize(e),console.debug("gfn init finished"),!this._GFN.settings.vpcId){const e=await this._GFN.server.getServerInfo();this._GFN.settings.vpcId=e.vpcId}}catch(e){console.error(`GFN Initialization Failed: ${e.message}`)}}async _login(){this._nonce?await this._loginWithNonce(this._nonce,this._cmsId):await this._gfnLogin()}async _loginWithNonce(e,t){console.debug("_loginWithNonce");try{await this._GFN.auth.loginWithNonce(e,t.toString())}catch(e){throw console.error(`GFN Authorization Failed: ${e.message}`),e}}async _gfnLogin(){console.debug("gfn login");const e=this._GFN.auth.createLoginUrl();console.debug(`login ${e}`);try{await this._GFN.auth.loginWithBrowserPopup(e),console.debug("GFN Authorization Successful!"),console.debug(`GFN Logged in username: ${this._GFN.currentUser.displayName}`)}catch(e){throw console.error(`GFN Authorization Failed: ${e.message}`),e}}async _stream(e){const t=this._cmsId,n=this._GFN.streamer.detectStreamingResolution(),i={server:e,appId:t,streamParams:{width:n.width,height:n.height,fps:60},authTokenCallback:async()=>this._GFN.currentUser.authInfo.idToken.value,windowElementId:"view",enableMutedAutoPlay:this._muteAudio};return this._GFN.streamer.start(i).then((()=>{console.debug("streamer is starting...")})).catch((e=>{console.debug(`error while starting stream. ${e}`)}))}resize(e,t){const n={type:"resize",value:{height:t,width:e}};this.sendMessage(JSON.stringify(n))}}class cA extends Ff{async connect(e){return e.backendUrl||(e.backendUrl=this.genDefaultBackendUrl(e)),super.connect(e)}getURLLocation(e){const t={search:_f.query(e)};return t.search=`${t.search}&disableworkerws=true`,t}async newSession(){if(!this.backendUrl())throw{action:ye.newSession,status:Se.error,info:"Backend URL must be set before requesting a new session."};const e=await fetch(this.backendUrl(),{method:"POST"});if(!e.ok){const t=await e.text();throw{action:ye.newSession,status:Se.error,info:t}}const t=e.headers.get("nvcf-request-id");if(!t)throw{action:ye.newSession,status:Se.error,info:"No session ID found in response."};return{action:ye.newSession,status:Se.success,sessionId:t,info:"New session request successful."}}async terminate(e){if(e){const e=this.sessionId();if(!this.backendUrl())throw{action:ye.terminate,status:Se.error,sessionId:e,info:"Backend URL must be set before requesting a session termination."};const t=await fetch(this.backendUrl(),{method:"DELETE"});if(!t.ok){const n=await t.text();throw{action:ye.terminate,status:Se.error,sessionId:e,info:`${t.status}: ${t.statusText}: ${n}`}}}return super.terminate(!1)}genDefaultBackendUrl(e){var t;if(!e.signalingServer||!e.signalingPort||!e.signalingPath)throw{action:ye.newSession,status:Se.error,info:"backenURL or signalingServer, signalingPort, and signalingPath must be set before requesting a new session."};return`${443===e.signalingPort?"https:":"http:"}//${e.signalingServer}:${e.signalingPort}${e.signalingPath}/sign_in?${(null==(t=e.signalingQuery)?void 0:t.toString())??""}`}}var Uf={exports:{}};Uf.exports=function(){var e="function"==typeof Promise,t="object"==typeof self?self:of,n=typeof Symbol<"u",i=typeof Map<"u",s=typeof Set<"u",r=typeof WeakMap<"u",o=typeof WeakSet<"u",a=typeof DataView<"u",c=n&&typeof Symbol.iterator<"u",d=n&&typeof Symbol.toStringTag<"u",l=s&&"function"==typeof Set.prototype.entries,u=i&&"function"==typeof Map.prototype.entries,h=l&&Object.getPrototypeOf((new Set).entries()),p=u&&Object.getPrototypeOf((new Map).entries()),f=c&&"function"==typeof Array.prototype[Symbol.iterator],v=f&&Object.getPrototypeOf([][Symbol.iterator]()),g=c&&"function"==typeof String.prototype[Symbol.iterator],m=g&&Object.getPrototypeOf(""[Symbol.iterator]()),A=8,b=-1;function S(n){var c=typeof n;if("object"!==c)return c;if(null===n)return"null";if(n===t)return"global";if(Array.isArray(n)&&(!1===d||!(Symbol.toStringTag in n)))return"Array";if("object"==typeof window&&null!==window){if("object"==typeof window.location&&n===window.location)return"Location";if("object"==typeof window.document&&n===window.document)return"Document";if("object"==typeof window.navigator){if("object"==typeof window.navigator.mimeTypes&&n===window.navigator.mimeTypes)return"MimeTypeArray";if("object"==typeof window.navigator.plugins&&n===window.navigator.plugins)return"PluginArray"}if(("function"==typeof window.HTMLElement||"object"==typeof window.HTMLElement)&&n instanceof window.HTMLElement){if("BLOCKQUOTE"===n.tagName)return"HTMLQuoteElement";if("TD"===n.tagName)return"HTMLTableDataCellElement";if("TH"===n.tagName)return"HTMLTableHeaderCellElement"}}var l=d&&n[Symbol.toStringTag];if("string"==typeof l)return l;var u=Object.getPrototypeOf(n);return u===RegExp.prototype?"RegExp":u===Date.prototype?"Date":e&&u===Promise.prototype?"Promise":s&&u===Set.prototype?"Set":i&&u===Map.prototype?"Map":o&&u===WeakSet.prototype?"WeakSet":r&&u===WeakMap.prototype?"WeakMap":a&&u===DataView.prototype?"DataView":i&&u===p?"Map Iterator":s&&u===h?"Set Iterator":f&&u===v?"Array Iterator":g&&u===m?"String Iterator":null===u?"Object":Object.prototype.toString.call(n).slice(A,b)}return S}();var lA=Uf.exports;const uA=k0(lA),Cc=typeof Buffer<"u",hA=Cc&&typeof Buffer.from<"u",fA=Cc?function(e){return Buffer.isBuffer(e)}:function(){return!1},pA=hA?function(e){return Buffer.from(e)}:Cc?function(e){return new Buffer(e)}:function(e){return e};function br(e){return fA(e)?"Buffer":uA(e)}const vA=new Set(["Arguments","Array","Map","Object","Set"]);function gA(e,t,n=null){switch(n||br(e)){case"Arguments":case"Array":case"Object":return e[t];case"Map":return e.get(t);case"Set":return t}}function uc(e){return vA.has(e)}function pf(e,t,n,i=null){switch(i||br(e)){case"Arguments":case"Array":case"Object":e[t]=n;break;case"Map":e.set(t,n);break;case"Set":e.add(n)}return e}const mA=typeof globalThis<"u"&&null!==globalThis&&globalThis.Object===Object&&globalThis,AA=typeof global<"u"&&null!==global&&global.Object===Object&&global,SA=typeof self<"u"&&null!==self&&self.Object===Object&&self,ic=mA||AA||SA||Function("return this")();function yA(e){return e.slice(0)}function bA(e){return new Boolean(e.valueOf())}function EA(e){return new DataView(e.buffer)}function wA(e){return pA(e)}function CA(e){return new Date(e.getTime())}function IA(e){return new Number(e)}function TA(e){return new RegExp(e.source,e.flags)}function RA(e){return new String(e)}function Yi(e,t){return ic[t].from?ic[t].from(e):new ic[t](e)}function Mt(e){return e}function vf(){return[]}function kA(){return new Map}function PA(){return{}}function OA(){return new Set}const DA=new Map([["ArrayBuffer",yA],["Boolean",bA],["Buffer",wA],["DataView",EA],["Date",CA],["Number",IA],["RegExp",TA],["String",RA],["Float32Array",Yi],["Float64Array",Yi],["Int16Array",Yi],["Int32Array",Yi],["Int8Array",Yi],["Uint16Array",Yi],["Uint32Array",Yi],["Uint8Array",Yi],["Uint8ClampedArray",Yi],["Array Iterator",Mt],["Map Iterator",Mt],["Promise",Mt],["Set Iterator",Mt],["String Iterator",Mt],["function",Mt],["global",Mt],["WeakMap",Mt],["WeakSet",Mt],["boolean",Mt],["null",Mt],["number",Mt],["string",Mt],["symbol",Mt],["undefined",Mt],["Arguments",vf],["Array",vf],["Map",kA],["Object",PA],["Set",OA]]);function MA(){}function hc(e,t=null,n=MA){2===arguments.length&&"function"==typeof t&&(n=t,t=null);const i=t||br(e),s=DA.get(i);if("Object"===i){const t=n(e,i);if(void 0!==t)return t}return s?s(e,i):e}function LA(e,t={}){"function"==typeof t&&(t={customizer:t});const{customizer:n}=t,i=br(e);if(!uc(i))return fc(e,null,null,null);const s=hc(e,i,n);return fc(e,s,new WeakMap([[e,s]]),new WeakSet([e]))}function fc(e,t,n,i,s){const r=br(e),o=hc(e,r);if(!uc(r))return o;let a;switch(r){case"Arguments":case"Array":a=Object.keys(e);break;case"Object":a=Object.keys(e),a.push(...Object.getOwnPropertySymbols(e));break;case"Map":case"Set":a=e.keys()}for(let s of a){const o=gA(e,s,r);if(i.has(o))pf(t,s,n.get(o),r);else{const e=br(o),a=hc(o,e);uc(e)&&(n.set(o,a),i.add(o)),pf(t,s,fc(o,a,n,i),r)}}return t}var NA=(e=>(e.DIRECT="direct",e.GFN="gfn",e.NVCF="nvcf",e))(NA||{});const tt=class e{static async connect(t){const n=t.streamSource;try{if(ke.setLogLevel(t.logLevel||mf.INFO),ke.setLogFormat(t.logFormat||uo.JSON),"gfn"===n)return e._stream=e._stream||new dA,e._stream.connect(t.streamConfig);if("direct"===n||"nvcf"===n){const i=t=>{t.status===Se.error&&e.terminate()};if(t.streamConfig.onStart){const e=LA(t),n=t.streamConfig.onStart,s=e=>{i(e),n(e)};e.streamConfig.onStart=s,t=e}else t.streamConfig.onStart=i;return"nvcf"===n?(e._stream=e._stream||new cA,e._stream.connect(t.streamConfig)):(e._stream=e._stream||new Ff,e._stream.connect(t.streamConfig))}}catch(e){throw{action:ye.start,status:Se.error,info:e}}throw console.error(`Stream:init: ${n} is an invalid source`),{action:ye.start,status:Se.error,info:TypeError(`Stream:init: '${n}' is an invalid source`)}}static async sendMessage(t){try{if(e._stream)return e._stream.sendMessage(t),console.debug(`Sent message to GFN app: ${t}`),{action:ye.message,status:Se.success,info:"Message was successfully sent."};{const e="There is no stream controller. Please call the setup method.";throw console.error(`Error sending message: ${e}`),{action:ye.message,status:Se.error,info:e}}}catch(e){throw console.error("Error sending message: "+e),{action:ye.message,status:Se.error,info:e}}}static async start(){if(e._stream)return e._stream.start();throw{action:ye.start,status:Se.error,info:"There is no stream controller. Please call the setup method."}}static async stop(){if(e._stream)return e._stream.stop().then((e=>e));throw{action:ye.stop,status:Se.error,info:"There is no stream controller. Please call the setup method."}}static async terminate(t=!1,n=!1){if(e._stream)return e._stream.terminate(t).then((t=>("success"===(null==t?void 0:t.status)&&(e._stream=null),t)));throw{action:ye.terminate,status:Se.error,info:"There is no stream controller. Please call the setup method."}}static async resize(t,n){try{if(e._stream)return e._stream.resize(t,n),{action:ye.update,status:Se.success,info:"The stream resolution has been updated."};throw{action:ye.update,status:Se.error,info:"There is no stream controller. Please call the setup method."}}catch(e){throw console.error("Error resizing: "+e),{action:ye.update,status:Se.error,info:e}}}};Re(tt,"_stream");let gf=tt;export{gf as AppStreamer,uo as LogFormat,mf as LogLevel,NA as StreamType,ye as eAction,Se as eStatus};